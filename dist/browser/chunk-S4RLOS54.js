import{a as nf,b as pr}from"./chunk-GUQDTDME.js";import{$ as du,$a as Bu,A as ys,Aa as Pu,B as bs,Ba as Ls,C as Zp,Ca as Mu,Cb as Yu,D as Qp,Da as Iu,E as Kp,F as xs,G as Yp,Ga as Zi,H as sr,Ha as Us,Hb as ef,I as eu,Ia as Du,Ib as tf,J as ws,Ja as Tu,K as Ss,Ka as zs,Kb as xi,L as Es,La as Fu,Lb as wi,M as tu,Ma as kn,Mb as Si,N as iu,Na as ku,Nb as si,O as nu,Oa as Bs,Ob as Ei,P as Fn,Pa as Ou,Pb as ft,Q as ou,Qa as Vu,Qb as dn,R as ru,Ra as ro,Rb as Ni,S as Ps,Sa as Nu,Sb as Ad,T as Ms,Ta as Au,Tb as Gi,U as au,Ua as ju,Ub as so,V as Is,Va as Ru,Vb as mr,W as su,Wa as Ws,Wb as lo,X as Ds,Xa as Lu,Xb as of,Y as Ts,Ya as $s,Z as lu,Za as Uu,_ as cu,_a as zu,a as Op,aa as Fs,ab as Hs,ba as mu,bb as Wu,c as Vp,ca as ks,cb as ao,d as Np,da as Os,db as On,e as Te,ea as Vs,eb as Gs,f as Je,fb as qs,g as Ap,ga as pu,gb as $u,h as hs,ha as uu,hb as Hu,i as gs,ia as fu,ib as Gu,j as jp,ja as hu,jb as qu,k as Rp,ka as gu,kb as dr,l as Lp,la as Ns,m as Up,ma as As,mb as Js,n as Cs,na as Cu,nb as ma,o as ar,oa as _u,ob as Ju,p as _s,pa as js,pb as Xu,q as zp,qa as lr,qb as Vd,r as Bp,ra as vu,rb as Xn,s as Wp,sa as Rs,sb as Nd,t as $p,ta as yu,u as Hp,ua as bu,ub as Zu,v as vs,va as cr,vb as Qu,w as Gp,wa as xu,x as qp,xa as wu,y as Jp,ya as Su,yb as Ku,z as Xp,za as Eu}from"./chunk-CZFE3RJ6.js";import{a as Yt}from"./chunk-V6QKETSR.js";import{a as bi,b as he,e as Ge,g as Be,h as Ye}from"./chunk-TTQ5IRBO.js";import{$a as q,$b as lt,$c as Wi,Aa as dp,Ab as hi,Ac as jo,Ad as Qe,B as Qa,Ba as an,Bb as d,Bd as us,Cb as Li,Cc as Ro,Cd as ze,D as Ka,Db as gi,Dc as Pp,Dd as Ne,Eb as hp,Ec as da,Ed as Xt,F as np,Fb as ut,Fd as ni,G as Ya,Gb as ct,Gc as be,Gd as Fe,H as op,Hb as dt,Hd as at,Ia as mp,Ic as ls,Id as Zt,Ja as mt,Jb as gp,Jc as Mp,Jd as Dn,Ka as No,Kb as Cp,Kd as Qt,La as os,Lb as Xe,Lc as Oi,Ld as ri,M as rp,Ma as c,Mb as xt,Md as $t,Na as pp,Nb as Ct,Nc as _i,Nd as Ht,Oa as sa,Ob as pi,Od as Gt,Pb as it,Pd as nr,Qa as gt,Qb as u,Qd as or,R as ap,Ra as er,Rb as W,Rd as Fp,Sb as Ie,Tb as ca,Td as kp,Ua as N,Ub as _p,Ud as pe,V as Fd,Va as rs,Vb as ie,Vd as Kt,W as es,Wa as Ao,Wb as Z,Wc as Ip,Wd as fs,X as ko,Xb as ne,Yb as vp,Yc as Dp,Z as sp,Za as Se,Zb as yp,_b as bp,a as k,aa as Yo,ab as fi,ac as Re,ad as oo,b as re,ba as He,bb as up,bc as ss,bd as ln,c as aa,ca as ts,cb as as,cc as tr,cd as cn,d as ep,da as Oo,db as sn,dc as we,dd as ir,e as qn,ea as Vo,ec as Xi,f as st,fa as b,fc as te,g as tp,gb as D,gc as vt,gd as cs,ge as $i,hb as T,hc as xp,he as Hi,ia as is,ib as de,id as Le,ie as vi,jb as bn,jc as wp,je as yi,ka as g,kb as Y,kc as Ii,kd as tt,ke as ai,la as C,lb as ee,le as Ke,m as P,mb as f,mc as Di,md as Lt,me as Mt,n as Ji,nb as l,nc as Sp,ne as Vi,o as Td,oa as lp,ob as a,oe as Tn,pa as kd,pb as _,pc as Ci,pe as rr,q as Tt,qa as cp,qb as _t,qc as ce,qe as At,r as ki,rb as Ft,rc as yt,sb as ii,sd as Od,tc as Oe,td as Ee,u as ip,ua as A,uc as le,ud as Tp,vb as la,vc as Ep,vd as ds,wb as fp,wd as xe,xb as M,xd as ms,yb as Jn,yc as nt,yd as ps,za as ns,zb as h}from"./chunk-AFPYJGSO.js";var Eh=st((Sh,rm)=>{"use strict";(function(o){typeof Sh=="object"&&typeof rm<"u"?rm.exports=o():typeof define=="function"&&define.amd?define([],o):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).JSZip=o()})(function(){return(function o(t,e,i){function n(m,p){if(!e[m]){if(!t[m]){var v=typeof aa=="function"&&aa;if(!p&&v)return v(m,!0);if(r)return r(m,!0);var y=new Error("Cannot find module '"+m+"'");throw y.code="MODULE_NOT_FOUND",y}var x=e[m]={exports:{}};t[m][0].call(x.exports,function(E){var w=t[m][1][E];return n(w||E)},x,x.exports,o,t,e,i)}return e[m].exports}for(var r=typeof aa=="function"&&aa,s=0;s<i.length;s++)n(i[s]);return n})({1:[function(o,t,e){"use strict";var i=o("./utils"),n=o("./support"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.encode=function(s){for(var m,p,v,y,x,E,w,O=[],F=0,V=s.length,L=V,B=i.getTypeOf(s)!=="string";F<s.length;)L=V-F,v=B?(m=s[F++],p=F<V?s[F++]:0,F<V?s[F++]:0):(m=s.charCodeAt(F++),p=F<V?s.charCodeAt(F++):0,F<V?s.charCodeAt(F++):0),y=m>>2,x=(3&m)<<4|p>>4,E=1<L?(15&p)<<2|v>>6:64,w=2<L?63&v:64,O.push(r.charAt(y)+r.charAt(x)+r.charAt(E)+r.charAt(w));return O.join("")},e.decode=function(s){var m,p,v,y,x,E,w=0,O=0,F="data:";if(s.substr(0,F.length)===F)throw new Error("Invalid base64 input, it looks like a data url.");var V,L=3*(s=s.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(s.charAt(s.length-1)===r.charAt(64)&&L--,s.charAt(s.length-2)===r.charAt(64)&&L--,L%1!=0)throw new Error("Invalid base64 input, bad content length.");for(V=n.uint8array?new Uint8Array(0|L):new Array(0|L);w<s.length;)m=r.indexOf(s.charAt(w++))<<2|(y=r.indexOf(s.charAt(w++)))>>4,p=(15&y)<<4|(x=r.indexOf(s.charAt(w++)))>>2,v=(3&x)<<6|(E=r.indexOf(s.charAt(w++))),V[O++]=m,x!==64&&(V[O++]=p),E!==64&&(V[O++]=v);return V}},{"./support":30,"./utils":32}],2:[function(o,t,e){"use strict";var i=o("./external"),n=o("./stream/DataWorker"),r=o("./stream/Crc32Probe"),s=o("./stream/DataLengthProbe");function m(p,v,y,x,E){this.compressedSize=p,this.uncompressedSize=v,this.crc32=y,this.compression=x,this.compressedContent=E}m.prototype={getContentWorker:function(){var p=new n(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s("data_length")),v=this;return p.on("end",function(){if(this.streamInfo.data_length!==v.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),p},getCompressedWorker:function(){return new n(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},m.createWorkerFrom=function(p,v,y){return p.pipe(new r).pipe(new s("uncompressedSize")).pipe(v.compressWorker(y)).pipe(new s("compressedSize")).withStreamInfo("compression",v)},t.exports=m},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(o,t,e){"use strict";var i=o("./stream/GenericWorker");e.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},e.DEFLATE=o("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(o,t,e){"use strict";var i=o("./utils"),n=(function(){for(var r,s=[],m=0;m<256;m++){r=m;for(var p=0;p<8;p++)r=1&r?3988292384^r>>>1:r>>>1;s[m]=r}return s})();t.exports=function(r,s){return r!==void 0&&r.length?i.getTypeOf(r)!=="string"?(function(m,p,v,y){var x=n,E=y+v;m^=-1;for(var w=y;w<E;w++)m=m>>>8^x[255&(m^p[w])];return-1^m})(0|s,r,r.length,0):(function(m,p,v,y){var x=n,E=y+v;m^=-1;for(var w=y;w<E;w++)m=m>>>8^x[255&(m^p.charCodeAt(w))];return-1^m})(0|s,r,r.length,0):0}},{"./utils":32}],5:[function(o,t,e){"use strict";e.base64=!1,e.binary=!1,e.dir=!1,e.createFolders=!0,e.date=null,e.compression=null,e.compressionOptions=null,e.comment=null,e.unixPermissions=null,e.dosPermissions=null},{}],6:[function(o,t,e){"use strict";var i=null;i=typeof Promise<"u"?Promise:o("lie"),t.exports={Promise:i}},{lie:37}],7:[function(o,t,e){"use strict";var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",n=o("pako"),r=o("./utils"),s=o("./stream/GenericWorker"),m=i?"uint8array":"array";function p(v,y){s.call(this,"FlateWorker/"+v),this._pako=null,this._pakoAction=v,this._pakoOptions=y,this.meta={}}e.magic="\b\0",r.inherits(p,s),p.prototype.processChunk=function(v){this.meta=v.meta,this._pako===null&&this._createPako(),this._pako.push(r.transformTo(m,v.data),!1)},p.prototype.flush=function(){s.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},p.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this._pako=null},p.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var v=this;this._pako.onData=function(y){v.push({data:y,meta:v.meta})}},e.compressWorker=function(v){return new p("Deflate",v)},e.uncompressWorker=function(){return new p("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(o,t,e){"use strict";function i(x,E){var w,O="";for(w=0;w<E;w++)O+=String.fromCharCode(255&x),x>>>=8;return O}function n(x,E,w,O,F,V){var L,B,z=x.file,Q=x.compression,K=V!==m.utf8encode,fe=r.transformTo("string",V(z.name)),ae=r.transformTo("string",m.utf8encode(z.name)),ye=z.comment,qe=r.transformTo("string",V(ye)),U=r.transformTo("string",m.utf8encode(ye)),me=ae.length!==z.name.length,I=U.length!==ye.length,ge="",Ve="",_e="",pt=z.dir,Pe=z.date,rt={crc32:0,compressedSize:0,uncompressedSize:0};E&&!w||(rt.crc32=x.crc32,rt.compressedSize=x.compressedSize,rt.uncompressedSize=x.uncompressedSize);var oe=0;E&&(oe|=8),K||!me&&!I||(oe|=2048);var X=0,et=0;pt&&(X|=16),F==="UNIX"?(et=798,X|=(function(ke,ci){var Bi=ke;return ke||(Bi=ci?16893:33204),(65535&Bi)<<16})(z.unixPermissions,pt)):(et=20,X|=(function(ke){return 63&(ke||0)})(z.dosPermissions)),L=Pe.getUTCHours(),L<<=6,L|=Pe.getUTCMinutes(),L<<=5,L|=Pe.getUTCSeconds()/2,B=Pe.getUTCFullYear()-1980,B<<=4,B|=Pe.getUTCMonth()+1,B<<=5,B|=Pe.getUTCDate(),me&&(Ve=i(1,1)+i(p(fe),4)+ae,ge+="up"+i(Ve.length,2)+Ve),I&&(_e=i(1,1)+i(p(qe),4)+U,ge+="uc"+i(_e.length,2)+_e);var Ae="";return Ae+=`
\0`,Ae+=i(oe,2),Ae+=Q.magic,Ae+=i(L,2),Ae+=i(B,2),Ae+=i(rt.crc32,4),Ae+=i(rt.compressedSize,4),Ae+=i(rt.uncompressedSize,4),Ae+=i(fe.length,2),Ae+=i(ge.length,2),{fileRecord:v.LOCAL_FILE_HEADER+Ae+fe+ge,dirRecord:v.CENTRAL_FILE_HEADER+i(et,2)+Ae+i(qe.length,2)+"\0\0\0\0"+i(X,4)+i(O,4)+fe+ge+qe}}var r=o("../utils"),s=o("../stream/GenericWorker"),m=o("../utf8"),p=o("../crc32"),v=o("../signature");function y(x,E,w,O){s.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=E,this.zipPlatform=w,this.encodeFileName=O,this.streamFiles=x,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(y,s),y.prototype.push=function(x){var E=x.meta.percent||0,w=this.entriesCount,O=this._sources.length;this.accumulate?this.contentBuffer.push(x):(this.bytesWritten+=x.data.length,s.prototype.push.call(this,{data:x.data,meta:{currentFile:this.currentFile,percent:w?(E+100*(w-O-1))/w:100}}))},y.prototype.openedSource=function(x){this.currentSourceOffset=this.bytesWritten,this.currentFile=x.file.name;var E=this.streamFiles&&!x.file.dir;if(E){var w=n(x,E,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:w.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(x){this.accumulate=!1;var E=this.streamFiles&&!x.file.dir,w=n(x,E,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(w.dirRecord),E)this.push({data:(function(O){return v.DATA_DESCRIPTOR+i(O.crc32,4)+i(O.compressedSize,4)+i(O.uncompressedSize,4)})(x),meta:{percent:100}});else for(this.push({data:w.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var x=this.bytesWritten,E=0;E<this.dirRecords.length;E++)this.push({data:this.dirRecords[E],meta:{percent:100}});var w=this.bytesWritten-x,O=(function(F,V,L,B,z){var Q=r.transformTo("string",z(B));return v.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(F,2)+i(F,2)+i(V,4)+i(L,4)+i(Q.length,2)+Q})(this.dirRecords.length,w,x,this.zipComment,this.encodeFileName);this.push({data:O,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(x){this._sources.push(x);var E=this;return x.on("data",function(w){E.processChunk(w)}),x.on("end",function(){E.closedSource(E.previous.streamInfo),E._sources.length?E.prepareNextSource():E.end()}),x.on("error",function(w){E.error(w)}),this},y.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(x){var E=this._sources;if(!s.prototype.error.call(this,x))return!1;for(var w=0;w<E.length;w++)try{E[w].error(x)}catch{}return!0},y.prototype.lock=function(){s.prototype.lock.call(this);for(var x=this._sources,E=0;E<x.length;E++)x[E].lock()},t.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(o,t,e){"use strict";var i=o("../compressions"),n=o("./ZipFileWorker");e.generateWorker=function(r,s,m){var p=new n(s.streamFiles,m,s.platform,s.encodeFileName),v=0;try{r.forEach(function(y,x){v++;var E=(function(V,L){var B=V||L,z=i[B];if(!z)throw new Error(B+" is not a valid compression method !");return z})(x.options.compression,s.compression),w=x.options.compressionOptions||s.compressionOptions||{},O=x.dir,F=x.date;x._compressWorker(E,w).withStreamInfo("file",{name:y,dir:O,date:F,comment:x.comment||"",unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions}).pipe(p)}),p.entriesCount=v}catch(y){p.error(y)}return p}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(o,t,e){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var n=new i;for(var r in this)typeof this[r]!="function"&&(n[r]=this[r]);return n}}(i.prototype=o("./object")).loadAsync=o("./load"),i.support=o("./support"),i.defaults=o("./defaults"),i.version="3.10.1",i.loadAsync=function(n,r){return new i().loadAsync(n,r)},i.external=o("./external"),t.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(o,t,e){"use strict";var i=o("./utils"),n=o("./external"),r=o("./utf8"),s=o("./zipEntries"),m=o("./stream/Crc32Probe"),p=o("./nodejsUtils");function v(y){return new n.Promise(function(x,E){var w=y.decompressed.getContentWorker().pipe(new m);w.on("error",function(O){E(O)}).on("end",function(){w.streamInfo.crc32!==y.decompressed.crc32?E(new Error("Corrupted zip : CRC32 mismatch")):x()}).resume()})}t.exports=function(y,x){var E=this;return x=i.extend(x||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),p.isNode&&p.isStream(y)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",y,!0,x.optimizedBinaryString,x.base64).then(function(w){var O=new s(x);return O.load(w),O}).then(function(w){var O=[n.Promise.resolve(w)],F=w.files;if(x.checkCRC32)for(var V=0;V<F.length;V++)O.push(v(F[V]));return n.Promise.all(O)}).then(function(w){for(var O=w.shift(),F=O.files,V=0;V<F.length;V++){var L=F[V],B=L.fileNameStr,z=i.resolve(L.fileNameStr);E.file(z,L.decompressed,{binary:!0,optimizedBinaryString:!0,date:L.date,dir:L.dir,comment:L.fileCommentStr.length?L.fileCommentStr:null,unixPermissions:L.unixPermissions,dosPermissions:L.dosPermissions,createFolders:x.createFolders}),L.dir||(E.file(z).unsafeOriginalName=B)}return O.zipComment.length&&(E.comment=O.zipComment),E})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(o,t,e){"use strict";var i=o("../utils"),n=o("../stream/GenericWorker");function r(s,m){n.call(this,"Nodejs stream input adapter for "+s),this._upstreamEnded=!1,this._bindStream(m)}i.inherits(r,n),r.prototype._bindStream=function(s){var m=this;(this._stream=s).pause(),s.on("data",function(p){m.push({data:p,meta:{percent:0}})}).on("error",function(p){m.isPaused?this.generatedError=p:m.error(p)}).on("end",function(){m.isPaused?m._upstreamEnded=!0:m.end()})},r.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},r.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=r},{"../stream/GenericWorker":28,"../utils":32}],13:[function(o,t,e){"use strict";var i=o("readable-stream").Readable;function n(r,s,m){i.call(this,s),this._helper=r;var p=this;r.on("data",function(v,y){p.push(v)||p._helper.pause(),m&&m(y)}).on("error",function(v){p.emit("error",v)}).on("end",function(){p.push(null)})}o("../utils").inherits(n,i),n.prototype._read=function(){this._helper.resume()},t.exports=n},{"../utils":32,"readable-stream":16}],14:[function(o,t,e){"use strict";t.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,n){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,n);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,n)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var n=new Buffer(i);return n.fill(0),n},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(o,t,e){"use strict";function i(z,Q,K){var fe,ae=r.getTypeOf(Q),ye=r.extend(K||{},p);ye.date=ye.date||new Date,ye.compression!==null&&(ye.compression=ye.compression.toUpperCase()),typeof ye.unixPermissions=="string"&&(ye.unixPermissions=parseInt(ye.unixPermissions,8)),ye.unixPermissions&&16384&ye.unixPermissions&&(ye.dir=!0),ye.dosPermissions&&16&ye.dosPermissions&&(ye.dir=!0),ye.dir&&(z=F(z)),ye.createFolders&&(fe=O(z))&&V.call(this,fe,!0);var qe=ae==="string"&&ye.binary===!1&&ye.base64===!1;K&&K.binary!==void 0||(ye.binary=!qe),(Q instanceof v&&Q.uncompressedSize===0||ye.dir||!Q||Q.length===0)&&(ye.base64=!1,ye.binary=!0,Q="",ye.compression="STORE",ae="string");var U=null;U=Q instanceof v||Q instanceof s?Q:E.isNode&&E.isStream(Q)?new w(z,Q):r.prepareContent(z,Q,ye.binary,ye.optimizedBinaryString,ye.base64);var me=new y(z,U,ye);this.files[z]=me}var n=o("./utf8"),r=o("./utils"),s=o("./stream/GenericWorker"),m=o("./stream/StreamHelper"),p=o("./defaults"),v=o("./compressedObject"),y=o("./zipObject"),x=o("./generate"),E=o("./nodejsUtils"),w=o("./nodejs/NodejsStreamInputAdapter"),O=function(z){z.slice(-1)==="/"&&(z=z.substring(0,z.length-1));var Q=z.lastIndexOf("/");return 0<Q?z.substring(0,Q):""},F=function(z){return z.slice(-1)!=="/"&&(z+="/"),z},V=function(z,Q){return Q=Q!==void 0?Q:p.createFolders,z=F(z),this.files[z]||i.call(this,z,null,{dir:!0,createFolders:Q}),this.files[z]};function L(z){return Object.prototype.toString.call(z)==="[object RegExp]"}var B={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(z){var Q,K,fe;for(Q in this.files)fe=this.files[Q],(K=Q.slice(this.root.length,Q.length))&&Q.slice(0,this.root.length)===this.root&&z(K,fe)},filter:function(z){var Q=[];return this.forEach(function(K,fe){z(K,fe)&&Q.push(fe)}),Q},file:function(z,Q,K){if(arguments.length!==1)return z=this.root+z,i.call(this,z,Q,K),this;if(L(z)){var fe=z;return this.filter(function(ye,qe){return!qe.dir&&fe.test(ye)})}var ae=this.files[this.root+z];return ae&&!ae.dir?ae:null},folder:function(z){if(!z)return this;if(L(z))return this.filter(function(ae,ye){return ye.dir&&z.test(ae)});var Q=this.root+z,K=V.call(this,Q),fe=this.clone();return fe.root=K.name,fe},remove:function(z){z=this.root+z;var Q=this.files[z];if(Q||(z.slice(-1)!=="/"&&(z+="/"),Q=this.files[z]),Q&&!Q.dir)delete this.files[z];else for(var K=this.filter(function(ae,ye){return ye.name.slice(0,z.length)===z}),fe=0;fe<K.length;fe++)delete this.files[K[fe].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(z){var Q,K={};try{if((K=r.extend(z||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=K.type.toLowerCase(),K.compression=K.compression.toUpperCase(),K.type==="binarystring"&&(K.type="string"),!K.type)throw new Error("No output type specified.");r.checkSupport(K.type),K.platform!=="darwin"&&K.platform!=="freebsd"&&K.platform!=="linux"&&K.platform!=="sunos"||(K.platform="UNIX"),K.platform==="win32"&&(K.platform="DOS");var fe=K.comment||this.comment||"";Q=x.generateWorker(this,K,fe)}catch(ae){(Q=new s("error")).error(ae)}return new m(Q,K.type||"string",K.mimeType)},generateAsync:function(z,Q){return this.generateInternalStream(z).accumulate(Q)},generateNodeStream:function(z,Q){return(z=z||{}).type||(z.type="nodebuffer"),this.generateInternalStream(z).toNodejsStream(Q)}};t.exports=B},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(o,t,e){"use strict";t.exports=o("stream")},{stream:void 0}],17:[function(o,t,e){"use strict";var i=o("./DataReader");function n(r){i.call(this,r);for(var s=0;s<this.data.length;s++)r[s]=255&r[s]}o("../utils").inherits(n,i),n.prototype.byteAt=function(r){return this.data[this.zero+r]},n.prototype.lastIndexOfSignature=function(r){for(var s=r.charCodeAt(0),m=r.charCodeAt(1),p=r.charCodeAt(2),v=r.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===s&&this.data[y+1]===m&&this.data[y+2]===p&&this.data[y+3]===v)return y-this.zero;return-1},n.prototype.readAndCheckSignature=function(r){var s=r.charCodeAt(0),m=r.charCodeAt(1),p=r.charCodeAt(2),v=r.charCodeAt(3),y=this.readData(4);return s===y[0]&&m===y[1]&&p===y[2]&&v===y[3]},n.prototype.readData=function(r){if(this.checkOffset(r),r===0)return[];var s=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,s},t.exports=n},{"../utils":32,"./DataReader":18}],18:[function(o,t,e){"use strict";var i=o("../utils");function n(r){this.data=r,this.length=r.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(r){this.checkIndex(this.index+r)},checkIndex:function(r){if(this.length<this.zero+r||r<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+r+"). Corrupted zip ?")},setIndex:function(r){this.checkIndex(r),this.index=r},skip:function(r){this.setIndex(this.index+r)},byteAt:function(){},readInt:function(r){var s,m=0;for(this.checkOffset(r),s=this.index+r-1;s>=this.index;s--)m=(m<<8)+this.byteAt(s);return this.index+=r,m},readString:function(r){return i.transformTo("string",this.readData(r))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var r=this.readInt(4);return new Date(Date.UTC(1980+(r>>25&127),(r>>21&15)-1,r>>16&31,r>>11&31,r>>5&63,(31&r)<<1))}},t.exports=n},{"../utils":32}],19:[function(o,t,e){"use strict";var i=o("./Uint8ArrayReader");function n(r){i.call(this,r)}o("../utils").inherits(n,i),n.prototype.readData=function(r){this.checkOffset(r);var s=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,s},t.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(o,t,e){"use strict";var i=o("./DataReader");function n(r){i.call(this,r)}o("../utils").inherits(n,i),n.prototype.byteAt=function(r){return this.data.charCodeAt(this.zero+r)},n.prototype.lastIndexOfSignature=function(r){return this.data.lastIndexOf(r)-this.zero},n.prototype.readAndCheckSignature=function(r){return r===this.readData(4)},n.prototype.readData=function(r){this.checkOffset(r);var s=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,s},t.exports=n},{"../utils":32,"./DataReader":18}],21:[function(o,t,e){"use strict";var i=o("./ArrayReader");function n(r){i.call(this,r)}o("../utils").inherits(n,i),n.prototype.readData=function(r){if(this.checkOffset(r),r===0)return new Uint8Array(0);var s=this.data.subarray(this.zero+this.index,this.zero+this.index+r);return this.index+=r,s},t.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(o,t,e){"use strict";var i=o("../utils"),n=o("../support"),r=o("./ArrayReader"),s=o("./StringReader"),m=o("./NodeBufferReader"),p=o("./Uint8ArrayReader");t.exports=function(v){var y=i.getTypeOf(v);return i.checkSupport(y),y!=="string"||n.uint8array?y==="nodebuffer"?new m(v):n.uint8array?new p(i.transformTo("uint8array",v)):new r(i.transformTo("array",v)):new s(v)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(o,t,e){"use strict";e.LOCAL_FILE_HEADER="PK",e.CENTRAL_FILE_HEADER="PK",e.CENTRAL_DIRECTORY_END="PK",e.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",e.ZIP64_CENTRAL_DIRECTORY_END="PK",e.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(o,t,e){"use strict";var i=o("./GenericWorker"),n=o("../utils");function r(s){i.call(this,"ConvertWorker to "+s),this.destType=s}n.inherits(r,i),r.prototype.processChunk=function(s){this.push({data:n.transformTo(this.destType,s.data),meta:s.meta})},t.exports=r},{"../utils":32,"./GenericWorker":28}],25:[function(o,t,e){"use strict";var i=o("./GenericWorker"),n=o("../crc32");function r(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}o("../utils").inherits(r,i),r.prototype.processChunk=function(s){this.streamInfo.crc32=n(s.data,this.streamInfo.crc32||0),this.push(s)},t.exports=r},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(o,t,e){"use strict";var i=o("../utils"),n=o("./GenericWorker");function r(s){n.call(this,"DataLengthProbe for "+s),this.propName=s,this.withStreamInfo(s,0)}i.inherits(r,n),r.prototype.processChunk=function(s){if(s){var m=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=m+s.data.length}n.prototype.processChunk.call(this,s)},t.exports=r},{"../utils":32,"./GenericWorker":28}],27:[function(o,t,e){"use strict";var i=o("../utils"),n=o("./GenericWorker");function r(s){n.call(this,"DataWorker");var m=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,s.then(function(p){m.dataIsReady=!0,m.data=p,m.max=p&&p.length||0,m.type=i.getTypeOf(p),m.isPaused||m._tickAndRepeat()},function(p){m.error(p)})}i.inherits(r,n),r.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},r.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},r.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},r.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var s=null,m=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":s=this.data.substring(this.index,m);break;case"uint8array":s=this.data.subarray(this.index,m);break;case"array":case"nodebuffer":s=this.data.slice(this.index,m)}return this.index=m,this.push({data:s,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=r},{"../utils":32,"./GenericWorker":28}],28:[function(o,t,e){"use strict";function i(n){this.name=n||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(n){this.emit("data",n)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(n){this.emit("error",n)}return!0},error:function(n){return!this.isFinished&&(this.isPaused?this.generatedError=n:(this.isFinished=!0,this.emit("error",n),this.previous&&this.previous.error(n),this.cleanUp()),!0)},on:function(n,r){return this._listeners[n].push(r),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(n,r){if(this._listeners[n])for(var s=0;s<this._listeners[n].length;s++)this._listeners[n][s].call(this,r)},pipe:function(n){return n.registerPrevious(this)},registerPrevious:function(n){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=n.streamInfo,this.mergeStreamInfo(),this.previous=n;var r=this;return n.on("data",function(s){r.processChunk(s)}),n.on("end",function(){r.end()}),n.on("error",function(s){r.error(s)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var n=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),n=!0),this.previous&&this.previous.resume(),!n},flush:function(){},processChunk:function(n){this.push(n)},withStreamInfo:function(n,r){return this.extraStreamInfo[n]=r,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var n in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,n)&&(this.streamInfo[n]=this.extraStreamInfo[n])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var n="Worker "+this.name;return this.previous?this.previous+" -> "+n:n}},t.exports=i},{}],29:[function(o,t,e){"use strict";var i=o("../utils"),n=o("./ConvertWorker"),r=o("./GenericWorker"),s=o("../base64"),m=o("../support"),p=o("../external"),v=null;if(m.nodestream)try{v=o("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(E,w){return new p.Promise(function(O,F){var V=[],L=E._internalType,B=E._outputType,z=E._mimeType;E.on("data",function(Q,K){V.push(Q),w&&w(K)}).on("error",function(Q){V=[],F(Q)}).on("end",function(){try{var Q=(function(K,fe,ae){switch(K){case"blob":return i.newBlob(i.transformTo("arraybuffer",fe),ae);case"base64":return s.encode(fe);default:return i.transformTo(K,fe)}})(B,(function(K,fe){var ae,ye=0,qe=null,U=0;for(ae=0;ae<fe.length;ae++)U+=fe[ae].length;switch(K){case"string":return fe.join("");case"array":return Array.prototype.concat.apply([],fe);case"uint8array":for(qe=new Uint8Array(U),ae=0;ae<fe.length;ae++)qe.set(fe[ae],ye),ye+=fe[ae].length;return qe;case"nodebuffer":return Buffer.concat(fe);default:throw new Error("concat : unsupported type '"+K+"'")}})(L,V),z);O(Q)}catch(K){F(K)}V=[]}).resume()})}function x(E,w,O){var F=w;switch(w){case"blob":case"arraybuffer":F="uint8array";break;case"base64":F="string"}try{this._internalType=F,this._outputType=w,this._mimeType=O,i.checkSupport(F),this._worker=E.pipe(new n(F)),E.lock()}catch(V){this._worker=new r("error"),this._worker.error(V)}}x.prototype={accumulate:function(E){return y(this,E)},on:function(E,w){var O=this;return E==="data"?this._worker.on(E,function(F){w.call(O,F.data,F.meta)}):this._worker.on(E,function(){i.delay(w,arguments,O)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(E){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new v(this,{objectMode:this._outputType!=="nodebuffer"},E)}},t.exports=x},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(o,t,e){"use strict";if(e.base64=!0,e.array=!0,e.string=!0,e.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",e.nodebuffer=typeof Buffer<"u",e.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")e.blob=!1;else{var i=new ArrayBuffer(0);try{e.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(i),e.blob=n.getBlob("application/zip").size===0}catch{e.blob=!1}}}try{e.nodestream=!!o("readable-stream").Readable}catch{e.nodestream=!1}},{"readable-stream":16}],31:[function(o,t,e){"use strict";for(var i=o("./utils"),n=o("./support"),r=o("./nodejsUtils"),s=o("./stream/GenericWorker"),m=new Array(256),p=0;p<256;p++)m[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;m[254]=m[254]=1;function v(){s.call(this,"utf-8 decode"),this.leftOver=null}function y(){s.call(this,"utf-8 encode")}e.utf8encode=function(x){return n.nodebuffer?r.newBufferFrom(x,"utf-8"):(function(E){var w,O,F,V,L,B=E.length,z=0;for(V=0;V<B;V++)(64512&(O=E.charCodeAt(V)))==55296&&V+1<B&&(64512&(F=E.charCodeAt(V+1)))==56320&&(O=65536+(O-55296<<10)+(F-56320),V++),z+=O<128?1:O<2048?2:O<65536?3:4;for(w=n.uint8array?new Uint8Array(z):new Array(z),V=L=0;L<z;V++)(64512&(O=E.charCodeAt(V)))==55296&&V+1<B&&(64512&(F=E.charCodeAt(V+1)))==56320&&(O=65536+(O-55296<<10)+(F-56320),V++),O<128?w[L++]=O:(O<2048?w[L++]=192|O>>>6:(O<65536?w[L++]=224|O>>>12:(w[L++]=240|O>>>18,w[L++]=128|O>>>12&63),w[L++]=128|O>>>6&63),w[L++]=128|63&O);return w})(x)},e.utf8decode=function(x){return n.nodebuffer?i.transformTo("nodebuffer",x).toString("utf-8"):(function(E){var w,O,F,V,L=E.length,B=new Array(2*L);for(w=O=0;w<L;)if((F=E[w++])<128)B[O++]=F;else if(4<(V=m[F]))B[O++]=65533,w+=V-1;else{for(F&=V===2?31:V===3?15:7;1<V&&w<L;)F=F<<6|63&E[w++],V--;1<V?B[O++]=65533:F<65536?B[O++]=F:(F-=65536,B[O++]=55296|F>>10&1023,B[O++]=56320|1023&F)}return B.length!==O&&(B.subarray?B=B.subarray(0,O):B.length=O),i.applyFromCharCode(B)})(x=i.transformTo(n.uint8array?"uint8array":"array",x))},i.inherits(v,s),v.prototype.processChunk=function(x){var E=i.transformTo(n.uint8array?"uint8array":"array",x.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var w=E;(E=new Uint8Array(w.length+this.leftOver.length)).set(this.leftOver,0),E.set(w,this.leftOver.length)}else E=this.leftOver.concat(E);this.leftOver=null}var O=(function(V,L){var B;for((L=L||V.length)>V.length&&(L=V.length),B=L-1;0<=B&&(192&V[B])==128;)B--;return B<0||B===0?L:B+m[V[B]]>L?B:L})(E),F=E;O!==E.length&&(n.uint8array?(F=E.subarray(0,O),this.leftOver=E.subarray(O,E.length)):(F=E.slice(0,O),this.leftOver=E.slice(O,E.length))),this.push({data:e.utf8decode(F),meta:x.meta})},v.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:e.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},e.Utf8DecodeWorker=v,i.inherits(y,s),y.prototype.processChunk=function(x){this.push({data:e.utf8encode(x.data),meta:x.meta})},e.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(o,t,e){"use strict";var i=o("./support"),n=o("./base64"),r=o("./nodejsUtils"),s=o("./external");function m(w){return w}function p(w,O){for(var F=0;F<w.length;++F)O[F]=255&w.charCodeAt(F);return O}o("setimmediate"),e.newBlob=function(w,O){e.checkSupport("blob");try{return new Blob([w],{type:O})}catch{try{var F=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return F.append(w),F.getBlob(O)}catch{throw new Error("Bug : can't construct the Blob.")}}};var v={stringifyByChunk:function(w,O,F){var V=[],L=0,B=w.length;if(B<=F)return String.fromCharCode.apply(null,w);for(;L<B;)O==="array"||O==="nodebuffer"?V.push(String.fromCharCode.apply(null,w.slice(L,Math.min(L+F,B)))):V.push(String.fromCharCode.apply(null,w.subarray(L,Math.min(L+F,B)))),L+=F;return V.join("")},stringifyByChar:function(w){for(var O="",F=0;F<w.length;F++)O+=String.fromCharCode(w[F]);return O},applyCanBeUsed:{uint8array:(function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,r.allocBuffer(1)).length===1}catch{return!1}})()}};function y(w){var O=65536,F=e.getTypeOf(w),V=!0;if(F==="uint8array"?V=v.applyCanBeUsed.uint8array:F==="nodebuffer"&&(V=v.applyCanBeUsed.nodebuffer),V)for(;1<O;)try{return v.stringifyByChunk(w,F,O)}catch{O=Math.floor(O/2)}return v.stringifyByChar(w)}function x(w,O){for(var F=0;F<w.length;F++)O[F]=w[F];return O}e.applyFromCharCode=y;var E={};E.string={string:m,array:function(w){return p(w,new Array(w.length))},arraybuffer:function(w){return E.string.uint8array(w).buffer},uint8array:function(w){return p(w,new Uint8Array(w.length))},nodebuffer:function(w){return p(w,r.allocBuffer(w.length))}},E.array={string:y,array:m,arraybuffer:function(w){return new Uint8Array(w).buffer},uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return r.newBufferFrom(w)}},E.arraybuffer={string:function(w){return y(new Uint8Array(w))},array:function(w){return x(new Uint8Array(w),new Array(w.byteLength))},arraybuffer:m,uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return r.newBufferFrom(new Uint8Array(w))}},E.uint8array={string:y,array:function(w){return x(w,new Array(w.length))},arraybuffer:function(w){return w.buffer},uint8array:m,nodebuffer:function(w){return r.newBufferFrom(w)}},E.nodebuffer={string:y,array:function(w){return x(w,new Array(w.length))},arraybuffer:function(w){return E.nodebuffer.uint8array(w).buffer},uint8array:function(w){return x(w,new Uint8Array(w.length))},nodebuffer:m},e.transformTo=function(w,O){if(O=O||"",!w)return O;e.checkSupport(w);var F=e.getTypeOf(O);return E[F][w](O)},e.resolve=function(w){for(var O=w.split("/"),F=[],V=0;V<O.length;V++){var L=O[V];L==="."||L===""&&V!==0&&V!==O.length-1||(L===".."?F.pop():F.push(L))}return F.join("/")},e.getTypeOf=function(w){return typeof w=="string"?"string":Object.prototype.toString.call(w)==="[object Array]"?"array":i.nodebuffer&&r.isBuffer(w)?"nodebuffer":i.uint8array&&w instanceof Uint8Array?"uint8array":i.arraybuffer&&w instanceof ArrayBuffer?"arraybuffer":void 0},e.checkSupport=function(w){if(!i[w.toLowerCase()])throw new Error(w+" is not supported by this platform")},e.MAX_VALUE_16BITS=65535,e.MAX_VALUE_32BITS=-1,e.pretty=function(w){var O,F,V="";for(F=0;F<(w||"").length;F++)V+="\\x"+((O=w.charCodeAt(F))<16?"0":"")+O.toString(16).toUpperCase();return V},e.delay=function(w,O,F){setImmediate(function(){w.apply(F||null,O||[])})},e.inherits=function(w,O){function F(){}F.prototype=O.prototype,w.prototype=new F},e.extend=function(){var w,O,F={};for(w=0;w<arguments.length;w++)for(O in arguments[w])Object.prototype.hasOwnProperty.call(arguments[w],O)&&F[O]===void 0&&(F[O]=arguments[w][O]);return F},e.prepareContent=function(w,O,F,V,L){return s.Promise.resolve(O).then(function(B){return i.blob&&(B instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(B))!==-1)&&typeof FileReader<"u"?new s.Promise(function(z,Q){var K=new FileReader;K.onload=function(fe){z(fe.target.result)},K.onerror=function(fe){Q(fe.target.error)},K.readAsArrayBuffer(B)}):B}).then(function(B){var z=e.getTypeOf(B);return z?(z==="arraybuffer"?B=e.transformTo("uint8array",B):z==="string"&&(L?B=n.decode(B):F&&V!==!0&&(B=(function(Q){return p(Q,i.uint8array?new Uint8Array(Q.length):new Array(Q.length))})(B))),B):s.Promise.reject(new Error("Can't read the data of '"+w+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(o,t,e){"use strict";var i=o("./reader/readerFor"),n=o("./utils"),r=o("./signature"),s=o("./zipEntry"),m=o("./support");function p(v){this.files=[],this.loadOptions=v}p.prototype={checkSignature:function(v){if(!this.reader.readAndCheckSignature(v)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(y)+", expected "+n.pretty(v)+")")}},isSignature:function(v,y){var x=this.reader.index;this.reader.setIndex(v);var E=this.reader.readString(4)===y;return this.reader.setIndex(x),E},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var v=this.reader.readData(this.zipCommentLength),y=m.uint8array?"uint8array":"array",x=n.transformTo(y,v);this.zipComment=this.loadOptions.decodeFileName(x)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var v,y,x,E=this.zip64EndOfCentralSize-44;0<E;)v=this.reader.readInt(2),y=this.reader.readInt(4),x=this.reader.readData(y),this.zip64ExtensibleData[v]={id:v,length:y,value:x}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var v,y;for(v=0;v<this.files.length;v++)y=this.files[v],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var v;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(r.CENTRAL_FILE_HEADER);)(v=new s({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(v);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var v=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(v<0)throw this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(v);var y=v;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(v=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(v),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var x=this.centralDirOffset+this.centralDirSize;this.zip64&&(x+=20,x+=12+this.zip64EndOfCentralSize);var E=y-x;if(0<E)this.isSignature(y,r.CENTRAL_FILE_HEADER)||(this.reader.zero=E);else if(E<0)throw new Error("Corrupted zip: missing "+Math.abs(E)+" bytes.")},prepareReader:function(v){this.reader=i(v)},load:function(v){this.prepareReader(v),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=p},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(o,t,e){"use strict";var i=o("./reader/readerFor"),n=o("./utils"),r=o("./compressedObject"),s=o("./crc32"),m=o("./utf8"),p=o("./compressions"),v=o("./support");function y(x,E){this.options=x,this.loadOptions=E}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(x){var E,w;if(x.skip(22),this.fileNameLength=x.readInt(2),w=x.readInt(2),this.fileName=x.readData(this.fileNameLength),x.skip(w),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((E=(function(O){for(var F in p)if(Object.prototype.hasOwnProperty.call(p,F)&&p[F].magic===O)return p[F];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,E,x.readData(this.compressedSize))},readCentralPart:function(x){this.versionMadeBy=x.readInt(2),x.skip(2),this.bitFlag=x.readInt(2),this.compressionMethod=x.readString(2),this.date=x.readDate(),this.crc32=x.readInt(4),this.compressedSize=x.readInt(4),this.uncompressedSize=x.readInt(4);var E=x.readInt(2);if(this.extraFieldsLength=x.readInt(2),this.fileCommentLength=x.readInt(2),this.diskNumberStart=x.readInt(2),this.internalFileAttributes=x.readInt(2),this.externalFileAttributes=x.readInt(4),this.localHeaderOffset=x.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");x.skip(E),this.readExtraFields(x),this.parseZIP64ExtraField(x),this.fileComment=x.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var x=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),x==0&&(this.dosPermissions=63&this.externalFileAttributes),x==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var x=i(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=x.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=x.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=x.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=x.readInt(4))}},readExtraFields:function(x){var E,w,O,F=x.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});x.index+4<F;)E=x.readInt(2),w=x.readInt(2),O=x.readData(w),this.extraFields[E]={id:E,length:w,value:O};x.setIndex(F)},handleUTF8:function(){var x=v.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=m.utf8decode(this.fileName),this.fileCommentStr=m.utf8decode(this.fileComment);else{var E=this.findExtraFieldUnicodePath();if(E!==null)this.fileNameStr=E;else{var w=n.transformTo(x,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(w)}var O=this.findExtraFieldUnicodeComment();if(O!==null)this.fileCommentStr=O;else{var F=n.transformTo(x,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(F)}}},findExtraFieldUnicodePath:function(){var x=this.extraFields[28789];if(x){var E=i(x.value);return E.readInt(1)!==1||s(this.fileName)!==E.readInt(4)?null:m.utf8decode(E.readData(x.length-5))}return null},findExtraFieldUnicodeComment:function(){var x=this.extraFields[25461];if(x){var E=i(x.value);return E.readInt(1)!==1||s(this.fileComment)!==E.readInt(4)?null:m.utf8decode(E.readData(x.length-5))}return null}},t.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(o,t,e){"use strict";function i(E,w,O){this.name=E,this.dir=O.dir,this.date=O.date,this.comment=O.comment,this.unixPermissions=O.unixPermissions,this.dosPermissions=O.dosPermissions,this._data=w,this._dataBinary=O.binary,this.options={compression:O.compression,compressionOptions:O.compressionOptions}}var n=o("./stream/StreamHelper"),r=o("./stream/DataWorker"),s=o("./utf8"),m=o("./compressedObject"),p=o("./stream/GenericWorker");i.prototype={internalStream:function(E){var w=null,O="string";try{if(!E)throw new Error("No output type specified.");var F=(O=E.toLowerCase())==="string"||O==="text";O!=="binarystring"&&O!=="text"||(O="string"),w=this._decompressWorker();var V=!this._dataBinary;V&&!F&&(w=w.pipe(new s.Utf8EncodeWorker)),!V&&F&&(w=w.pipe(new s.Utf8DecodeWorker))}catch(L){(w=new p("error")).error(L)}return new n(w,O,"")},async:function(E,w){return this.internalStream(E).accumulate(w)},nodeStream:function(E,w){return this.internalStream(E||"nodebuffer").toNodejsStream(w)},_compressWorker:function(E,w){if(this._data instanceof m&&this._data.compression.magic===E.magic)return this._data.getCompressedWorker();var O=this._decompressWorker();return this._dataBinary||(O=O.pipe(new s.Utf8EncodeWorker)),m.createWorkerFrom(O,E,w)},_decompressWorker:function(){return this._data instanceof m?this._data.getContentWorker():this._data instanceof p?this._data:new r(this._data)}};for(var v=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},x=0;x<v.length;x++)i.prototype[v[x]]=y;t.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(o,t,e){(function(i){"use strict";var n,r,s=i.MutationObserver||i.WebKitMutationObserver;if(s){var m=0,p=new s(E),v=i.document.createTextNode("");p.observe(v,{characterData:!0}),n=function(){v.data=m=++m%2}}else if(i.setImmediate||i.MessageChannel===void 0)n="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var w=i.document.createElement("script");w.onreadystatechange=function(){E(),w.onreadystatechange=null,w.parentNode.removeChild(w),w=null},i.document.documentElement.appendChild(w)}:function(){setTimeout(E,0)};else{var y=new i.MessageChannel;y.port1.onmessage=E,n=function(){y.port2.postMessage(0)}}var x=[];function E(){var w,O;r=!0;for(var F=x.length;F;){for(O=x,x=[],w=-1;++w<F;)O[w]();F=x.length}r=!1}t.exports=function(w){x.push(w)!==1||r||n()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(o,t,e){"use strict";var i=o("immediate");function n(){}var r={},s=["REJECTED"],m=["FULFILLED"],p=["PENDING"];function v(F){if(typeof F!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,F!==n&&w(this,F)}function y(F,V,L){this.promise=F,typeof V=="function"&&(this.onFulfilled=V,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}function x(F,V,L){i(function(){var B;try{B=V(L)}catch(z){return r.reject(F,z)}B===F?r.reject(F,new TypeError("Cannot resolve promise with itself")):r.resolve(F,B)})}function E(F){var V=F&&F.then;if(F&&(typeof F=="object"||typeof F=="function")&&typeof V=="function")return function(){V.apply(F,arguments)}}function w(F,V){var L=!1;function B(K){L||(L=!0,r.reject(F,K))}function z(K){L||(L=!0,r.resolve(F,K))}var Q=O(function(){V(z,B)});Q.status==="error"&&B(Q.value)}function O(F,V){var L={};try{L.value=F(V),L.status="success"}catch(B){L.status="error",L.value=B}return L}(t.exports=v).prototype.finally=function(F){if(typeof F!="function")return this;var V=this.constructor;return this.then(function(L){return V.resolve(F()).then(function(){return L})},function(L){return V.resolve(F()).then(function(){throw L})})},v.prototype.catch=function(F){return this.then(null,F)},v.prototype.then=function(F,V){if(typeof F!="function"&&this.state===m||typeof V!="function"&&this.state===s)return this;var L=new this.constructor(n);return this.state!==p?x(L,this.state===m?F:V,this.outcome):this.queue.push(new y(L,F,V)),L},y.prototype.callFulfilled=function(F){r.resolve(this.promise,F)},y.prototype.otherCallFulfilled=function(F){x(this.promise,this.onFulfilled,F)},y.prototype.callRejected=function(F){r.reject(this.promise,F)},y.prototype.otherCallRejected=function(F){x(this.promise,this.onRejected,F)},r.resolve=function(F,V){var L=O(E,V);if(L.status==="error")return r.reject(F,L.value);var B=L.value;if(B)w(F,B);else{F.state=m,F.outcome=V;for(var z=-1,Q=F.queue.length;++z<Q;)F.queue[z].callFulfilled(V)}return F},r.reject=function(F,V){F.state=s,F.outcome=V;for(var L=-1,B=F.queue.length;++L<B;)F.queue[L].callRejected(V);return F},v.resolve=function(F){return F instanceof this?F:r.resolve(new this(n),F)},v.reject=function(F){var V=new this(n);return r.reject(V,F)},v.all=function(F){var V=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=F.length,B=!1;if(!L)return this.resolve([]);for(var z=new Array(L),Q=0,K=-1,fe=new this(n);++K<L;)ae(F[K],K);return fe;function ae(ye,qe){V.resolve(ye).then(function(U){z[qe]=U,++Q!==L||B||(B=!0,r.resolve(fe,z))},function(U){B||(B=!0,r.reject(fe,U))})}},v.race=function(F){var V=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=F.length,B=!1;if(!L)return this.resolve([]);for(var z=-1,Q=new this(n);++z<L;)K=F[z],V.resolve(K).then(function(fe){B||(B=!0,r.resolve(Q,fe))},function(fe){B||(B=!0,r.reject(Q,fe))});var K;return Q}},{immediate:36}],38:[function(o,t,e){"use strict";var i={};(0,o("./lib/utils/common").assign)(i,o("./lib/deflate"),o("./lib/inflate"),o("./lib/zlib/constants")),t.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(o,t,e){"use strict";var i=o("./zlib/deflate"),n=o("./utils/common"),r=o("./utils/strings"),s=o("./zlib/messages"),m=o("./zlib/zstream"),p=Object.prototype.toString,v=0,y=-1,x=0,E=8;function w(F){if(!(this instanceof w))return new w(F);this.options=n.assign({level:y,method:E,chunkSize:16384,windowBits:15,memLevel:8,strategy:x,to:""},F||{});var V=this.options;V.raw&&0<V.windowBits?V.windowBits=-V.windowBits:V.gzip&&0<V.windowBits&&V.windowBits<16&&(V.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var L=i.deflateInit2(this.strm,V.level,V.method,V.windowBits,V.memLevel,V.strategy);if(L!==v)throw new Error(s[L]);if(V.header&&i.deflateSetHeader(this.strm,V.header),V.dictionary){var B;if(B=typeof V.dictionary=="string"?r.string2buf(V.dictionary):p.call(V.dictionary)==="[object ArrayBuffer]"?new Uint8Array(V.dictionary):V.dictionary,(L=i.deflateSetDictionary(this.strm,B))!==v)throw new Error(s[L]);this._dict_set=!0}}function O(F,V){var L=new w(V);if(L.push(F,!0),L.err)throw L.msg||s[L.err];return L.result}w.prototype.push=function(F,V){var L,B,z=this.strm,Q=this.options.chunkSize;if(this.ended)return!1;B=V===~~V?V:V===!0?4:0,typeof F=="string"?z.input=r.string2buf(F):p.call(F)==="[object ArrayBuffer]"?z.input=new Uint8Array(F):z.input=F,z.next_in=0,z.avail_in=z.input.length;do{if(z.avail_out===0&&(z.output=new n.Buf8(Q),z.next_out=0,z.avail_out=Q),(L=i.deflate(z,B))!==1&&L!==v)return this.onEnd(L),!(this.ended=!0);z.avail_out!==0&&(z.avail_in!==0||B!==4&&B!==2)||(this.options.to==="string"?this.onData(r.buf2binstring(n.shrinkBuf(z.output,z.next_out))):this.onData(n.shrinkBuf(z.output,z.next_out)))}while((0<z.avail_in||z.avail_out===0)&&L!==1);return B===4?(L=i.deflateEnd(this.strm),this.onEnd(L),this.ended=!0,L===v):B!==2||(this.onEnd(v),!(z.avail_out=0))},w.prototype.onData=function(F){this.chunks.push(F)},w.prototype.onEnd=function(F){F===v&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=F,this.msg=this.strm.msg},e.Deflate=w,e.deflate=O,e.deflateRaw=function(F,V){return(V=V||{}).raw=!0,O(F,V)},e.gzip=function(F,V){return(V=V||{}).gzip=!0,O(F,V)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(o,t,e){"use strict";var i=o("./zlib/inflate"),n=o("./utils/common"),r=o("./utils/strings"),s=o("./zlib/constants"),m=o("./zlib/messages"),p=o("./zlib/zstream"),v=o("./zlib/gzheader"),y=Object.prototype.toString;function x(w){if(!(this instanceof x))return new x(w);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},w||{});var O=this.options;O.raw&&0<=O.windowBits&&O.windowBits<16&&(O.windowBits=-O.windowBits,O.windowBits===0&&(O.windowBits=-15)),!(0<=O.windowBits&&O.windowBits<16)||w&&w.windowBits||(O.windowBits+=32),15<O.windowBits&&O.windowBits<48&&(15&O.windowBits)==0&&(O.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var F=i.inflateInit2(this.strm,O.windowBits);if(F!==s.Z_OK)throw new Error(m[F]);this.header=new v,i.inflateGetHeader(this.strm,this.header)}function E(w,O){var F=new x(O);if(F.push(w,!0),F.err)throw F.msg||m[F.err];return F.result}x.prototype.push=function(w,O){var F,V,L,B,z,Q,K=this.strm,fe=this.options.chunkSize,ae=this.options.dictionary,ye=!1;if(this.ended)return!1;V=O===~~O?O:O===!0?s.Z_FINISH:s.Z_NO_FLUSH,typeof w=="string"?K.input=r.binstring2buf(w):y.call(w)==="[object ArrayBuffer]"?K.input=new Uint8Array(w):K.input=w,K.next_in=0,K.avail_in=K.input.length;do{if(K.avail_out===0&&(K.output=new n.Buf8(fe),K.next_out=0,K.avail_out=fe),(F=i.inflate(K,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&ae&&(Q=typeof ae=="string"?r.string2buf(ae):y.call(ae)==="[object ArrayBuffer]"?new Uint8Array(ae):ae,F=i.inflateSetDictionary(this.strm,Q)),F===s.Z_BUF_ERROR&&ye===!0&&(F=s.Z_OK,ye=!1),F!==s.Z_STREAM_END&&F!==s.Z_OK)return this.onEnd(F),!(this.ended=!0);K.next_out&&(K.avail_out!==0&&F!==s.Z_STREAM_END&&(K.avail_in!==0||V!==s.Z_FINISH&&V!==s.Z_SYNC_FLUSH)||(this.options.to==="string"?(L=r.utf8border(K.output,K.next_out),B=K.next_out-L,z=r.buf2string(K.output,L),K.next_out=B,K.avail_out=fe-B,B&&n.arraySet(K.output,K.output,L,B,0),this.onData(z)):this.onData(n.shrinkBuf(K.output,K.next_out)))),K.avail_in===0&&K.avail_out===0&&(ye=!0)}while((0<K.avail_in||K.avail_out===0)&&F!==s.Z_STREAM_END);return F===s.Z_STREAM_END&&(V=s.Z_FINISH),V===s.Z_FINISH?(F=i.inflateEnd(this.strm),this.onEnd(F),this.ended=!0,F===s.Z_OK):V!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),!(K.avail_out=0))},x.prototype.onData=function(w){this.chunks.push(w)},x.prototype.onEnd=function(w){w===s.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},e.Inflate=x,e.inflate=E,e.inflateRaw=function(w,O){return(O=O||{}).raw=!0,E(w,O)},e.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(o,t,e){"use strict";var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";e.assign=function(s){for(var m=Array.prototype.slice.call(arguments,1);m.length;){var p=m.shift();if(p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var v in p)p.hasOwnProperty(v)&&(s[v]=p[v])}}return s},e.shrinkBuf=function(s,m){return s.length===m?s:s.subarray?s.subarray(0,m):(s.length=m,s)};var n={arraySet:function(s,m,p,v,y){if(m.subarray&&s.subarray)s.set(m.subarray(p,p+v),y);else for(var x=0;x<v;x++)s[y+x]=m[p+x]},flattenChunks:function(s){var m,p,v,y,x,E;for(m=v=0,p=s.length;m<p;m++)v+=s[m].length;for(E=new Uint8Array(v),m=y=0,p=s.length;m<p;m++)x=s[m],E.set(x,y),y+=x.length;return E}},r={arraySet:function(s,m,p,v,y){for(var x=0;x<v;x++)s[y+x]=m[p+x]},flattenChunks:function(s){return[].concat.apply([],s)}};e.setTyped=function(s){s?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,n)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,r))},e.setTyped(i)},{}],42:[function(o,t,e){"use strict";var i=o("./common"),n=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{r=!1}for(var s=new i.Buf8(256),m=0;m<256;m++)s[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;function p(v,y){if(y<65537&&(v.subarray&&r||!v.subarray&&n))return String.fromCharCode.apply(null,i.shrinkBuf(v,y));for(var x="",E=0;E<y;E++)x+=String.fromCharCode(v[E]);return x}s[254]=s[254]=1,e.string2buf=function(v){var y,x,E,w,O,F=v.length,V=0;for(w=0;w<F;w++)(64512&(x=v.charCodeAt(w)))==55296&&w+1<F&&(64512&(E=v.charCodeAt(w+1)))==56320&&(x=65536+(x-55296<<10)+(E-56320),w++),V+=x<128?1:x<2048?2:x<65536?3:4;for(y=new i.Buf8(V),w=O=0;O<V;w++)(64512&(x=v.charCodeAt(w)))==55296&&w+1<F&&(64512&(E=v.charCodeAt(w+1)))==56320&&(x=65536+(x-55296<<10)+(E-56320),w++),x<128?y[O++]=x:(x<2048?y[O++]=192|x>>>6:(x<65536?y[O++]=224|x>>>12:(y[O++]=240|x>>>18,y[O++]=128|x>>>12&63),y[O++]=128|x>>>6&63),y[O++]=128|63&x);return y},e.buf2binstring=function(v){return p(v,v.length)},e.binstring2buf=function(v){for(var y=new i.Buf8(v.length),x=0,E=y.length;x<E;x++)y[x]=v.charCodeAt(x);return y},e.buf2string=function(v,y){var x,E,w,O,F=y||v.length,V=new Array(2*F);for(x=E=0;x<F;)if((w=v[x++])<128)V[E++]=w;else if(4<(O=s[w]))V[E++]=65533,x+=O-1;else{for(w&=O===2?31:O===3?15:7;1<O&&x<F;)w=w<<6|63&v[x++],O--;1<O?V[E++]=65533:w<65536?V[E++]=w:(w-=65536,V[E++]=55296|w>>10&1023,V[E++]=56320|1023&w)}return p(V,E)},e.utf8border=function(v,y){var x;for((y=y||v.length)>v.length&&(y=v.length),x=y-1;0<=x&&(192&v[x])==128;)x--;return x<0||x===0?y:x+s[v[x]]>y?x:y}},{"./common":41}],43:[function(o,t,e){"use strict";t.exports=function(i,n,r,s){for(var m=65535&i|0,p=i>>>16&65535|0,v=0;r!==0;){for(r-=v=2e3<r?2e3:r;p=p+(m=m+n[s++]|0)|0,--v;);m%=65521,p%=65521}return m|p<<16|0}},{}],44:[function(o,t,e){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(o,t,e){"use strict";var i=(function(){for(var n,r=[],s=0;s<256;s++){n=s;for(var m=0;m<8;m++)n=1&n?3988292384^n>>>1:n>>>1;r[s]=n}return r})();t.exports=function(n,r,s,m){var p=i,v=m+s;n^=-1;for(var y=m;y<v;y++)n=n>>>8^p[255&(n^r[y])];return-1^n}},{}],46:[function(o,t,e){"use strict";var i,n=o("../utils/common"),r=o("./trees"),s=o("./adler32"),m=o("./crc32"),p=o("./messages"),v=0,y=4,x=0,E=-2,w=-1,O=4,F=2,V=8,L=9,B=286,z=30,Q=19,K=2*B+1,fe=15,ae=3,ye=258,qe=ye+ae+1,U=42,me=113,I=1,ge=2,Ve=3,_e=4;function pt(S,ue){return S.msg=p[ue],ue}function Pe(S){return(S<<1)-(4<S?9:0)}function rt(S){for(var ue=S.length;0<=--ue;)S[ue]=0}function oe(S){var ue=S.state,se=ue.pending;se>S.avail_out&&(se=S.avail_out),se!==0&&(n.arraySet(S.output,ue.pending_buf,ue.pending_out,se,S.next_out),S.next_out+=se,ue.pending_out+=se,S.total_out+=se,S.avail_out-=se,ue.pending-=se,ue.pending===0&&(ue.pending_out=0))}function X(S,ue){r._tr_flush_block(S,0<=S.block_start?S.block_start:-1,S.strstart-S.block_start,ue),S.block_start=S.strstart,oe(S.strm)}function et(S,ue){S.pending_buf[S.pending++]=ue}function Ae(S,ue){S.pending_buf[S.pending++]=ue>>>8&255,S.pending_buf[S.pending++]=255&ue}function ke(S,ue){var se,R,j=S.max_chain_length,$=S.strstart,Ce=S.prev_length,ve=S.nice_match,G=S.strstart>S.w_size-qe?S.strstart-(S.w_size-qe):0,Me=S.window,je=S.w_mask,De=S.prev,Ze=S.strstart+ye,Wt=Me[$+Ce-1],Pt=Me[$+Ce];S.prev_length>=S.good_match&&(j>>=2),ve>S.lookahead&&(ve=S.lookahead);do if(Me[(se=ue)+Ce]===Pt&&Me[se+Ce-1]===Wt&&Me[se]===Me[$]&&Me[++se]===Me[$+1]){$+=2,se++;do;while(Me[++$]===Me[++se]&&Me[++$]===Me[++se]&&Me[++$]===Me[++se]&&Me[++$]===Me[++se]&&Me[++$]===Me[++se]&&Me[++$]===Me[++se]&&Me[++$]===Me[++se]&&Me[++$]===Me[++se]&&$<Ze);if(R=ye-(Ze-$),$=Ze-ye,Ce<R){if(S.match_start=ue,ve<=(Ce=R))break;Wt=Me[$+Ce-1],Pt=Me[$+Ce]}}while((ue=De[ue&je])>G&&--j!=0);return Ce<=S.lookahead?Ce:S.lookahead}function ci(S){var ue,se,R,j,$,Ce,ve,G,Me,je,De=S.w_size;do{if(j=S.window_size-S.lookahead-S.strstart,S.strstart>=De+(De-qe)){for(n.arraySet(S.window,S.window,De,De,0),S.match_start-=De,S.strstart-=De,S.block_start-=De,ue=se=S.hash_size;R=S.head[--ue],S.head[ue]=De<=R?R-De:0,--se;);for(ue=se=De;R=S.prev[--ue],S.prev[ue]=De<=R?R-De:0,--se;);j+=De}if(S.strm.avail_in===0)break;if(Ce=S.strm,ve=S.window,G=S.strstart+S.lookahead,Me=j,je=void 0,je=Ce.avail_in,Me<je&&(je=Me),se=je===0?0:(Ce.avail_in-=je,n.arraySet(ve,Ce.input,Ce.next_in,je,G),Ce.state.wrap===1?Ce.adler=s(Ce.adler,ve,je,G):Ce.state.wrap===2&&(Ce.adler=m(Ce.adler,ve,je,G)),Ce.next_in+=je,Ce.total_in+=je,je),S.lookahead+=se,S.lookahead+S.insert>=ae)for($=S.strstart-S.insert,S.ins_h=S.window[$],S.ins_h=(S.ins_h<<S.hash_shift^S.window[$+1])&S.hash_mask;S.insert&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[$+ae-1])&S.hash_mask,S.prev[$&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=$,$++,S.insert--,!(S.lookahead+S.insert<ae)););}while(S.lookahead<qe&&S.strm.avail_in!==0)}function Bi(S,ue){for(var se,R;;){if(S.lookahead<qe){if(ci(S),S.lookahead<qe&&ue===v)return I;if(S.lookahead===0)break}if(se=0,S.lookahead>=ae&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+ae-1])&S.hash_mask,se=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),se!==0&&S.strstart-se<=S.w_size-qe&&(S.match_length=ke(S,se)),S.match_length>=ae)if(R=r._tr_tally(S,S.strstart-S.match_start,S.match_length-ae),S.lookahead-=S.match_length,S.match_length<=S.max_lazy_match&&S.lookahead>=ae){for(S.match_length--;S.strstart++,S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+ae-1])&S.hash_mask,se=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart,--S.match_length!=0;);S.strstart++}else S.strstart+=S.match_length,S.match_length=0,S.ins_h=S.window[S.strstart],S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+1])&S.hash_mask;else R=r._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++;if(R&&(X(S,!1),S.strm.avail_out===0))return I}return S.insert=S.strstart<ae-1?S.strstart:ae-1,ue===y?(X(S,!0),S.strm.avail_out===0?Ve:_e):S.last_lit&&(X(S,!1),S.strm.avail_out===0)?I:ge}function Et(S,ue){for(var se,R,j;;){if(S.lookahead<qe){if(ci(S),S.lookahead<qe&&ue===v)return I;if(S.lookahead===0)break}if(se=0,S.lookahead>=ae&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+ae-1])&S.hash_mask,se=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),S.prev_length=S.match_length,S.prev_match=S.match_start,S.match_length=ae-1,se!==0&&S.prev_length<S.max_lazy_match&&S.strstart-se<=S.w_size-qe&&(S.match_length=ke(S,se),S.match_length<=5&&(S.strategy===1||S.match_length===ae&&4096<S.strstart-S.match_start)&&(S.match_length=ae-1)),S.prev_length>=ae&&S.match_length<=S.prev_length){for(j=S.strstart+S.lookahead-ae,R=r._tr_tally(S,S.strstart-1-S.prev_match,S.prev_length-ae),S.lookahead-=S.prev_length-1,S.prev_length-=2;++S.strstart<=j&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+ae-1])&S.hash_mask,se=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),--S.prev_length!=0;);if(S.match_available=0,S.match_length=ae-1,S.strstart++,R&&(X(S,!1),S.strm.avail_out===0))return I}else if(S.match_available){if((R=r._tr_tally(S,0,S.window[S.strstart-1]))&&X(S,!1),S.strstart++,S.lookahead--,S.strm.avail_out===0)return I}else S.match_available=1,S.strstart++,S.lookahead--}return S.match_available&&(R=r._tr_tally(S,0,S.window[S.strstart-1]),S.match_available=0),S.insert=S.strstart<ae-1?S.strstart:ae-1,ue===y?(X(S,!0),S.strm.avail_out===0?Ve:_e):S.last_lit&&(X(S,!1),S.strm.avail_out===0)?I:ge}function Nt(S,ue,se,R,j){this.good_length=S,this.max_lazy=ue,this.nice_length=se,this.max_chain=R,this.func=j}function Fi(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=V,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*K),this.dyn_dtree=new n.Buf16(2*(2*z+1)),this.bl_tree=new n.Buf16(2*(2*Q+1)),rt(this.dyn_ltree),rt(this.dyn_dtree),rt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(fe+1),this.heap=new n.Buf16(2*B+1),rt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*B+1),rt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function di(S){var ue;return S&&S.state?(S.total_in=S.total_out=0,S.data_type=F,(ue=S.state).pending=0,ue.pending_out=0,ue.wrap<0&&(ue.wrap=-ue.wrap),ue.status=ue.wrap?U:me,S.adler=ue.wrap===2?0:1,ue.last_flush=v,r._tr_init(ue),x):pt(S,E)}function Mn(S){var ue=di(S);return ue===x&&(function(se){se.window_size=2*se.w_size,rt(se.head),se.max_lazy_match=i[se.level].max_lazy,se.good_match=i[se.level].good_length,se.nice_match=i[se.level].nice_length,se.max_chain_length=i[se.level].max_chain,se.strstart=0,se.block_start=0,se.lookahead=0,se.insert=0,se.match_length=se.prev_length=ae-1,se.match_available=0,se.ins_h=0})(S.state),ue}function yn(S,ue,se,R,j,$){if(!S)return E;var Ce=1;if(ue===w&&(ue=6),R<0?(Ce=0,R=-R):15<R&&(Ce=2,R-=16),j<1||L<j||se!==V||R<8||15<R||ue<0||9<ue||$<0||O<$)return pt(S,E);R===8&&(R=9);var ve=new Fi;return(S.state=ve).strm=S,ve.wrap=Ce,ve.gzhead=null,ve.w_bits=R,ve.w_size=1<<ve.w_bits,ve.w_mask=ve.w_size-1,ve.hash_bits=j+7,ve.hash_size=1<<ve.hash_bits,ve.hash_mask=ve.hash_size-1,ve.hash_shift=~~((ve.hash_bits+ae-1)/ae),ve.window=new n.Buf8(2*ve.w_size),ve.head=new n.Buf16(ve.hash_size),ve.prev=new n.Buf16(ve.w_size),ve.lit_bufsize=1<<j+6,ve.pending_buf_size=4*ve.lit_bufsize,ve.pending_buf=new n.Buf8(ve.pending_buf_size),ve.d_buf=1*ve.lit_bufsize,ve.l_buf=3*ve.lit_bufsize,ve.level=ue,ve.strategy=$,ve.method=se,Mn(S)}i=[new Nt(0,0,0,0,function(S,ue){var se=65535;for(se>S.pending_buf_size-5&&(se=S.pending_buf_size-5);;){if(S.lookahead<=1){if(ci(S),S.lookahead===0&&ue===v)return I;if(S.lookahead===0)break}S.strstart+=S.lookahead,S.lookahead=0;var R=S.block_start+se;if((S.strstart===0||S.strstart>=R)&&(S.lookahead=S.strstart-R,S.strstart=R,X(S,!1),S.strm.avail_out===0)||S.strstart-S.block_start>=S.w_size-qe&&(X(S,!1),S.strm.avail_out===0))return I}return S.insert=0,ue===y?(X(S,!0),S.strm.avail_out===0?Ve:_e):(S.strstart>S.block_start&&(X(S,!1),S.strm.avail_out),I)}),new Nt(4,4,8,4,Bi),new Nt(4,5,16,8,Bi),new Nt(4,6,32,32,Bi),new Nt(4,4,16,16,Et),new Nt(8,16,32,32,Et),new Nt(8,16,128,128,Et),new Nt(8,32,128,256,Et),new Nt(32,128,258,1024,Et),new Nt(32,258,258,4096,Et)],e.deflateInit=function(S,ue){return yn(S,ue,V,15,8,0)},e.deflateInit2=yn,e.deflateReset=Mn,e.deflateResetKeep=di,e.deflateSetHeader=function(S,ue){return S&&S.state?S.state.wrap!==2?E:(S.state.gzhead=ue,x):E},e.deflate=function(S,ue){var se,R,j,$;if(!S||!S.state||5<ue||ue<0)return S?pt(S,E):E;if(R=S.state,!S.output||!S.input&&S.avail_in!==0||R.status===666&&ue!==y)return pt(S,S.avail_out===0?-5:E);if(R.strm=S,se=R.last_flush,R.last_flush=ue,R.status===U)if(R.wrap===2)S.adler=0,et(R,31),et(R,139),et(R,8),R.gzhead?(et(R,(R.gzhead.text?1:0)+(R.gzhead.hcrc?2:0)+(R.gzhead.extra?4:0)+(R.gzhead.name?8:0)+(R.gzhead.comment?16:0)),et(R,255&R.gzhead.time),et(R,R.gzhead.time>>8&255),et(R,R.gzhead.time>>16&255),et(R,R.gzhead.time>>24&255),et(R,R.level===9?2:2<=R.strategy||R.level<2?4:0),et(R,255&R.gzhead.os),R.gzhead.extra&&R.gzhead.extra.length&&(et(R,255&R.gzhead.extra.length),et(R,R.gzhead.extra.length>>8&255)),R.gzhead.hcrc&&(S.adler=m(S.adler,R.pending_buf,R.pending,0)),R.gzindex=0,R.status=69):(et(R,0),et(R,0),et(R,0),et(R,0),et(R,0),et(R,R.level===9?2:2<=R.strategy||R.level<2?4:0),et(R,3),R.status=me);else{var Ce=V+(R.w_bits-8<<4)<<8;Ce|=(2<=R.strategy||R.level<2?0:R.level<6?1:R.level===6?2:3)<<6,R.strstart!==0&&(Ce|=32),Ce+=31-Ce%31,R.status=me,Ae(R,Ce),R.strstart!==0&&(Ae(R,S.adler>>>16),Ae(R,65535&S.adler)),S.adler=1}if(R.status===69)if(R.gzhead.extra){for(j=R.pending;R.gzindex<(65535&R.gzhead.extra.length)&&(R.pending!==R.pending_buf_size||(R.gzhead.hcrc&&R.pending>j&&(S.adler=m(S.adler,R.pending_buf,R.pending-j,j)),oe(S),j=R.pending,R.pending!==R.pending_buf_size));)et(R,255&R.gzhead.extra[R.gzindex]),R.gzindex++;R.gzhead.hcrc&&R.pending>j&&(S.adler=m(S.adler,R.pending_buf,R.pending-j,j)),R.gzindex===R.gzhead.extra.length&&(R.gzindex=0,R.status=73)}else R.status=73;if(R.status===73)if(R.gzhead.name){j=R.pending;do{if(R.pending===R.pending_buf_size&&(R.gzhead.hcrc&&R.pending>j&&(S.adler=m(S.adler,R.pending_buf,R.pending-j,j)),oe(S),j=R.pending,R.pending===R.pending_buf_size)){$=1;break}$=R.gzindex<R.gzhead.name.length?255&R.gzhead.name.charCodeAt(R.gzindex++):0,et(R,$)}while($!==0);R.gzhead.hcrc&&R.pending>j&&(S.adler=m(S.adler,R.pending_buf,R.pending-j,j)),$===0&&(R.gzindex=0,R.status=91)}else R.status=91;if(R.status===91)if(R.gzhead.comment){j=R.pending;do{if(R.pending===R.pending_buf_size&&(R.gzhead.hcrc&&R.pending>j&&(S.adler=m(S.adler,R.pending_buf,R.pending-j,j)),oe(S),j=R.pending,R.pending===R.pending_buf_size)){$=1;break}$=R.gzindex<R.gzhead.comment.length?255&R.gzhead.comment.charCodeAt(R.gzindex++):0,et(R,$)}while($!==0);R.gzhead.hcrc&&R.pending>j&&(S.adler=m(S.adler,R.pending_buf,R.pending-j,j)),$===0&&(R.status=103)}else R.status=103;if(R.status===103&&(R.gzhead.hcrc?(R.pending+2>R.pending_buf_size&&oe(S),R.pending+2<=R.pending_buf_size&&(et(R,255&S.adler),et(R,S.adler>>8&255),S.adler=0,R.status=me)):R.status=me),R.pending!==0){if(oe(S),S.avail_out===0)return R.last_flush=-1,x}else if(S.avail_in===0&&Pe(ue)<=Pe(se)&&ue!==y)return pt(S,-5);if(R.status===666&&S.avail_in!==0)return pt(S,-5);if(S.avail_in!==0||R.lookahead!==0||ue!==v&&R.status!==666){var ve=R.strategy===2?(function(G,Me){for(var je;;){if(G.lookahead===0&&(ci(G),G.lookahead===0)){if(Me===v)return I;break}if(G.match_length=0,je=r._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++,je&&(X(G,!1),G.strm.avail_out===0))return I}return G.insert=0,Me===y?(X(G,!0),G.strm.avail_out===0?Ve:_e):G.last_lit&&(X(G,!1),G.strm.avail_out===0)?I:ge})(R,ue):R.strategy===3?(function(G,Me){for(var je,De,Ze,Wt,Pt=G.window;;){if(G.lookahead<=ye){if(ci(G),G.lookahead<=ye&&Me===v)return I;if(G.lookahead===0)break}if(G.match_length=0,G.lookahead>=ae&&0<G.strstart&&(De=Pt[Ze=G.strstart-1])===Pt[++Ze]&&De===Pt[++Ze]&&De===Pt[++Ze]){Wt=G.strstart+ye;do;while(De===Pt[++Ze]&&De===Pt[++Ze]&&De===Pt[++Ze]&&De===Pt[++Ze]&&De===Pt[++Ze]&&De===Pt[++Ze]&&De===Pt[++Ze]&&De===Pt[++Ze]&&Ze<Wt);G.match_length=ye-(Wt-Ze),G.match_length>G.lookahead&&(G.match_length=G.lookahead)}if(G.match_length>=ae?(je=r._tr_tally(G,1,G.match_length-ae),G.lookahead-=G.match_length,G.strstart+=G.match_length,G.match_length=0):(je=r._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++),je&&(X(G,!1),G.strm.avail_out===0))return I}return G.insert=0,Me===y?(X(G,!0),G.strm.avail_out===0?Ve:_e):G.last_lit&&(X(G,!1),G.strm.avail_out===0)?I:ge})(R,ue):i[R.level].func(R,ue);if(ve!==Ve&&ve!==_e||(R.status=666),ve===I||ve===Ve)return S.avail_out===0&&(R.last_flush=-1),x;if(ve===ge&&(ue===1?r._tr_align(R):ue!==5&&(r._tr_stored_block(R,0,0,!1),ue===3&&(rt(R.head),R.lookahead===0&&(R.strstart=0,R.block_start=0,R.insert=0))),oe(S),S.avail_out===0))return R.last_flush=-1,x}return ue!==y?x:R.wrap<=0?1:(R.wrap===2?(et(R,255&S.adler),et(R,S.adler>>8&255),et(R,S.adler>>16&255),et(R,S.adler>>24&255),et(R,255&S.total_in),et(R,S.total_in>>8&255),et(R,S.total_in>>16&255),et(R,S.total_in>>24&255)):(Ae(R,S.adler>>>16),Ae(R,65535&S.adler)),oe(S),0<R.wrap&&(R.wrap=-R.wrap),R.pending!==0?x:1)},e.deflateEnd=function(S){var ue;return S&&S.state?(ue=S.state.status)!==U&&ue!==69&&ue!==73&&ue!==91&&ue!==103&&ue!==me&&ue!==666?pt(S,E):(S.state=null,ue===me?pt(S,-3):x):E},e.deflateSetDictionary=function(S,ue){var se,R,j,$,Ce,ve,G,Me,je=ue.length;if(!S||!S.state||($=(se=S.state).wrap)===2||$===1&&se.status!==U||se.lookahead)return E;for($===1&&(S.adler=s(S.adler,ue,je,0)),se.wrap=0,je>=se.w_size&&($===0&&(rt(se.head),se.strstart=0,se.block_start=0,se.insert=0),Me=new n.Buf8(se.w_size),n.arraySet(Me,ue,je-se.w_size,se.w_size,0),ue=Me,je=se.w_size),Ce=S.avail_in,ve=S.next_in,G=S.input,S.avail_in=je,S.next_in=0,S.input=ue,ci(se);se.lookahead>=ae;){for(R=se.strstart,j=se.lookahead-(ae-1);se.ins_h=(se.ins_h<<se.hash_shift^se.window[R+ae-1])&se.hash_mask,se.prev[R&se.w_mask]=se.head[se.ins_h],se.head[se.ins_h]=R,R++,--j;);se.strstart=R,se.lookahead=ae-1,ci(se)}return se.strstart+=se.lookahead,se.block_start=se.strstart,se.insert=se.lookahead,se.lookahead=0,se.match_length=se.prev_length=ae-1,se.match_available=0,S.next_in=ve,S.input=G,S.avail_in=Ce,se.wrap=$,x},e.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(o,t,e){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(o,t,e){"use strict";t.exports=function(i,n){var r,s,m,p,v,y,x,E,w,O,F,V,L,B,z,Q,K,fe,ae,ye,qe,U,me,I,ge;r=i.state,s=i.next_in,I=i.input,m=s+(i.avail_in-5),p=i.next_out,ge=i.output,v=p-(n-i.avail_out),y=p+(i.avail_out-257),x=r.dmax,E=r.wsize,w=r.whave,O=r.wnext,F=r.window,V=r.hold,L=r.bits,B=r.lencode,z=r.distcode,Q=(1<<r.lenbits)-1,K=(1<<r.distbits)-1;e:do{L<15&&(V+=I[s++]<<L,L+=8,V+=I[s++]<<L,L+=8),fe=B[V&Q];t:for(;;){if(V>>>=ae=fe>>>24,L-=ae,(ae=fe>>>16&255)===0)ge[p++]=65535&fe;else{if(!(16&ae)){if((64&ae)==0){fe=B[(65535&fe)+(V&(1<<ae)-1)];continue t}if(32&ae){r.mode=12;break e}i.msg="invalid literal/length code",r.mode=30;break e}ye=65535&fe,(ae&=15)&&(L<ae&&(V+=I[s++]<<L,L+=8),ye+=V&(1<<ae)-1,V>>>=ae,L-=ae),L<15&&(V+=I[s++]<<L,L+=8,V+=I[s++]<<L,L+=8),fe=z[V&K];i:for(;;){if(V>>>=ae=fe>>>24,L-=ae,!(16&(ae=fe>>>16&255))){if((64&ae)==0){fe=z[(65535&fe)+(V&(1<<ae)-1)];continue i}i.msg="invalid distance code",r.mode=30;break e}if(qe=65535&fe,L<(ae&=15)&&(V+=I[s++]<<L,(L+=8)<ae&&(V+=I[s++]<<L,L+=8)),x<(qe+=V&(1<<ae)-1)){i.msg="invalid distance too far back",r.mode=30;break e}if(V>>>=ae,L-=ae,(ae=p-v)<qe){if(w<(ae=qe-ae)&&r.sane){i.msg="invalid distance too far back",r.mode=30;break e}if(me=F,(U=0)===O){if(U+=E-ae,ae<ye){for(ye-=ae;ge[p++]=F[U++],--ae;);U=p-qe,me=ge}}else if(O<ae){if(U+=E+O-ae,(ae-=O)<ye){for(ye-=ae;ge[p++]=F[U++],--ae;);if(U=0,O<ye){for(ye-=ae=O;ge[p++]=F[U++],--ae;);U=p-qe,me=ge}}}else if(U+=O-ae,ae<ye){for(ye-=ae;ge[p++]=F[U++],--ae;);U=p-qe,me=ge}for(;2<ye;)ge[p++]=me[U++],ge[p++]=me[U++],ge[p++]=me[U++],ye-=3;ye&&(ge[p++]=me[U++],1<ye&&(ge[p++]=me[U++]))}else{for(U=p-qe;ge[p++]=ge[U++],ge[p++]=ge[U++],ge[p++]=ge[U++],2<(ye-=3););ye&&(ge[p++]=ge[U++],1<ye&&(ge[p++]=ge[U++]))}break}}break}}while(s<m&&p<y);s-=ye=L>>3,V&=(1<<(L-=ye<<3))-1,i.next_in=s,i.next_out=p,i.avail_in=s<m?m-s+5:5-(s-m),i.avail_out=p<y?y-p+257:257-(p-y),r.hold=V,r.bits=L}},{}],49:[function(o,t,e){"use strict";var i=o("../utils/common"),n=o("./adler32"),r=o("./crc32"),s=o("./inffast"),m=o("./inftrees"),p=1,v=2,y=0,x=-2,E=1,w=852,O=592;function F(U){return(U>>>24&255)+(U>>>8&65280)+((65280&U)<<8)+((255&U)<<24)}function V(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function L(U){var me;return U&&U.state?(me=U.state,U.total_in=U.total_out=me.total=0,U.msg="",me.wrap&&(U.adler=1&me.wrap),me.mode=E,me.last=0,me.havedict=0,me.dmax=32768,me.head=null,me.hold=0,me.bits=0,me.lencode=me.lendyn=new i.Buf32(w),me.distcode=me.distdyn=new i.Buf32(O),me.sane=1,me.back=-1,y):x}function B(U){var me;return U&&U.state?((me=U.state).wsize=0,me.whave=0,me.wnext=0,L(U)):x}function z(U,me){var I,ge;return U&&U.state?(ge=U.state,me<0?(I=0,me=-me):(I=1+(me>>4),me<48&&(me&=15)),me&&(me<8||15<me)?x:(ge.window!==null&&ge.wbits!==me&&(ge.window=null),ge.wrap=I,ge.wbits=me,B(U))):x}function Q(U,me){var I,ge;return U?(ge=new V,(U.state=ge).window=null,(I=z(U,me))!==y&&(U.state=null),I):x}var K,fe,ae=!0;function ye(U){if(ae){var me;for(K=new i.Buf32(512),fe=new i.Buf32(32),me=0;me<144;)U.lens[me++]=8;for(;me<256;)U.lens[me++]=9;for(;me<280;)U.lens[me++]=7;for(;me<288;)U.lens[me++]=8;for(m(p,U.lens,0,288,K,0,U.work,{bits:9}),me=0;me<32;)U.lens[me++]=5;m(v,U.lens,0,32,fe,0,U.work,{bits:5}),ae=!1}U.lencode=K,U.lenbits=9,U.distcode=fe,U.distbits=5}function qe(U,me,I,ge){var Ve,_e=U.state;return _e.window===null&&(_e.wsize=1<<_e.wbits,_e.wnext=0,_e.whave=0,_e.window=new i.Buf8(_e.wsize)),ge>=_e.wsize?(i.arraySet(_e.window,me,I-_e.wsize,_e.wsize,0),_e.wnext=0,_e.whave=_e.wsize):(ge<(Ve=_e.wsize-_e.wnext)&&(Ve=ge),i.arraySet(_e.window,me,I-ge,Ve,_e.wnext),(ge-=Ve)?(i.arraySet(_e.window,me,I-ge,ge,0),_e.wnext=ge,_e.whave=_e.wsize):(_e.wnext+=Ve,_e.wnext===_e.wsize&&(_e.wnext=0),_e.whave<_e.wsize&&(_e.whave+=Ve))),0}e.inflateReset=B,e.inflateReset2=z,e.inflateResetKeep=L,e.inflateInit=function(U){return Q(U,15)},e.inflateInit2=Q,e.inflate=function(U,me){var I,ge,Ve,_e,pt,Pe,rt,oe,X,et,Ae,ke,ci,Bi,Et,Nt,Fi,di,Mn,yn,S,ue,se,R,j=0,$=new i.Buf8(4),Ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!U||!U.state||!U.output||!U.input&&U.avail_in!==0)return x;(I=U.state).mode===12&&(I.mode=13),pt=U.next_out,Ve=U.output,rt=U.avail_out,_e=U.next_in,ge=U.input,Pe=U.avail_in,oe=I.hold,X=I.bits,et=Pe,Ae=rt,ue=y;e:for(;;)switch(I.mode){case E:if(I.wrap===0){I.mode=13;break}for(;X<16;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}if(2&I.wrap&&oe===35615){$[I.check=0]=255&oe,$[1]=oe>>>8&255,I.check=r(I.check,$,2,0),X=oe=0,I.mode=2;break}if(I.flags=0,I.head&&(I.head.done=!1),!(1&I.wrap)||(((255&oe)<<8)+(oe>>8))%31){U.msg="incorrect header check",I.mode=30;break}if((15&oe)!=8){U.msg="unknown compression method",I.mode=30;break}if(X-=4,S=8+(15&(oe>>>=4)),I.wbits===0)I.wbits=S;else if(S>I.wbits){U.msg="invalid window size",I.mode=30;break}I.dmax=1<<S,U.adler=I.check=1,I.mode=512&oe?10:12,X=oe=0;break;case 2:for(;X<16;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}if(I.flags=oe,(255&I.flags)!=8){U.msg="unknown compression method",I.mode=30;break}if(57344&I.flags){U.msg="unknown header flags set",I.mode=30;break}I.head&&(I.head.text=oe>>8&1),512&I.flags&&($[0]=255&oe,$[1]=oe>>>8&255,I.check=r(I.check,$,2,0)),X=oe=0,I.mode=3;case 3:for(;X<32;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}I.head&&(I.head.time=oe),512&I.flags&&($[0]=255&oe,$[1]=oe>>>8&255,$[2]=oe>>>16&255,$[3]=oe>>>24&255,I.check=r(I.check,$,4,0)),X=oe=0,I.mode=4;case 4:for(;X<16;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}I.head&&(I.head.xflags=255&oe,I.head.os=oe>>8),512&I.flags&&($[0]=255&oe,$[1]=oe>>>8&255,I.check=r(I.check,$,2,0)),X=oe=0,I.mode=5;case 5:if(1024&I.flags){for(;X<16;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}I.length=oe,I.head&&(I.head.extra_len=oe),512&I.flags&&($[0]=255&oe,$[1]=oe>>>8&255,I.check=r(I.check,$,2,0)),X=oe=0}else I.head&&(I.head.extra=null);I.mode=6;case 6:if(1024&I.flags&&(Pe<(ke=I.length)&&(ke=Pe),ke&&(I.head&&(S=I.head.extra_len-I.length,I.head.extra||(I.head.extra=new Array(I.head.extra_len)),i.arraySet(I.head.extra,ge,_e,ke,S)),512&I.flags&&(I.check=r(I.check,ge,ke,_e)),Pe-=ke,_e+=ke,I.length-=ke),I.length))break e;I.length=0,I.mode=7;case 7:if(2048&I.flags){if(Pe===0)break e;for(ke=0;S=ge[_e+ke++],I.head&&S&&I.length<65536&&(I.head.name+=String.fromCharCode(S)),S&&ke<Pe;);if(512&I.flags&&(I.check=r(I.check,ge,ke,_e)),Pe-=ke,_e+=ke,S)break e}else I.head&&(I.head.name=null);I.length=0,I.mode=8;case 8:if(4096&I.flags){if(Pe===0)break e;for(ke=0;S=ge[_e+ke++],I.head&&S&&I.length<65536&&(I.head.comment+=String.fromCharCode(S)),S&&ke<Pe;);if(512&I.flags&&(I.check=r(I.check,ge,ke,_e)),Pe-=ke,_e+=ke,S)break e}else I.head&&(I.head.comment=null);I.mode=9;case 9:if(512&I.flags){for(;X<16;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}if(oe!==(65535&I.check)){U.msg="header crc mismatch",I.mode=30;break}X=oe=0}I.head&&(I.head.hcrc=I.flags>>9&1,I.head.done=!0),U.adler=I.check=0,I.mode=12;break;case 10:for(;X<32;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}U.adler=I.check=F(oe),X=oe=0,I.mode=11;case 11:if(I.havedict===0)return U.next_out=pt,U.avail_out=rt,U.next_in=_e,U.avail_in=Pe,I.hold=oe,I.bits=X,2;U.adler=I.check=1,I.mode=12;case 12:if(me===5||me===6)break e;case 13:if(I.last){oe>>>=7&X,X-=7&X,I.mode=27;break}for(;X<3;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}switch(I.last=1&oe,X-=1,3&(oe>>>=1)){case 0:I.mode=14;break;case 1:if(ye(I),I.mode=20,me!==6)break;oe>>>=2,X-=2;break e;case 2:I.mode=17;break;case 3:U.msg="invalid block type",I.mode=30}oe>>>=2,X-=2;break;case 14:for(oe>>>=7&X,X-=7&X;X<32;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}if((65535&oe)!=(oe>>>16^65535)){U.msg="invalid stored block lengths",I.mode=30;break}if(I.length=65535&oe,X=oe=0,I.mode=15,me===6)break e;case 15:I.mode=16;case 16:if(ke=I.length){if(Pe<ke&&(ke=Pe),rt<ke&&(ke=rt),ke===0)break e;i.arraySet(Ve,ge,_e,ke,pt),Pe-=ke,_e+=ke,rt-=ke,pt+=ke,I.length-=ke;break}I.mode=12;break;case 17:for(;X<14;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}if(I.nlen=257+(31&oe),oe>>>=5,X-=5,I.ndist=1+(31&oe),oe>>>=5,X-=5,I.ncode=4+(15&oe),oe>>>=4,X-=4,286<I.nlen||30<I.ndist){U.msg="too many length or distance symbols",I.mode=30;break}I.have=0,I.mode=18;case 18:for(;I.have<I.ncode;){for(;X<3;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}I.lens[Ce[I.have++]]=7&oe,oe>>>=3,X-=3}for(;I.have<19;)I.lens[Ce[I.have++]]=0;if(I.lencode=I.lendyn,I.lenbits=7,se={bits:I.lenbits},ue=m(0,I.lens,0,19,I.lencode,0,I.work,se),I.lenbits=se.bits,ue){U.msg="invalid code lengths set",I.mode=30;break}I.have=0,I.mode=19;case 19:for(;I.have<I.nlen+I.ndist;){for(;Nt=(j=I.lencode[oe&(1<<I.lenbits)-1])>>>16&255,Fi=65535&j,!((Et=j>>>24)<=X);){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}if(Fi<16)oe>>>=Et,X-=Et,I.lens[I.have++]=Fi;else{if(Fi===16){for(R=Et+2;X<R;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}if(oe>>>=Et,X-=Et,I.have===0){U.msg="invalid bit length repeat",I.mode=30;break}S=I.lens[I.have-1],ke=3+(3&oe),oe>>>=2,X-=2}else if(Fi===17){for(R=Et+3;X<R;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}X-=Et,S=0,ke=3+(7&(oe>>>=Et)),oe>>>=3,X-=3}else{for(R=Et+7;X<R;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}X-=Et,S=0,ke=11+(127&(oe>>>=Et)),oe>>>=7,X-=7}if(I.have+ke>I.nlen+I.ndist){U.msg="invalid bit length repeat",I.mode=30;break}for(;ke--;)I.lens[I.have++]=S}}if(I.mode===30)break;if(I.lens[256]===0){U.msg="invalid code -- missing end-of-block",I.mode=30;break}if(I.lenbits=9,se={bits:I.lenbits},ue=m(p,I.lens,0,I.nlen,I.lencode,0,I.work,se),I.lenbits=se.bits,ue){U.msg="invalid literal/lengths set",I.mode=30;break}if(I.distbits=6,I.distcode=I.distdyn,se={bits:I.distbits},ue=m(v,I.lens,I.nlen,I.ndist,I.distcode,0,I.work,se),I.distbits=se.bits,ue){U.msg="invalid distances set",I.mode=30;break}if(I.mode=20,me===6)break e;case 20:I.mode=21;case 21:if(6<=Pe&&258<=rt){U.next_out=pt,U.avail_out=rt,U.next_in=_e,U.avail_in=Pe,I.hold=oe,I.bits=X,s(U,Ae),pt=U.next_out,Ve=U.output,rt=U.avail_out,_e=U.next_in,ge=U.input,Pe=U.avail_in,oe=I.hold,X=I.bits,I.mode===12&&(I.back=-1);break}for(I.back=0;Nt=(j=I.lencode[oe&(1<<I.lenbits)-1])>>>16&255,Fi=65535&j,!((Et=j>>>24)<=X);){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}if(Nt&&(240&Nt)==0){for(di=Et,Mn=Nt,yn=Fi;Nt=(j=I.lencode[yn+((oe&(1<<di+Mn)-1)>>di)])>>>16&255,Fi=65535&j,!(di+(Et=j>>>24)<=X);){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}oe>>>=di,X-=di,I.back+=di}if(oe>>>=Et,X-=Et,I.back+=Et,I.length=Fi,Nt===0){I.mode=26;break}if(32&Nt){I.back=-1,I.mode=12;break}if(64&Nt){U.msg="invalid literal/length code",I.mode=30;break}I.extra=15&Nt,I.mode=22;case 22:if(I.extra){for(R=I.extra;X<R;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}I.length+=oe&(1<<I.extra)-1,oe>>>=I.extra,X-=I.extra,I.back+=I.extra}I.was=I.length,I.mode=23;case 23:for(;Nt=(j=I.distcode[oe&(1<<I.distbits)-1])>>>16&255,Fi=65535&j,!((Et=j>>>24)<=X);){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}if((240&Nt)==0){for(di=Et,Mn=Nt,yn=Fi;Nt=(j=I.distcode[yn+((oe&(1<<di+Mn)-1)>>di)])>>>16&255,Fi=65535&j,!(di+(Et=j>>>24)<=X);){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}oe>>>=di,X-=di,I.back+=di}if(oe>>>=Et,X-=Et,I.back+=Et,64&Nt){U.msg="invalid distance code",I.mode=30;break}I.offset=Fi,I.extra=15&Nt,I.mode=24;case 24:if(I.extra){for(R=I.extra;X<R;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}I.offset+=oe&(1<<I.extra)-1,oe>>>=I.extra,X-=I.extra,I.back+=I.extra}if(I.offset>I.dmax){U.msg="invalid distance too far back",I.mode=30;break}I.mode=25;case 25:if(rt===0)break e;if(ke=Ae-rt,I.offset>ke){if((ke=I.offset-ke)>I.whave&&I.sane){U.msg="invalid distance too far back",I.mode=30;break}ci=ke>I.wnext?(ke-=I.wnext,I.wsize-ke):I.wnext-ke,ke>I.length&&(ke=I.length),Bi=I.window}else Bi=Ve,ci=pt-I.offset,ke=I.length;for(rt<ke&&(ke=rt),rt-=ke,I.length-=ke;Ve[pt++]=Bi[ci++],--ke;);I.length===0&&(I.mode=21);break;case 26:if(rt===0)break e;Ve[pt++]=I.length,rt--,I.mode=21;break;case 27:if(I.wrap){for(;X<32;){if(Pe===0)break e;Pe--,oe|=ge[_e++]<<X,X+=8}if(Ae-=rt,U.total_out+=Ae,I.total+=Ae,Ae&&(U.adler=I.check=I.flags?r(I.check,Ve,Ae,pt-Ae):n(I.check,Ve,Ae,pt-Ae)),Ae=rt,(I.flags?oe:F(oe))!==I.check){U.msg="incorrect data check",I.mode=30;break}X=oe=0}I.mode=28;case 28:if(I.wrap&&I.flags){for(;X<32;){if(Pe===0)break e;Pe--,oe+=ge[_e++]<<X,X+=8}if(oe!==(4294967295&I.total)){U.msg="incorrect length check",I.mode=30;break}X=oe=0}I.mode=29;case 29:ue=1;break e;case 30:ue=-3;break e;case 31:return-4;case 32:default:return x}return U.next_out=pt,U.avail_out=rt,U.next_in=_e,U.avail_in=Pe,I.hold=oe,I.bits=X,(I.wsize||Ae!==U.avail_out&&I.mode<30&&(I.mode<27||me!==4))&&qe(U,U.output,U.next_out,Ae-U.avail_out)?(I.mode=31,-4):(et-=U.avail_in,Ae-=U.avail_out,U.total_in+=et,U.total_out+=Ae,I.total+=Ae,I.wrap&&Ae&&(U.adler=I.check=I.flags?r(I.check,Ve,Ae,U.next_out-Ae):n(I.check,Ve,Ae,U.next_out-Ae)),U.data_type=I.bits+(I.last?64:0)+(I.mode===12?128:0)+(I.mode===20||I.mode===15?256:0),(et==0&&Ae===0||me===4)&&ue===y&&(ue=-5),ue)},e.inflateEnd=function(U){if(!U||!U.state)return x;var me=U.state;return me.window&&(me.window=null),U.state=null,y},e.inflateGetHeader=function(U,me){var I;return U&&U.state?(2&(I=U.state).wrap)==0?x:((I.head=me).done=!1,y):x},e.inflateSetDictionary=function(U,me){var I,ge=me.length;return U&&U.state?(I=U.state).wrap!==0&&I.mode!==11?x:I.mode===11&&n(1,me,ge,0)!==I.check?-3:qe(U,me,ge,ge)?(I.mode=31,-4):(I.havedict=1,y):x},e.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(o,t,e){"use strict";var i=o("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],m=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(p,v,y,x,E,w,O,F){var V,L,B,z,Q,K,fe,ae,ye,qe=F.bits,U=0,me=0,I=0,ge=0,Ve=0,_e=0,pt=0,Pe=0,rt=0,oe=0,X=null,et=0,Ae=new i.Buf16(16),ke=new i.Buf16(16),ci=null,Bi=0;for(U=0;U<=15;U++)Ae[U]=0;for(me=0;me<x;me++)Ae[v[y+me]]++;for(Ve=qe,ge=15;1<=ge&&Ae[ge]===0;ge--);if(ge<Ve&&(Ve=ge),ge===0)return E[w++]=20971520,E[w++]=20971520,F.bits=1,0;for(I=1;I<ge&&Ae[I]===0;I++);for(Ve<I&&(Ve=I),U=Pe=1;U<=15;U++)if(Pe<<=1,(Pe-=Ae[U])<0)return-1;if(0<Pe&&(p===0||ge!==1))return-1;for(ke[1]=0,U=1;U<15;U++)ke[U+1]=ke[U]+Ae[U];for(me=0;me<x;me++)v[y+me]!==0&&(O[ke[v[y+me]]++]=me);if(K=p===0?(X=ci=O,19):p===1?(X=n,et-=257,ci=r,Bi-=257,256):(X=s,ci=m,-1),U=I,Q=w,pt=me=oe=0,B=-1,z=(rt=1<<(_e=Ve))-1,p===1&&852<rt||p===2&&592<rt)return 1;for(;;){for(fe=U-pt,ye=O[me]<K?(ae=0,O[me]):O[me]>K?(ae=ci[Bi+O[me]],X[et+O[me]]):(ae=96,0),V=1<<U-pt,I=L=1<<_e;E[Q+(oe>>pt)+(L-=V)]=fe<<24|ae<<16|ye|0,L!==0;);for(V=1<<U-1;oe&V;)V>>=1;if(V!==0?(oe&=V-1,oe+=V):oe=0,me++,--Ae[U]==0){if(U===ge)break;U=v[y+O[me]]}if(Ve<U&&(oe&z)!==B){for(pt===0&&(pt=Ve),Q+=I,Pe=1<<(_e=U-pt);_e+pt<ge&&!((Pe-=Ae[_e+pt])<=0);)_e++,Pe<<=1;if(rt+=1<<_e,p===1&&852<rt||p===2&&592<rt)return 1;E[B=oe&z]=Ve<<24|_e<<16|Q-w|0}}return oe!==0&&(E[Q+oe]=U-pt<<24|64<<16|0),F.bits=Ve,0}},{"../utils/common":41}],51:[function(o,t,e){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(o,t,e){"use strict";var i=o("../utils/common"),n=0,r=1;function s(j){for(var $=j.length;0<=--$;)j[$]=0}var m=0,p=29,v=256,y=v+1+p,x=30,E=19,w=2*y+1,O=15,F=16,V=7,L=256,B=16,z=17,Q=18,K=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],fe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ye=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],qe=new Array(2*(y+2));s(qe);var U=new Array(2*x);s(U);var me=new Array(512);s(me);var I=new Array(256);s(I);var ge=new Array(p);s(ge);var Ve,_e,pt,Pe=new Array(x);function rt(j,$,Ce,ve,G){this.static_tree=j,this.extra_bits=$,this.extra_base=Ce,this.elems=ve,this.max_length=G,this.has_stree=j&&j.length}function oe(j,$){this.dyn_tree=j,this.max_code=0,this.stat_desc=$}function X(j){return j<256?me[j]:me[256+(j>>>7)]}function et(j,$){j.pending_buf[j.pending++]=255&$,j.pending_buf[j.pending++]=$>>>8&255}function Ae(j,$,Ce){j.bi_valid>F-Ce?(j.bi_buf|=$<<j.bi_valid&65535,et(j,j.bi_buf),j.bi_buf=$>>F-j.bi_valid,j.bi_valid+=Ce-F):(j.bi_buf|=$<<j.bi_valid&65535,j.bi_valid+=Ce)}function ke(j,$,Ce){Ae(j,Ce[2*$],Ce[2*$+1])}function ci(j,$){for(var Ce=0;Ce|=1&j,j>>>=1,Ce<<=1,0<--$;);return Ce>>>1}function Bi(j,$,Ce){var ve,G,Me=new Array(O+1),je=0;for(ve=1;ve<=O;ve++)Me[ve]=je=je+Ce[ve-1]<<1;for(G=0;G<=$;G++){var De=j[2*G+1];De!==0&&(j[2*G]=ci(Me[De]++,De))}}function Et(j){var $;for($=0;$<y;$++)j.dyn_ltree[2*$]=0;for($=0;$<x;$++)j.dyn_dtree[2*$]=0;for($=0;$<E;$++)j.bl_tree[2*$]=0;j.dyn_ltree[2*L]=1,j.opt_len=j.static_len=0,j.last_lit=j.matches=0}function Nt(j){8<j.bi_valid?et(j,j.bi_buf):0<j.bi_valid&&(j.pending_buf[j.pending++]=j.bi_buf),j.bi_buf=0,j.bi_valid=0}function Fi(j,$,Ce,ve){var G=2*$,Me=2*Ce;return j[G]<j[Me]||j[G]===j[Me]&&ve[$]<=ve[Ce]}function di(j,$,Ce){for(var ve=j.heap[Ce],G=Ce<<1;G<=j.heap_len&&(G<j.heap_len&&Fi($,j.heap[G+1],j.heap[G],j.depth)&&G++,!Fi($,ve,j.heap[G],j.depth));)j.heap[Ce]=j.heap[G],Ce=G,G<<=1;j.heap[Ce]=ve}function Mn(j,$,Ce){var ve,G,Me,je,De=0;if(j.last_lit!==0)for(;ve=j.pending_buf[j.d_buf+2*De]<<8|j.pending_buf[j.d_buf+2*De+1],G=j.pending_buf[j.l_buf+De],De++,ve===0?ke(j,G,$):(ke(j,(Me=I[G])+v+1,$),(je=K[Me])!==0&&Ae(j,G-=ge[Me],je),ke(j,Me=X(--ve),Ce),(je=fe[Me])!==0&&Ae(j,ve-=Pe[Me],je)),De<j.last_lit;);ke(j,L,$)}function yn(j,$){var Ce,ve,G,Me=$.dyn_tree,je=$.stat_desc.static_tree,De=$.stat_desc.has_stree,Ze=$.stat_desc.elems,Wt=-1;for(j.heap_len=0,j.heap_max=w,Ce=0;Ce<Ze;Ce++)Me[2*Ce]!==0?(j.heap[++j.heap_len]=Wt=Ce,j.depth[Ce]=0):Me[2*Ce+1]=0;for(;j.heap_len<2;)Me[2*(G=j.heap[++j.heap_len]=Wt<2?++Wt:0)]=1,j.depth[G]=0,j.opt_len--,De&&(j.static_len-=je[2*G+1]);for($.max_code=Wt,Ce=j.heap_len>>1;1<=Ce;Ce--)di(j,Me,Ce);for(G=Ze;Ce=j.heap[1],j.heap[1]=j.heap[j.heap_len--],di(j,Me,1),ve=j.heap[1],j.heap[--j.heap_max]=Ce,j.heap[--j.heap_max]=ve,Me[2*G]=Me[2*Ce]+Me[2*ve],j.depth[G]=(j.depth[Ce]>=j.depth[ve]?j.depth[Ce]:j.depth[ve])+1,Me[2*Ce+1]=Me[2*ve+1]=G,j.heap[1]=G++,di(j,Me,1),2<=j.heap_len;);j.heap[--j.heap_max]=j.heap[1],(function(Pt,rn){var na,In,oa,mi,Xa,Dd,Gn=rn.dyn_tree,Km=rn.max_code,A0=rn.stat_desc.static_tree,j0=rn.stat_desc.has_stree,R0=rn.stat_desc.extra_bits,Ym=rn.stat_desc.extra_base,ra=rn.stat_desc.max_length,Za=0;for(mi=0;mi<=O;mi++)Pt.bl_count[mi]=0;for(Gn[2*Pt.heap[Pt.heap_max]+1]=0,na=Pt.heap_max+1;na<w;na++)ra<(mi=Gn[2*Gn[2*(In=Pt.heap[na])+1]+1]+1)&&(mi=ra,Za++),Gn[2*In+1]=mi,Km<In||(Pt.bl_count[mi]++,Xa=0,Ym<=In&&(Xa=R0[In-Ym]),Dd=Gn[2*In],Pt.opt_len+=Dd*(mi+Xa),j0&&(Pt.static_len+=Dd*(A0[2*In+1]+Xa)));if(Za!==0){do{for(mi=ra-1;Pt.bl_count[mi]===0;)mi--;Pt.bl_count[mi]--,Pt.bl_count[mi+1]+=2,Pt.bl_count[ra]--,Za-=2}while(0<Za);for(mi=ra;mi!==0;mi--)for(In=Pt.bl_count[mi];In!==0;)Km<(oa=Pt.heap[--na])||(Gn[2*oa+1]!==mi&&(Pt.opt_len+=(mi-Gn[2*oa+1])*Gn[2*oa],Gn[2*oa+1]=mi),In--)}})(j,$),Bi(Me,Wt,j.bl_count)}function S(j,$,Ce){var ve,G,Me=-1,je=$[1],De=0,Ze=7,Wt=4;for(je===0&&(Ze=138,Wt=3),$[2*(Ce+1)+1]=65535,ve=0;ve<=Ce;ve++)G=je,je=$[2*(ve+1)+1],++De<Ze&&G===je||(De<Wt?j.bl_tree[2*G]+=De:G!==0?(G!==Me&&j.bl_tree[2*G]++,j.bl_tree[2*B]++):De<=10?j.bl_tree[2*z]++:j.bl_tree[2*Q]++,Me=G,Wt=(De=0)===je?(Ze=138,3):G===je?(Ze=6,3):(Ze=7,4))}function ue(j,$,Ce){var ve,G,Me=-1,je=$[1],De=0,Ze=7,Wt=4;for(je===0&&(Ze=138,Wt=3),ve=0;ve<=Ce;ve++)if(G=je,je=$[2*(ve+1)+1],!(++De<Ze&&G===je)){if(De<Wt)for(;ke(j,G,j.bl_tree),--De!=0;);else G!==0?(G!==Me&&(ke(j,G,j.bl_tree),De--),ke(j,B,j.bl_tree),Ae(j,De-3,2)):De<=10?(ke(j,z,j.bl_tree),Ae(j,De-3,3)):(ke(j,Q,j.bl_tree),Ae(j,De-11,7));Me=G,Wt=(De=0)===je?(Ze=138,3):G===je?(Ze=6,3):(Ze=7,4)}}s(Pe);var se=!1;function R(j,$,Ce,ve){Ae(j,(m<<1)+(ve?1:0),3),(function(G,Me,je,De){Nt(G),De&&(et(G,je),et(G,~je)),i.arraySet(G.pending_buf,G.window,Me,je,G.pending),G.pending+=je})(j,$,Ce,!0)}e._tr_init=function(j){se||((function(){var $,Ce,ve,G,Me,je=new Array(O+1);for(G=ve=0;G<p-1;G++)for(ge[G]=ve,$=0;$<1<<K[G];$++)I[ve++]=G;for(I[ve-1]=G,G=Me=0;G<16;G++)for(Pe[G]=Me,$=0;$<1<<fe[G];$++)me[Me++]=G;for(Me>>=7;G<x;G++)for(Pe[G]=Me<<7,$=0;$<1<<fe[G]-7;$++)me[256+Me++]=G;for(Ce=0;Ce<=O;Ce++)je[Ce]=0;for($=0;$<=143;)qe[2*$+1]=8,$++,je[8]++;for(;$<=255;)qe[2*$+1]=9,$++,je[9]++;for(;$<=279;)qe[2*$+1]=7,$++,je[7]++;for(;$<=287;)qe[2*$+1]=8,$++,je[8]++;for(Bi(qe,y+1,je),$=0;$<x;$++)U[2*$+1]=5,U[2*$]=ci($,5);Ve=new rt(qe,K,v+1,y,O),_e=new rt(U,fe,0,x,O),pt=new rt(new Array(0),ae,0,E,V)})(),se=!0),j.l_desc=new oe(j.dyn_ltree,Ve),j.d_desc=new oe(j.dyn_dtree,_e),j.bl_desc=new oe(j.bl_tree,pt),j.bi_buf=0,j.bi_valid=0,Et(j)},e._tr_stored_block=R,e._tr_flush_block=function(j,$,Ce,ve){var G,Me,je=0;0<j.level?(j.strm.data_type===2&&(j.strm.data_type=(function(De){var Ze,Wt=4093624447;for(Ze=0;Ze<=31;Ze++,Wt>>>=1)if(1&Wt&&De.dyn_ltree[2*Ze]!==0)return n;if(De.dyn_ltree[18]!==0||De.dyn_ltree[20]!==0||De.dyn_ltree[26]!==0)return r;for(Ze=32;Ze<v;Ze++)if(De.dyn_ltree[2*Ze]!==0)return r;return n})(j)),yn(j,j.l_desc),yn(j,j.d_desc),je=(function(De){var Ze;for(S(De,De.dyn_ltree,De.l_desc.max_code),S(De,De.dyn_dtree,De.d_desc.max_code),yn(De,De.bl_desc),Ze=E-1;3<=Ze&&De.bl_tree[2*ye[Ze]+1]===0;Ze--);return De.opt_len+=3*(Ze+1)+5+5+4,Ze})(j),G=j.opt_len+3+7>>>3,(Me=j.static_len+3+7>>>3)<=G&&(G=Me)):G=Me=Ce+5,Ce+4<=G&&$!==-1?R(j,$,Ce,ve):j.strategy===4||Me===G?(Ae(j,2+(ve?1:0),3),Mn(j,qe,U)):(Ae(j,4+(ve?1:0),3),(function(De,Ze,Wt,Pt){var rn;for(Ae(De,Ze-257,5),Ae(De,Wt-1,5),Ae(De,Pt-4,4),rn=0;rn<Pt;rn++)Ae(De,De.bl_tree[2*ye[rn]+1],3);ue(De,De.dyn_ltree,Ze-1),ue(De,De.dyn_dtree,Wt-1)})(j,j.l_desc.max_code+1,j.d_desc.max_code+1,je+1),Mn(j,j.dyn_ltree,j.dyn_dtree)),Et(j),ve&&Nt(j)},e._tr_tally=function(j,$,Ce){return j.pending_buf[j.d_buf+2*j.last_lit]=$>>>8&255,j.pending_buf[j.d_buf+2*j.last_lit+1]=255&$,j.pending_buf[j.l_buf+j.last_lit]=255&Ce,j.last_lit++,$===0?j.dyn_ltree[2*Ce]++:(j.matches++,$--,j.dyn_ltree[2*(I[Ce]+v+1)]++,j.dyn_dtree[2*X($)]++),j.last_lit===j.lit_bufsize-1},e._tr_align=function(j){Ae(j,2,3),ke(j,L,qe),(function($){$.bi_valid===16?(et($,$.bi_buf),$.bi_buf=0,$.bi_valid=0):8<=$.bi_valid&&($.pending_buf[$.pending++]=255&$.bi_buf,$.bi_buf>>=8,$.bi_valid-=8)})(j)}},{"../utils/common":41}],53:[function(o,t,e){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(o,t,e){(function(i){(function(n,r){"use strict";if(!n.setImmediate){var s,m,p,v,y=1,x={},E=!1,w=n.document,O=Object.getPrototypeOf&&Object.getPrototypeOf(n);O=O&&O.setTimeout?O:n,s={}.toString.call(n.process)==="[object process]"?function(B){process.nextTick(function(){V(B)})}:(function(){if(n.postMessage&&!n.importScripts){var B=!0,z=n.onmessage;return n.onmessage=function(){B=!1},n.postMessage("","*"),n.onmessage=z,B}})()?(v="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",L,!1):n.attachEvent("onmessage",L),function(B){n.postMessage(v+B,"*")}):n.MessageChannel?((p=new MessageChannel).port1.onmessage=function(B){V(B.data)},function(B){p.port2.postMessage(B)}):w&&"onreadystatechange"in w.createElement("script")?(m=w.documentElement,function(B){var z=w.createElement("script");z.onreadystatechange=function(){V(B),z.onreadystatechange=null,m.removeChild(z),z=null},m.appendChild(z)}):function(B){setTimeout(V,0,B)},O.setImmediate=function(B){typeof B!="function"&&(B=new Function(""+B));for(var z=new Array(arguments.length-1),Q=0;Q<z.length;Q++)z[Q]=arguments[Q+1];var K={callback:B,args:z};return x[y]=K,s(y),y++},O.clearImmediate=F}function F(B){delete x[B]}function V(B){if(E)setTimeout(V,0,B);else{var z=x[B];if(z){E=!0;try{(function(Q){var K=Q.callback,fe=Q.args;switch(fe.length){case 0:K();break;case 1:K(fe[0]);break;case 2:K(fe[0],fe[1]);break;case 3:K(fe[0],fe[1],fe[2]);break;default:K.apply(r,fe)}})(z)}finally{F(B),E=!1}}}}function L(B){B.source===n&&typeof B.data=="string"&&B.data.indexOf(v)===0&&V(+B.data.slice(v.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})});var Vh=st((wQ,cm)=>{"use strict";var ht=String,Oh=function(){return{isColorSupported:!1,reset:ht,bold:ht,dim:ht,italic:ht,underline:ht,inverse:ht,hidden:ht,strikethrough:ht,black:ht,red:ht,green:ht,yellow:ht,blue:ht,magenta:ht,cyan:ht,white:ht,gray:ht,bgBlack:ht,bgRed:ht,bgGreen:ht,bgYellow:ht,bgBlue:ht,bgMagenta:ht,bgCyan:ht,bgWhite:ht,blackBright:ht,redBright:ht,greenBright:ht,yellowBright:ht,blueBright:ht,magentaBright:ht,cyanBright:ht,whiteBright:ht,bgBlackBright:ht,bgRedBright:ht,bgGreenBright:ht,bgYellowBright:ht,bgBlueBright:ht,bgMagentaBright:ht,bgCyanBright:ht,bgWhiteBright:ht}};cm.exports=Oh();cm.exports.createColors=Oh});var dm=st(()=>{"use strict"});var Cc=st((PQ,jh)=>{"use strict";var Nh=Vh(),Ah=dm(),wa=class o extends Error{constructor(t,e,i,n,r,s){super(t),this.name="CssSyntaxError",this.reason=t,r&&(this.file=r),n&&(this.source=n),s&&(this.plugin=s),typeof e<"u"&&typeof i<"u"&&(typeof e=="number"?(this.line=e,this.column=i):(this.line=e.line,this.column=e.column,this.endLine=i.line,this.endColumn=i.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,o)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",typeof this.line<"u"&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(t){if(!this.source)return"";let e=this.source;t==null&&(t=Nh.isColorSupported);let i=y=>y,n=y=>y,r=y=>y;if(t){let{bold:y,gray:x,red:E}=Nh.createColors(!0);n=w=>y(E(w)),i=w=>x(w),Ah&&(r=w=>Ah(w))}let s=e.split(/\r?\n/),m=Math.max(this.line-3,0),p=Math.min(this.line+2,s.length),v=String(p).length;return s.slice(m,p).map((y,x)=>{let E=m+1+x,w=" "+(" "+E).slice(-v)+" | ";if(E===this.line){if(y.length>160){let F=20,V=Math.max(0,this.column-F),L=Math.max(this.column+F,this.endColumn+F),B=y.slice(V,L),z=i(w.replace(/\d/g," "))+y.slice(0,Math.min(this.column-1,F-1)).replace(/[^\t]/g," ");return n(">")+i(w)+r(B)+`
 `+z+n("^")}let O=i(w.replace(/\d/g," "))+y.slice(0,this.column-1).replace(/[^\t]/g," ");return n(">")+i(w)+r(y)+`
 `+O+n("^")}return" "+i(w)+r(y)}).join(`
`)}toString(){let t=this.showSourceCode();return t&&(t=`

`+t+`
`),this.name+": "+this.message+t}};jh.exports=wa;wa.default=wa});var mm=st((MQ,Lh)=>{"use strict";var Rh={after:`
`,beforeClose:`
`,beforeComment:`
`,beforeDecl:`
`,beforeOpen:" ",beforeRule:`
`,colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};function ux(o){return o[0].toUpperCase()+o.slice(1)}var Sa=class{constructor(t){this.builder=t}atrule(t,e){let i="@"+t.name,n=t.params?this.rawValue(t,"params"):"";if(typeof t.raws.afterName<"u"?i+=t.raws.afterName:n&&(i+=" "),t.nodes)this.block(t,i+n);else{let r=(t.raws.between||"")+(e?";":"");this.builder(i+n+r,t)}}beforeAfter(t,e){let i;t.type==="decl"?i=this.raw(t,null,"beforeDecl"):t.type==="comment"?i=this.raw(t,null,"beforeComment"):e==="before"?i=this.raw(t,null,"beforeRule"):i=this.raw(t,null,"beforeClose");let n=t.parent,r=0;for(;n&&n.type!=="root";)r+=1,n=n.parent;if(i.includes(`
`)){let s=this.raw(t,null,"indent");if(s.length)for(let m=0;m<r;m++)i+=s}return i}block(t,e){let i=this.raw(t,"between","beforeOpen");this.builder(e+i+"{",t,"start");let n;t.nodes&&t.nodes.length?(this.body(t),n=this.raw(t,"after")):n=this.raw(t,"after","emptyBody"),n&&this.builder(n),this.builder("}",t,"end")}body(t){let e=t.nodes.length-1;for(;e>0&&t.nodes[e].type==="comment";)e-=1;let i=this.raw(t,"semicolon");for(let n=0;n<t.nodes.length;n++){let r=t.nodes[n],s=this.raw(r,"before");s&&this.builder(s),this.stringify(r,e!==n||i)}}comment(t){let e=this.raw(t,"left","commentLeft"),i=this.raw(t,"right","commentRight");this.builder("/*"+e+t.text+i+"*/",t)}decl(t,e){let i=this.raw(t,"between","colon"),n=t.prop+i+this.rawValue(t,"value");t.important&&(n+=t.raws.important||" !important"),e&&(n+=";"),this.builder(n,t)}document(t){this.body(t)}raw(t,e,i){let n;if(i||(i=e),e&&(n=t.raws[e],typeof n<"u"))return n;let r=t.parent;if(i==="before"&&(!r||r.type==="root"&&r.first===t||r&&r.type==="document"))return"";if(!r)return Rh[i];let s=t.root();if(s.rawCache||(s.rawCache={}),typeof s.rawCache[i]<"u")return s.rawCache[i];if(i==="before"||i==="after")return this.beforeAfter(t,i);{let m="raw"+ux(i);this[m]?n=this[m](s,t):s.walk(p=>{if(n=p.raws[e],typeof n<"u")return!1})}return typeof n>"u"&&(n=Rh[i]),s.rawCache[i]=n,n}rawBeforeClose(t){let e;return t.walk(i=>{if(i.nodes&&i.nodes.length>0&&typeof i.raws.after<"u")return e=i.raws.after,e.includes(`
`)&&(e=e.replace(/[^\n]+$/,"")),!1}),e&&(e=e.replace(/\S/g,"")),e}rawBeforeComment(t,e){let i;return t.walkComments(n=>{if(typeof n.raws.before<"u")return i=n.raws.before,i.includes(`
`)&&(i=i.replace(/[^\n]+$/,"")),!1}),typeof i>"u"?i=this.raw(e,null,"beforeDecl"):i&&(i=i.replace(/\S/g,"")),i}rawBeforeDecl(t,e){let i;return t.walkDecls(n=>{if(typeof n.raws.before<"u")return i=n.raws.before,i.includes(`
`)&&(i=i.replace(/[^\n]+$/,"")),!1}),typeof i>"u"?i=this.raw(e,null,"beforeRule"):i&&(i=i.replace(/\S/g,"")),i}rawBeforeOpen(t){let e;return t.walk(i=>{if(i.type!=="decl"&&(e=i.raws.between,typeof e<"u"))return!1}),e}rawBeforeRule(t){let e;return t.walk(i=>{if(i.nodes&&(i.parent!==t||t.first!==i)&&typeof i.raws.before<"u")return e=i.raws.before,e.includes(`
`)&&(e=e.replace(/[^\n]+$/,"")),!1}),e&&(e=e.replace(/\S/g,"")),e}rawColon(t){let e;return t.walkDecls(i=>{if(typeof i.raws.between<"u")return e=i.raws.between.replace(/[^\s:]/g,""),!1}),e}rawEmptyBody(t){let e;return t.walk(i=>{if(i.nodes&&i.nodes.length===0&&(e=i.raws.after,typeof e<"u"))return!1}),e}rawIndent(t){if(t.raws.indent)return t.raws.indent;let e;return t.walk(i=>{let n=i.parent;if(n&&n!==t&&n.parent&&n.parent===t&&typeof i.raws.before<"u"){let r=i.raws.before.split(`
`);return e=r[r.length-1],e=e.replace(/\S/g,""),!1}}),e}rawSemicolon(t){let e;return t.walk(i=>{if(i.nodes&&i.nodes.length&&i.last.type==="decl"&&(e=i.raws.semicolon,typeof e<"u"))return!1}),e}rawValue(t,e){let i=t[e],n=t.raws[e];return n&&n.value===i?n.raw:i}root(t){this.body(t),t.raws.after&&this.builder(t.raws.after)}rule(t){this.block(t,this.rawValue(t,"selector")),t.raws.ownSemicolon&&this.builder(t.raws.ownSemicolon,t,"end")}stringify(t,e){if(!this[t.type])throw new Error("Unknown AST node type "+t.type+". Maybe you need to change PostCSS stringifier.");this[t.type](t,e)}};Lh.exports=Sa;Sa.default=Sa});var Ea=st((IQ,Uh)=>{"use strict";var fx=mm();function pm(o,t){new fx(t).stringify(o)}Uh.exports=pm;pm.default=pm});var _c=st((DQ,um)=>{"use strict";um.exports.isClean=Symbol("isClean");um.exports.my=Symbol("my")});var Ia=st((TQ,zh)=>{"use strict";var hx=Cc(),gx=mm(),Cx=Ea(),{isClean:Pa,my:_x}=_c();function fm(o,t){let e=new o.constructor;for(let i in o){if(!Object.prototype.hasOwnProperty.call(o,i)||i==="proxyCache")continue;let n=o[i],r=typeof n;i==="parent"&&r==="object"?t&&(e[i]=t):i==="source"?e[i]=n:Array.isArray(n)?e[i]=n.map(s=>fm(s,e)):(r==="object"&&n!==null&&(n=fm(n)),e[i]=n)}return e}function to(o,t){if(t&&typeof t.offset<"u")return t.offset;let e=1,i=1,n=0;for(let r=0;r<o.length;r++){if(i===t.line&&e===t.column){n=r;break}o[r]===`
`?(e=1,i+=1):e+=1}return n}var Ma=class{get proxyOf(){return this}constructor(t={}){this.raws={},this[Pa]=!1,this[_x]=!0;for(let e in t)if(e==="nodes"){this.nodes=[];for(let i of t[e])typeof i.clone=="function"?this.append(i.clone()):this.append(i)}else this[e]=t[e]}addToError(t){if(t.postcssNode=this,t.stack&&this.source&&/\n\s{4}at /.test(t.stack)){let e=this.source;t.stack=t.stack.replace(/\n\s{4}at /,`$&${e.input.from}:${e.start.line}:${e.start.column}$&`)}return t}after(t){return this.parent.insertAfter(this,t),this}assign(t={}){for(let e in t)this[e]=t[e];return this}before(t){return this.parent.insertBefore(this,t),this}cleanRaws(t){delete this.raws.before,delete this.raws.after,t||delete this.raws.between}clone(t={}){let e=fm(this);for(let i in t)e[i]=t[i];return e}cloneAfter(t={}){let e=this.clone(t);return this.parent.insertAfter(this,e),e}cloneBefore(t={}){let e=this.clone(t);return this.parent.insertBefore(this,e),e}error(t,e={}){if(this.source){let{end:i,start:n}=this.rangeBy(e);return this.source.input.error(t,{column:n.column,line:n.line},{column:i.column,line:i.line},e)}return new hx(t)}getProxyProcessor(){return{get(t,e){return e==="proxyOf"?t:e==="root"?()=>t.root().toProxy():t[e]},set(t,e,i){return t[e]===i||(t[e]=i,(e==="prop"||e==="value"||e==="name"||e==="params"||e==="important"||e==="text")&&t.markDirty()),!0}}}markClean(){this[Pa]=!0}markDirty(){if(this[Pa]){this[Pa]=!1;let t=this;for(;t=t.parent;)t[Pa]=!1}}next(){if(!this.parent)return;let t=this.parent.index(this);return this.parent.nodes[t+1]}positionBy(t={}){let e=this.source.start;if(t.index)e=this.positionInside(t.index);else if(t.word){let i="document"in this.source.input?this.source.input.document:this.source.input.css,r=i.slice(to(i,this.source.start),to(i,this.source.end)).indexOf(t.word);r!==-1&&(e=this.positionInside(r))}return e}positionInside(t){let e=this.source.start.column,i=this.source.start.line,n="document"in this.source.input?this.source.input.document:this.source.input.css,r=to(n,this.source.start),s=r+t;for(let m=r;m<s;m++)n[m]===`
`?(e=1,i+=1):e+=1;return{column:e,line:i,offset:s}}prev(){if(!this.parent)return;let t=this.parent.index(this);return this.parent.nodes[t-1]}rangeBy(t={}){let e="document"in this.source.input?this.source.input.document:this.source.input.css,i={column:this.source.start.column,line:this.source.start.line,offset:to(e,this.source.start)},n=this.source.end?{column:this.source.end.column+1,line:this.source.end.line,offset:typeof this.source.end.offset=="number"?this.source.end.offset:to(e,this.source.end)+1}:{column:i.column+1,line:i.line,offset:i.offset+1};if(t.word){let s=e.slice(to(e,this.source.start),to(e,this.source.end)).indexOf(t.word);s!==-1&&(i=this.positionInside(s),n=this.positionInside(s+t.word.length))}else t.start?i={column:t.start.column,line:t.start.line,offset:to(e,t.start)}:t.index&&(i=this.positionInside(t.index)),t.end?n={column:t.end.column,line:t.end.line,offset:to(e,t.end)}:typeof t.endIndex=="number"?n=this.positionInside(t.endIndex):t.index&&(n=this.positionInside(t.index+1));return(n.line<i.line||n.line===i.line&&n.column<=i.column)&&(n={column:i.column+1,line:i.line,offset:i.offset+1}),{end:n,start:i}}raw(t,e){return new gx().raw(this,t,e)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...t){if(this.parent){let e=this,i=!1;for(let n of t)n===this?i=!0:i?(this.parent.insertAfter(e,n),e=n):this.parent.insertBefore(e,n);i||this.remove()}return this}root(){let t=this;for(;t.parent&&t.parent.type!=="document";)t=t.parent;return t}toJSON(t,e){let i={},n=e==null;e=e||new Map;let r=0;for(let s in this){if(!Object.prototype.hasOwnProperty.call(this,s)||s==="parent"||s==="proxyCache")continue;let m=this[s];if(Array.isArray(m))i[s]=m.map(p=>typeof p=="object"&&p.toJSON?p.toJSON(null,e):p);else if(typeof m=="object"&&m.toJSON)i[s]=m.toJSON(null,e);else if(s==="source"){if(m==null)continue;let p=e.get(m.input);p==null&&(p=r,e.set(m.input,r),r++),i[s]={end:m.end,inputId:p,start:m.start}}else i[s]=m}return n&&(i.inputs=[...e.keys()].map(s=>s.toJSON())),i}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(t=Cx){t.stringify&&(t=t.stringify);let e="";return t(this,i=>{e+=i}),e}warn(t,e,i={}){let n={node:this};for(let r in i)n[r]=i[r];return t.warn(e,n)}};zh.exports=Ma;Ma.default=Ma});var Ta=st((FQ,Bh)=>{"use strict";var vx=Ia(),Da=class extends vx{constructor(t){super(t),this.type="comment"}};Bh.exports=Da;Da.default=Da});var ka=st((kQ,Wh)=>{"use strict";var yx=Ia(),Fa=class extends yx{get variable(){return this.prop.startsWith("--")||this.prop[0]==="$"}constructor(t){t&&typeof t.value<"u"&&typeof t.value!="string"&&(t=re(k({},t),{value:String(t.value)})),super(t),this.type="decl"}};Wh.exports=Fa;Fa.default=Fa});var Eo=st((VQ,Kh)=>{"use strict";var Hh=Ta(),Gh=ka(),bx=Ia(),{isClean:qh,my:Jh}=_c(),hm,$h,Xh,gm;function Zh(o){return o.map(t=>(t.nodes&&(t.nodes=Zh(t.nodes)),delete t.source,t))}function Qh(o){if(o[qh]=!1,o.proxyOf.nodes)for(let t of o.proxyOf.nodes)Qh(t)}var Oa=(()=>{class o extends bx{get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}append(...e){for(let i of e){let n=this.normalize(i,this.last);for(let r of n)this.proxyOf.nodes.push(r)}return this.markDirty(),this}cleanRaws(e){if(super.cleanRaws(e),this.nodes)for(let i of this.nodes)i.cleanRaws(e)}each(e){if(!this.proxyOf.nodes)return;let i=this.getIterator(),n,r;for(;this.indexes[i]<this.proxyOf.nodes.length&&(n=this.indexes[i],r=e(this.proxyOf.nodes[n],n),r!==!1);)this.indexes[i]+=1;return delete this.indexes[i],r}every(e){return this.nodes.every(e)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let e=this.lastEach;return this.indexes[e]=0,e}getProxyProcessor(){return{get(e,i){return i==="proxyOf"?e:e[i]?i==="each"||typeof i=="string"&&i.startsWith("walk")?(...n)=>e[i](...n.map(r=>typeof r=="function"?(s,m)=>r(s.toProxy(),m):r)):i==="every"||i==="some"?n=>e[i]((r,...s)=>n(r.toProxy(),...s)):i==="root"?()=>e.root().toProxy():i==="nodes"?e.nodes.map(n=>n.toProxy()):i==="first"||i==="last"?e[i].toProxy():e[i]:e[i]},set(e,i,n){return e[i]===n||(e[i]=n,(i==="name"||i==="params"||i==="selector")&&e.markDirty()),!0}}}index(e){return typeof e=="number"?e:(e.proxyOf&&(e=e.proxyOf),this.proxyOf.nodes.indexOf(e))}insertAfter(e,i){let n=this.index(e),r=this.normalize(i,this.proxyOf.nodes[n]).reverse();n=this.index(e);for(let m of r)this.proxyOf.nodes.splice(n+1,0,m);let s;for(let m in this.indexes)s=this.indexes[m],n<s&&(this.indexes[m]=s+r.length);return this.markDirty(),this}insertBefore(e,i){let n=this.index(e),r=n===0?"prepend":!1,s=this.normalize(i,this.proxyOf.nodes[n],r).reverse();n=this.index(e);for(let p of s)this.proxyOf.nodes.splice(n,0,p);let m;for(let p in this.indexes)m=this.indexes[p],n<=m&&(this.indexes[p]=m+s.length);return this.markDirty(),this}normalize(e,i){if(typeof e=="string")e=Zh($h(e).nodes);else if(typeof e>"u")e=[];else if(Array.isArray(e)){e=e.slice(0);for(let r of e)r.parent&&r.parent.removeChild(r,"ignore")}else if(e.type==="root"&&this.type!=="document"){e=e.nodes.slice(0);for(let r of e)r.parent&&r.parent.removeChild(r,"ignore")}else if(e.type)e=[e];else if(e.prop){if(typeof e.value>"u")throw new Error("Value field is missed in node creation");typeof e.value!="string"&&(e.value=String(e.value)),e=[new Gh(e)]}else if(e.selector||e.selectors)e=[new gm(e)];else if(e.name)e=[new hm(e)];else if(e.text)e=[new Hh(e)];else throw new Error("Unknown node type in node creation");return e.map(r=>(r[Jh]||o.rebuild(r),r=r.proxyOf,r.parent&&r.parent.removeChild(r),r[qh]&&Qh(r),r.raws||(r.raws={}),typeof r.raws.before>"u"&&i&&typeof i.raws.before<"u"&&(r.raws.before=i.raws.before.replace(/\S/g,"")),r.parent=this.proxyOf,r))}prepend(...e){e=e.reverse();for(let i of e){let n=this.normalize(i,this.first,"prepend").reverse();for(let r of n)this.proxyOf.nodes.unshift(r);for(let r in this.indexes)this.indexes[r]=this.indexes[r]+n.length}return this.markDirty(),this}push(e){return e.parent=this,this.proxyOf.nodes.push(e),this}removeAll(){for(let e of this.proxyOf.nodes)e.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(e){e=this.index(e),this.proxyOf.nodes[e].parent=void 0,this.proxyOf.nodes.splice(e,1);let i;for(let n in this.indexes)i=this.indexes[n],i>=e&&(this.indexes[n]=i-1);return this.markDirty(),this}replaceValues(e,i,n){return n||(n=i,i={}),this.walkDecls(r=>{i.props&&!i.props.includes(r.prop)||i.fast&&!r.value.includes(i.fast)||(r.value=r.value.replace(e,n))}),this.markDirty(),this}some(e){return this.nodes.some(e)}walk(e){return this.each((i,n)=>{let r;try{r=e(i,n)}catch(s){throw i.addToError(s)}return r!==!1&&i.walk&&(r=i.walk(e)),r})}walkAtRules(e,i){return i?e instanceof RegExp?this.walk((n,r)=>{if(n.type==="atrule"&&e.test(n.name))return i(n,r)}):this.walk((n,r)=>{if(n.type==="atrule"&&n.name===e)return i(n,r)}):(i=e,this.walk((n,r)=>{if(n.type==="atrule")return i(n,r)}))}walkComments(e){return this.walk((i,n)=>{if(i.type==="comment")return e(i,n)})}walkDecls(e,i){return i?e instanceof RegExp?this.walk((n,r)=>{if(n.type==="decl"&&e.test(n.prop))return i(n,r)}):this.walk((n,r)=>{if(n.type==="decl"&&n.prop===e)return i(n,r)}):(i=e,this.walk((n,r)=>{if(n.type==="decl")return i(n,r)}))}walkRules(e,i){return i?e instanceof RegExp?this.walk((n,r)=>{if(n.type==="rule"&&e.test(n.selector))return i(n,r)}):this.walk((n,r)=>{if(n.type==="rule"&&n.selector===e)return i(n,r)}):(i=e,this.walk((n,r)=>{if(n.type==="rule")return i(n,r)}))}}return o.registerParse=t=>{$h=t},o.registerRule=t=>{gm=t},o.registerAtRule=t=>{hm=t},o.registerRoot=t=>{Xh=t},o})();Kh.exports=Oa;Oa.default=Oa;Oa.rebuild=o=>{o.type==="atrule"?Object.setPrototypeOf(o,hm.prototype):o.type==="rule"?Object.setPrototypeOf(o,gm.prototype):o.type==="decl"?Object.setPrototypeOf(o,Gh.prototype):o.type==="comment"?Object.setPrototypeOf(o,Hh.prototype):o.type==="root"&&Object.setPrototypeOf(o,Xh.prototype),o[Jh]=!0,o.nodes&&o.nodes.forEach(t=>{Oa.rebuild(t)})}});var vc=st((NQ,eg)=>{"use strict";var Yh=Eo(),Rr=class extends Yh{constructor(t){super(t),this.type="atrule"}append(...t){return this.proxyOf.nodes||(this.nodes=[]),super.append(...t)}prepend(...t){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...t)}};eg.exports=Rr;Rr.default=Rr;Yh.registerAtRule(Rr)});var yc=st((AQ,ng)=>{"use strict";var xx=Eo(),tg,ig,Cm=(()=>{class o extends xx{constructor(e){super(k({type:"document"},e)),this.nodes||(this.nodes=[])}toResult(e={}){return new tg(new ig,this,e).stringify()}}return o.registerLazyResult=t=>{tg=t},o.registerProcessor=t=>{ig=t},o})();ng.exports=Cm;Cm.default=Cm});var rg=st((RQ,og)=>{"use strict";var wx="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Sx=(o,t=21)=>(e=t)=>{let i="",n=e|0;for(;n--;)i+=o[Math.random()*o.length|0];return i},Ex=(o=21)=>{let t="",e=o|0;for(;e--;)t+=wx[Math.random()*64|0];return t};og.exports={nanoid:Ex,customAlphabet:Sx}});var bc=st(()=>{"use strict"});var sg=st(_m=>{"use strict";var ag="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");_m.encode=function(o){if(0<=o&&o<ag.length)return ag[o];throw new TypeError("Must be between 0 and 63: "+o)};_m.decode=function(o){var t=65,e=90,i=97,n=122,r=48,s=57,m=43,p=47,v=26,y=52;return t<=o&&o<=e?o-t:i<=o&&o<=n?o-i+v:r<=o&&o<=s?o-r+y:o==m?62:o==p?63:-1}});var bm=st(ym=>{"use strict";var lg=sg(),vm=5,cg=1<<vm,dg=cg-1,mg=cg;function Px(o){return o<0?(-o<<1)+1:(o<<1)+0}function Mx(o){var t=(o&1)===1,e=o>>1;return t?-e:e}ym.encode=function(t){var e="",i,n=Px(t);do i=n&dg,n>>>=vm,n>0&&(i|=mg),e+=lg.encode(i);while(n>0);return e};ym.decode=function(t,e,i){var n=t.length,r=0,s=0,m,p;do{if(e>=n)throw new Error("Expected more digits in base 64 VLQ value.");if(p=lg.decode(t.charCodeAt(e++)),p===-1)throw new Error("Invalid base64 digit: "+t.charAt(e-1));m=!!(p&mg),p&=dg,r=r+(p<<s),s+=vm}while(m);i.value=Mx(r),i.rest=e}});var Ur=st(Ri=>{"use strict";function Ix(o,t,e){if(t in o)return o[t];if(arguments.length===3)return e;throw new Error('"'+t+'" is a required argument.')}Ri.getArg=Ix;var pg=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,Dx=/^data:.+\,.+$/;function Va(o){var t=o.match(pg);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}Ri.urlParse=Va;function Lr(o){var t="";return o.scheme&&(t+=o.scheme+":"),t+="//",o.auth&&(t+=o.auth+"@"),o.host&&(t+=o.host),o.port&&(t+=":"+o.port),o.path&&(t+=o.path),t}Ri.urlGenerate=Lr;var Tx=32;function Fx(o){var t=[];return function(e){for(var i=0;i<t.length;i++)if(t[i].input===e){var n=t[0];return t[0]=t[i],t[i]=n,t[0].result}var r=o(e);return t.unshift({input:e,result:r}),t.length>Tx&&t.pop(),r}}var xm=Fx(function(t){var e=t,i=Va(t);if(i){if(!i.path)return t;e=i.path}for(var n=Ri.isAbsolute(e),r=[],s=0,m=0;;)if(s=m,m=e.indexOf("/",s),m===-1){r.push(e.slice(s));break}else for(r.push(e.slice(s,m));m<e.length&&e[m]==="/";)m++;for(var p,v=0,m=r.length-1;m>=0;m--)p=r[m],p==="."?r.splice(m,1):p===".."?v++:v>0&&(p===""?(r.splice(m+1,v),v=0):(r.splice(m,2),v--));return e=r.join("/"),e===""&&(e=n?"/":"."),i?(i.path=e,Lr(i)):e});Ri.normalize=xm;function ug(o,t){o===""&&(o="."),t===""&&(t=".");var e=Va(t),i=Va(o);if(i&&(o=i.path||"/"),e&&!e.scheme)return i&&(e.scheme=i.scheme),Lr(e);if(e||t.match(Dx))return t;if(i&&!i.host&&!i.path)return i.host=t,Lr(i);var n=t.charAt(0)==="/"?t:xm(o.replace(/\/+$/,"")+"/"+t);return i?(i.path=n,Lr(i)):n}Ri.join=ug;Ri.isAbsolute=function(o){return o.charAt(0)==="/"||pg.test(o)};function kx(o,t){o===""&&(o="."),o=o.replace(/\/$/,"");for(var e=0;t.indexOf(o+"/")!==0;){var i=o.lastIndexOf("/");if(i<0||(o=o.slice(0,i),o.match(/^([^\/]+:\/)?\/*$/)))return t;++e}return Array(e+1).join("../")+t.substr(o.length+1)}Ri.relative=kx;var fg=(function(){var o=Object.create(null);return!("__proto__"in o)})();function hg(o){return o}function Ox(o){return gg(o)?"$"+o:o}Ri.toSetString=fg?hg:Ox;function Vx(o){return gg(o)?o.slice(1):o}Ri.fromSetString=fg?hg:Vx;function gg(o){if(!o)return!1;var t=o.length;if(t<9||o.charCodeAt(t-1)!==95||o.charCodeAt(t-2)!==95||o.charCodeAt(t-3)!==111||o.charCodeAt(t-4)!==116||o.charCodeAt(t-5)!==111||o.charCodeAt(t-6)!==114||o.charCodeAt(t-7)!==112||o.charCodeAt(t-8)!==95||o.charCodeAt(t-9)!==95)return!1;for(var e=t-10;e>=0;e--)if(o.charCodeAt(e)!==36)return!1;return!0}function Nx(o,t,e){var i=io(o.source,t.source);return i!==0||(i=o.originalLine-t.originalLine,i!==0)||(i=o.originalColumn-t.originalColumn,i!==0||e)||(i=o.generatedColumn-t.generatedColumn,i!==0)||(i=o.generatedLine-t.generatedLine,i!==0)?i:io(o.name,t.name)}Ri.compareByOriginalPositions=Nx;function Ax(o,t,e){var i;return i=o.originalLine-t.originalLine,i!==0||(i=o.originalColumn-t.originalColumn,i!==0||e)||(i=o.generatedColumn-t.generatedColumn,i!==0)||(i=o.generatedLine-t.generatedLine,i!==0)?i:io(o.name,t.name)}Ri.compareByOriginalPositionsNoSource=Ax;function jx(o,t,e){var i=o.generatedLine-t.generatedLine;return i!==0||(i=o.generatedColumn-t.generatedColumn,i!==0||e)||(i=io(o.source,t.source),i!==0)||(i=o.originalLine-t.originalLine,i!==0)||(i=o.originalColumn-t.originalColumn,i!==0)?i:io(o.name,t.name)}Ri.compareByGeneratedPositionsDeflated=jx;function Rx(o,t,e){var i=o.generatedColumn-t.generatedColumn;return i!==0||e||(i=io(o.source,t.source),i!==0)||(i=o.originalLine-t.originalLine,i!==0)||(i=o.originalColumn-t.originalColumn,i!==0)?i:io(o.name,t.name)}Ri.compareByGeneratedPositionsDeflatedNoLine=Rx;function io(o,t){return o===t?0:o===null?1:t===null?-1:o>t?1:-1}function Lx(o,t){var e=o.generatedLine-t.generatedLine;return e!==0||(e=o.generatedColumn-t.generatedColumn,e!==0)||(e=io(o.source,t.source),e!==0)||(e=o.originalLine-t.originalLine,e!==0)||(e=o.originalColumn-t.originalColumn,e!==0)?e:io(o.name,t.name)}Ri.compareByGeneratedPositionsInflated=Lx;function Ux(o){return JSON.parse(o.replace(/^\)]}'[^\n]*\n/,""))}Ri.parseSourceMapInput=Ux;function zx(o,t,e){if(t=t||"",o&&(o[o.length-1]!=="/"&&t[0]!=="/"&&(o+="/"),t=o+t),e){var i=Va(e);if(!i)throw new Error("sourceMapURL could not be parsed");if(i.path){var n=i.path.lastIndexOf("/");n>=0&&(i.path=i.path.substring(0,n+1))}t=ug(Lr(i),t)}return xm(t)}Ri.computeSourceURL=zx});var Em=st(Cg=>{"use strict";var wm=Ur(),Sm=Object.prototype.hasOwnProperty,Jo=typeof Map<"u";function no(){this._array=[],this._set=Jo?new Map:Object.create(null)}no.fromArray=function(t,e){for(var i=new no,n=0,r=t.length;n<r;n++)i.add(t[n],e);return i};no.prototype.size=function(){return Jo?this._set.size:Object.getOwnPropertyNames(this._set).length};no.prototype.add=function(t,e){var i=Jo?t:wm.toSetString(t),n=Jo?this.has(t):Sm.call(this._set,i),r=this._array.length;(!n||e)&&this._array.push(t),n||(Jo?this._set.set(t,r):this._set[i]=r)};no.prototype.has=function(t){if(Jo)return this._set.has(t);var e=wm.toSetString(t);return Sm.call(this._set,e)};no.prototype.indexOf=function(t){if(Jo){var e=this._set.get(t);if(e>=0)return e}else{var i=wm.toSetString(t);if(Sm.call(this._set,i))return this._set[i]}throw new Error('"'+t+'" is not in the set.')};no.prototype.at=function(t){if(t>=0&&t<this._array.length)return this._array[t];throw new Error("No element indexed by "+t)};no.prototype.toArray=function(){return this._array.slice()};Cg.ArraySet=no});var yg=st(vg=>{"use strict";var _g=Ur();function Bx(o,t){var e=o.generatedLine,i=t.generatedLine,n=o.generatedColumn,r=t.generatedColumn;return i>e||i==e&&r>=n||_g.compareByGeneratedPositionsInflated(o,t)<=0}function xc(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}xc.prototype.unsortedForEach=function(t,e){this._array.forEach(t,e)};xc.prototype.add=function(t){Bx(this._last,t)?(this._last=t,this._array.push(t)):(this._sorted=!1,this._array.push(t))};xc.prototype.toArray=function(){return this._sorted||(this._array.sort(_g.compareByGeneratedPositionsInflated),this._sorted=!0),this._array};vg.MappingList=xc});var Pm=st(bg=>{"use strict";var Na=bm(),ui=Ur(),wc=Em().ArraySet,Wx=yg().MappingList;function vn(o){o||(o={}),this._file=ui.getArg(o,"file",null),this._sourceRoot=ui.getArg(o,"sourceRoot",null),this._skipValidation=ui.getArg(o,"skipValidation",!1),this._ignoreInvalidMapping=ui.getArg(o,"ignoreInvalidMapping",!1),this._sources=new wc,this._names=new wc,this._mappings=new Wx,this._sourcesContents=null}vn.prototype._version=3;vn.fromSourceMap=function(t,e){var i=t.sourceRoot,n=new vn(Object.assign(e||{},{file:t.file,sourceRoot:i}));return t.eachMapping(function(r){var s={generated:{line:r.generatedLine,column:r.generatedColumn}};r.source!=null&&(s.source=r.source,i!=null&&(s.source=ui.relative(i,s.source)),s.original={line:r.originalLine,column:r.originalColumn},r.name!=null&&(s.name=r.name)),n.addMapping(s)}),t.sources.forEach(function(r){var s=r;i!==null&&(s=ui.relative(i,r)),n._sources.has(s)||n._sources.add(s);var m=t.sourceContentFor(r);m!=null&&n.setSourceContent(r,m)}),n};vn.prototype.addMapping=function(t){var e=ui.getArg(t,"generated"),i=ui.getArg(t,"original",null),n=ui.getArg(t,"source",null),r=ui.getArg(t,"name",null);!this._skipValidation&&this._validateMapping(e,i,n,r)===!1||(n!=null&&(n=String(n),this._sources.has(n)||this._sources.add(n)),r!=null&&(r=String(r),this._names.has(r)||this._names.add(r)),this._mappings.add({generatedLine:e.line,generatedColumn:e.column,originalLine:i!=null&&i.line,originalColumn:i!=null&&i.column,source:n,name:r}))};vn.prototype.setSourceContent=function(t,e){var i=t;this._sourceRoot!=null&&(i=ui.relative(this._sourceRoot,i)),e!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[ui.toSetString(i)]=e):this._sourcesContents&&(delete this._sourcesContents[ui.toSetString(i)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))};vn.prototype.applySourceMap=function(t,e,i){var n=e;if(e==null){if(t.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);n=t.file}var r=this._sourceRoot;r!=null&&(n=ui.relative(r,n));var s=new wc,m=new wc;this._mappings.unsortedForEach(function(p){if(p.source===n&&p.originalLine!=null){var v=t.originalPositionFor({line:p.originalLine,column:p.originalColumn});v.source!=null&&(p.source=v.source,i!=null&&(p.source=ui.join(i,p.source)),r!=null&&(p.source=ui.relative(r,p.source)),p.originalLine=v.line,p.originalColumn=v.column,v.name!=null&&(p.name=v.name))}var y=p.source;y!=null&&!s.has(y)&&s.add(y);var x=p.name;x!=null&&!m.has(x)&&m.add(x)},this),this._sources=s,this._names=m,t.sources.forEach(function(p){var v=t.sourceContentFor(p);v!=null&&(i!=null&&(p=ui.join(i,p)),r!=null&&(p=ui.relative(r,p)),this.setSourceContent(p,v))},this)};vn.prototype._validateMapping=function(t,e,i,n){if(e&&typeof e.line!="number"&&typeof e.column!="number"){var r="original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.";if(this._ignoreInvalidMapping)return typeof console<"u"&&console.warn&&console.warn(r),!1;throw new Error(r)}if(!(t&&"line"in t&&"column"in t&&t.line>0&&t.column>=0&&!e&&!i&&!n)){if(t&&"line"in t&&"column"in t&&e&&"line"in e&&"column"in e&&t.line>0&&t.column>=0&&e.line>0&&e.column>=0&&i)return;var r="Invalid mapping: "+JSON.stringify({generated:t,source:i,original:e,name:n});if(this._ignoreInvalidMapping)return typeof console<"u"&&console.warn&&console.warn(r),!1;throw new Error(r)}};vn.prototype._serializeMappings=function(){for(var t=0,e=1,i=0,n=0,r=0,s=0,m="",p,v,y,x,E=this._mappings.toArray(),w=0,O=E.length;w<O;w++){if(v=E[w],p="",v.generatedLine!==e)for(t=0;v.generatedLine!==e;)p+=";",e++;else if(w>0){if(!ui.compareByGeneratedPositionsInflated(v,E[w-1]))continue;p+=","}p+=Na.encode(v.generatedColumn-t),t=v.generatedColumn,v.source!=null&&(x=this._sources.indexOf(v.source),p+=Na.encode(x-s),s=x,p+=Na.encode(v.originalLine-1-n),n=v.originalLine-1,p+=Na.encode(v.originalColumn-i),i=v.originalColumn,v.name!=null&&(y=this._names.indexOf(v.name),p+=Na.encode(y-r),r=y)),m+=p}return m};vn.prototype._generateSourcesContent=function(t,e){return t.map(function(i){if(!this._sourcesContents)return null;e!=null&&(i=ui.relative(e,i));var n=ui.toSetString(i);return Object.prototype.hasOwnProperty.call(this._sourcesContents,n)?this._sourcesContents[n]:null},this)};vn.prototype.toJSON=function(){var t={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(t.file=this._file),this._sourceRoot!=null&&(t.sourceRoot=this._sourceRoot),this._sourcesContents&&(t.sourcesContent=this._generateSourcesContent(t.sources,t.sourceRoot)),t};vn.prototype.toString=function(){return JSON.stringify(this.toJSON())};bg.SourceMapGenerator=vn});var xg=st(Xo=>{"use strict";Xo.GREATEST_LOWER_BOUND=1;Xo.LEAST_UPPER_BOUND=2;function Mm(o,t,e,i,n,r){var s=Math.floor((t-o)/2)+o,m=n(e,i[s],!0);return m===0?s:m>0?t-s>1?Mm(s,t,e,i,n,r):r==Xo.LEAST_UPPER_BOUND?t<i.length?t:-1:s:s-o>1?Mm(o,s,e,i,n,r):r==Xo.LEAST_UPPER_BOUND?s:o<0?-1:o}Xo.search=function(t,e,i,n){if(e.length===0)return-1;var r=Mm(-1,e.length,t,e,i,n||Xo.GREATEST_LOWER_BOUND);if(r<0)return-1;for(;r-1>=0&&i(e[r],e[r-1],!0)===0;)--r;return r}});var Eg=st(Sg=>{"use strict";function $x(o){function t(n,r,s){var m=n[r];n[r]=n[s],n[s]=m}function e(n,r){return Math.round(n+Math.random()*(r-n))}function i(n,r,s,m){if(s<m){var p=e(s,m),v=s-1;t(n,p,m);for(var y=n[m],x=s;x<m;x++)r(n[x],y,!1)<=0&&(v+=1,t(n,v,x));t(n,v+1,x);var E=v+1;i(n,r,s,E-1),i(n,r,E+1,m)}}return i}function Hx(o){let t=$x.toString();return new Function(`return ${t}`)()(o)}var wg=new WeakMap;Sg.quickSort=function(o,t,e=0){let i=wg.get(t);i===void 0&&(i=Hx(t),wg.set(t,i)),i(o,t,e,o.length-1)}});var Ig=st(Sc=>{"use strict";var $e=Ur(),Dm=xg(),zr=Em().ArraySet,Gx=bm(),Aa=Eg().quickSort;function Jt(o,t){var e=o;return typeof o=="string"&&(e=$e.parseSourceMapInput(o)),e.sections!=null?new Pn(e,t):new zi(e,t)}Jt.fromSourceMap=function(o,t){return zi.fromSourceMap(o,t)};Jt.prototype._version=3;Jt.prototype.__generatedMappings=null;Object.defineProperty(Jt.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}});Jt.prototype.__originalMappings=null;Object.defineProperty(Jt.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}});Jt.prototype._charIsMappingSeparator=function(t,e){var i=t.charAt(e);return i===";"||i===","};Jt.prototype._parseMappings=function(t,e){throw new Error("Subclasses must implement _parseMappings")};Jt.GENERATED_ORDER=1;Jt.ORIGINAL_ORDER=2;Jt.GREATEST_LOWER_BOUND=1;Jt.LEAST_UPPER_BOUND=2;Jt.prototype.eachMapping=function(t,e,i){var n=e||null,r=i||Jt.GENERATED_ORDER,s;switch(r){case Jt.GENERATED_ORDER:s=this._generatedMappings;break;case Jt.ORIGINAL_ORDER:s=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}for(var m=this.sourceRoot,p=t.bind(n),v=this._names,y=this._sources,x=this._sourceMapURL,E=0,w=s.length;E<w;E++){var O=s[E],F=O.source===null?null:y.at(O.source);F!==null&&(F=$e.computeSourceURL(m,F,x)),p({source:F,generatedLine:O.generatedLine,generatedColumn:O.generatedColumn,originalLine:O.originalLine,originalColumn:O.originalColumn,name:O.name===null?null:v.at(O.name)})}};Jt.prototype.allGeneratedPositionsFor=function(t){var e=$e.getArg(t,"line"),i={source:$e.getArg(t,"source"),originalLine:e,originalColumn:$e.getArg(t,"column",0)};if(i.source=this._findSourceIndex(i.source),i.source<0)return[];var n=[],r=this._findMapping(i,this._originalMappings,"originalLine","originalColumn",$e.compareByOriginalPositions,Dm.LEAST_UPPER_BOUND);if(r>=0){var s=this._originalMappings[r];if(t.column===void 0)for(var m=s.originalLine;s&&s.originalLine===m;)n.push({line:$e.getArg(s,"generatedLine",null),column:$e.getArg(s,"generatedColumn",null),lastColumn:$e.getArg(s,"lastGeneratedColumn",null)}),s=this._originalMappings[++r];else for(var p=s.originalColumn;s&&s.originalLine===e&&s.originalColumn==p;)n.push({line:$e.getArg(s,"generatedLine",null),column:$e.getArg(s,"generatedColumn",null),lastColumn:$e.getArg(s,"lastGeneratedColumn",null)}),s=this._originalMappings[++r]}return n};Sc.SourceMapConsumer=Jt;function zi(o,t){var e=o;typeof o=="string"&&(e=$e.parseSourceMapInput(o));var i=$e.getArg(e,"version"),n=$e.getArg(e,"sources"),r=$e.getArg(e,"names",[]),s=$e.getArg(e,"sourceRoot",null),m=$e.getArg(e,"sourcesContent",null),p=$e.getArg(e,"mappings"),v=$e.getArg(e,"file",null);if(i!=this._version)throw new Error("Unsupported version: "+i);s&&(s=$e.normalize(s)),n=n.map(String).map($e.normalize).map(function(y){return s&&$e.isAbsolute(s)&&$e.isAbsolute(y)?$e.relative(s,y):y}),this._names=zr.fromArray(r.map(String),!0),this._sources=zr.fromArray(n,!0),this._absoluteSources=this._sources.toArray().map(function(y){return $e.computeSourceURL(s,y,t)}),this.sourceRoot=s,this.sourcesContent=m,this._mappings=p,this._sourceMapURL=t,this.file=v}zi.prototype=Object.create(Jt.prototype);zi.prototype.consumer=Jt;zi.prototype._findSourceIndex=function(o){var t=o;if(this.sourceRoot!=null&&(t=$e.relative(this.sourceRoot,t)),this._sources.has(t))return this._sources.indexOf(t);var e;for(e=0;e<this._absoluteSources.length;++e)if(this._absoluteSources[e]==o)return e;return-1};zi.fromSourceMap=function(t,e){var i=Object.create(zi.prototype),n=i._names=zr.fromArray(t._names.toArray(),!0),r=i._sources=zr.fromArray(t._sources.toArray(),!0);i.sourceRoot=t._sourceRoot,i.sourcesContent=t._generateSourcesContent(i._sources.toArray(),i.sourceRoot),i.file=t._file,i._sourceMapURL=e,i._absoluteSources=i._sources.toArray().map(function(w){return $e.computeSourceURL(i.sourceRoot,w,e)});for(var s=t._mappings.toArray().slice(),m=i.__generatedMappings=[],p=i.__originalMappings=[],v=0,y=s.length;v<y;v++){var x=s[v],E=new Mg;E.generatedLine=x.generatedLine,E.generatedColumn=x.generatedColumn,x.source&&(E.source=r.indexOf(x.source),E.originalLine=x.originalLine,E.originalColumn=x.originalColumn,x.name&&(E.name=n.indexOf(x.name)),p.push(E)),m.push(E)}return Aa(i.__originalMappings,$e.compareByOriginalPositions),i};zi.prototype._version=3;Object.defineProperty(zi.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function Mg(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}var Im=$e.compareByGeneratedPositionsDeflatedNoLine;function Pg(o,t){let e=o.length,i=o.length-t;if(!(i<=1))if(i==2){let n=o[t],r=o[t+1];Im(n,r)>0&&(o[t]=r,o[t+1]=n)}else if(i<20)for(let n=t;n<e;n++)for(let r=n;r>t;r--){let s=o[r-1],m=o[r];if(Im(s,m)<=0)break;o[r-1]=m,o[r]=s}else Aa(o,Im,t)}zi.prototype._parseMappings=function(t,e){var i=1,n=0,r=0,s=0,m=0,p=0,v=t.length,y=0,x={},E={},w=[],O=[],F,V,L,B,z;let Q=0;for(;y<v;)if(t.charAt(y)===";")i++,y++,n=0,Pg(O,Q),Q=O.length;else if(t.charAt(y)===",")y++;else{for(F=new Mg,F.generatedLine=i,B=y;B<v&&!this._charIsMappingSeparator(t,B);B++);for(V=t.slice(y,B),L=[];y<B;)Gx.decode(t,y,E),z=E.value,y=E.rest,L.push(z);if(L.length===2)throw new Error("Found a source, but no line and column");if(L.length===3)throw new Error("Found a source and line, but no column");if(F.generatedColumn=n+L[0],n=F.generatedColumn,L.length>1&&(F.source=m+L[1],m+=L[1],F.originalLine=r+L[2],r=F.originalLine,F.originalLine+=1,F.originalColumn=s+L[3],s=F.originalColumn,L.length>4&&(F.name=p+L[4],p+=L[4])),O.push(F),typeof F.originalLine=="number"){let fe=F.source;for(;w.length<=fe;)w.push(null);w[fe]===null&&(w[fe]=[]),w[fe].push(F)}}Pg(O,Q),this.__generatedMappings=O;for(var K=0;K<w.length;K++)w[K]!=null&&Aa(w[K],$e.compareByOriginalPositionsNoSource);this.__originalMappings=[].concat(...w)};zi.prototype._findMapping=function(t,e,i,n,r,s){if(t[i]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+t[i]);if(t[n]<0)throw new TypeError("Column must be greater than or equal to 0, got "+t[n]);return Dm.search(t,e,r,s)};zi.prototype.computeColumnSpans=function(){for(var t=0;t<this._generatedMappings.length;++t){var e=this._generatedMappings[t];if(t+1<this._generatedMappings.length){var i=this._generatedMappings[t+1];if(e.generatedLine===i.generatedLine){e.lastGeneratedColumn=i.generatedColumn-1;continue}}e.lastGeneratedColumn=1/0}};zi.prototype.originalPositionFor=function(t){var e={generatedLine:$e.getArg(t,"line"),generatedColumn:$e.getArg(t,"column")},i=this._findMapping(e,this._generatedMappings,"generatedLine","generatedColumn",$e.compareByGeneratedPositionsDeflated,$e.getArg(t,"bias",Jt.GREATEST_LOWER_BOUND));if(i>=0){var n=this._generatedMappings[i];if(n.generatedLine===e.generatedLine){var r=$e.getArg(n,"source",null);r!==null&&(r=this._sources.at(r),r=$e.computeSourceURL(this.sourceRoot,r,this._sourceMapURL));var s=$e.getArg(n,"name",null);return s!==null&&(s=this._names.at(s)),{source:r,line:$e.getArg(n,"originalLine",null),column:$e.getArg(n,"originalColumn",null),name:s}}}return{source:null,line:null,column:null,name:null}};zi.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(t){return t==null}):!1};zi.prototype.sourceContentFor=function(t,e){if(!this.sourcesContent)return null;var i=this._findSourceIndex(t);if(i>=0)return this.sourcesContent[i];var n=t;this.sourceRoot!=null&&(n=$e.relative(this.sourceRoot,n));var r;if(this.sourceRoot!=null&&(r=$e.urlParse(this.sourceRoot))){var s=n.replace(/^file:\/\//,"");if(r.scheme=="file"&&this._sources.has(s))return this.sourcesContent[this._sources.indexOf(s)];if((!r.path||r.path=="/")&&this._sources.has("/"+n))return this.sourcesContent[this._sources.indexOf("/"+n)]}if(e)return null;throw new Error('"'+n+'" is not in the SourceMap.')};zi.prototype.generatedPositionFor=function(t){var e=$e.getArg(t,"source");if(e=this._findSourceIndex(e),e<0)return{line:null,column:null,lastColumn:null};var i={source:e,originalLine:$e.getArg(t,"line"),originalColumn:$e.getArg(t,"column")},n=this._findMapping(i,this._originalMappings,"originalLine","originalColumn",$e.compareByOriginalPositions,$e.getArg(t,"bias",Jt.GREATEST_LOWER_BOUND));if(n>=0){var r=this._originalMappings[n];if(r.source===i.source)return{line:$e.getArg(r,"generatedLine",null),column:$e.getArg(r,"generatedColumn",null),lastColumn:$e.getArg(r,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}};Sc.BasicSourceMapConsumer=zi;function Pn(o,t){var e=o;typeof o=="string"&&(e=$e.parseSourceMapInput(o));var i=$e.getArg(e,"version"),n=$e.getArg(e,"sections");if(i!=this._version)throw new Error("Unsupported version: "+i);this._sources=new zr,this._names=new zr;var r={line:-1,column:0};this._sections=n.map(function(s){if(s.url)throw new Error("Support for url field in sections not implemented.");var m=$e.getArg(s,"offset"),p=$e.getArg(m,"line"),v=$e.getArg(m,"column");if(p<r.line||p===r.line&&v<r.column)throw new Error("Section offsets must be ordered and non-overlapping.");return r=m,{generatedOffset:{generatedLine:p+1,generatedColumn:v+1},consumer:new Jt($e.getArg(s,"map"),t)}})}Pn.prototype=Object.create(Jt.prototype);Pn.prototype.constructor=Jt;Pn.prototype._version=3;Object.defineProperty(Pn.prototype,"sources",{get:function(){for(var o=[],t=0;t<this._sections.length;t++)for(var e=0;e<this._sections[t].consumer.sources.length;e++)o.push(this._sections[t].consumer.sources[e]);return o}});Pn.prototype.originalPositionFor=function(t){var e={generatedLine:$e.getArg(t,"line"),generatedColumn:$e.getArg(t,"column")},i=Dm.search(e,this._sections,function(r,s){var m=r.generatedLine-s.generatedOffset.generatedLine;return m||r.generatedColumn-s.generatedOffset.generatedColumn}),n=this._sections[i];return n?n.consumer.originalPositionFor({line:e.generatedLine-(n.generatedOffset.generatedLine-1),column:e.generatedColumn-(n.generatedOffset.generatedLine===e.generatedLine?n.generatedOffset.generatedColumn-1:0),bias:t.bias}):{source:null,line:null,column:null,name:null}};Pn.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(t){return t.consumer.hasContentsOfAllSources()})};Pn.prototype.sourceContentFor=function(t,e){for(var i=0;i<this._sections.length;i++){var n=this._sections[i],r=n.consumer.sourceContentFor(t,!0);if(r||r==="")return r}if(e)return null;throw new Error('"'+t+'" is not in the SourceMap.')};Pn.prototype.generatedPositionFor=function(t){for(var e=0;e<this._sections.length;e++){var i=this._sections[e];if(i.consumer._findSourceIndex($e.getArg(t,"source"))!==-1){var n=i.consumer.generatedPositionFor(t);if(n){var r={line:n.line+(i.generatedOffset.generatedLine-1),column:n.column+(i.generatedOffset.generatedLine===n.line?i.generatedOffset.generatedColumn-1:0)};return r}}}return{line:null,column:null}};Pn.prototype._parseMappings=function(t,e){this.__generatedMappings=[],this.__originalMappings=[];for(var i=0;i<this._sections.length;i++)for(var n=this._sections[i],r=n.consumer._generatedMappings,s=0;s<r.length;s++){var m=r[s],p=n.consumer._sources.at(m.source);p!==null&&(p=$e.computeSourceURL(n.consumer.sourceRoot,p,this._sourceMapURL)),this._sources.add(p),p=this._sources.indexOf(p);var v=null;m.name&&(v=n.consumer._names.at(m.name),this._names.add(v),v=this._names.indexOf(v));var y={source:p,generatedLine:m.generatedLine+(n.generatedOffset.generatedLine-1),generatedColumn:m.generatedColumn+(n.generatedOffset.generatedLine===m.generatedLine?n.generatedOffset.generatedColumn-1:0),originalLine:m.originalLine,originalColumn:m.originalColumn,name:v};this.__generatedMappings.push(y),typeof y.originalLine=="number"&&this.__originalMappings.push(y)}Aa(this.__generatedMappings,$e.compareByGeneratedPositionsDeflated),Aa(this.__originalMappings,$e.compareByOriginalPositions)};Sc.IndexedSourceMapConsumer=Pn});var Tg=st(Dg=>{"use strict";var qx=Pm().SourceMapGenerator,Ec=Ur(),Jx=/(\r?\n)/,Xx=10,Br="$$$isSourceNode$$$";function on(o,t,e,i,n){this.children=[],this.sourceContents={},this.line=o??null,this.column=t??null,this.source=e??null,this.name=n??null,this[Br]=!0,i!=null&&this.add(i)}on.fromStringWithSourceMap=function(t,e,i){var n=new on,r=t.split(Jx),s=0,m=function(){var E=O(),w=O()||"";return E+w;function O(){return s<r.length?r[s++]:void 0}},p=1,v=0,y=null;return e.eachMapping(function(E){if(y!==null)if(p<E.generatedLine)x(y,m()),p++,v=0;else{var w=r[s]||"",O=w.substr(0,E.generatedColumn-v);r[s]=w.substr(E.generatedColumn-v),v=E.generatedColumn,x(y,O),y=E;return}for(;p<E.generatedLine;)n.add(m()),p++;if(v<E.generatedColumn){var w=r[s]||"";n.add(w.substr(0,E.generatedColumn)),r[s]=w.substr(E.generatedColumn),v=E.generatedColumn}y=E},this),s<r.length&&(y&&x(y,m()),n.add(r.splice(s).join(""))),e.sources.forEach(function(E){var w=e.sourceContentFor(E);w!=null&&(i!=null&&(E=Ec.join(i,E)),n.setSourceContent(E,w))}),n;function x(E,w){if(E===null||E.source===void 0)n.add(w);else{var O=i?Ec.join(i,E.source):E.source;n.add(new on(E.originalLine,E.originalColumn,O,w,E.name))}}};on.prototype.add=function(t){if(Array.isArray(t))t.forEach(function(e){this.add(e)},this);else if(t[Br]||typeof t=="string")t&&this.children.push(t);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);return this};on.prototype.prepend=function(t){if(Array.isArray(t))for(var e=t.length-1;e>=0;e--)this.prepend(t[e]);else if(t[Br]||typeof t=="string")this.children.unshift(t);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);return this};on.prototype.walk=function(t){for(var e,i=0,n=this.children.length;i<n;i++)e=this.children[i],e[Br]?e.walk(t):e!==""&&t(e,{source:this.source,line:this.line,column:this.column,name:this.name})};on.prototype.join=function(t){var e,i,n=this.children.length;if(n>0){for(e=[],i=0;i<n-1;i++)e.push(this.children[i]),e.push(t);e.push(this.children[i]),this.children=e}return this};on.prototype.replaceRight=function(t,e){var i=this.children[this.children.length-1];return i[Br]?i.replaceRight(t,e):typeof i=="string"?this.children[this.children.length-1]=i.replace(t,e):this.children.push("".replace(t,e)),this};on.prototype.setSourceContent=function(t,e){this.sourceContents[Ec.toSetString(t)]=e};on.prototype.walkSourceContents=function(t){for(var e=0,i=this.children.length;e<i;e++)this.children[e][Br]&&this.children[e].walkSourceContents(t);for(var n=Object.keys(this.sourceContents),e=0,i=n.length;e<i;e++)t(Ec.fromSetString(n[e]),this.sourceContents[n[e]])};on.prototype.toString=function(){var t="";return this.walk(function(e){t+=e}),t};on.prototype.toStringWithSourceMap=function(t){var e={code:"",line:1,column:0},i=new qx(t),n=!1,r=null,s=null,m=null,p=null;return this.walk(function(v,y){e.code+=v,y.source!==null&&y.line!==null&&y.column!==null?((r!==y.source||s!==y.line||m!==y.column||p!==y.name)&&i.addMapping({source:y.source,original:{line:y.line,column:y.column},generated:{line:e.line,column:e.column},name:y.name}),r=y.source,s=y.line,m=y.column,p=y.name,n=!0):n&&(i.addMapping({generated:{line:e.line,column:e.column}}),r=null,n=!1);for(var x=0,E=v.length;x<E;x++)v.charCodeAt(x)===Xx?(e.line++,e.column=0,x+1===E?(r=null,n=!1):n&&i.addMapping({source:y.source,original:{line:y.line,column:y.column},generated:{line:e.line,column:e.column},name:y.name})):e.column++}),this.walkSourceContents(function(v,y){i.setSourceContent(v,y)}),{code:e.code,map:i}};Dg.SourceNode=on});var Mc=st(Pc=>{"use strict";Pc.SourceMapGenerator=Pm().SourceMapGenerator;Pc.SourceMapConsumer=Ig().SourceMapConsumer;Pc.SourceNode=Tg().SourceNode});var Tm=st(()=>{"use strict"});var Fg=st(()=>{"use strict"});var km=st((iK,Vg)=>{"use strict";var{existsSync:Zx,readFileSync:Qx}=Fg(),{dirname:Fm,join:Kx}=bc(),{SourceMapConsumer:kg,SourceMapGenerator:Og}=Mc();function Yx(o){return Buffer?Buffer.from(o,"base64").toString():window.atob(o)}var ja=class{constructor(t,e){if(e.map===!1)return;this.loadAnnotation(t),this.inline=this.startWith(this.annotation,"data:");let i=e.map?e.map.prev:void 0,n=this.loadMap(e.from,i);!this.mapFile&&e.from&&(this.mapFile=e.from),this.mapFile&&(this.root=Fm(this.mapFile)),n&&(this.text=n)}consumer(){return this.consumerCache||(this.consumerCache=new kg(this.text)),this.consumerCache}decodeInline(t){let e=/^data:application\/json;charset=utf-?8;base64,/,i=/^data:application\/json;base64,/,n=/^data:application\/json;charset=utf-?8,/,r=/^data:application\/json,/,s=t.match(n)||t.match(r);if(s)return decodeURIComponent(t.substr(s[0].length));let m=t.match(e)||t.match(i);if(m)return Yx(t.substr(m[0].length));let p=t.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+p)}getAnnotationURL(t){return t.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(t){return typeof t!="object"?!1:typeof t.mappings=="string"||typeof t._mappings=="string"||Array.isArray(t.sections)}loadAnnotation(t){let e=t.match(/\/\*\s*# sourceMappingURL=/g);if(!e)return;let i=t.lastIndexOf(e.pop()),n=t.indexOf("*/",i);i>-1&&n>-1&&(this.annotation=this.getAnnotationURL(t.substring(i,n)))}loadFile(t){if(this.root=Fm(t),Zx(t))return this.mapFile=t,Qx(t,"utf-8").toString().trim()}loadMap(t,e){if(e===!1)return!1;if(e){if(typeof e=="string")return e;if(typeof e=="function"){let i=e(t);if(i){let n=this.loadFile(i);if(!n)throw new Error("Unable to load previous source map: "+i.toString());return n}}else{if(e instanceof kg)return Og.fromSourceMap(e).toString();if(e instanceof Og)return e.toString();if(this.isMap(e))return JSON.stringify(e);throw new Error("Unsupported previous source map format: "+e.toString())}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let i=this.annotation;return t&&(i=Kx(Fm(t),i)),this.loadFile(i)}}}startWith(t,e){return t?t.substr(0,e.length)===e:!1}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}};Vg.exports=ja;ja.default=ja});var Ra=st((nK,Lg)=>{"use strict";var{nanoid:ew}=rg(),{isAbsolute:Nm,resolve:Am}=bc(),{SourceMapConsumer:tw,SourceMapGenerator:iw}=Mc(),{fileURLToPath:Ng,pathToFileURL:Ic}=Tm(),Ag=Cc(),nw=km(),Om=dm(),Vm=Symbol("lineToIndexCache"),ow=!!(tw&&iw),jg=!!(Am&&Nm);function Rg(o){if(o[Vm])return o[Vm];let t=o.css.split(`
`),e=new Array(t.length),i=0;for(let n=0,r=t.length;n<r;n++)e[n]=i,i+=t[n].length+1;return o[Vm]=e,e}var Wr=class{get from(){return this.file||this.id}constructor(t,e={}){if(t===null||typeof t>"u"||typeof t=="object"&&!t.toString)throw new Error(`PostCSS received ${t} instead of CSS string`);if(this.css=t.toString(),this.css[0]==="\uFEFF"||this.css[0]==="\uFFFE"?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,this.document=this.css,e.document&&(this.document=e.document.toString()),e.from&&(!jg||/^\w+:\/\//.test(e.from)||Nm(e.from)?this.file=e.from:this.file=Am(e.from)),jg&&ow){let i=new nw(this.css,e);if(i.text){this.map=i;let n=i.consumer().file;!this.file&&n&&(this.file=this.mapResolve(n))}}this.file||(this.id="<input css "+ew(6)+">"),this.map&&(this.map.file=this.from)}error(t,e,i,n={}){let r,s,m,p,v;if(e&&typeof e=="object"){let x=e,E=i;if(typeof x.offset=="number"){p=x.offset;let w=this.fromOffset(p);e=w.line,i=w.col}else e=x.line,i=x.column,p=this.fromLineAndColumn(e,i);if(typeof E.offset=="number"){m=E.offset;let w=this.fromOffset(m);s=w.line,r=w.col}else s=E.line,r=E.column,m=this.fromLineAndColumn(E.line,E.column)}else if(i)p=this.fromLineAndColumn(e,i);else{p=e;let x=this.fromOffset(p);e=x.line,i=x.col}let y=this.origin(e,i,s,r);return y?v=new Ag(t,y.endLine===void 0?y.line:{column:y.column,line:y.line},y.endLine===void 0?y.column:{column:y.endColumn,line:y.endLine},y.source,y.file,n.plugin):v=new Ag(t,s===void 0?e:{column:i,line:e},s===void 0?i:{column:r,line:s},this.css,this.file,n.plugin),v.input={column:i,endColumn:r,endLine:s,endOffset:m,line:e,offset:p,source:this.css},this.file&&(Ic&&(v.input.url=Ic(this.file).toString()),v.input.file=this.file),v}fromLineAndColumn(t,e){return Rg(this)[t-1]+e-1}fromOffset(t){let e=Rg(this),i=e[e.length-1],n=0;if(t>=i)n=e.length-1;else{let r=e.length-2,s;for(;n<r;)if(s=n+(r-n>>1),t<e[s])r=s-1;else if(t>=e[s+1])n=s+1;else{n=s;break}}return{col:t-e[n]+1,line:n+1}}mapResolve(t){return/^\w+:\/\//.test(t)?t:Am(this.map.consumer().sourceRoot||this.map.root||".",t)}origin(t,e,i,n){if(!this.map)return!1;let r=this.map.consumer(),s=r.originalPositionFor({column:e,line:t});if(!s.source)return!1;let m;typeof i=="number"&&(m=r.originalPositionFor({column:n,line:i}));let p;Nm(s.source)?p=Ic(s.source):p=new URL(s.source,this.map.consumer().sourceRoot||Ic(this.map.mapFile));let v={column:s.column,endColumn:m&&m.column,endLine:m&&m.line,line:s.line,url:p.toString()};if(p.protocol==="file:")if(Ng)v.file=Ng(p);else throw new Error("file: protocol is not available in this PostCSS build");let y=r.sourceContentFor(s.source);return y&&(v.source=y),v}toJSON(){let t={};for(let e of["hasBOM","css","file","id"])this[e]!=null&&(t[e]=this[e]);return this.map&&(t.map=k({},this.map),t.map.consumerCache&&(t.map.consumerCache=void 0)),t}};Lg.exports=Wr;Wr.default=Wr;Om&&Om.registerInput&&Om.registerInput(Wr)});var $r=st((rK,Wg)=>{"use strict";var Bg=Eo(),Ug,zg,Dc=(()=>{class o extends Bg{constructor(e){super(e),this.type="root",this.nodes||(this.nodes=[])}normalize(e,i,n){let r=super.normalize(e);if(i){if(n==="prepend")this.nodes.length>1?i.raws.before=this.nodes[1].raws.before:delete i.raws.before;else if(this.first!==i)for(let s of r)s.raws.before=i.raws.before}return r}removeChild(e,i){let n=this.index(e);return!i&&n===0&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[n].raws.before),super.removeChild(e)}toResult(e={}){return new Ug(new zg,this,e).stringify()}}return o.registerLazyResult=t=>{Ug=t},o.registerProcessor=t=>{zg=t},o})();Wg.exports=Dc;Dc.default=Dc;Bg.registerRoot(Dc)});var jm=st((aK,$g)=>{"use strict";var La={comma(o){return La.split(o,[","],!0)},space(o){let t=[" ",`
`,"	"];return La.split(o,t)},split(o,t,e){let i=[],n="",r=!1,s=0,m=!1,p="",v=!1;for(let y of o)v?v=!1:y==="\\"?v=!0:m?y===p&&(m=!1):y==='"'||y==="'"?(m=!0,p=y):y==="("?s+=1:y===")"?s>0&&(s-=1):s===0&&t.includes(y)&&(r=!0),r?(n!==""&&i.push(n.trim()),n="",r=!1):n+=y;return(e||n!=="")&&i.push(n.trim()),i}};$g.exports=La;La.default=La});var Tc=st((sK,Gg)=>{"use strict";var Hg=Eo(),rw=jm(),Hr=class extends Hg{get selectors(){return rw.comma(this.selector)}set selectors(t){let e=this.selector?this.selector.match(/,\s*/):null,i=e?e[0]:","+this.raw("between","beforeOpen");this.selector=t.join(i)}constructor(t){super(t),this.type="rule",this.nodes||(this.nodes=[])}};Gg.exports=Hr;Hr.default=Hr;Hg.registerRule(Hr)});var Jg=st((lK,qg)=>{"use strict";var aw=vc(),sw=Ta(),lw=ka(),cw=Ra(),dw=km(),mw=$r(),pw=Tc();function Ua(o,t){if(Array.isArray(o))return o.map(s=>Ua(s));let n=o,{inputs:e}=n,i=qn(n,["inputs"]);if(e){t=[];for(let s of e){let m=re(k({},s),{__proto__:cw.prototype});m.map&&(m.map=re(k({},m.map),{__proto__:dw.prototype})),t.push(m)}}if(i.nodes&&(i.nodes=o.nodes.map(s=>Ua(s,t))),i.source){let r=i.source,{inputId:s}=r,m=qn(r,["inputId"]);i.source=m,s!=null&&(i.source.input=t[s])}if(i.type==="root")return new mw(i);if(i.type==="decl")return new lw(i);if(i.type==="rule")return new pw(i);if(i.type==="comment")return new sw(i);if(i.type==="atrule")return new aw(i);throw new Error("Unknown node type: "+o.type)}qg.exports=Ua;Ua.default=Ua});var Lm=st((dK,e0)=>{"use strict";var{dirname:Fc,relative:Zg,resolve:Qg,sep:Kg}=bc(),{SourceMapConsumer:Yg,SourceMapGenerator:kc}=Mc(),{pathToFileURL:Xg}=Tm(),uw=Ra(),fw=!!(Yg&&kc),hw=!!(Fc&&Qg&&Zg&&Kg),Rm=class{constructor(t,e,i,n){this.stringify=t,this.mapOpts=i.map||{},this.root=e,this.opts=i,this.css=n,this.originalCSS=n,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let t;this.isInline()?t="data:application/json;base64,"+this.toBase64(this.map.toString()):typeof this.mapOpts.annotation=="string"?t=this.mapOpts.annotation:typeof this.mapOpts.annotation=="function"?t=this.mapOpts.annotation(this.opts.to,this.root):t=this.outputFile()+".map";let e=`
`;this.css.includes(`\r
`)&&(e=`\r
`),this.css+=e+"/*# sourceMappingURL="+t+" */"}applyPrevMaps(){for(let t of this.previous()){let e=this.toUrl(this.path(t.file)),i=t.root||Fc(t.file),n;this.mapOpts.sourcesContent===!1?(n=new Yg(t.text),n.sourcesContent&&(n.sourcesContent=null)):n=t.consumer(),this.map.applySourceMap(n,e,this.toUrl(this.path(i)))}}clearAnnotation(){if(this.mapOpts.annotation!==!1)if(this.root){let t;for(let e=this.root.nodes.length-1;e>=0;e--)t=this.root.nodes[e],t.type==="comment"&&t.text.startsWith("# sourceMappingURL=")&&this.root.removeChild(e)}else this.css&&(this.css=this.css.replace(/\n*\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),hw&&fw&&this.isMap())return this.generateMap();{let t="";return this.stringify(this.root,e=>{t+=e}),[t]}}generateMap(){if(this.root)this.generateString();else if(this.previous().length===1){let t=this.previous()[0].consumer();t.file=this.outputFile(),this.map=kc.fromSourceMap(t,{ignoreInvalidMapping:!0})}else this.map=new kc({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new kc({file:this.outputFile(),ignoreInvalidMapping:!0});let t=1,e=1,i="<no source>",n={generated:{column:0,line:0},original:{column:0,line:0},source:""},r,s;this.stringify(this.root,(m,p,v)=>{if(this.css+=m,p&&v!=="end"&&(n.generated.line=t,n.generated.column=e-1,p.source&&p.source.start?(n.source=this.sourcePath(p),n.original.line=p.source.start.line,n.original.column=p.source.start.column-1,this.map.addMapping(n)):(n.source=i,n.original.line=1,n.original.column=0,this.map.addMapping(n))),s=m.match(/\n/g),s?(t+=s.length,r=m.lastIndexOf(`
`),e=m.length-r):e+=m.length,p&&v!=="start"){let y=p.parent||{raws:{}};(!(p.type==="decl"||p.type==="atrule"&&!p.nodes)||p!==y.last||y.raws.semicolon)&&(p.source&&p.source.end?(n.source=this.sourcePath(p),n.original.line=p.source.end.line,n.original.column=p.source.end.column-1,n.generated.line=t,n.generated.column=e-2,this.map.addMapping(n)):(n.source=i,n.original.line=1,n.original.column=0,n.generated.line=t,n.generated.column=e-1,this.map.addMapping(n)))}})}isAnnotation(){return this.isInline()?!0:typeof this.mapOpts.annotation<"u"?this.mapOpts.annotation:this.previous().length?this.previous().some(t=>t.annotation):!0}isInline(){if(typeof this.mapOpts.inline<"u")return this.mapOpts.inline;let t=this.mapOpts.annotation;return typeof t<"u"&&t!==!0?!1:this.previous().length?this.previous().some(e=>e.inline):!0}isMap(){return typeof this.opts.map<"u"?!!this.opts.map:this.previous().length>0}isSourcesContent(){return typeof this.mapOpts.sourcesContent<"u"?this.mapOpts.sourcesContent:this.previous().length?this.previous().some(t=>t.withContent()):!0}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(t){if(this.mapOpts.absolute||t.charCodeAt(0)===60||/^\w+:\/\//.test(t))return t;let e=this.memoizedPaths.get(t);if(e)return e;let i=this.opts.to?Fc(this.opts.to):".";typeof this.mapOpts.annotation=="string"&&(i=Fc(Qg(i,this.mapOpts.annotation)));let n=Zg(i,t);return this.memoizedPaths.set(t,n),n}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(t=>{if(t.source&&t.source.input.map){let e=t.source.input.map;this.previousMaps.includes(e)||this.previousMaps.push(e)}});else{let t=new uw(this.originalCSS,this.opts);t.map&&this.previousMaps.push(t.map)}return this.previousMaps}setSourcesContent(){let t={};if(this.root)this.root.walk(e=>{if(e.source){let i=e.source.input.from;if(i&&!t[i]){t[i]=!0;let n=this.usesFileUrls?this.toFileUrl(i):this.toUrl(this.path(i));this.map.setSourceContent(n,e.source.input.css)}}});else if(this.css){let e=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(e,this.css)}}sourcePath(t){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(t.source.input.from):this.toUrl(this.path(t.source.input.from))}toBase64(t){return Buffer?Buffer.from(t).toString("base64"):window.btoa(unescape(encodeURIComponent(t)))}toFileUrl(t){let e=this.memoizedFileURLs.get(t);if(e)return e;if(Xg){let i=Xg(t).toString();return this.memoizedFileURLs.set(t,i),i}else throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(t){let e=this.memoizedURLs.get(t);if(e)return e;Kg==="\\"&&(t=t.replace(/\\/g,"/"));let i=encodeURI(t).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(t,i),i}};e0.exports=Rm});var n0=st((mK,i0)=>{"use strict";var Oc=/[\t\n\f\r "#'()/;[\\\]{}]/g,Vc=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,gw=/.[\r\n"'(/\\]/,t0=/[\da-f]/i;i0.exports=function(t,e={}){let i=t.css.valueOf(),n=e.ignoreErrors,r,s,m,p,v,y,x,E,w,O,F=i.length,V=0,L=[],B=[];function z(){return V}function Q(ye){throw t.error("Unclosed "+ye,V)}function K(){return B.length===0&&V>=F}function fe(ye){if(B.length)return B.pop();if(V>=F)return;let qe=ye?ye.ignoreUnclosed:!1;switch(r=i.charCodeAt(V),r){case 10:case 32:case 9:case 13:case 12:{p=V;do p+=1,r=i.charCodeAt(p);while(r===32||r===10||r===9||r===13||r===12);y=["space",i.slice(V,p)],V=p-1;break}case 91:case 93:case 123:case 125:case 58:case 59:case 41:{let U=String.fromCharCode(r);y=[U,U,V];break}case 40:{if(O=L.length?L.pop()[1]:"",w=i.charCodeAt(V+1),O==="url"&&w!==39&&w!==34&&w!==32&&w!==10&&w!==9&&w!==12&&w!==13){p=V;do{if(x=!1,p=i.indexOf(")",p+1),p===-1)if(n||qe){p=V;break}else Q("bracket");for(E=p;i.charCodeAt(E-1)===92;)E-=1,x=!x}while(x);y=["brackets",i.slice(V,p+1),V,p],V=p}else p=i.indexOf(")",V+1),s=i.slice(V,p+1),p===-1||gw.test(s)?y=["(","(",V]:(y=["brackets",s,V,p],V=p);break}case 39:case 34:{v=r===39?"'":'"',p=V;do{if(x=!1,p=i.indexOf(v,p+1),p===-1)if(n||qe){p=V+1;break}else Q("string");for(E=p;i.charCodeAt(E-1)===92;)E-=1,x=!x}while(x);y=["string",i.slice(V,p+1),V,p],V=p;break}case 64:{Oc.lastIndex=V+1,Oc.test(i),Oc.lastIndex===0?p=i.length-1:p=Oc.lastIndex-2,y=["at-word",i.slice(V,p+1),V,p],V=p;break}case 92:{for(p=V,m=!0;i.charCodeAt(p+1)===92;)p+=1,m=!m;if(r=i.charCodeAt(p+1),m&&r!==47&&r!==32&&r!==10&&r!==9&&r!==13&&r!==12&&(p+=1,t0.test(i.charAt(p)))){for(;t0.test(i.charAt(p+1));)p+=1;i.charCodeAt(p+1)===32&&(p+=1)}y=["word",i.slice(V,p+1),V,p],V=p;break}default:{r===47&&i.charCodeAt(V+1)===42?(p=i.indexOf("*/",V+2)+1,p===0&&(n||qe?p=i.length:Q("comment")),y=["comment",i.slice(V,p+1),V,p],V=p):(Vc.lastIndex=V+1,Vc.test(i),Vc.lastIndex===0?p=i.length-1:p=Vc.lastIndex-2,y=["word",i.slice(V,p+1),V,p],L.push(y),V=p);break}}return V++,y}function ae(ye){B.push(ye)}return{back:ae,endOfFile:K,nextToken:fe,position:z}}});var s0=st((pK,a0)=>{"use strict";var Cw=vc(),_w=Ta(),vw=ka(),yw=$r(),o0=Tc(),bw=n0(),r0={empty:!0,space:!0};function xw(o){for(let t=o.length-1;t>=0;t--){let e=o[t],i=e[3]||e[2];if(i)return i}}var Um=class{constructor(t){this.input=t,this.root=new yw,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:t,start:{column:1,line:1,offset:0}}}atrule(t){let e=new Cw;e.name=t[1].slice(1),e.name===""&&this.unnamedAtrule(e,t),this.init(e,t[2]);let i,n,r,s=!1,m=!1,p=[],v=[];for(;!this.tokenizer.endOfFile();){if(t=this.tokenizer.nextToken(),i=t[0],i==="("||i==="["?v.push(i==="("?")":"]"):i==="{"&&v.length>0?v.push("}"):i===v[v.length-1]&&v.pop(),v.length===0)if(i===";"){e.source.end=this.getPosition(t[2]),e.source.end.offset++,this.semicolon=!0;break}else if(i==="{"){m=!0;break}else if(i==="}"){if(p.length>0){for(r=p.length-1,n=p[r];n&&n[0]==="space";)n=p[--r];n&&(e.source.end=this.getPosition(n[3]||n[2]),e.source.end.offset++)}this.end(t);break}else p.push(t);else p.push(t);if(this.tokenizer.endOfFile()){s=!0;break}}e.raws.between=this.spacesAndCommentsFromEnd(p),p.length?(e.raws.afterName=this.spacesAndCommentsFromStart(p),this.raw(e,"params",p),s&&(t=p[p.length-1],e.source.end=this.getPosition(t[3]||t[2]),e.source.end.offset++,this.spaces=e.raws.between,e.raws.between="")):(e.raws.afterName="",e.params=""),m&&(e.nodes=[],this.current=e)}checkMissedSemicolon(t){let e=this.colon(t);if(e===!1)return;let i=0,n;for(let r=e-1;r>=0&&(n=t[r],!(n[0]!=="space"&&(i+=1,i===2)));r--);throw this.input.error("Missed semicolon",n[0]==="word"?n[3]+1:n[2])}colon(t){let e=0,i,n,r;for(let[s,m]of t.entries()){if(n=m,r=n[0],r==="("&&(e+=1),r===")"&&(e-=1),e===0&&r===":")if(!i)this.doubleColon(n);else{if(i[0]==="word"&&i[1]==="progid")continue;return s}i=n}return!1}comment(t){let e=new _w;this.init(e,t[2]),e.source.end=this.getPosition(t[3]||t[2]),e.source.end.offset++;let i=t[1].slice(2,-2);if(/^\s*$/.test(i))e.text="",e.raws.left=i,e.raws.right="";else{let n=i.match(/^(\s*)([^]*\S)(\s*)$/);e.text=n[2],e.raws.left=n[1],e.raws.right=n[3]}}createTokenizer(){this.tokenizer=bw(this.input)}decl(t,e){let i=new vw;this.init(i,t[0][2]);let n=t[t.length-1];for(n[0]===";"&&(this.semicolon=!0,t.pop()),i.source.end=this.getPosition(n[3]||n[2]||xw(t)),i.source.end.offset++;t[0][0]!=="word";)t.length===1&&this.unknownWord(t),i.raws.before+=t.shift()[1];for(i.source.start=this.getPosition(t[0][2]),i.prop="";t.length;){let v=t[0][0];if(v===":"||v==="space"||v==="comment")break;i.prop+=t.shift()[1]}i.raws.between="";let r;for(;t.length;)if(r=t.shift(),r[0]===":"){i.raws.between+=r[1];break}else r[0]==="word"&&/\w/.test(r[1])&&this.unknownWord([r]),i.raws.between+=r[1];(i.prop[0]==="_"||i.prop[0]==="*")&&(i.raws.before+=i.prop[0],i.prop=i.prop.slice(1));let s=[],m;for(;t.length&&(m=t[0][0],!(m!=="space"&&m!=="comment"));)s.push(t.shift());this.precheckMissedSemicolon(t);for(let v=t.length-1;v>=0;v--){if(r=t[v],r[1].toLowerCase()==="!important"){i.important=!0;let y=this.stringFrom(t,v);y=this.spacesFromEnd(t)+y,y!==" !important"&&(i.raws.important=y);break}else if(r[1].toLowerCase()==="important"){let y=t.slice(0),x="";for(let E=v;E>0;E--){let w=y[E][0];if(x.trim().startsWith("!")&&w!=="space")break;x=y.pop()[1]+x}x.trim().startsWith("!")&&(i.important=!0,i.raws.important=x,t=y)}if(r[0]!=="space"&&r[0]!=="comment")break}t.some(v=>v[0]!=="space"&&v[0]!=="comment")&&(i.raws.between+=s.map(v=>v[1]).join(""),s=[]),this.raw(i,"value",s.concat(t),e),i.value.includes(":")&&!e&&this.checkMissedSemicolon(t)}doubleColon(t){throw this.input.error("Double colon",{offset:t[2]},{offset:t[2]+t[1].length})}emptyRule(t){let e=new o0;this.init(e,t[2]),e.selector="",e.raws.between="",this.current=e}end(t){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(t[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(t)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(t){if(this.spaces+=t[1],this.current.nodes){let e=this.current.nodes[this.current.nodes.length-1];e&&e.type==="rule"&&!e.raws.ownSemicolon&&(e.raws.ownSemicolon=this.spaces,this.spaces="",e.source.end=this.getPosition(t[2]),e.source.end.offset+=e.raws.ownSemicolon.length)}}getPosition(t){let e=this.input.fromOffset(t);return{column:e.col,line:e.line,offset:t}}init(t,e){this.current.push(t),t.source={input:this.input,start:this.getPosition(e)},t.raws.before=this.spaces,this.spaces="",t.type!=="comment"&&(this.semicolon=!1)}other(t){let e=!1,i=null,n=!1,r=null,s=[],m=t[1].startsWith("--"),p=[],v=t;for(;v;){if(i=v[0],p.push(v),i==="("||i==="[")r||(r=v),s.push(i==="("?")":"]");else if(m&&n&&i==="{")r||(r=v),s.push("}");else if(s.length===0)if(i===";")if(n){this.decl(p,m);return}else break;else if(i==="{"){this.rule(p);return}else if(i==="}"){this.tokenizer.back(p.pop()),e=!0;break}else i===":"&&(n=!0);else i===s[s.length-1]&&(s.pop(),s.length===0&&(r=null));v=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(e=!0),s.length>0&&this.unclosedBracket(r),e&&n){if(!m)for(;p.length&&(v=p[p.length-1][0],!(v!=="space"&&v!=="comment"));)this.tokenizer.back(p.pop());this.decl(p,m)}else this.unknownWord(p)}parse(){let t;for(;!this.tokenizer.endOfFile();)switch(t=this.tokenizer.nextToken(),t[0]){case"space":this.spaces+=t[1];break;case";":this.freeSemicolon(t);break;case"}":this.end(t);break;case"comment":this.comment(t);break;case"at-word":this.atrule(t);break;case"{":this.emptyRule(t);break;default:this.other(t);break}this.endFile()}precheckMissedSemicolon(){}raw(t,e,i,n){let r,s,m=i.length,p="",v=!0,y,x;for(let E=0;E<m;E+=1)r=i[E],s=r[0],s==="space"&&E===m-1&&!n?v=!1:s==="comment"?(x=i[E-1]?i[E-1][0]:"empty",y=i[E+1]?i[E+1][0]:"empty",!r0[x]&&!r0[y]?p.slice(-1)===","?v=!1:p+=r[1]:v=!1):p+=r[1];if(!v){let E=i.reduce((w,O)=>w+O[1],"");t.raws[e]={raw:E,value:p}}t[e]=p}rule(t){t.pop();let e=new o0;this.init(e,t[0][2]),e.raws.between=this.spacesAndCommentsFromEnd(t),this.raw(e,"selector",t),this.current=e}spacesAndCommentsFromEnd(t){let e,i="";for(;t.length&&(e=t[t.length-1][0],!(e!=="space"&&e!=="comment"));)i=t.pop()[1]+i;return i}spacesAndCommentsFromStart(t){let e,i="";for(;t.length&&(e=t[0][0],!(e!=="space"&&e!=="comment"));)i+=t.shift()[1];return i}spacesFromEnd(t){let e,i="";for(;t.length&&(e=t[t.length-1][0],e==="space");)i=t.pop()[1]+i;return i}stringFrom(t,e){let i="";for(let n=e;n<t.length;n++)i+=t[n][1];return t.splice(e,t.length-e),i}unclosedBlock(){let t=this.current.source.start;throw this.input.error("Unclosed block",t.line,t.column)}unclosedBracket(t){throw this.input.error("Unclosed bracket",{offset:t[2]},{offset:t[2]+1})}unexpectedClose(t){throw this.input.error("Unexpected }",{offset:t[2]},{offset:t[2]+1})}unknownWord(t){throw this.input.error("Unknown word "+t[0][1],{offset:t[0][2]},{offset:t[0][2]+t[0][1].length})}unnamedAtrule(t,e){throw this.input.error("At-rule without name",{offset:e[2]},{offset:e[2]+e[1].length})}};a0.exports=Um});var Ac=st((uK,l0)=>{"use strict";var ww=Eo(),Sw=Ra(),Ew=s0();function Nc(o,t){let e=new Sw(o,t),i=new Ew(e);try{i.parse()}catch(n){throw n}return i.root}l0.exports=Nc;Nc.default=Nc;ww.registerParse(Nc)});var zm=st((fK,c0)=>{"use strict";var za=class{constructor(t,e={}){if(this.type="warning",this.text=t,e.node&&e.node.source){let i=e.node.rangeBy(e);this.line=i.start.line,this.column=i.start.column,this.endLine=i.end.line,this.endColumn=i.end.column}for(let i in e)this[i]=e[i]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}};c0.exports=za;za.default=za});var jc=st((hK,d0)=>{"use strict";var Pw=zm(),Ba=class{get content(){return this.css}constructor(t,e,i){this.processor=t,this.messages=[],this.root=e,this.opts=i,this.css="",this.map=void 0}toString(){return this.css}warn(t,e={}){e.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(e.plugin=this.lastPlugin.postcssPlugin);let i=new Pw(t,e);return this.messages.push(i),i}warnings(){return this.messages.filter(t=>t.type==="warning")}};d0.exports=Ba;Ba.default=Ba});var Bm=st((gK,p0)=>{"use strict";var m0={};p0.exports=function(t){m0[t]||(m0[t]=!0,typeof console<"u"&&console.warn&&console.warn(t))}});var Hm=st((_K,g0)=>{"use strict";var Mw=Eo(),Iw=yc(),Dw=Lm(),Tw=Ac(),u0=jc(),Fw=$r(),kw=Ea(),{isClean:Wn,my:Ow}=_c(),CK=Bm(),Vw={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},Nw={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},Aw={Once:!0,postcssPlugin:!0,prepare:!0},Gr=0;function Wa(o){return typeof o=="object"&&typeof o.then=="function"}function h0(o){let t=!1,e=Vw[o.type];return o.type==="decl"?t=o.prop.toLowerCase():o.type==="atrule"&&(t=o.name.toLowerCase()),t&&o.append?[e,e+"-"+t,Gr,e+"Exit",e+"Exit-"+t]:t?[e,e+"-"+t,e+"Exit",e+"Exit-"+t]:o.append?[e,Gr,e+"Exit"]:[e,e+"Exit"]}function f0(o){let t;return o.type==="document"?t=["Document",Gr,"DocumentExit"]:o.type==="root"?t=["Root",Gr,"RootExit"]:t=h0(o),{eventIndex:0,events:t,iterator:0,node:o,visitorIndex:0,visitors:[]}}function $m(o){return o[Wn]=!1,o.nodes&&o.nodes.forEach(t=>$m(t)),o}var Wm={},$a=(()=>{class o{get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}constructor(e,i,n){this.stringified=!1,this.processed=!1;let r;if(typeof i=="object"&&i!==null&&(i.type==="root"||i.type==="document"))r=$m(i);else if(i instanceof o||i instanceof u0)r=$m(i.root),i.map&&(typeof n.map>"u"&&(n.map={}),n.map.inline||(n.map.inline=!1),n.map.prev=i.map);else{let s=Tw;n.syntax&&(s=n.syntax.parse),n.parser&&(s=n.parser),s.parse&&(s=s.parse);try{r=s(i,n)}catch(m){this.processed=!0,this.error=m}r&&!r[Ow]&&Mw.rebuild(r)}this.result=new u0(e,r,n),this.helpers=re(k({},Wm),{postcss:Wm,result:this.result}),this.plugins=this.processor.plugins.map(s=>typeof s=="object"&&s.prepare?k(k({},s),s.prepare(this.result)):s)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(e){return this.async().catch(e)}finally(e){return this.async().then(e,e)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(e,i){let n=this.result.lastPlugin;try{i&&i.addToError(e),this.error=e,e.name==="CssSyntaxError"&&!e.plugin?(e.plugin=n.postcssPlugin,e.setMessage()):n.postcssVersion}catch(r){console&&console.error&&console.error(r)}return e}prepareVisitors(){this.listeners={};let e=(i,n,r)=>{this.listeners[n]||(this.listeners[n]=[]),this.listeners[n].push([i,r])};for(let i of this.plugins)if(typeof i=="object")for(let n in i){if(!Nw[n]&&/^[A-Z]/.test(n))throw new Error(`Unknown event ${n} in ${i.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!Aw[n])if(typeof i[n]=="object")for(let r in i[n])r==="*"?e(i,n,i[n][r]):e(i,n+"-"+r.toLowerCase(),i[n][r]);else typeof i[n]=="function"&&e(i,n,i[n])}this.hasListener=Object.keys(this.listeners).length>0}runAsync(){return P(this,null,function*(){this.plugin=0;for(let e=0;e<this.plugins.length;e++){let i=this.plugins[e],n=this.runOnRoot(i);if(Wa(n))try{yield n}catch(r){throw this.handleError(r)}}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[Wn];){e[Wn]=!0;let i=[f0(e)];for(;i.length>0;){let n=this.visitTick(i);if(Wa(n))try{yield n}catch(r){let s=i[i.length-1].node;throw this.handleError(r,s)}}}if(this.listeners.OnceExit)for(let[i,n]of this.listeners.OnceExit){this.result.lastPlugin=i;try{if(e.type==="document"){let r=e.nodes.map(s=>n(s,this.helpers));yield Promise.all(r)}else yield n(e,this.helpers)}catch(r){throw this.handleError(r)}}}return this.processed=!0,this.stringify()})}runOnRoot(e){this.result.lastPlugin=e;try{if(typeof e=="object"&&e.Once){if(this.result.root.type==="document"){let i=this.result.root.nodes.map(n=>e.Once(n,this.helpers));return Wa(i[0])?Promise.all(i):i}return e.Once(this.result.root,this.helpers)}else if(typeof e=="function")return e(this.result.root,this.result)}catch(i){throw this.handleError(i)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let e=this.result.opts,i=kw;e.syntax&&(i=e.syntax.stringify),e.stringifier&&(i=e.stringifier),i.stringify&&(i=i.stringify);let r=new Dw(i,this.result.root,this.result.opts).generate();return this.result.css=r[0],this.result.map=r[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let e of this.plugins){let i=this.runOnRoot(e);if(Wa(i))throw this.getAsyncError()}if(this.prepareVisitors(),this.hasListener){let e=this.result.root;for(;!e[Wn];)e[Wn]=!0,this.walkSync(e);if(this.listeners.OnceExit)if(e.type==="document")for(let i of e.nodes)this.visitSync(this.listeners.OnceExit,i);else this.visitSync(this.listeners.OnceExit,e)}return this.result}then(e,i){return this.async().then(e,i)}toString(){return this.css}visitSync(e,i){for(let[n,r]of e){this.result.lastPlugin=n;let s;try{s=r(i,this.helpers)}catch(m){throw this.handleError(m,i.proxyOf)}if(i.type!=="root"&&i.type!=="document"&&!i.parent)return!0;if(Wa(s))throw this.getAsyncError()}}visitTick(e){let i=e[e.length-1],{node:n,visitors:r}=i;if(n.type!=="root"&&n.type!=="document"&&!n.parent){e.pop();return}if(r.length>0&&i.visitorIndex<r.length){let[m,p]=r[i.visitorIndex];i.visitorIndex+=1,i.visitorIndex===r.length&&(i.visitors=[],i.visitorIndex=0),this.result.lastPlugin=m;try{return p(n.toProxy(),this.helpers)}catch(v){throw this.handleError(v,n)}}if(i.iterator!==0){let m=i.iterator,p;for(;p=n.nodes[n.indexes[m]];)if(n.indexes[m]+=1,!p[Wn]){p[Wn]=!0,e.push(f0(p));return}i.iterator=0,delete n.indexes[m]}let s=i.events;for(;i.eventIndex<s.length;){let m=s[i.eventIndex];if(i.eventIndex+=1,m===Gr){n.nodes&&n.nodes.length&&(n[Wn]=!0,i.iterator=n.getIterator());return}else if(this.listeners[m]){i.visitors=this.listeners[m];return}}e.pop()}walkSync(e){e[Wn]=!0;let i=h0(e);for(let n of i)if(n===Gr)e.nodes&&e.each(r=>{r[Wn]||this.walkSync(r)});else{let r=this.listeners[n];if(r&&this.visitSync(r,e.toProxy()))return}}warnings(){return this.sync().warnings()}}return o.registerPostcss=t=>{Wm=t},o})();g0.exports=$a;$a.default=$a;Fw.registerLazyResult($a);Iw.registerLazyResult($a)});var _0=st((bK,C0)=>{"use strict";var jw=Lm(),Rw=Ac(),Lw=jc(),Uw=Ea(),yK=Bm(),Ha=class{get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let t,e=Rw;try{t=e(this._css,this._opts)}catch(i){this.error=i}if(this.error)throw this.error;return this._root=t,t}get[Symbol.toStringTag](){return"NoWorkResult"}constructor(t,e,i){e=e.toString(),this.stringified=!1,this._processor=t,this._css=e,this._opts=i,this._map=void 0;let n,r=Uw;this.result=new Lw(this._processor,n,this._opts),this.result.css=e;let s=this;Object.defineProperty(this.result,"root",{get(){return s.root}});let m=new jw(r,n,this._opts,e);if(m.isMap()){let[p,v]=m.generate();p&&(this.result.css=p),v&&(this.result.map=v)}else m.clearAnnotation(),this.result.css=m.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(t){return this.async().catch(t)}finally(t){return this.async().then(t,t)}sync(){if(this.error)throw this.error;return this.result}then(t,e){return this.async().then(t,e)}toString(){return this._css}warnings(){return[]}};C0.exports=Ha;Ha.default=Ha});var y0=st((xK,v0)=>{"use strict";var zw=yc(),Bw=Hm(),Ww=_0(),$w=$r(),Zo=class{constructor(t=[]){this.version="8.5.6",this.plugins=this.normalize(t)}normalize(t){let e=[];for(let i of t)if(i.postcss===!0?i=i():i.postcss&&(i=i.postcss),typeof i=="object"&&Array.isArray(i.plugins))e=e.concat(i.plugins);else if(typeof i=="object"&&i.postcssPlugin)e.push(i);else if(typeof i=="function")e.push(i);else if(!(typeof i=="object"&&(i.parse||i.stringify)))throw new Error(i+" is not a PostCSS plugin");return e}process(t,e={}){return!this.plugins.length&&!e.parser&&!e.stringifier&&!e.syntax?new Ww(this,t,e):new Bw(this,t,e)}use(t){return this.plugins=this.plugins.concat(this.normalize([t])),this}};v0.exports=Zo;Zo.default=Zo;$w.registerProcessor(Zo);zw.registerProcessor(Zo)});var I0=st((wK,M0)=>{"use strict";var b0=vc(),x0=Ta(),Hw=Eo(),Gw=Cc(),w0=ka(),S0=yc(),qw=Jg(),Jw=Ra(),Xw=Hm(),Zw=jm(),Qw=Ia(),Kw=Ac(),Gm=y0(),Yw=jc(),E0=$r(),P0=Tc(),eS=Ea(),tS=zm();function Rt(...o){return o.length===1&&Array.isArray(o[0])&&(o=o[0]),new Gm(o)}Rt.plugin=function(t,e){let i=!1;function n(...s){console&&console.warn&&!i&&(i=!0,console.warn(t+`: postcss.plugin was deprecated. Migration guide:
https://evilmartians.com/chronicles/postcss-8-plugin-migration`),process.env.LANG&&process.env.LANG.startsWith("cn")&&console.warn(t+`: \u91CC\u9762 postcss.plugin \u88AB\u5F03\u7528. \u8FC1\u79FB\u6307\u5357:
https://www.w3ctech.com/topic/2226`));let m=e(...s);return m.postcssPlugin=t,m.postcssVersion=new Gm().version,m}let r;return Object.defineProperty(n,"postcss",{get(){return r||(r=n()),r}}),n.process=function(s,m,p){return Rt([n(p)]).process(s,m)},n};Rt.stringify=eS;Rt.parse=Kw;Rt.fromJSON=qw;Rt.list=Zw;Rt.comment=o=>new x0(o);Rt.atRule=o=>new b0(o);Rt.decl=o=>new w0(o);Rt.rule=o=>new P0(o);Rt.root=o=>new E0(o);Rt.document=o=>new S0(o);Rt.CssSyntaxError=Gw;Rt.Declaration=w0;Rt.Container=Hw;Rt.Processor=Gm;Rt.Document=S0;Rt.Comment=x0;Rt.Warning=tS;Rt.AtRule=b0;Rt.Result=Yw;Rt.Input=Jw;Rt.Rule=P0;Rt.Root=E0;Rt.Node=Qw;Xw.registerPostcss(Rt);M0.exports=Rt;Rt.default=Rt});function L0(o,t){if(o&1){let e=M();_t(0,"button",1),hi("click",function(){g(e);let n=d();return C(n.openRoles())}),ii(1,"img",2),_t(2,"span",3),u(3),Ft()()}if(o&2){d();let e=bp(0);c(3),W(e=="root"?"Due\xF1o":e)}}var Xs=class o{authService=b(xe);roleNavigationService=b(Op);addClass="";roleChange=Oe();constructor(){yt(t=>{let e=this.roleNavigationService.roleChange.subscribe(i=>{this.roleChange.emit(i)});t(()=>{e.unsubscribe()})})}openRoles(){this.roleNavigationService.openRoles()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-nav-rol"]],inputs:{addClass:"addClass"},outputs:{roleChange:"roleChange"},decls:2,vars:2,consts:[["type","button",1,"d-flex","form-select","gap-1","align-items-center",2,"font-size","15px","padding-right","2rem"],["type","button",1,"d-flex","form-select","gap-1","align-items-center",2,"font-size","15px","padding-right","2rem",3,"click"],["src","https://cdn-icons-png.flaticon.com/512/10307/10307344.png","alt",""],[1,"label"]],template:function(e,i){if(e&1&&(vp(0),D(1,L0,4,1,"button",0)),e&2){let n=yp(i.authService.userData.rol);c(),T(n!=null?1:-1)}},dependencies:[Ke],styles:["img[_ngcontent-%COMP%]{width:20px;height:auto}"]})};var z0=o=>({all:o}),Zs=class o{authService=b(xe);base=Le.isMultipleSystem?`${Le.sistema}/${this.authService.userData.rol}`:`${this.authService.userData.rol}`;router=b(ln);all=!1;ngOnInit(){return P(this,null,function*(){this.router.events.subscribe(t=>{t instanceof Dp&&(this.all=t.url.includes("design"))}),this.router.url.includes("design")&&(this.all=!0)})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-home"]],decls:11,vars:3,consts:[[1,"navbar","navbar-expand-lg","navbar-main"],["type","button","data-toggle","collapse","data-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent",1,"collapse","navbar-collapse","px-1"],[1,"navbar-nav","me-auto"],[1,"navbar-nav","gap-1"],["id","intro_usuario"],[1,"main-panel",3,"ngClass"]],template:function(e,i){e&1&&(l(0,"nav",0)(1,"button",1),_(2,"span",2),a(),l(3,"div",3)(4,"ul",4),_(5,"app-nav-user"),a(),l(6,"ul",5),_(7,"app-nav-rol")(8,"app-nav-user-data",6),a()()(),l(9,"main",7),_(10,"router-outlet"),a()),e&2&&(c(9),f("ngClass",te(1,z0,i.all)))},dependencies:[_i,be,cs,oo,Np,Xs,Vp],styles:[".main-panel[_ngcontent-%COMP%]{height:calc(100vh - var(--h-navbar));overflow:auto;position:relative;flex-grow:1}.main-panel.all[_ngcontent-%COMP%]{position:absolute;inset:0;height:100vh}"]})};var Qs=class o{authService=b(xe);base=Le.isMultipleSystem?`${Le.sistema}/${this.authService.userData.rol}`:`${this.authService.userData.rol}`;routerActive=b(Wi);project_id="";static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-web-design-page"]],features:[we([Te({lucideEye:su,lucidePencilRuler:Us,lucideSave:ro})])],decls:1,vars:0,template:function(e,i){e&1&&_(0,"router-outlet")},dependencies:[oo],styles:["[_nghost-%COMP%]{height:100vh;height:100dvh;background:var(--bg);display:block}.design[_ngcontent-%COMP%]{height:calc(100vh - var(--h-navbar))}.panel[_ngcontent-%COMP%]{height:100%}"]})};var ur=(n=>(n.INREVIEW="3",n.CONSTRUCTION="2",n.PUBLISHED="1",n.CANCELED="0",n))(ur||{});var Pi=class o{API=`${Le.web_maker}/project`;apiService=b(Lt);loadingService=b(Yt);confirmationService=b(ft);auth=b(xe);toastrService=b(tt);states=[{code:"1",denomination:"Publicado",background:"#000",color:"#fff"},{code:"2",denomination:"Construcci\xF3n",background:"#000",color:"#fff"},{code:"3",denomination:"En revisi\xF3n",background:"#000",color:"#fff"},{code:"0",denomination:"Anulado",background:"#000",color:"#fff"}];stateMap=this.states.reduce((t,e)=>(t[e.code]={label:e.denomination,background:e.background,color:e.color,code:e.code},t),{});canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.canAdd=this.auth.hasSubPermission("project-ADD"),this.canEdit=this.auth.hasSubPermission("project-EDIT"),this.canRemove=this.auth.hasSubPermission("project-REMOVE"),this.canChangeState=this.auth.hasSubPermission("project-CHANGE-STATE"),this.canExport=this.auth.hasPermission("project-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("project-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("project-EXPORT-PDF")}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}shared(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/shared`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}init(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/init/${t.id}`,t)})}initCmsPage(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/init-cms/${t.id}`,t)})}pageSave(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/page-save/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}pageCmsSave(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/page-cms-save/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}makeProject(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/makeProject/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}patch(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}updateFavicon(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/favicon/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}duplicate(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/duplicate/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}changeState(t){return P(this,null,function*(){let e=this.stateMap[t.state],i="";switch(t.state){case"1":i="text-success";break;case"0":i="text-danger";break}let n=`
            <div class="text-center">
                <div class="mb-3">\xBFEst\xE1 seguro de cambiar el estado del registro?</div>
                <h3 >Nuevo estado: <b class="${i}">${e}</b></h3>
            </div>
        `;if(!(yield this.confirmationService.create("Confirmar",n)))return;this.loadingService.open();let s=yield this.apiService.putPrivate(`${this.API}/state/change/${t.id}`,t);return this.loadingService.hide(),s})}delete(t){return P(this,null,function*(){return this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,t)})}export(t,e){return P(this,null,function*(){if(!(yield this.confirmationService.create("Confirmar","\xBFEst\xE1 seguro de exportar los datos?")))return;this.loadingService.open();let n=re(k({},t),{type_export:e,url:Le.production?Le.storage:Le.storage}),r=yield this.apiService.getPrivate(`${this.API}/export`,n);return this.loadingService.hide(),r&&r.state=="success"&&window.open(r.url),r})}setMainPage(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/mainpage/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var B0=o=>({active:o}),Ks=class o{item={};isActived=!1;card="box";auth=b(xe);base=this.auth.projectPath();openMenu=new q;openMenuEmit(t){this.openMenu.emit(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-project-card"]],inputs:{item:"item",isActived:"isActived",card:"card"},outputs:{openMenu:"openMenu"},decls:11,vars:8,consts:[[1,"items",3,"ngClass"],[1,"item-info"],[1,"d-flex","flex-column"],[1,"text-truncate"],["app-button","","color","light",1,"mt-3",3,"routerLink"],["type","button",1,"btn","btn-more",2,"position","absolute","top","0","right","0",3,"click"],[1,"icon","ion-md-more"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"b",3),u(4),a(),l(5,"div"),u(6),a()(),l(7,"a",4),u(8,"Dise\xF1ar"),a()(),l(9,"button",5),h("click",function(r){return i.openMenuEmit(r)}),_(10,"i",6),a()()),e&2&&(f("ngClass",te(6,B0,i.isActived)),c(4),W(i.item.code),c(2),W(i.item.denomination),c(),f("routerLink",ss("/",i.base,"/proyectos/",i.item.id)))},dependencies:[be,he,Be,cn],styles:[".items[_ngcontent-%COMP%]{background-image:linear-gradient(0deg,#00000080,#0000001a),url(https://images.unsplash.com/photo-1467232004584-a241de8bcf5d?q=80&w=2069&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D);background-size:cover;background-position:center;height:200px;display:flex;justify-content:space-between;flex-direction:row;align-items:end;padding:1rem;border-radius:.5rem;color:#fff}.items.active[_ngcontent-%COMP%]{outline:2px solid var(--primary)}.item-info[_ngcontent-%COMP%]{display:flex;gap:.5rem;width:100%;align-items:end;overflow:hidden}.item-info[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:nth-child(1){flex:1}"]})};var W0=o=>({"modal-body":o});function $0(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",6),u(2,"DATOS"),a(),l(3,"button",7),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}var Ys=class o{constructor(t){this.activeModal=t}isModal=!0;item={};eventChange=new q;close(){this.isModal?this.activeModal.close():this.eventChange.emit({event:"close",data:this.item})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-project-detail"]],inputs:{isModal:"isModal",item:"item"},outputs:{eventChange:"eventChange"},decls:69,vars:17,consts:[[1,"modal-header"],[1,"",3,"ngClass"],[1,"table","table-datos","box-main"],[2,"width","100px"],["nowrap",""],[3,"state"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"]],template:function(e,i){e&1&&(D(0,$0,4,0,"div",0),l(1,"div",1)(2,"table",2)(3,"thead")(4,"tr"),_(5,"th",3)(6,"th"),a()(),l(7,"tbody")(8,"tr")(9,"td",4)(10,"b"),u(11,"C\xF3digo"),a()(),l(12,"td"),u(13),a()(),l(14,"tr")(15,"td",4)(16,"b"),u(17,"Denominaci\xF3n"),a()(),l(18,"td"),u(19),a()(),l(20,"tr")(21,"td",4)(22,"b"),u(23,"Descripci\xF3n"),a()(),l(24,"td"),u(25),a()(),l(26,"tr")(27,"td",4)(28,"b"),u(29,"Fecha de registro"),a()(),l(30,"td"),u(31),Ii(32,"date"),a()(),l(33,"tr")(34,"td",4)(35,"b"),u(36,"Estado"),a()(),l(37,"td"),_(38,"app-text-state",5),a()(),l(39,"tr")(40,"td",4)(41,"b"),u(42,"Favicon"),a()(),l(43,"td"),u(44),a()(),l(45,"tr")(46,"td",4)(47,"b"),u(48,"Faviconname"),a()(),l(49,"td"),u(50),a()(),l(51,"tr")(52,"td",4)(53,"b"),u(54,"Estado Publico"),a()(),l(55,"td"),u(56),a()(),l(57,"tr")(58,"td",4)(59,"b"),u(60,"Dominio"),a()(),l(61,"td"),u(62),a()(),l(63,"tr")(64,"td",4)(65,"b"),u(66,"Metadata"),a()(),l(67,"td"),u(68),a()()()()()),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(15,W0,i.isModal)),c(12),W(i.item.code),c(6),W(i.item.denomination),c(6),W(i.item.description),c(6),W(Di(32,12,i.item.createAt,"dd/MM/yyyy HH:mm:ss")),c(7),f("state",i.item.state),c(6),W(i.item.faviconUrl),c(6),W(i.item.faviconName),c(6),W(i.item.statePublic),c(6),W(i.item.domian),c(6),W(i.item.metaData))},dependencies:[be,Gi,Oi],encapsulation:2})};var H0=o=>({"modal-body":o}),rf=o=>({"has-danger":o});function G0(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",16),u(2,"DATOS DEL PROYECTO"),a(),l(3,"button",17),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}function q0(o,t){o&1&&_(0,"app-loading")}var el=class o{constructor(t){this.modalActive=t}accion="add";project;isModal=!0;idinstitucion="";uid="";eventChange=new q;projectService=b(Pi);authService=b(xe);uploadService=b(mr);toastService=b(tt);states=this.projectService.states;ngOnInit(){return P(this,null,function*(){if(this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.uid===""&&(this.uid=this.authService.userData.id+""),this.accion=="update"){if(!this.project)return;this.form.patchValue({code:this.project.code,denomination:this.project.denomination,description:this.project.description,state:this.project.state,faviconUrl:this.project.faviconUrl,faviconName:this.project.faviconName,statePublic:this.project.statePublic,domian:this.project.domian,fontFamily:this.project.fontFamily,metaData:this.project.metaData}),this.project.nameImg==""&&(this.file.type="link"),this.file.name=this.project.nameImg??"",this.file.url=this.project.imgUrl??"",this.file.required=!1}})}ngAfterViewInit(){document.getElementById("code")?.focus()}form=new ni({code:new Fe("",{validators:[ze.required],nonNullable:!0}),denomination:new Fe("",{validators:[ze.required],nonNullable:!0}),description:new Fe("",{validators:[],nonNullable:!0}),state:new Fe("2",{validators:[],nonNullable:!0}),faviconUrl:new Fe("",{validators:[],nonNullable:!0}),faviconName:new Fe("",{validators:[],nonNullable:!0}),statePublic:new Fe("0",{validators:[],nonNullable:!0}),domian:new Fe("",{validators:[],nonNullable:!0}),fontFamily:new Fe("",{validators:[],nonNullable:!0}),metaData:new Fe("",{validators:[],nonNullable:!0})});get codeControl(){return this.form.get("code")}get denominationControl(){return this.form.get("denomination")}get descriptionControl(){return this.form.get("description")}get stateControl(){return this.form.get("state")}get faviconUrlControl(){return this.form.get("faviconUrl")}get faviconNameControl(){return this.form.get("faviconName")}get statePublicControl(){return this.form.get("statePublic")}get domianControl(){return this.form.get("domian")}get fontFamilyControl(){return this.form.get("fontFamily")}get metaDataControl(){return this.form.get("metaData")}close(){this.isModal?this.modalActive.dismiss():this.eventChange.emit({event:"close",data:void 0})}submit=!1;loading=!1;save(){return P(this,null,function*(){if(this.submit=!0,!this.form.valid)return;this.submit=!1;let t=this.form.value;if(yield this.uploadFile()){if(this.accion=="add"){let i={code:t.code,denomination:t.denomination,idinstitucion:this.idinstitucion,description:t.description,createBy:this.uid,state:t.state,imgUrl:this.file.url,nameImg:this.file.name,faviconUrl:t.faviconUrl,faviconName:t.faviconName,statePublic:t.statePublic,domian:t.domian,fontFamily:t.fontFamily,metaData:t.metaData,mainPage_id:null};this.loading=!0;let n=yield this.projectService.add(i);this.loading=!1,n.state=="success"&&(this.isModal?this.modalActive.close(n.data):this.eventChange.emit({event:"add",data:n.data}))}else if(this.accion=="update"){let i={id:this.project.id,code:t.code,denomination:t.denomination,idinstitucion:this.idinstitucion,description:t.description,state:t.state,imgUrl:this.file.url,nameImg:this.file.name,faviconUrl:t.faviconUrl,faviconName:t.faviconName,statePublic:t.statePublic,domian:t.domian,fontFamily:t.fontFamily,metaData:t.metaData,mainPage_id:this.project.mainPage_id};this.loading=!0;let n=yield this.projectService.update(i);this.loading=!1,n.state=="success"&&(this.isModal?this.modalActive.close(i):this.eventChange.emit({event:"update",data:n.data}))}}})}currentFiles=null;file={required:!1,type:"file",name:"",url:""};eventFile(t){return P(this,null,function*(){if(this.file.type="file",this.file.name="",this.file.url="",t.event=="clear"){this.currentFiles=null;return}if(t.event=="files"){this.currentFiles=t.files??null;return}t.event=="link"&&(this.file.url=t.url??"",this.file.name=t.name??"",this.currentFiles=null,this.file.type="link")})}uploadFile(){return P(this,null,function*(){if(this.file.required&&this.accion=="add"&&this.file.type=="file"&&(!this.currentFiles||this.currentFiles?.length==0))return this.toastService.error("Debe seleccionar un archivo"),!1;if(this.file.type=="file"&&this.currentFiles&&this.currentFiles.length>0){let t=this.currentFiles[0],e=yield this.uploadService.uploadFile("applications",t);if(e&&e.state=="success")this.file.url=e.url??"",this.file.name=e.nameFile??"";else return!1}return!0})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-project-form"]],inputs:{accion:"accion",project:"project",isModal:"isModal",idinstitucion:"idinstitucion",uid:"uid"},outputs:{eventChange:"eventChange"},decls:23,vars:17,consts:[[1,"modal-header"],[1,"",3,"ngClass"],[1,"container",3,"submit","formGroup"],[1,"form-group","row",3,"ngClass"],["for","code",1,"control-label","col-12","col-md-3"],[1,"col-12","col-md-9"],["type","text","name","code","id","code","formControlName","code",1,"form-control"],[1,"left",3,"control","show"],["for","denomination",1,"control-label","col-12"],[1,"col-12"],["type","text","name","denomination","id","denomination","formControlName","denomination",1,"form-control"],[1,"form-group"],[3,"evento","url"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary","btn-lg-medio","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-lg-medio",3,"click"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"]],template:function(e,i){e&1&&(D(0,G0,4,0,"div",0),l(1,"div",1)(2,"form",2),h("submit",function(){return i.save()}),l(3,"div",3)(4,"label",4),u(5,"C\xF3digo "),a(),l(6,"div",5),_(7,"input",6)(8,"app-control-messages",7),a()(),l(9,"div",3)(10,"label",8),u(11,"Denominaci\xF3n "),a(),l(12,"div",9),_(13,"input",10)(14,"app-control-messages",7),a()(),l(15,"div",11)(16,"app-file-upload",12),h("evento",function(r){return i.eventFile(r)}),a()()()(),l(17,"div",13)(18,"button",14),h("click",function(){return i.close()}),u(19," Cancelar "),a(),l(20,"button",15),h("click",function(){return i.save()}),u(21," Guardar "),a()(),D(22,q0,1,0,"app-loading")),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(11,H0,i.isModal)),c(),f("formGroup",i.form),c(),f("ngClass",te(13,rf,i.codeControl.invalid&&(i.codeControl.touched||i.submit))),c(5),f("control",i.codeControl)("show",i.submit),c(),f("ngClass",te(15,rf,i.denominationControl.invalid&&(i.denominationControl.touched||i.submit))),c(5),f("control",i.denominationControl)("show",i.submit),c(2),f("url",i.file.url),c(6),T(i.loading?22:-1))},dependencies:[Kt,Zt,Qe,Ne,Xt,Qt,ri,bi,be,Ye,so],encapsulation:2})};var tl=class o{state=le();EStateCustom=Ad;stateValue=ce(()=>this.stateFormat(this.state()));size=le("");isMode=le("");ngOnInit(){this.isMode()=="S"&&(this.EStateCustom={1:{label:"Si",color:"rgb(0 182 7)",icon:"",background:""},0:{label:"No",color:"rgb(255 19 19)",icon:"",background:""}})}stateFormat=t=>{let e="";return t!=null&&(e=t.toString()),this.EStateCustom[e]||Ad[""]};static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-text-state2"]],hostVars:6,hostBindings:function(e,i){e&2&&(it(`_estados text-truncate ${i.size()} ${i.stateValue().classes}`),xt("color",i.stateValue().color)("background",i.stateValue().background))},inputs:{state:[1,"state"],EStateCustom:"EStateCustom",size:[1,"size"],isMode:[1,"isMode"]},decls:2,vars:4,template:function(e,i){e&1&&(ii(0,"i"),u(1)),e&2&&(it(Re("icon ",i.stateValue().icon)),c(),Ie(" ",i.stateValue().label," "))},styles:["._estados[_nghost-%COMP%]{text-align:center;font-weight:700;padding:.25rem .75rem;border-radius:1rem;width:fit-content;margin:0 auto;line-height:normal;display:block;text-transform:uppercase}._estados.sm[_nghost-%COMP%]{font-size:.6rem;padding:.15rem .5rem}._estados.lg[_nghost-%COMP%]{font-size:1rem}"],changeDetection:0})};var il=class o{state="0";projectService=b(Pi);static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-project-state"]],inputs:{state:"state"},decls:1,vars:2,consts:[["size","sm",3,"EStateCustom","state"]],template:function(e,i){e&1&&_(0,"app-text-state2",0),e&2&&f("EStateCustom",i.projectService.stateMap)("state",i.state)},dependencies:[tl],encapsulation:2})};var J0=o=>({active:o}),af=(o,t)=>({item:o,indice:t}),X0=(o,t)=>t.id;function Z0(o,t){if(o&1){let e=M();l(0,"div",3)(1,"div")(2,"h4",11),u(3,"Proyectos"),a()(),l(4,"div")(5,"button",12),h("click",function(){g(e);let n=d();return C(n.add())}),_(6,"i",13),l(7,"span"),u(8,"Adicionar"),a()()()()}}function Q0(o,t){if(o&1){let e=M();l(0,"app-ui-header-management",14),ne("stateChange",function(n){g(e);let r=d();return Z(r.filter.state,n)||(r.filter.state=n),C(n)})("searchChange",function(n){g(e);let r=d();return Z(r.filter.texto,n)||(r.filter.texto=n),C(n)}),h("onAdd",function(){g(e);let n=d();return C(n.add())})("onExport",function(n){g(e);let r=d();return C(r.export(n))})("onSearch",function(){g(e);let n=d();return C(n.searchChange())})("reload",function(){g(e);let n=d();return C(n.list())}),ne("modeChange",function(n){g(e);let r=d();return Z(r.mode,n)||(r.mode=n),C(n)}),a()}if(o&2){let e=d();ie("state",e.filter.state)("search",e.filter.texto),f("states",e.projectService.states)("canExport",e.projectService.canExport)("canExportExcel",e.projectService.canExportExcel)("canExportPdf",e.projectService.canExportPdf)("canNew",e.projectService.canAdd),ie("mode",e.mode),f("size",e.size)}}function K0(o,t){o&1&&(l(0,"thead")(1,"tr")(2,"th",17),u(3,"#"),a(),l(4,"th",18),u(5,"C\xF3digo"),a(),l(6,"th"),u(7,"Denominaci\xF3n"),a(),l(8,"th",18),u(9,"Estado"),a(),_(10,"th",17)(11,"th",17),a()())}function Y0(o,t){if(o&1){let e=M();l(0,"tr",19,2),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))}),l(2,"td",20),u(3),a(),l(4,"td",21),u(5),a(),l(6,"td",22),u(7),a(),l(8,"td",21),_(9,"app-ui-project-state",23),a(),l(10,"td",24),u(11),l(12,"button",25),u(13,"Dise\xF1ar"),a()(),l(14,"td",20)(15,"button",26),h("click",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),C(s.open(n))}),_(16,"i",27),a()()()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(5);f("ngClass",te(11,J0,e.id==n.selected.id))("contextMenu",r)("contextMenuValue",vt(13,af,e,i)),c(3),Ie(" ",(i+1).zfill(2)," "),c(2),W(e.code),c(2),W(e.denomination),c(2),f("state",e.state),c(2),Ie(" [",n.base,"] "),c(),f("routerLink",ss("/",n.base,"/design/w/",e.id))}}function eC(o,t){if(o&1&&(l(0,"div",5)(1,"table",15),D(2,K0,12,0,"thead"),l(3,"tbody"),Y(4,Y0,17,16,"tr",16,X0),a()()()),o&2){let e=d();c(2),T(e.mode=="table"?2:-1),c(2),ee(e.projects)}}function tC(o,t){if(o&1){let e=M();l(0,"app-ui-project-card",29,2),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))})("openMenu",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),C(s.open(n))}),a()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(5);f("card",lt(n.mode))("item",e)("isActived",e.id==n.selected.id)("contextMenu",r)("contextMenuValue",vt(6,af,e,i))}}function iC(o,t){o&1&&_(0,"app-ui-message-empty")}function nC(o,t){if(o&1&&(l(0,"div"),Y(1,tC,2,9,"app-ui-project-card",28,de,!1,iC,1,0,"app-ui-message-empty"),a()),o&2){let e=d();it(Re("_",e.mode," m-0 p-0 list-card")),c(),ee(e.projects)}}function oC(o,t){o&1&&(l(0,"div",30)(1,"div",31),_(2,"i",32),a(),l(3,"div",33),u(4,"Ver detalles"),a(),_(5,"div",34),a())}function rC(o,t){o&1&&(l(0,"div",30)(1,"div",31),_(2,"i",35),a(),l(3,"div",33),u(4,"Adicionar"),a(),l(5,"div",34),u(6,"F1"),a()())}function aC(o,t){o&1&&(l(0,"div",30)(1,"div",31),_(2,"i",36),a(),l(3,"div",33),u(4,"Editar"),a(),_(5,"div",34),a())}function sC(o,t){o&1&&(l(0,"div",30)(1,"div",31),_(2,"i",37),a(),l(3,"div",33),u(4,"Duplicar proyecto"),a(),_(5,"div",34),a())}function lC(o,t){o&1&&(l(0,"div",30)(1,"div",31),_(2,"i",38),a(),l(3,"div",33),u(4,"Eliminar"),a(),_(5,"div",34),a())}function cC(o,t){}function dC(o,t){o&1&&(l(0,"div",30)(1,"div",31),_(2,"img",39),a(),l(3,"div",33),u(4,"Exportar"),a(),_(5,"div",34),a())}function mC(o,t){}function pC(o,t){o&1&&(l(0,"div",30)(1,"div",31),_(2,"i",40),a(),l(3,"div",33),u(4,"Actualizar lista"),a(),_(5,"div",34),a())}function uC(o,t){o&1&&(l(0,"div",30)(1,"div",31),_(2,"img",41),a(),l(3,"div",33),u(4,"En formato PDF"),a(),_(5,"div",34),a())}function fC(o,t){o&1&&(l(0,"div",30)(1,"div",31),_(2,"img",42),a(),l(3,"div",33),u(4,"En formato Excel"),a(),_(5,"div",34),a())}function hC(o,t){o&1&&_(0,"app-loading")}var nl=class o{idinstitucion="";state="";statePublic="";mode="box";size="lg";eventChange=new q;projectService=b(Pi);authService=b(xe);confirmationService=b(ft);modalService=b(Vi);base=Le.isMultipleSystem?`${Le.sistema}/${this.authService.userData.rol}`:`${this.authService.userData.rol}`;filter={texto:""};projects=[];EProjectState=ur;loading=!1;ngOnInit(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.filter.idinstitucion=this.idinstitucion,this.filter.state=this.state,this.filter.statePublic=this.statePublic,this.list()})}list(){return P(this,null,function*(){this.loading=!0;let t=yield this.projectService.list(this.filter);this.loading=!1,t&&t.state=="success"&&(this.projects=t.data??[])})}add(){this.openForm()}update(t){this.openForm("update",t)}duplicate(t){return P(this,null,function*(){try{if(!(yield this.confirmationService.create("Duplicar","\xBFEst\xE1 seguro de duplicar el proyecto?")))return;this.loading=!0;let i=yield this.projectService.duplicate({id:t.id,idinstitucion:t.idinstitucion});this.loading=!1,i&&i.state=="success"&&i.data&&this.projects.unshift(i.data)}catch(e){console.error(e)}})}openForm(t="add",e){return P(this,null,function*(){try{let i=this.modalService.open(el,{backdrop:"static",keyboard:!1,size:"md"});i.componentInstance.accion=t,i.componentInstance.idinstitucion=this.filter.idinstitucion,i.componentInstance.state=this.filter.state,i.componentInstance.statePublic=this.filter.statePublic,t=="update"&&(i.componentInstance.project=JSON.parse(JSON.stringify(e)));let n=yield i.result;if(t=="add")this.projects.unshift(n);else if(t=="update"){if(!e)return;Object.assign(e,n)}}catch{}})}remove(t,e=-1){return P(this,null,function*(){if(!(yield this.confirmationService.create("Eliminar","\xBFEst\xE1 seguro de eliminar el proyecto?")))return;this.loading=!0;let n=yield this.projectService.delete({id:t.id,idinstitucion:t.idinstitucion});this.loading=!1,n.state=="success"&&(this.projects.splice(e,1),this.selected={})})}openDetail(t){return P(this,null,function*(){try{let e=yield this.modalService.open(Ys,{backdrop:"static",keyboard:!1,size:"lg"});e.componentInstance.item=t,e.componentInstance.id=t.id,e.componentInstance.idinstitucion=t.idinstitucion;let i=yield e.result}catch{}})}changeState(t,e){return P(this,null,function*(){let i={id:t.id,idinstitucion:t.idinstitucion,state:e},n=yield this.projectService.changeState(i);n&&n.state=="success"&&(t.state=e)})}searchChange(){this.list()}stateFilterChange(){this.list()}suiteFilterChange(){this.list()}selected={};select(t,e="click"){t.id==this.selected.id&&e!="dblclick"||(this.selected=t,e=="dblclick"&&this.openDetail(t),this.eventChange.emit({event:e,data:JSON.parse(JSON.stringify(t))}))}canAdd=()=>this.projectService.canAdd;canEdit=()=>this.projectService.canEdit;canRemove=()=>this.projectService.canRemove;canChangeState=()=>this.projectService.canChangeState;canExport=()=>this.projectService.canExport;canExportExcel=()=>this.projectService.canExportExcel;canExportPdf=()=>this.projectService.canExportPdf;export(t="pdf"){return P(this,null,function*(){yield this.projectService.export(this.filter,t)})}changeMode(t){this.mode=t}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-project-list"]],inputs:{idinstitucion:"idinstitucion",state:"state",statePublic:"statePublic",mode:"mode",size:"size"},outputs:{eventChange:"eventChange"},decls:20,vars:13,consts:[["menu",""],["SubMenu",""],["ngxContextMenu","ngxContextMenu"],[1,"___centrar","py-1","gap-1","mt-2"],[3,"state","search","states","canExport","canExportExcel","canExportPdf","canNew","mode","size"],[1,"box-main","p-0",2,"border-radius","0.5rem","overflow","hidden"],[3,"class"],["contextMenuItem","",3,"execute"],["contextMenuItem","",3,"execute","visible"],["contextMenuItem","",3,"divider"],["contextMenuItem","",3,"visible","subMenu"],[1,"my-2"],["app-button","",3,"click"],[1,"icon","ion-md-add"],[3,"stateChange","searchChange","onAdd","onExport","onSearch","reload","modeChange","state","search","states","canExport","canExportExcel","canExportPdf","canNew","mode","size"],[1,"table","table-sm","table-box","table-fixed"],[3,"ngClass","contextMenu","contextMenuValue"],[2,"width","40px"],[2,"width","50px"],[3,"elementEvents","ngClass","contextMenu","contextMenuValue"],[1,"text-center",2,"width","40px"],[1,"text-center",2,"width","50px"],[1,""],[3,"state"],[1,"text-center",2,"width","100px"],["app-button","","variant","outline",3,"routerLink"],[1,"btn","btn-more",3,"click"],[1,"ion-md-more"],[3,"item","isActived","card","contextMenu","contextMenuValue"],[3,"elementEvents","openMenu","item","isActived","card","contextMenu","contextMenuValue"],[1,"_items"],[1,"icons"],[1,"icons","icon","ion-md-list-box"],[1,"label","w-100"],[1,"atajo"],[1,"icons","icon","ion-md-add"],[1,"icons","icon","ion-md-create"],[1,"icons","icon","ion-md-copy"],[1,"icons","icon","ion-md-trash"],["src","https://cdn-icons-png.flaticon.com/512/5414/5414637.png","alt",""],[1,"icons","icon","ion-md-refresh"],["src","assets/img/icons/pdf.png","alt",""],["src","assets/img/icons/excel.png","alt",""]],template:function(e,i){if(e&1){let n=M();D(0,Z0,9,0,"div",3)(1,Q0,1,9,"app-ui-header-management",4),D(2,eC,6,1,"div",5)(3,nC,4,4,"div",6),l(4,"context-menu",null,0),Se(6,oC,6,0,"ng-template",7),h("execute",function(s){return g(n),C(i.openDetail(s.value.item))}),Se(7,rC,7,0,"ng-template",8),h("execute",function(){return g(n),C(i.add())}),Se(8,aC,6,0,"ng-template",8),h("execute",function(s){return g(n),C(i.update(s.value.item))}),Se(9,sC,6,0,"ng-template",8),h("execute",function(s){return g(n),C(i.duplicate(s.value.item))}),Se(10,lC,6,0,"ng-template",8),h("execute",function(s){return g(n),C(i.remove(s.value.item,s.value.indice))}),Se(11,cC,0,0,"ng-template",9)(12,dC,6,0,"ng-template",10)(13,mC,0,0,"ng-template",9)(14,pC,6,0,"ng-template",7),h("execute",function(){return g(n),C(i.list())}),a(),l(15,"context-menu",null,1),Se(17,uC,6,0,"ng-template",8),h("execute",function(){return g(n),C(i.export())}),Se(18,fC,6,0,"ng-template",8),h("execute",function(){return g(n),C(i.export("excel"))}),a(),D(19,hC,1,0,"app-loading")}if(e&2){let n=Xe(16);T(i.mode=="dashboard"||i.mode=="box"?0:1),c(2),T(i.mode=="table"||i.mode=="dashboard"?2:3),c(5),f("visible",i.canAdd),c(),f("visible",i.canEdit),c(),f("visible",i.canEdit),c(),f("visible",i.canRemove),c(),f("divider",!0),c(),f("visible",i.canExport)("subMenu",n),c(),f("divider",!0),c(4),f("visible",i.canExportPdf),c(),f("visible",i.canExportExcel),c(),T(i.loading?19:-1)}},dependencies:[si,Si,wi,xi,be,pe,Ye,Ke,At,Ks,Ei,dn,Ni,il,he,Be,cn],styles:[".list-card[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}"]})};var ol=class o{usuario;institution;auth=b(xe);constructor(){this.usuario=this.auth.userData,this.usuario.idinstitucion+""!=""&&(this.institution=this.auth.institucionData)}loading=!0;base=this.auth.projectPath();ngOnInit(){}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-web-project-page"]],decls:32,vars:6,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"row","row-gap-2"],[1,"col-12","mt-3"],[1,"col-md-6","col-12"],[1,"d-flex","p-3","gap-3","align-items-center","shadow",2,"background","var(--fuse-bg-card)","border-radius","0.5rem","height","100%",3,"routerLink"],["src","https://cdn-icons-png.flaticon.com/128/4997/4997543.png","alt","",2,"width","50px"],[1,"d-flex","flex-column"],["for","",1,"label","text-truncate"],["src","https://cdn-icons-png.flaticon.com/128/1907/1907490.png","alt","",2,"width","5ch"],[1,"label","text-truncate"],["src","https://cdn-icons-png.flaticon.com/128/16425/16425457.png","alt","",2,"width","5ch"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"div",2),_(3,"app-ui-project-list"),a()(),l(4,"div",3)(5,"div",4)(6,"h4"),u(7,"Otras opciones"),a()(),l(8,"div",5)(9,"a",6),_(10,"img",7),l(11,"div",8)(12,"label",9),u(13,"Componentes"),a(),l(14,"span"),u(15,"Administra y dise\xF1a componentes para tus webs"),a()()()(),l(16,"div",5)(17,"a",6),_(18,"img",10),l(19,"div",8)(20,"label",11),u(21,"Secciones"),a(),l(22,"span"),u(23,"Crea presets para tus proyectos y agilizar el dise\xF1o de tus sitios web"),a()()()(),l(24,"div",5)(25,"a",6),_(26,"img",12),l(27,"div",8)(28,"label",11),u(29,"Documentos"),a(),l(30,"p"),u(31,"Editar documentos"),a()()()()()()),e&2&&(c(9),f("routerLink",Re("/",i.base,"/componentes")),c(8),f("routerLink",Re("/",i.base,"/design/presets")),c(8),f("routerLink",Re("/",i.base,"/design/docs")))},dependencies:[nl,cn],styles:[".design[_ngcontent-%COMP%]{display:grid;grid-template-columns:250px 1fr}.design[_ngcontent-%COMP%]   .box-main[_ngcontent-%COMP%]{min-height:calc(100vh - var(--h-navbar))}"]})};var gC=()=>["active"],rl=class o{router=b(ln);activedRouter=b(Wi);isActive=le(!1);label=le();iconImage=le();constructor(){}link=le();static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["menu-item"]],inputs:{isActive:[1,"isActive"],label:[1,"label"],iconImage:[1,"iconImage"],link:[1,"link"]},decls:2,vars:7,consts:[["placement","right","container","body","routerLinkActive","active",3,"ngbTooltip","routerLink","relativeTo","routerLinkActive"],["alt","",1,"img-icon",2,"width","24px",3,"src"]],template:function(e,i){e&1&&(l(0,"a",0),_(1,"img",1),a()),e&2&&(f("routerLink",lt(i.link()))("ngbTooltip",i.label())("relativeTo",i.activedRouter)("routerLinkActive",Xi(6,gC)),c(),f("src",i.iconImage(),mt))},dependencies:[At,rr,ir,cn],styles:["a[_ngcontent-%COMP%]{border:none;color:var(--navbar-color);background:transparent;height:48px;width:48px;display:flex;justify-content:center;align-items:center}a[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transition:transform .2s ease-in-out}a.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--filter);transform:scale(1.3)}a[_ngcontent-%COMP%]:hover{background:var(--primary)}a[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:var(--filter-white);transform:scale(1.3)}"]})};var co=class o{auth=b(xe);institution;usuario;project_id=A("");project=A(void 0);constructor(){this.usuario=this.auth.userData,this.usuario.idinstitucion+""!=""&&(this.institution=this.auth.institucionData)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var al=class o{auth=b(xe);projectDetailService=b(co);activeMenu=A("pages");setActiveMenu(t){this.activeMenu.set(t)}usuario;institution;constructor(){this.usuario=this.auth.userData,this.usuario.idinstitucion+""!=""&&(this.institution=this.auth.institucionData),this.load()}base=this.auth.projectPath();routerActive=b(Wi);projectService=b(Pi);load(){this.routerActive.params.subscribe(t=>P(this,null,function*(){if(t.project_id){this.projectDetailService.project_id.set(t.project_id);let e=yield this.projectService.data({id:+t.project_id,idinstitucion:this.institution?.idinstitucion+""});if(e.state!="success")return;this.projectDetailService.project.set(e.data)}}))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-project-detail"]],features:[we([Te({lucideLayoutTemplate:js})])],decls:9,vars:5,consts:[[1,"pages"],[1,"d-flex","flex-column"],["label","P\xE1ginas","iconImage","/assets/icons/internet.svg",3,"link"],["label","Multimedia","iconImage","/assets/icons/cloud.svg",3,"link"],["label","Componentes","iconImage","/assets/icons/component-script.svg",3,"link"],["label","Historial","iconImage","/assets/icons/history.svg",3,"link"],["label","CMS","iconImage","/assets/icons/database.svg",3,"link"],[1,"flex-grow-1"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1),_(2,"menu-item",2)(3,"menu-item",3)(4,"menu-item",4)(5,"menu-item",5)(6,"menu-item",6),a()(),l(7,"div",7),_(8,"router-outlet"),a()),e&2&&(c(2),f("link","general"),c(),f("link","storage"),c(),f("link","componentes"),c(),f("link","historial"),c(),f("link","cms"))},dependencies:[rl,oo],styles:["[_nghost-%COMP%]{height:100%;position:relative;display:grid;grid-template-columns:auto 1fr;grid-template-rows:100%;border-top:1px solid var(--border-color)}[_nghost-%COMP%]     header{background:transparent!important}.pages[_ngcontent-%COMP%]{border-right:1px solid var(--border-color)}"]})};var CC=o=>({"has-prefix":o});function _C(o,t){if(o&1&&(l(0,"div",3),u(1),a()),o&2){let e=d();c(),W(e.prefix)}}var ei=class o{zone=b(fi);placeholder="";prefix="";onlyPixels=!1;onlyNumber=!1;min;max;referenceValue=0;validUnits=["px","%","vh","vw","auto","unset",""];step=10;units=A("");number=A("0");initValue=A("");value=ce(()=>this.number()+this.units());cleanup=null;set inValue(t){this.initValue.set(t??""),this.parseUnit(t??"")}valueChange=new q;disabled=le(!1);isDragging=!1;startY=0;startValue=0;constructor(){yt(()=>{let t=this.value();Ci(()=>{this.initValue()!=t&&(this.initValue.set(t),this.valueChange.emit(t))})})}ngAfterViewInit(){this.cleanup=this.zone.runOutsideAngular(()=>{let t=this.onMouseMove.bind(this),e=this.onMouseUp.bind(this);return document.addEventListener("mousemove",t),document.addEventListener("mouseup",e),()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",e)}})}parseUnit(t){let e=this.units(),i=this.number();if(!t){this.units.set(""),this.number.set("");return}let n=parseFloat(t),r=this.onlyPixels?"px":t.replace(n.toString(),"").trim();this.validUnits.includes(r)?(this.number.set(this.validateNumber(n)),this.units.set(r)):(this.units.set(""),this.number.set(""),setTimeout(()=>{this.units.set(e),this.number.set(i)},0))}validateNumber(t){return isNaN(t)?"":(this.min!=null&&(t=Math.max(this.min,t)),this.max!=null&&(t=Math.min(this.max,t)),t+"")}onKeyDown(t){t.key===" "&&t.preventDefault(),(t.key==="ArrowUp"||t.key==="ArrowDown")&&(t.preventDefault(),this.startValue=parseFloat(this.number())||this.referenceValue||0,this.byStep(t.key==="ArrowUp"?1:-1,t.shiftKey)),t.stopPropagation()}onChange(t){this.parseUnit(t.target.value)}onMouseDown(t){t.preventDefault(),this.isDragging=!0,this.startY=t.clientY,this.startValue=parseFloat(this.number())||this.referenceValue||0}byStep(t,e){let i=e?this.step:1;["auto","none","unset"].includes(this.units())&&this.units.set("px");let n=this.startValue+t*i;n=n%i===0?n:n-n%i,this.number.set(this.validateNumber(n))}onMouseMove(t){this.isDragging&&this.byStep(this.startY-t.clientY,t.shiftKey)}onMouseUp(){this.isDragging&&(this.isDragging=!1)}ngOnDestroy(){this.cleanup?.()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-unit-selector"]],inputs:{placeholder:"placeholder",prefix:"prefix",onlyPixels:"onlyPixels",onlyNumber:"onlyNumber",min:"min",max:"max",referenceValue:"referenceValue",inValue:[0,"value","inValue"],disabled:[1,"disabled"]},outputs:{valueChange:"valueChange"},decls:6,vars:9,consts:[[1,"unit-selector"],[1,"unit-input",3,"ngClass"],[3,"change","keydown","value","disabled","placeholder"],[1,"prefix"],[1,"unit-interactor",3,"mousedown"],[1,"bi-chevron-expand"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"input",2),h("change",function(r){return i.onChange(r)})("keydown",function(r){return i.onKeyDown(r)}),a(),D(3,_C,2,1,"div",3),l(4,"div",4),h("mousedown",function(r){return i.onMouseDown(r)}),_(5,"i",5),a()()()),e&2&&(Ct("disabled",i.disabled()),c(),f("ngClass",te(7,CC,i.prefix)),c(),f("value",i.number()+i.units())("disabled",i.disabled())("placeholder",i.placeholder),c(),T(i.prefix!=""?3:-1))},dependencies:[_i,be,pe],styles:["[_nghost-%COMP%]{display:block;width:100%;line-height:normal}.unit-selector[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid #ced4da;border-radius:.375rem;overflow:hidden;width:100%;height:24px;justify-content:space-between;background:#fff}.unit-interactor[_ngcontent-%COMP%]{height:100%;width:16px;color:gray;display:flex;align-items:center;justify-content:center;font-size:.7rem;cursor:ns-resize;background:#fff}.unit-input[_ngcontent-%COMP%]{display:flex;flex:1;position:relative}.disabled[_ngcontent-%COMP%]{opacity:.4;pointer-events:none;-webkit-user-select:none;user-select:none}input[_ngcontent-%COMP%]{border:none;width:100%}input[_ngcontent-%COMP%]:focus{outline:none}.prefix[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:.65rem;color:gray;padding:0 .25rem;white-space:nowrap}"],changeDetection:0})};var Uo=Object.freeze({margin:"0px 0px 0px 0px"}),ti=Object.freeze({"ctrl-c":"#00000000","ctrl-g":"[]","ctrl-g-type":"linear","ctrl-g-a":"0","ctrl-i":"","ctrl-mode":"base",background:"#00000000"}),zo={"border-width":"0px","border-style":"solid","border-color":"#000000"},Qn={"border-radius":""},mo=Object.freeze({"backdrop-filter":"none",filter:"none"}),en={"font-size":"16px"},Ti=Object.freeze({overflow:"initial"}),Mi={show:"block"},fr=Object.freeze({"grid-column":"span 1","grid-row":"span 1"}),Ai=Object.freeze({display:"flex","flex-direction":"","align-items":"flex-start","justify-content":"flex-start",gap:"","grid-template-columns":"","ctrl-mode":"row","ctrl-gc":"3","ctrl-gmcw":"100px"}),Kn={padding:""},Vn=Object.freeze({top:"",right:"",bottom:"",left:"",transform:"initial",position:"relative","ctrl-mh":"","ctrl-mv":""}),Bt=Object.freeze({width:"auto",height:"auto","min-width":"initial","max-width":"initial","min-height":"initial","max-height":"initial"}),Bo=Object.freeze({"ctrl-h":"0px","ctrl-v":"0px","ctrl-b":"0px","ctrl-s":"0px","ctrl-c":"#000000"}),tn={"text-align":"left"},nn={color:"#000000"},xn={"font-weight":"normal","font-style":"normal","white-space":"normal","letter-spacing":"","line-height":"1.2","text-decoration":"none"},sl={_s:"1",_r:"0",_fy:"1",_fx:"1"},Wo={z:""},vC={background:ti,borderRadius:Qn,fontSize:en,layout:Ai,position:Vn,shadow:Bo,border:zo,filter:mo,gridSpan:fr,padding:Kn,size:Bt,textAlign:tn,textStyle:xn,margin:Uo,textColor:nn,general:Ti,tf:sl,v:Mi,z:Wo},sf=o=>{if(!o)return{};let t=vC[o];return t?k({},t):{}};var jd=["desktop","tablet","mobile"],cf=new Set(jd),ik=Object.fromEntries([...cf].map(o=>[o,null])),nk=Object.fromEntries([...cf].map(o=>[o,!1])),yC=[{action:"tf-h1",icon:"bi-type-h1",text:"28 pixeles",size:"28px"},{action:"tf-h2",icon:"bi-type-h2",text:"25 pixeles",size:"25px"},{action:"tf-h3",icon:"bi-type-h3",text:"22 pixeles",size:"22px"},{action:"tf-h4",icon:"bi-type-h4",text:"19 pixeles",size:"19px"},{action:"tf-h5",icon:"bi-type-h5",text:"16 pixeles",size:"16px"},{action:"tf-h6",icon:"bi-type-h6",text:"14 pixeles",size:"14px"},{action:"tf-p",icon:"bi-paragraph",text:"16 pixeles",size:"16px"}],pa=yC.reduce((o,t)=>(o[t.action]=t.size,o),{});function bC(o){return!isNaN(parseFloat(o||""))}function po(o,t=""){let e=new Set(["px","%","vh","vw","auto","unset",""]),i=o?.trim()||t,n=parseFloat(i),r=i.replace(n.toString(),"")||"";return e.has(r)?{num:n,unit:r,isFixedUnit:bC(i)}:{num:n,unit:"",isFixedUnit:!1}}var df=800;function xC(o,t=window){let e=m=>m?{html:m,top:m.offsetTop,right:m.offsetWidth-m.offsetLeft,bottom:m.offsetHeight-m.offsetTop,left:m.offsetLeft,width:m.offsetWidth,height:m.offsetHeight}:{html:null,top:0,left:0,right:t.document.documentElement.clientWidth,width:t.document.documentElement.clientWidth,height:t.innerHeight},n=t.getComputedStyle(o).position==="fixed",r=null;if(!n)r=e(o.parentElement);else{let m=o.parentElement;for(;m;){let p=t.getComputedStyle(m);if(p.transform!=="none"||p.perspective!=="none"||p.filter!=="none"){r=e(m);break}m=m.parentElement}r||(r=e(null))}let s=null;if(n)s=r;else{let m=o.parentElement;for(;m;){let p=t.getComputedStyle(m);if(p.transform!=="none"||p.perspective!=="none"||p.filter!=="none"){s=e(m);break}m=m.parentElement}s||(s=e(null))}return re(k({},r),{frTop:s.top,frLeft:s.left,frWidth:s.width,frHeight:s.height})}function lf(o){if(o==="auto")return 1;let t=o.match(/^span\s+(\d+)$/);return t?parseInt(t[1]):1}var mf=(o,t=window)=>{let e=t.getComputedStyle(o),i=xC(o),n=i.html,r=o.offsetWidth,s=o.offsetHeight,m=i.width,p=i.height;if(n){let v=t.getComputedStyle(n),y=v.display==="grid",x=!["relative","sticky"].includes(e.position),E=i.width,w=i.height,O=lf(e.gridColumn),F=lf(e.gridRow),V=x?0:parseFloat(v.paddingLeft)+parseFloat(v.paddingRight),L=x?0:parseInt(v.paddingTop)+parseInt(v.paddingBottom),B=x?1:v.gridTemplateColumns.split(" ").length,z=parseInt(v.columnGap)||0,Q=parseInt(v.rowGap)||0,K=!y||x?0:(B-1)*z;m=(E-V-K)/B*O+z*(O-1);let fe=x?1:v.gridTemplateRows.split(" ").length,ae=!y||x?0:(fe-1)*Q;p=(w-L-ae)/fe*F+Q*(F-1)}return{width:+r.toFixed(2),height:+s.toFixed(2),percentWidth:+(r/m*100).toFixed(1),percentHeight:+(s/p*100).toFixed(1),parenteRect:i}};var oi=jd,$o=new Set(oi),hr=oi[0],Ho=Object.fromEntries([...$o].map(o=>[o,null])),pf=Object.fromEntries([...$o].map(o=>[o,!1]));function ua(o,t,e,i={}){if(!$o.has(e))return null;if(o){let n=oi.indexOf(e);for(let r=n;r>=0;r--){let s=o[oi[r]];if(s)return k({},s)}}if(t){let n=oi.indexOf(e);for(let r=n;r>=0;r--){let s=t[oi[r]];if(s)return k({},s)}}return Object.keys(i).length>0?k({},i):null}function wt(o,t){return Object.fromEntries(Object.entries(t).map(([e,i])=>[e,o[e]||i]))}function We(o){return Object.fromEntries([...$o].map(t=>[t,t===hr?k({},o):null]))}function uf(o){return oi.every(t=>o[t]==null)}function Rd(o){return o==null?k({},Ho):oi.reduce((t,e)=>(t[e]=o==null||o[e]==null?null:k({},o[e]),t),{})}var mn=class o{API=`${Le.web_maker}/project-cms`;apiService=b(Lt);loadingService=b(Yt);confirmationService=b(ft);auth=b(xe);toastrService=b(tt);canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.canAdd=this.auth.hasSubPermission("project-cms-ADD"),this.canEdit=this.auth.hasSubPermission("project-cms-EDIT"),this.canRemove=this.auth.hasSubPermission("project-cms-REMOVE"),this.canChangeState=this.auth.hasSubPermission("project-cms-CHANGE-STATE"),this.canExport=this.auth.hasPermission("project-cms-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("project-cms-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("project-cms-EXPORT-PDF")}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}addAll(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create/all`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}patch(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}delete(t){return P(this,null,function*(){let e=yield this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}export(t,e,i=!0){return P(this,null,function*(){if(i&&!(yield this.confirmationService.create("Confirmar","\xBFEst\xE1 seguro de exportar los datos?")))return;this.loadingService.open();let n=re(k({},t),{type_export:e,url:Le.storage_view,institution:this.auth.getInstitution()}),r=yield this.apiService.postPrivate(`${this.API}/export`,n);return this.loadingService.hide(),r&&r.state=="success"&&window.open(r.url),r})}saveOrder(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/order/list`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var gr=class o{API=`${Le.web_maker}/project-data`;apiService=b(Lt);auth=b(xe);toastrService=b(tt);canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.canAdd=this.auth.hasSubPermission("variables-ADD"),this.canEdit=this.auth.hasSubPermission("variables-EDIT"),this.canRemove=this.auth.hasSubPermission("variables-REMOVE"),this.canChangeState=this.auth.hasSubPermission("variables-CHANGE-STATE"),this.canExport=this.auth.hasPermission("variables-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("variables-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("variables-EXPORT-PDF")}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}patch(t){return P(this,null,function*(){let e=yield this.apiService.patchPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}delete(t){return P(this,null,function*(){return this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,t)})}registerVariables(t,e){return P(this,null,function*(){let i=yield this.apiService.postPrivate(`${this.API}/register/variables`,{project_id:t,data:e});return i.state==="success"&&this.toastrService.success(i.message),i})}registerPaletteColor(t,e){return P(this,null,function*(){let i=yield this.apiService.postPrivate(`${this.API}/register/palette-color`,{project_id:t,paletteColor:e});return i.state==="success"&&this.toastrService.success(i.message),i})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var ll=class o{projectDataService=b(gr);auth=b(xe);projectService=b(Pi);projectCmsService=b(mn);project_id="";cmsList=A([]);projectVars=A([]);componentVars=A([]);contextVars=A([]);cmsVars=A([]);vars=ce(()=>[...this.projectVars(),...this.componentVars(),...this.contextVars(),...this.cmsVars()]);paletteColors=A([]);isReady=A(!1);pageVars=ce(()=>this.vars().filter(t=>t.type==="link2"||t.type==="slug"));textVars=ce(()=>this.vars().filter(t=>t.type==="text"));iconVars=ce(()=>this.vars().filter(t=>t.type==="icon"));imageVars=ce(()=>this.vars().filter(t=>t.type==="image"));paragraphVars=ce(()=>this.vars().filter(t=>t.type==="paragraph"));fontFamily=A(" ");currentProjectCmsId=A(null);currentProjectCms=ce(()=>this.cmsList().find(t=>+t.id===this.currentProjectCmsId())??null);setComponentVars(t){let e=t.map(i=>({type:i.type,value:i.default,name:i.label,id:i.field,category:"general"}));this.componentVars.set(e)}setContextVariables(t){let e=t.map(i=>({type:i.type,value:i.value,name:i.name,id:i.id,category:"general"}));this.contextVars.set(e)}setCmsVariables(t){let e=t.map(i=>({type:i.type,value:i.value,name:i.name,id:i.id,category:"general"}));this.cmsVars.set(e)}load(t){return P(this,null,function*(){let e=""+this.auth.institucionData?.idinstitucion;this.isReady.set(!1),this.project_id=t,yield this.loadCMS(this.project_id,e);let i=yield this.projectService.data({id:+this.project_id,idinstitucion:e});i.state=="success"&&this.fontFamily.set(i.data?.fontFamily??"");let n=yield this.projectDataService.list({project_id:t,idinstitucion:e});try{if(n.state!="success")return;let r=n.data??[];if(r.length===0)return;let[s]=r,m=JSON.parse(s.data??"[]"),p=JSON.parse(s.paletteColors??"[]");this.paletteColors.set(p),this.projectVars.set(m)}catch(r){console.error(r)}this.isReady.set(!0)})}addVariable(t){let e=Ee(this.projectVars());this.projectVars().find(i=>i.id===t.id)||(this.projectVars.set([...this.projectVars(),t]),this.saveVariables().then(i=>{i.state!=="success"&&this.projectVars.set(e)}))}saveVariables(){return this.projectDataService.registerVariables(+this.project_id,JSON.stringify(this.projectVars().filter(t=>t.category==="general")))}updatePageVariables(t){let e=t.map(i=>({type:"link2",value:i.value,name:i.name,id:i.id,category:"general"}));this.projectVars.set([...this.projectVars().filter(i=>i.type!=="link2"),...e])}computeVariable(t,e=this.vars()){if(t)return e.find(i=>i.id===t)}clearProject(){this.projectVars.set([]),this.paletteColors.set([]),this.isReady.set(!1),this.componentVars.set([]),this.contextVars.set([]),this.fontFamily.set(" "),this.cmsVars.set([]),this.cmsList.set([])}getVariablesByCategory(t){return this.projectVars().filter(e=>e.category===t)}findVariableById(t){return this.projectVars().find(e=>e.id===t)}updateVariableValue(t,e){let i=this.projectVars(),n=i.findIndex(s=>s.id===t);if(n===-1)return!1;let r=[...i];return r[n]=re(k({},r[n]),{value:e}),this.projectVars.set(r),!0}removeVariableById(t){let e=Ee(this.projectVars()),i=this.projectVars(),n=i.filter(r=>r.id!==t);return n.length===i.length?!1:(this.projectVars.set(n),this.saveVariables().then(r=>{r.state!=="success"&&this.projectVars.set(e)}),!0)}clearCategoryVariables(t){this.projectVars.set(this.projectVars().filter(e=>e.category!==t))}updateVariable(t,e,i){let n=Ee(this.projectVars()),r=this.projectVars(),s=r.findIndex(p=>p.id===e);if(s===-1)return!1;let m=[...r];return m[s]=re(k({},m[s]),{[t]:i}),this.projectVars.set(m),this.saveVariables().then(p=>{p.state!=="success"&&this.projectVars.set(n)}),!0}loadCMS(t,e){return P(this,null,function*(){let i=yield this.projectCmsService.list({project_id:t,idinstitucion:e});if(i&&i.state=="success"){let n=i.data?.map(r=>{let s=r.cms?.fieldsData?.filter(v=>v.type!="slug").map(v=>({id:`field_${v.id}`,name:v.denomination,type:v.type,value:"default"}))??[];s.push({id:"cms_slug",name:r.cms?.denomination+"/:slug",type:"slug",value:r.url});let m=r.cms?.fieldsData?.map(v=>({id:`field_${v.id}`,name:v.denomination,type:v.type}))??[],p=r.cms?.data?.map(v=>re(k({id:v.id+""},JSON.parse(v.data)),{denomination:v.denomination,slug:v.slug,cms_slug:`/${r.url}/:slug`}))??[];return{id:r.id+"",name:r.cms?.denomination,project_id:t,fields:m,rows:p,variables:s}})??[];this.cmsList.set(n)}})}cmsFields=t=>this.cmsList().find(e=>e.id===t)?.fields??[];cmsRows=t=>this.cmsList().find(e=>e.id===t)?.rows??[];cmsVariables=t=>this.cmsList().find(e=>e.id===t)?.variables??[];static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var pn=class o{static parseBoxShadow(t){let e=/(rgba?\([^)]*\)|#[0-9a-fA-F]{3,8}|[a-zA-Z]+)\s*$/,i=t.match(e);if(!i)return null;let n=i[1].trim(),s=t.slice(0,i.index).trim().split(/\s+/);if(s.length!==3&&s.length!==4)return null;let[m,p,v]=s,y=s.length===4?s[3]:"0",x=o.convertColorToHex8(n);return{"ctrl-h":m,"ctrl-v":p,"ctrl-b":v,"ctrl-s":y,"ctrl-c":x,"box-shadow":`${m} ${p} ${v} ${y} ${x}`}}static convertColorToHex8(t){let i=new OffscreenCanvas(1,1).getContext("2d");if(!i)throw new Error("No se pudo obtener el contexto 2D del canvas.");i.fillStyle=t,i.fillRect(0,0,1,1);let r=i.getImageData(0,0,1,1).data,[s,m,p,v]=r,y=s.toString(16).padStart(2,"0"),x=m.toString(16).padStart(2,"0"),E=p.toString(16).padStart(2,"0"),w=v.toString(16).padStart(2,"0");return"#"+(y+x+E+w).toUpperCase()}static parseUnit(t){let e=t.trim();if(e==="auto")return"auto";let i=/^([-+]?\d*\.?\d+)([a-zA-Z%]+)?$/,n=e.match(i);if(!n)return e;let r=parseFloat(n[1]),s=n[2]?n[2].toLowerCase():"";return s===""&&r===0?"0":new Set(["px","%","vh","vw"]).has(s)?`${r}${s}`:`${r*16}px`}static parseBorder(t){let e=t.trim().split(/\s+/);if(e.length!==3)return{"border-width":"1px","border-style":"solid","border-color":"#000000"};let[i,n,r]=e,s=o.parseUnit(i),m=r.startsWith("#")||r.startsWith("rgb")?r:o.convertColorToHex8(r);return{"border-width":s,"border-style":n,"border-color":m}}static parseBox(t){if(!t)return null;let e=t.trim().split(/\s+/);if(e.every(i=>i===e[0]))return e[0];switch(e.length){case 1:return e[0];case 2:return`${e[0]} ${e[1]} ${e[0]} ${e[1]}`;case 3:return`${e[0]} ${e[1]} ${e[2]} ${e[1]}`;default:return`${e[0]} ${e[1]} ${e[2]} ${e[3]}`}}static parseGridTemplateColumns(t){let e=t.trim(),i=/^repeat\(\s*([^,]+)\s*,\s*(.+)\s*\)$/,n=e.match(i),r,s,m="",p;if(n){let v=n[1].trim(),y=n[2].trim();/^\d+$/.test(v)?(r=v,s="grid"):(r="auto",s="responsive");let x=/^minmax\(\s*([^,]+)\s*,\s*.+\)$/,E=y.match(x);E&&(m=E[1].trim()),p=`repeat(${v}, ${y})`}else{let v=e.split(/\s+/);r=v.length.toString(),s="grid",p=`repeat(${v.length}, ${v[0]})`}return{columns:r,mode:s,"ideal-width":m,style:p}}static getContrast(t){if(!t||t=="#00000000"||t=="transparent")return"#000000";let i=new OffscreenCanvas(1,1).getContext("2d");if(!i)throw new Error("No se pudo obtener el contexto 2D del canvas.");i.fillStyle=t,i.fillRect(0,0,1,1);let{data:n}=i.getImageData(0,0,1,1),[r,s,m]=n;return(r*299+s*587+m*114)/1e3>186?"#000000":"#FFFFFF"}static okContrast(t,e){let i=V=>{let B=new OffscreenCanvas(1,1).getContext("2d");if(!B)throw new Error("No se pudo obtener el contexto 2D del canvas.");B.fillStyle=V,B.fillRect(0,0,1,1);let{data:z}=B.getImageData(0,0,1,1);return[z[0],z[1],z[2]]},[n,r,s]=i(t),[m,p,v]=i(e),y=(V,L,B)=>{let z=[V,L,B].map(Q=>(Q=Q/255,Q<=.03928?Q/12.92:Math.pow((Q+.055)/1.055,2.4)));return .2126*z[0]+.7152*z[1]+.0722*z[2]},x=y(n,r,s),E=y(m,p,v),w=Math.max(x,E),O=Math.min(x,E);return(w+.05)/(O+.05)>=4.5}};var wC=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","if","else-if","else","for","empty"]),Ld=class{parser;type;constructor(){this.parser=new DOMParser}convertTemplateToFunction(t,e){this.type=e;let i=this.parser.parseFromString(t,"text/html");return i.querySelectorAll("script").forEach(r=>r.remove()),this.getChildren(i.body)}nodeToFunction(t){if(t.nodeType===Node.TEXT_NODE)return this.handleTextNode(t);if(t.nodeType===Node.ELEMENT_NODE){let e=t,i=e.tagName.toLowerCase(),n=`'${i}'`;if(i==="if")return this.handleIfStatement(e);if(i==="else-if"||i==="else")return null;if(i==="for")return this.handleForLoop(e);if(i==="empty")return null;if(i==="slot")return"children";let r=this.getAttributes(e),s=this.getChildren(e),m=e.getAttribute("tag");return m&&(n=m.startsWith("{{")&&m.endsWith("}}")?m.slice(2,-2):`'${m}'`),n.startsWith("'")&&n.endsWith("'")&&!wC.has(n.slice(1,-1))?`h(${wn(n.slice(1,-1))}, null, null)`:`h(${n}, ${r}, ${s})`}return null}handleTextNode(t){let e=t.textContent||"";if(!e.trim())return null;let n=e.split(/({{\s*.*?\s*}})/).map(r=>r.startsWith("{{")&&r.endsWith("}}")?{ex:r.slice(2,-2).trim(),isVar:!0}:r.trim()?{ex:`${r.replace(/'/g,"\\'").replace(/\n/g,"\\n")}`,isVar:!1}:null).filter(Boolean);return n.length===0?null:n.length===1?n[0]?.isVar?n[0]?.ex:`'${n[0]?.ex}'`:"`"+n.map(r=>r?.isVar?"${"+r.ex+"}":r?.ex??"").join("")+"`"}handleIfStatement(t){let e=t.getAttribute("compare")||"",i=this.getChildren(t),n=t.nextElementSibling,r=n&&["else","else-if"].includes(n.tagName.toLowerCase()),s=n&&n.tagName.toLowerCase()==="else";if(!r)return`...(${e} ? ${i} : [])`;if(s){let v=this.getChildren(n);return`...(${e} ? ${i} : ${v})`}let m=["(() => {"],p=t;for(;p;){let v=p.tagName.toLowerCase(),y=v==="else",x=v==="else-if";if(!y&&!x&&p!==t)break;let E=y?"":p.getAttribute("compare")||"",w=this.getChildren(p);if(m.push(y?"else {":x?`else if (${E}) {`:`if (${E}) {`),m.push(`return ${w}`),m.push("}"),y)break;p=p.nextElementSibling}return m.some(v=>v.startsWith("else {"))||m.push("else { return [] }"),m.push("})()"),`...${m.join("")}`}handleForLoop(t){if(t.childNodes.length==0)return null;let e=t.getAttribute("item")||"item",i=t.getAttribute("index")||"index",n=t.getAttribute("list")||"[]",r=this.getChildren(t),s="[]",m=t.nextElementSibling;return m&&m.tagName.toLowerCase()==="empty"&&(s=this.getChildren(m)),`...(${n}?.length ? ${n}.flatMap((${e}, ${i}) => ${r}) : ${s})`}getAttributes(t){let e=[];this.type&&e.push(`'${this.type}': ''`);for(let i=0;i<t.attributes.length;i++){let n=t.attributes[i],r=n.name,s=n.value;if(r.startsWith("#")){let m=r.slice(1);e.push(`ref: ${m}`);continue}if(r==="[html]"){e.push(`dangerouslySetInnerHTML: { __html: ${s} }`);continue}if(r.startsWith("[")&&r.endsWith("]")){r=r.slice(1,-1),s=this.removeInterpolation(s),e.push(`...attr('${r}', ${s})`);continue}r.startsWith("(")&&r.endsWith(")")?(r=`on${r.slice(1,-1)}`,s=`($event) => ${s}`):s.includes("{{")?s=this.handleMultipleInterpolations(s):s=`'${s.replace(/'/g,"\\'")}'`,e.push(`'${r}': ${s}`)}return`{${e.join(", ")}}`}removeInterpolation(t){return t.replace(/^{{|}}$/g,"").trim()}handleMultipleInterpolations(t){return`[${t.split(/({{\s*.*?\s*}})/).map(n=>n.startsWith("{{")&&n.endsWith("}}")?this.removeInterpolation(n):`'${n.replace(/'/g,"\\'")}'`).join(", ")}].join('')`}getChildren(t){let e=[];for(let i=0;i<t.childNodes.length;i++){let n=this.nodeToFunction(t.childNodes[i]);n&&e.push(n)}return`[${e.join(", ")}]`}};function ff(o,t){return new Ld().convertTemplateToFunction(o,t)}function wn(o){return"_"+o.replace(/[^a-zA-Z0-9]/g,"_")+"_"}var bt=[{type:"link2",optional:!1,label:"Link",field:"__link",default:"#"},{type:"group",optional:!1,label:"Nueva ventana",field:"_tLink",default:"_self",options:[{value:"_self",label:"NO"},{value:"_blank",label:"SI"}]}],Sn=[{controlName:"fontSize",enabled:!1,optional:!0,icon:"bi-type",label:"Tama\xF1o",float:!0},{controlName:"textStyle",enabled:!1,optional:!0,icon:"bi-type",label:"Estilo",float:!0},{controlName:"textAlign",enabled:!1,optional:!0,icon:"bi bi-text-left",label:"Alineaci\xF3n",float:!0},{controlName:"layout",enabled:!1,optional:!0,icon:"bi bi-align-center",label:"Distribuci\xF3n del Contenido"},{controlName:"size",enabled:!0,optional:!1,icon:"",label:"Ancho y Alto",float:!0},{controlName:"textColor",enabled:!1,optional:!0,icon:"bi-type",label:"Color",float:!0},{controlName:"background",enabled:!0,optional:!1,icon:"bi bi-paint-bucket",label:"Fondo",float:!0},{controlName:"position",enabled:!0,optional:!1,icon:"bi bi-arrows-move",label:"Posici\xF3n",float:!0},{controlName:"padding",enabled:!0,optional:!1,icon:"",label:"Padding"},{controlName:"margin",enabled:!0,optional:!1,icon:"",label:"Margen"},{controlName:"border",enabled:!0,optional:!1,icon:"bi bi-border",label:"Borde"},{controlName:"borderRadius",enabled:!0,optional:!1,icon:"",label:"Esquinas redondeadas"},{controlName:"shadow",enabled:!0,optional:!1,icon:"",label:"Sombra"},{controlName:"gridSpan",enabled:!0,optional:!1,icon:"bi bi-grid-3x3",label:"Grid Span"},{controlName:"filter",enabled:!0,optional:!1,icon:"bi-magic",label:"Efectos",float:!0},{controlName:"tf",enabled:!0,optional:!1,icon:"bi bi-arrows-angle-contract",label:"Transformaci\xF3n",float:!0},{controlName:"general",enabled:!0,optional:!1,icon:"bi bi-gear",label:"General",float:!0},{controlName:"z",enabled:!0,optional:!1,icon:"bi bi-stack",label:"Z-Index",float:!0},{controlName:"v",enabled:!0,optional:!1,icon:"bi bi-eye",label:"Visibilidad",float:!0}],hf=Sn.filter(o=>["size","position","gridSpan","general","z","v"].includes(o.controlName)),gf=new Set(Sn.filter(o=>!o.optional).map(o=>o.controlName)),Zk=new Set(Sn.filter(o=>o.optional).map(o=>o.controlName)),Cf=Ot(bt);var _f=0,ot="$d";function yf(o,t,e,i){i=k(k({wmid:"",type:""},Cf),i);let n=`const enableLink = ${ot}['isLink'] === true && window['modeview'] == null;`,r="return _comp_";switch(o){case"overlay":r=`return h(__sysc.DropdownContainer, {...${ot}, key: ${ot}['wmid'], parent}, _comp_)`;break;case"dialog":r=`return h(__sysc.DialogContainer, {...${ot}, key: ${ot}['wmid'], parent}, _comp_)`}return`({dataset, style, overlay, children, parent}) => {   
        const ${ot} = {...${JSON.stringify(i)}, ...dataset};
        const inStyle = style ?? {}
        const $el = useRef(null);
        const events = ${ot}?.['events'] ?? {};
        const registerEvents = {}
        if(events['click'] && window['modeview'] != 'designer') {
            registerEvents['onClick'] = () => events['click'].forEach(({channel, action, value}) => {
                notify(channel,{action, value})
            })
        }
        useEffect(() => {
            if($el.current && overlay && overlay.length > 0) {
                const meta = overlay.map(x => h(x.type,{key: x.key, ...x.props, parent: $el}))
                addOverlay(meta, $el.current)
            }
            return () => {if($el.current) removeOverlay($el.current)}
        }, [$el.current])
        ${n}${e}
        const classes = (${ot}?.['classes'] ?? '') + ' wmw ' + ${ot}['wmid']
        const __attrs = {ref: $el, class: classes, wmid: ${ot}['wmid'], wt: ${ot}.type, id: ${ot}['id'], style: inStyle, target: ${ot}?.['_tLink'], ...registerEvents};

        // if(enableLink){
        //     if(${ot}?.['__link'] && ${ot}.['__link'].includes(':slug')) {
        //         //containt ':slug'
        //         console.log('link', ${ot}?.['__link'], contextDataset)
        //     }
        // }

        const _comp_ = enableLink ? h('a', {href: ${ot}?.['__link'], ...__attrs}, ${t}) : h('div', __attrs, ${t})
        ${r}
    }`}function Ut(o,t,e,i){let n=ff(t,"element-"+o);return yf(o,n,e,i)}function bf(o,t,e,i){return yf(o,t,e,i)}function Ot(o,t=!0){let e={};return o.forEach(i=>{if(i.type=="array"){let n=[];if(t){let r=Ot(i.formFields??[]);for(let s=0;s<3;s++)n.push(r)}e[i.field]=n}else e[i.field]=i.default}),e}function Go(){return _f++,"WM-"+_f.toString(36)}function xf(){return"project_"+Math.random().toString(36).substring(2)}function fa(o=""){let t=Date.now().toString(36),e=Math.random().toString(36).substring(2,10);return o+t+e}function cl(o){return P(this,null,function*(){let t=yield fetch(o);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.text()})}function wf(o){return P(this,null,function*(){let t=yield fetch(o);if(!t.ok)throw new Error(`Error al descargar la imagen: ${t.status}`);let e=yield t.blob(),i=e.type,n;switch(i){case"image/svg+xml":n="svg";break;case"image/jpeg":case"image/jpg":n="jpg";break;case"image/png":n="png";break;default:n="png";break}return{blob:e,extension:n}})}function Sf(o,t,e,i){let n=o?1:-1;if(e.length===0)return t;let r=[...t],s=e.map(m=>({key:m,index:r.findIndex(p=>i(p)===m)})).filter(m=>m.index!==-1).sort((m,p)=>(m.index-p.index)*n*-1);if(s.length===0)return t;for(let m=0;m<s.length;m++){let p=s[m].index,v=r.splice(p,1)[0],y=o?Math.min(r.length-m,p+n):Math.max(m,p+n);r.splice(y,0,v)}return r}function uo(o,t){let e=k({},o);return Object.keys(t).forEach(i=>{t[i]!==void 0&&(vf(t[i])&&vf(e[i])?e[i]=uo(e[i],t[i]):e[i]=t[i])}),e}function vf(o){return o!==null&&typeof o=="object"&&!Array.isArray(o)}var En=class o{constructor(t,e,i,n=null){this.node=t;this.device=e;this.cssContext=i;this.context=n;this.htmlNode=this.context?.document.querySelector(`[wmid="${this.node.id}"]`)??null,this.typeComponent=this.node.type}htmlNode=null;typeComponent="";setStyle(t,e,i){$o.has(e)&&(t[e]=k(k({},t[e]??{}),i))}inheritDevice(t,e,i,n={}){t[e]||(t[e]=k({},Ho)),t[e][i]=ua(t[e],null,i,n)}getGroupStyle=(t,e)=>!this.node.css[this.cssContext]||!this.node.css[this.cssContext][t]?k({},e):ua(this.node.css[this.cssContext][t],null,this.device,k({},e));hasGroupStyle=t=>!this.node.css[this.cssContext]||!this.node.css[this.cssContext][t]?!1:$o.has(this.device)&&this.node.css[this.cssContext][t][this.device]!==null;inherit(t,e){this.node.css[this.cssContext]||(this.node.css[this.cssContext]={[t]:k({},Ho)}),this.node.css[this.cssContext][t]=uo(this.node.css[this.cssContext],Ee(this.node.css?.main))[t],this.inheritDevice(this.node.css[this.cssContext],t,this.device,k({},e))}inheritFontSize=()=>this.inherit("fontSize",k({},en));inheritSize=()=>this.inherit("size",k({},Bt));inheritPosition=()=>this.inherit("position",k({},Vn));inheritMargin=()=>this.inherit("margin",k({},Uo));inheritOverflow=()=>this.inherit("general",k({},Ti));inheritZIndex=()=>this.inherit("z",k({},Wo));inheritPadding=()=>this.inherit("padding",k({},Kn));inheritLayout=()=>this.inherit("layout",k({},Ai));inheritBorderRadius=()=>this.inherit("borderRadius",k({},Qn));inheritTextStyle=()=>this.inherit("textStyle",k({},xn));inheritTextAlign=()=>this.inherit("textAlign",k({},tn));inheritBackground=()=>this.inherit("background",k({},ti));inheritTextColor=()=>this.inherit("textColor",k({},nn));inheritFilter=()=>this.inherit("filter",k({},mo));inheritShadow=()=>this.inherit("shadow",k({},Bo));inheritBorder=()=>this.inherit("border",k({},zo));inheritGridSpan=()=>this.inherit("gridSpan",k({},fr));inheritTransform=()=>this.inherit("tf",k({},Vn));setPosition=t=>{this.setNodePosition({top:t.top?`${t.top}px`:"",left:t.left?`${t.left}px`:"",bottom:t.bottom?`${t.bottom}px`:"",right:t.right?`${t.right}px`:"",transform:"initial","ctrl-mh":"","ctrl-mv":""})};setStyleGroup=(t,e)=>this.setStyle(this.node.css[this.cssContext][t],this.device,e);setNodeSize=t=>{this.inheritSize(),this.setStyleGroup("size",t)};setNodePosition=t=>{this.inheritPosition(),this.setStyleGroup("position",t)};setNodeFontSize=t=>{this.inheritFontSize(),this.setStyleGroup("fontSize",t)};setNodeLayout=t=>{this.inheritLayout(),this.setStyleGroup("layout",t)};setNodeOverflow=t=>{this.inheritOverflow(),this.setStyleGroup("general",t)};setNodeZIndex=t=>{this.inheritZIndex(),this.setStyleGroup("z",t)};setNodeMargin=t=>{this.inheritMargin(),this.setStyleGroup("margin",t)};setNodePadding=t=>{this.inheritPadding(),this.setStyleGroup("padding",t)};setNodeBorderRadius=t=>{this.inheritBorderRadius(),this.setStyleGroup("borderRadius",t)};setNodeTextStyle=t=>{this.inheritTextStyle(),this.setStyleGroup("textStyle",t)};setNodeTextAlign=t=>{this.inheritTextAlign(),this.setStyleGroup("textAlign",t)};setNodeBackground=t=>{this.inheritBackground(),this.setStyleGroup("background",t)};setNodeTextColor=t=>{this.inheritTextColor(),this.setStyleGroup("textColor",t)};setNodeFilter=t=>{this.inheritFilter(),this.setStyleGroup("filter",t)};setNodeShadow=t=>{this.inheritShadow(),this.setStyleGroup("shadow",t)};setNodeBorder=t=>{this.inheritBorder(),this.setStyleGroup("border",t)};setNodeGridSpan=t=>{this.inheritGridSpan(),this.setStyleGroup("gridSpan",t)};setNodeTransform=t=>{this.inheritTransform(),this.setStyleGroup("tf",t)};getComputedStyles=()=>this.htmlNode?this.context?.getComputedStyle(this.htmlNode):null;getSizeUnit=()=>{let t=this.getSize();return{width:po(t.width),height:po(t.height)}};getSize=()=>this.getGroupStyle("size",k({},Bt));getPosition=()=>this.getGroupStyle("position",k({},Vn));getFontSize=()=>this.getGroupStyle("fontSize",k({},en));getMargin=()=>this.getGroupStyle("margin",k({},Uo));getOverflow=()=>this.getGroupStyle("general",k({},Ti));getZIndex=()=>this.getGroupStyle("z",k({},Wo));getPadding=()=>this.getGroupStyle("padding",k({},Kn));getLayout=()=>this.getGroupStyle("layout",k({},Ai));getBorderRadius=()=>this.getGroupStyle("borderRadius",k({},Qn));getTextStyle=()=>this.getGroupStyle("textStyle",k({},xn));getTextAlign=()=>this.getGroupStyle("textAlign",k({},tn));getBackground=()=>this.getGroupStyle("background",k({},ti));getTextColor=()=>this.getGroupStyle("textColor",k({},nn));getFilter=()=>this.getGroupStyle("filter",k({},mo));getShadow=()=>this.getGroupStyle("shadow",k({},Bo));getBorder=()=>this.getGroupStyle("border",k({},zo));getGridSpan=()=>this.getGroupStyle("gridSpan",k({},fr));hasValueSize=()=>this.hasGroupStyle("size");hasValuePosition=()=>this.hasGroupStyle("position");hasValueFontSize=()=>this.hasGroupStyle("fontSize");hasValueMargin=()=>this.hasGroupStyle("margin");hasValueOverflow=()=>this.hasGroupStyle("general");hasValueZIndex=()=>this.hasGroupStyle("z");hasValuePadding=()=>this.hasGroupStyle("padding");hasValueLayout=()=>this.hasGroupStyle("layout");hasValueBorderRadius=()=>this.hasGroupStyle("borderRadius");hasValueTextStyle=()=>this.hasGroupStyle("textStyle");hasValueTextAlign=()=>this.hasGroupStyle("textAlign");hasValueBackground=()=>this.hasGroupStyle("background");hasValueTextColor=()=>this.hasGroupStyle("textColor");hasValueFilter=()=>this.hasGroupStyle("filter");hasValueShadow=()=>this.hasGroupStyle("shadow");hasValueBorder=()=>this.hasGroupStyle("border");hasValueGridSpan=()=>this.hasGroupStyle("gridSpan");hasValueTransform=()=>this.hasGroupStyle("tf");resetPosition=()=>o.resetCssPosition(this.node);addCssStyles=(t,e)=>{let i=pa["tf-"+e],n=t.background??t["background-color"],r=n??"#00000000",s=pn.getContrast(r),m=pn.parseBox(t.padding),p=t.color??"#000000",v=t["font-size"]??i,y=pn.parseBox(t["border-radius"]),x=t.height,E=["section","footer","nav","main"].includes(e)?"100%":t.width??"auto",w=t["max-height"],O=t["max-width"],F=t["min-height"],V=t["min-width"],L=t.display,B=t["grid-template-columns"]??"0",z=t["flex-direction"]??"row",Q=t.gap??"16px",K=t["justify-content"],fe=t["align-items"],ae=t["box-shadow"],ye=t.border,qe=t["text-align"];if(this.setNodeBackground({background:r,"ctrl-c":r}),m&&this.setNodePadding({padding:m}),p&&(this.typeComponent==="header-text"||this.typeComponent==="paragraph")){let U=pn.okContrast(r,p);this.setNodeTextColor({color:U?p:s})}if(p&&this.typeComponent==="button"){let U=pn.okContrast(r,p);this.setNodeTextColor({color:U?p:s})}if(v&&this.setNodeFontSize({"font-size":pn.parseUnit(v)}),v&&this.typeComponent==="button"&&this.setNodeFontSize({"font-size":"16px"}),qe&&this.setNodeTextAlign({"text-align":qe}),y&&this.setNodeBorderRadius({"border-radius":y}),(x!=null||E!=null||w!=null||O!=null||F!=null||V!=null)&&this.setNodeSize({height:x??"",width:E??"","max-height":w??"","max-width":O??"","min-height":F??"","min-width":V??""}),["layout","overlay"].includes(this.typeComponent)){L==null&&(L="flex",z="column");let U=pn.parseGridTemplateColumns(B);this.setNodeLayout({display:L,"flex-direction":z,gap:Q??"16px","ctrl-mode":L=="flex"?z:U.mode,"justify-content":K,"align-items":fe,"ctrl-gc":U.columns,"grid-template-columns":U.style})}if(ae){let U=pn.parseBoxShadow(ae);U&&this.setNodeShadow(U)}if(ye&&ye!="none"){let U=pn.parseBorder(ye);U&&this.setNodeBorder(U)}};htmlData(){let t=this.htmlNode,e=this.context;if(!t||!e)return null;let i=mf(t,e),n=e.getComputedStyle(t),r=n.position,s=t.parentElement,m=i.parenteRect,p=t.getBoundingClientRect();return console.log({jj:p.top,ff:m.top}),{parent:s,left:+(p.left-m.left).toFixed(2),top:+(p.top-m.top).toFixed(2),frLeft:+(p.left-m.frLeft).toFixed(2),frTop:+(p.top-m.frTop).toFixed(2),width:i.width,height:i.height,percentHeight:i.percentHeight,percentWidth:i.percentWidth,parentWidth:+m.width.toFixed(2),parentHeight:+m.height.toFixed(2),frParentWidth:+m.frWidth.toFixed(2),frParentHeight:+m.frHeight.toFixed(2),relativeLeft:parseFloat(n.left)||0,relativeTop:parseFloat(n.top)||0,position:r,isFree:r==="absolute"||r==="fixed"}}static resetCssPosition=t=>{if(t?.css==null)return;Object.keys(t.css).forEach(i=>{t.css[i].position&&oi.forEach(n=>{t.css[i].position[n]&&(t.css[i].position[n]=k({},Vn))})})}};var Ue=class o{dataHandler=b(ll);closeForm=new Tt;contextDesign=A({nodes:[],mode:"main-editor",metadata:{}});disableEvents=A(!1);device=A(hr);standbyComponent=A(void 0);iframeContext=A(null);sandboxIsReady=A(!1);previewMode=A(!1);nodeTabContainers=A([]);currentOverlayIdOpen=A(null);formNode=A(null);cssComponentContext=A("main");isHoverMode=A(!1);customFields=A([]);hasEnablerPaletteColor=A(!1);showMenu=A(!1);copyCacheElements=A([]);hasStandbyComponent=ce(()=>this.standbyComponent()!=null);isContextEditorReady=ce(()=>this.iframeContext()!=null);isPageMode=ce(()=>this.contextDesign().mode==="main-editor");isComponentMode=ce(()=>this.contextDesign().mode==="component-editor");isSectionMode=ce(()=>this.contextDesign().mode==="section");isDocumentMode=ce(()=>this.contextDesign().mode==="document");isDisabledDesigner=ce(()=>this.contextDesign().mode==="disabled");isCMSMode=ce(()=>this.contextDesign().mode==="cms-page");isVariablesReady=this.dataHandler.isReady;palettColors=this.dataHandler.paletteColors;modeOverlay=ce(()=>this.currentOverlayIdOpen()!=null);isCurrentFormNodeTopLevel=ce(()=>this.formNode()?.parent==null||this.formNode()?.parent?.type==="content");htmlNode=ce(()=>this.formNode()?this.iframeContext()?.document?.querySelector(`[wmid="${this.formNode()?.id}"]`)??null:null);canUseVariables=ce(()=>this.isPageMode()||this.isComponentMode()||this.isCMSMode());sectionComponents$=new Tt;listenNewSection=this.sectionComponents$.asObservable();menuCoordinates=A({x:0,y:0});iframeDesigner=ce(()=>{if(this.sandboxIsReady())return this.iframeContext()?.DESIGNER_MEDIATOR});setCustomFields(t){let e=Ee(t);this.customFields.set(e),this.dataHandler.setComponentVars(e)}setCmsVars=t=>this.dataHandler.setCmsVariables(t);setContextVars=t=>this.dataHandler.setContextVariables(t);deviceInfo=A([{width:1260,device:oi[0],icon:"https://cdn-icons-png.flaticon.com/512/9428/9428079.png"},{width:1023,device:oi[1],icon:"https://cdn-icons-png.flaticon.com/512/1551/1551356.png"},{width:575,device:oi[2],icon:"https://cdn-icons-png.flaticon.com/128/1551/1551353.png"}]);currentDeviceInfo=ce(()=>this.deviceInfo().find(t=>t.device===this.device()));formattedVariables=ce(()=>{let t={};return[...this.dataHandler.textVars(),...this.dataHandler.iconVars(),...this.dataHandler.pageVars(),...this.dataHandler.imageVars(),...this.dataHandler.paragraphVars()].forEach(e=>{t[e.id+""]=e.value}),t});resetDesigner(){this.sandboxIsReady.set(!1),this.iframeContext.set(null),this.standbyComponent.set(void 0),this.formNode.set(null),this.contextDesign.set({nodes:[],mode:"disabled",metadata:{}}),this.customFields.set([]),this.dataHandler.clearProject(),this.dataHandler.setComponentVars([]),this.dataHandler.setContextVariables([]),this.device.set(hr),this.showMenu.set(!1),this.copyCacheElements.set([])}recreateElement(t){this.iframeDesigner()?.recreateElement(t)}updateVars=()=>this.iframeDesigner()?.setVariables(this.formattedVariables());insertResources=t=>{this.iframeDesigner()?.insertResources(t)};hasDisabledEvents=()=>this.disableEvents();setDisabledEvents=t=>this.disableEvents.set(t);updateFormNode(t){t?this.formNode.set(re(k({},t),{fields:k({},t.fields),css:k({},t.css)})):this.formNode.set(null)}createNodeProcessor(t=this.formNode()){return!t||!this.device()?null:new En(t,this.device(),this.cssComponentContext(),this.iframeContext())}setContext=t=>{this.iframeContext.set(t?.contentWindow??null)};updateAddersState=()=>this.iframeDesigner()?.setAddersState(this.hasStandbyComponent());updateActiveDevice=()=>{this.iframeDesigner()?.setDevice(this.device(),this.deviceInfo())};selectNodes=t=>this.iframeDesigner()?.selectNodes(t);initializeProjectData(t){return P(this,null,function*(){this.dataHandler.clearProject(),yield this.dataHandler.load(t)})}newSection=t=>this.sectionComponents$.next(t);removeStandby=()=>this.standbyComponent.set(void 0);updatePageVariables=t=>this.dataHandler.updatePageVariables(t);resetProjectData=()=>this.dataHandler.clearProject();computeVariable=t=>this.dataHandler.computeVariable(t);addStringVariable=(t,e)=>this.dataHandler.addVariable({type:"text",value:e,name:t,id:fa("tv_"),category:"general"});updateVariable=(t,e,i)=>this.dataHandler.updateVariable(t,e,i);removeVariableById=t=>this.dataHandler.removeVariableById(t);saveCustomField=t=>{let e=this.customFields().findIndex(n=>n.field===t.field),i=[...this.customFields()];e!==-1?(i[e]=k({},t),this.customFields.set(i)):i.push(t),this.setCustomFields(i)};createField=(t,e,i)=>{let n={type:t,label:i,field:fa("f_"),default:e};return this.saveCustomField(n),n};onIncomingMessage=t=>{this.iframeDesigner()&&(this.iframeDesigner().events.registerEmitMessage=t)};updateVariablePagesIframe=()=>this.iframeDesigner()?.setVariablesPage(this.dataHandler.pageVars());updateCssContext=()=>this.iframeDesigner()?.setCssContext(this.cssComponentContext());updateCurrentOverlayIdOpen=()=>this.iframeDesigner()?.setCurrentOverlayIdOpen(this.currentOverlayIdOpen());updateFontFamily=()=>this.iframeDesigner()?.setFontFamily(this.dataHandler.fontFamily());updateActiveHover=()=>{let t=this.isHoverMode(),e=this.formNode(),i=t&&e!=null?e.id:null;this.iframeDesigner()?.setActiveHover(i)};takeScreenShot=t=>P(this,null,function*(){return this.iframeDesigner()?.takeScreenShot(t)});onNodeMouseDown(t){this.iframeDesigner()&&(this.iframeDesigner().events.onNodeMouseDown=t)}onNodeMouseUp(t){this.iframeDesigner()&&(this.iframeDesigner().events.onNodeMouseUp=t)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var SC=["container"],EC=["panelHeader"],PC=["panelContent"],MC=o=>({display:o}),IC=o=>({"enable-drag":o}),DC=o=>({maxWidth:o}),dl=class o{container;panelHeader;panelContent;destroyRef=b(cp);ngZone=b(fi);isOpen=A(!1);close=Oe();startDrag=A(!1);title=A("Panel de configuraci\xF3n");maxWidth=A(400);canCloseClickOuside=A(!0);cleanup=null;constructor(){yt(()=>{this.isOpen()&&this.updatePanelPosition()})}ngAfterViewInit(){this.initializeDragAndDrop()}onResize(){this.isOpen()&&this.updatePanelPosition()}updatePanelPosition(){let e=window.innerWidth-300-this.maxWidth()-32;this.panelContent.nativeElement.style.left=`${e}px`,this.panelContent.nativeElement.style.top="16px"}closePanel(){this.close.emit(),this.isOpen.set(!1)}initializeDragAndDrop(){this.cleanup=this.ngZone.runOutsideAngular(()=>{let t=Ka(this.panelHeader.nativeElement,"mousedown").pipe(op(m=>!m.target.closest(".close-button"))),e=Ka(document,"mousemove"),i=Ka(document,"mouseup"),n=i.subscribe(()=>{this.startDrag.set(!1)}),r=t.pipe(es(m=>{this.startDrag.set(!0);let p=m.clientX,v=m.clientY,y=this.panelContent.nativeElement.offsetLeft,x=this.panelContent.nativeElement.offsetTop;return e.pipe(ko(i),fs(this.destroyRef),Qa(E=>({x:y+(E.clientX-p),y:x+(E.clientY-v)})))})).subscribe(({x:m,y:p})=>{this.panelContent.nativeElement.style.left=`${m}px`,this.panelContent.nativeElement.style.bottom="auto",this.panelContent.nativeElement.style.top=`${p}px`}),s=m=>{if(!this.isOpen())return;!m.target.closest(".panel-content")&&this.canCloseClickOuside()&&this.closePanel()};return document.addEventListener("click",s,!0),()=>{r.unsubscribe(),n.unsubscribe(),document.removeEventListener("click",s,!0)}})}ngOnDestroy(){this.cleanup&&this.cleanup()}onKeydown(t){t.key==="Escape"&&this.closePanel()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-panel-options"]],viewQuery:function(e,i){if(e&1&&(ut(SC,7,er),ut(EC,7),ut(PC,7)),e&2){let n;ct(n=dt())&&(i.container=n.first),ct(n=dt())&&(i.panelHeader=n.first),ct(n=dt())&&(i.panelContent=n.first)}},hostVars:8,hostBindings:function(e,i){e&1&&h("resize",function(){return i.onResize()},No)("keydown",function(r){return i.onKeydown(r)},No),e&2&&(pi(te(4,MC,i.isOpen()?"block":"none")),it(te(6,IC,i.startDrag())))},outputs:{close:"close"},decls:11,vars:5,consts:[["panelContent",""],["panelHeader",""],["container",""],[1,"panel-content"],[1,"panel-header"],[1,"close-button",3,"click"],[1,"bi","bi-x-lg"],[1,"panel-body"]],template:function(e,i){if(e&1){let n=M();_t(0,"div",3,0)(2,"div",4,1)(4,"div"),u(5),Ft(),_t(6,"button",5),hi("click",function(){return g(n),C(i.closePanel())}),ii(7,"i",6),Ft()(),_t(8,"div",7),fp(9,null,2),Ft()()}e&2&&(pi(te(3,DC,i.maxWidth()+"px")),c(5),W(i.title()))},styles:["[_nghost-%COMP%]{position:fixed;width:100%;height:100%;z-index:999999999999;top:0;left:0;pointer-events:none}.enable-drag[_nghost-%COMP%]{pointer-events:auto}.panel-content[_ngcontent-%COMP%]{position:fixed;background:var(--fuse-bg-card);border-radius:.5rem;box-shadow:0 0 10px #0000001a;min-width:200px;width:400px;pointer-events:auto}.panel-body[_ngcontent-%COMP%]{max-height:80vh;overflow-y:auto}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--border-color);padding:.25rem 1rem;cursor:move;-webkit-user-select:none;user-select:none}.drag-handle[_ngcontent-%COMP%]{cursor:move;color:var(--fuse-text-secondary)}.drag-handle[_ngcontent-%COMP%]:hover{color:var(--fuse-primary)}.close-button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;color:var(--fuse-text-secondary);padding:.25rem;display:flex;align-items:center;justify-content:center}.close-button[_ngcontent-%COMP%]:hover{color:var(--fuse-warn)}"]})};var Vt=class o{constructor(t,e){this.appRef=t;this.injector=e;this.createContainerBase()}panelRef=null;containerBase=null;currentSub;currentResolver=null;currentDataSub=null;createContainerBase(){this.containerBase||(this.containerBase=document.createElement("div"),this.containerBase.id="panel-options-container",this.containerBase.style.display="none",document.body.appendChild(this.containerBase)),this.panelRef=da(dl,{environmentInjector:this.injector,hostElement:this.containerBase}),this.currentSub=this.panelRef?.instance.close.subscribe(()=>this.destroyComponent()),this.appRef.attachView(this.panelRef.hostView)}disableOutsideClick=()=>this.panelRef?.instance.canCloseClickOuside.set(!1);enableCloseOnOutside=()=>this.panelRef?.instance.canCloseClickOuside.set(!0);show(t,e,i){this.panelRef||this.createContainerBase(),this.destroyComponent(),this.panelRef?.instance.title.set(i?.title||"Panel de configuraci\xF3n"),this.panelRef?.instance.maxWidth.set(i?.maxWidth||400);let n=this.panelRef.instance.container.createComponent(t);return e&&Object.assign(n.instance,e),this.panelRef.instance.isOpen.set(!0),this.currentDataSub=new Tt,this.currentDataSub}destroyComponent(){this.panelRef?.instance.container.clear(),this.panelRef?.instance.isOpen.set(!1),this.currentDataSub?.complete(),this.currentDataSub=null,this.currentResolver?.(),this.currentResolver=null}ok=t=>{this.currentDataSub?.next(t)};close=()=>this.destroyComponent();ngOnDestroy(){this.destroyComponent(),this.containerBase?.remove(),this.currentSub?.unsubscribe(),this.currentSub=void 0,this.currentDataSub?.complete(),this.currentDataSub=null}static \u0275fac=function(e){return new(e||o)(Vo(as),Vo(is))};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var ml=[{name:"Red",color:"#F44336"},{name:"Pink",color:"#E91E63"},{name:"Purple",color:"#9C27B0"},{name:"Indigo",color:"#3F51B5"},{name:"Blue",color:"#2196F3"},{name:"Cyan",color:"#00BCD4"},{name:"Teal",color:"#009688"},{name:"Green",color:"#4CAF50"},{name:"Lime",color:"#CDDC39"},{name:"Orange",color:"#FF9800"}],pl=[{name:"Gray 100",color:"#FFFFFF"},{name:"Gray 900",color:"#000000"},{name:"Gray 700",color:"#616161"},{name:"Gray 500",color:"#9E9E9E"},{name:"Gray 300",color:"#E0E0E0"}],fo=class o{rgbToHsv(t,e,i){t/=255,e/=255,i/=255;let n=Math.max(t,e,i),r=Math.min(t,e,i),s=0,m=0,p=n,v=n-r;if(m=n===0?0:v/n,n===r)s=0;else{switch(n){case t:s=(e-i)/v+(e<i?6:0);break;case e:s=(i-t)/v+2;break;case i:s=(t-e)/v+4;break}s/=6}return[s*360,m*100,p*100]}hsvToRgb(t,e,i){t/=360,e/=100,i/=100;let n,r,s,m=Math.floor(t*6),p=t*6-m,v=i*(1-e),y=i*(1-p*e),x=i*(1-(1-p)*e);switch(m%6){case 0:n=i,r=x,s=v;break;case 1:n=y,r=i,s=v;break;case 2:n=v,r=i,s=x;break;case 3:n=v,r=y,s=i;break;case 4:n=x,r=v,s=i;break;case 5:n=i,r=v,s=y;break}return[Math.round((n??0)*255),Math.round((r??0)*255),Math.round((s??0)*255)]}rgbaToHex(t,e,i,n){let r=s=>{let m=Math.round(s).toString(16);return m.length===1?"0"+m:m};return`#${r(t)}${r(e)}${r(i)}${r(Math.round(n*255))}`}hexToRgba(t){t=t.replace(/^#/,""),t.length===3&&(t=t.split("").map(m=>m+m).join("")),t.length===6&&(t+="ff");let e=parseInt(t,16),i=e>>24&255,n=e>>16&255,r=e>>8&255,s=(e&255)/255;return[i,n,r,s]}rgbaToString(t,e,i,n){return`rgba(${Math.round(t)}, ${Math.round(e)}, ${Math.round(i)}, ${n.toFixed(2)})`}static stringToRgba(t){let i=new OffscreenCanvas(1,1).getContext("2d");if(!i)return[0,0,0,0];i.clearRect(0,0,1,1),i.fillStyle=t,i.fillRect(0,0,1,1);let[n,r,s,m]=i.getImageData(0,0,1,1).data;return[n,r,s,m/255]}rgbaToHsla(t,e,i,n){t/=255,e/=255,i/=255;let r=Math.max(t,e,i),s=Math.min(t,e,i),m=0,p=0,v=(r+s)/2;if(r!==s){let y=r-s;switch(p=v>.5?y/(2-r-s):y/(r+s),r){case t:m=(e-i)/y+(e<i?6:0);break;case e:m=(i-t)/y+2;break;case i:m=(t-e)/y+4;break}m/=6}return[m*360,p*100,v*100,n]}hslaToRgba(t,e,i,n){t/=360,e/=100,i/=100;let r,s,m;if(e===0)r=s=m=i;else{let p=(x,E,w)=>(w<0&&(w+=1),w>1&&(w-=1),w<.16666666666666666?x+(E-x)*6*w:w<.5?E:w<.6666666666666666?x+(E-x)*(.6666666666666666-w)*6:x),v=i<.5?i*(1+e):i+e-i*e,y=2*i-v;r=p(y,v,t+1/3),s=p(y,v,t),m=p(y,v,t-1/3)}return[Math.round(r*255),Math.round(s*255),Math.round(m*255),n]}hslaToString(t,e,i,n){return`hsla(${Math.round(t)}, ${Math.round(e)}%, ${Math.round(i)}%, ${n.toFixed(2)})`}hsvaToHex(t,e,i){let n=this.hsvToRgb(t,e,i);return this.rgbaToHex(n[0],n[1],n[2],1)}stringToHsla(t){let e=o.stringToRgba(t);return this.rgbaToHsla(...e)}generateSuggestedColors(t,e){let i=(m,p)=>m.map(v=>Math.round(v*(1-p))),n=(m,p)=>m.map(v=>Math.round(v+(255-v)*p)),r=[...t];return[i(r,.4),i(r,.2),r,n(r,.2),n(r,.4)].map(m=>this.rgbaToHex(m[0],m[1],m[2],e))}static calculateBrightness(t){return(t[0]*299+t[1]*587+t[2]*114)/1e3}};var Qi=class{static drawHueCanvas(t){let e=t.getContext("2d"),i=e.createLinearGradient(0,0,t.width,0),n=["#f00","#ff0","#0f0","#0ff","#00f","#f0f","#f00"];n.forEach((r,s)=>{i.addColorStop(s/(n.length-1),r)}),e.fillStyle=i,e.fillRect(0,0,t.width,t.height)}static drawAlphaCanvas(t){let e=t.getContext("2d"),i=e.createLinearGradient(0,0,t.width,0);i.addColorStop(0,"rgba(0, 0, 0, 0)"),i.addColorStop(1,"rgba(0, 0, 0, 1)"),e.fillStyle=i,e.fillRect(0,0,t.width,t.height)}static drawColorPicker(t,e){let i=t.getContext("2d");i.imageSmoothingEnabled=!1;let n=i.createLinearGradient(0,0,t.width,0);n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(1,`hsl(${e}, 100%, 50%)`),i.fillStyle=n,i.fillRect(0,0,t.width,t.height);let r=i.createLinearGradient(0,0,0,t.height);r.addColorStop(0,"rgba(0, 0, 0, 0)"),r.addColorStop(1,"rgba(0, 0, 0, 1)"),i.fillStyle=r,i.fillRect(0,0,t.width,t.height)}};var TC=["canvas"],FC=["hueCanvas"],kC=(o,t)=>({"--size":o,"--color":t}),OC=o=>({dragging:o});function VC(o,t){if(o&1){let e=M();l(0,"button",22),h("click",function(){g(e);let n=d();return C(n.useEyeDropper())}),_(1,"ng-icon",23),a()}}var ul=class o{height=le(120);elementRef=b(an);ngZone=b(fi);canvasRef;hueCanvasRef;set color(t){this.parseColor(t),this.hexColor.set(this.colorUtils.rgbaToHex(...this.selectedColor,this.alpha())),this.updateSuggestedColors(),this.updateAllComponents()}width=le(300);colorChange=new q;isEyeDropperSupported=typeof window<"u"&&"EyeDropper"in window;colorUtils=new fo;selectedColor=[0,0,0];hue=0;alpha=ce(()=>this.opacityPercentage()/100);hexColor=A("#000000");opacityPercentage=A(100);hueIndicatorPosition=A("0%");isInitialized=A(!1);colorIndicatorPosition=A({left:"0px",top:"0px"});suggestedColors=A([]);isColorDragging=A(!1);isHueDragging=A(!1);isAlphaDragging=A(!1);isDragging=ce(()=>this.isColorDragging()||this.isHueDragging()||this.isAlphaDragging());cleanup=null;resizeObserver=null;initResizeObserver(){let t=this.canvasRef.nativeElement.parentElement;t&&(this.resizeObserver=new ResizeObserver(()=>{let e=t.clientWidth,i=this.canvasRef.nativeElement;i.width=e;let n=this.hueCanvasRef.nativeElement;n.width=e,this.updateAllComponents()}),this.resizeObserver.observe(t))}updateAllComponents(){this.isInitialized()&&(Qi.drawColorPicker(this.canvasRef.nativeElement,this.hue),Qi.drawHueCanvas(this.hueCanvasRef.nativeElement),this.updateColorIndicator(),this.updateHueIndicator())}ngAfterViewInit(){this.isInitialized.set(!0),this.updateAllComponents(),this.initResizeObserver(),this.cleanup=this.ngZone.runOutsideAngular(()=>{let t=this.onMouseMove.bind(this);document.addEventListener("mousemove",t);let e=this.onMouseUp.bind(this);return document.addEventListener("mouseup",e),()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",e)}})}copyColor(){let t=this.getColorString();navigator.clipboard.writeText(t).then(()=>{console.log("Color copiado al portapapeles:",t)})}onCanvasMouseDown(t){this.isColorDragging.set(!0),this.handleColorSelection(t)}onHueCanvasMouseDown(t){this.isHueDragging.set(!0),this.htmlTarget=t.target,this.handleHueSelection(t)}htmlTarget=null;onAlphaCanvasMouseDown(t){this.isAlphaDragging.set(!0),this.htmlTarget=t.target,this.handleAlphaSelection(t)}onMouseMove(t){this.isColorDragging()?this.handleColorSelection(t):this.isHueDragging()?this.handleHueSelection(t):this.isAlphaDragging()&&this.handleAlphaSelection(t)}onMouseUp(){this.isColorDragging.set(!1),this.isHueDragging.set(!1),this.isAlphaDragging.set(!1);let t=this.getColorString();this.colorChange.emit(t),this.htmlTarget=null}handleColorSelection(t){let e=this.canvasRef.nativeElement,i=e.getBoundingClientRect(),n=Math.max(0,Math.min(t.clientX-i.left,e.width)),r=Math.max(0,Math.min(t.clientY-i.top,e.height)),s=Math.max(0,Math.min(1,n/e.width))*100,m=Math.max(0,Math.min(1,1-r/e.height))*100,p=this.colorUtils.hsvToRgb(this.hue,s,m);this.selectedColor=[p[0],p[1],p[2]],this.opacityPercentage()===0&&this.opacityPercentage.set(100),this.updateColor(),this.updateColorIndicator(n,r)}handleHueSelection(t){let e=this.hueCanvasRef.nativeElement.getBoundingClientRect(),n=Math.max(0,Math.min(t.clientX-e.left,e.width))/e.width*100;this.hue=Math.round(n/100*360),this.updateSelectedColorFromHue(),Qi.drawColorPicker(this.canvasRef.nativeElement,this.hue),this.updateColor(),this.updateHueIndicator(n)}handleAlphaSelection(t){if(!this.htmlTarget)return;let e=this.htmlTarget.getBoundingClientRect(),i=Math.max(0,Math.min(t.clientX-e.left,e.width));this.opacityPercentage.set(Math.round(i/e.width*100)),this.updateColor()}useEyeDropper(){return P(this,null,function*(){if(this.isEyeDropperSupported)try{let e=yield new window.EyeDropper().open();this.parseColor(e.sRGBHex),this.updateAllComponents(),this.colorChange.emit(this.getColorString())}catch(t){t instanceof DOMException&&t.name==="AbortError"||console.error("Error al usar el cuentagotas:",t)}})}updateSelectedColorFromHue(){let t=this.colorUtils.rgbToHsv(...this.selectedColor),e=this.colorUtils.hsvToRgb(this.hue,t[1],t[2]);this.selectedColor=[e[0],e[1],e[2]]}updateColorIndicator(t,e){let i=this.canvasRef.nativeElement;if(t===void 0||e===void 0){let n=this.colorUtils.rgbToHsv(...this.selectedColor);t=n[1]*i.width/100,e=(1-n[2]/100)*i.height}this.colorIndicatorPosition.set({left:`${t}px`,top:`${e}px`})}updateHueIndicator(t){t===void 0&&(t=this.hue/360*100),this.hueIndicatorPosition.set(`${t}%`)}colorWithoutAlpha=A("#000000");updateColor(){this.hexColor.set(this.colorUtils.rgbaToHex(...this.selectedColor,this.alpha())),this.colorWithoutAlpha.set(this.colorUtils.rgbaToHex(...this.selectedColor,1)),this.updateSuggestedColors()}makeTransparent(){this.selectedColor=[0,0,0],this.hexColor.set("#00000000"),this.opacityPercentage.set(0),this.updateAllComponents(),this.colorChange.emit("#00000000")}getColorString(){return this.colorUtils.rgbaToHex(...this.selectedColor,this.alpha())}onHexInput(t){this.parseColor(t)&&(this.updateColor(),this.updateColorIndicator(),this.updateHueIndicator(),Qi.drawColorPicker(this.canvasRef.nativeElement,this.hue),Qi.drawHueCanvas(this.hueCanvasRef.nativeElement),this.colorChange.emit(this.getColorString()))}onOpacityChange(){this.updateColor(),this.colorChange.emit(this.getColorString())}parseColor(t){try{let e=fo.stringToRgba(t);this.selectedColor=[e[0],e[1],e[2]],this.opacityPercentage.set(Math.round(e[3]*100));let i=this.colorUtils.rgbToHsv(...this.selectedColor);return this.hue=i[0],this.colorWithoutAlpha.set(this.colorUtils.rgbaToHex(...this.selectedColor,1)),!0}catch{return!1}}updateSuggestedColors(){this.suggestedColors.set(this.colorUtils.generateSuggestedColors(this.selectedColor,this.alpha()))}selectSuggestedColor(t){this.parseColor(t),this.updateAllComponents(),this.colorChange.emit(this.getColorString())}ngOnDestroy(){this.cleanup?.(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-color-selector"]],viewQuery:function(e,i){if(e&1&&(ut(TC,5),ut(FC,5)),e&2){let n;ct(n=dt())&&(i.canvasRef=n.first),ct(n=dt())&&(i.hueCanvasRef=n.first)}},hostVars:5,hostBindings:function(e,i){e&2&&pi(vt(2,kC,i.width()+"px",i.colorWithoutAlpha()))},inputs:{height:[1,"height"],color:"color",width:[1,"width"]},outputs:{colorChange:"colorChange"},features:[we([],[Te({lucideCopy:Fn,lucideCircleX:Ss,lucideCircleOff:ws,lucideDroplet:Ms,lucideTrash2:ao,lucidePipette:zs,lucideGhost:ks})])],decls:23,vars:12,consts:[["canvas",""],["hueCanvas",""],[1,"color-picker",3,"ngClass"],[1,"color-picker-container"],["height","120",1,"color-canvas",3,"mousedown"],[1,"color-indicator"],[1,"alpha-canvas-container","bg-transparent-fx"],[1,"alpha-canvas",3,"mousedown"],[1,"alpha-indicator"],[1,"hue-canvas-container","position-relative"],["height","20",1,"hue-canvas",3,"mousedown"],[1,"hue-indicator"],[1,"p-2"],[1,"d-flex","justify-content-between","align-items-center"],["app-icon-button","","variant","text","size","sm","color","secondary","title","Remover color",3,"click"],["name","lucideGhost","size","1rem"],["app-icon-button","","variant","text","size","sm","color","secondary","title","Usar cuentagotas"],["app-icon-button","","variant","text","size","sm","color","secondary","title","Copiar",3,"click"],["name","lucideCopy","size","1rem"],[1,"color-input-container"],["id","opacity-input","type","number","min","0","max","100","step","1",1,"opacity-input","number-input-clean",3,"ngModelChange","ngModel"],["type","text","placeholder","color",1,"hex-input",3,"ngModelChange","ngModel"],["app-icon-button","","variant","text","size","sm","color","secondary","title","Usar cuentagotas",3,"click"],["name","lucidePipette","size","1rem"]],template:function(e,i){if(e&1){let n=M();l(0,"div",2)(1,"div",3)(2,"canvas",4,0),h("mousedown",function(s){return g(n),C(i.onCanvasMouseDown(s))}),a(),_(4,"div",5),a(),l(5,"div",6)(6,"div",7),h("mousedown",function(s){return g(n),C(i.onAlphaCanvasMouseDown(s))}),a(),_(7,"div",8),a(),l(8,"div",9)(9,"canvas",10,1),h("mousedown",function(s){return g(n),C(i.onHueCanvasMouseDown(s))}),a(),_(11,"div",11),a(),l(12,"div",12)(13,"div",13)(14,"div")(15,"button",14),h("click",function(){return g(n),C(i.makeTransparent())}),_(16,"ng-icon",15),a(),D(17,VC,2,0,"button",16),a(),l(18,"button",17),h("click",function(){return g(n),C(i.copyColor())}),_(19,"ng-icon",18),a()(),l(20,"div",19)(21,"input",20),ne("ngModelChange",function(s){return g(n),Z(i.opacityPercentage,s)||(i.opacityPercentage=s),C(s)}),h("ngModelChange",function(){return g(n),C(i.onOpacityChange())}),a(),l(22,"input",21),ne("ngModelChange",function(s){return g(n),Z(i.hexColor,s)||(i.hexColor=s),C(s)}),h("ngModelChange",function(s){return g(n),C(i.onHexInput(s))}),a()()()()}e&2&&(f("ngClass",te(10,OC,i.isDragging())),c(4),pi(i.colorIndicatorPosition()),c(3),xt("left",i.opacityPercentage()+"%"),c(4),xt("left",i.hueIndicatorPosition()),c(6),T(i.isEyeDropperSupported?17:-1),c(4),ie("ngModel",i.opacityPercentage),c(),ie("ngModel",i.hexColor))},dependencies:[_i,be,pe,Qe,Dn,Ne,or,nr,at,he,Ge,Je],styles:['[_nghost-%COMP%]{min-width:var(--size);display:block}.label[_ngcontent-%COMP%]{color:gray;font-size:.875rem;margin-top:.5rem}.color-picker[_ngcontent-%COMP%], .color-picker[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(input){-webkit-user-select:none;user-select:none}.color-picker.dragging[_ngcontent-%COMP%]:before{content:"";position:fixed;inset:0;background-color:#0000;z-index:-1}.color-canvas-container[_ngcontent-%COMP%]{position:relative}.color-canvas[_ngcontent-%COMP%]{cursor:crosshair}.hue-alpha-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.color-picker-container[_ngcontent-%COMP%]{position:relative;overflow:hidden}.alpha-canvas-container[_ngcontent-%COMP%], .hue-canvas-container[_ngcontent-%COMP%]{position:relative;height:20px;overflow-x:hidden;width:100%}canvas[_ngcontent-%COMP%]{display:block}.hue-canvas[_ngcontent-%COMP%], .alpha-canvas[_ngcontent-%COMP%]{cursor:pointer}.alpha-canvas[_ngcontent-%COMP%]{background:linear-gradient(to right,rgba(0,0,0,0),var(--color));height:20px;width:100%}.color-indicator[_ngcontent-%COMP%]{position:absolute;width:26px;height:26px;border:2px solid white;border-radius:50%;pointer-events:none;box-shadow:0 0 8px 1px #0003;transform:translate(-50%,-50%);background-color:var(--color);transition:background-color .1s ease-in-out}.hue-indicator[_ngcontent-%COMP%], .alpha-indicator[_ngcontent-%COMP%]{position:absolute;width:8px;height:20px;border-radius:0;box-shadow:none;border:1px solid black;transform:translate(-50%);background-color:#fff;top:0;pointer-events:none}.color-input-container[_ngcontent-%COMP%]{margin-top:.5rem;display:flex;gap:.5rem;align-items:center}.color-preview[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:.375rem;border:1px solid #d1d5db}.hex-input[_ngcontent-%COMP%]{flex:1;padding:.25rem .5rem;border:1px solid #d1d5db;border-radius:.375rem;font-size:.875rem;width:100%}.opacity-container[_ngcontent-%COMP%]{margin-top:.5rem;display:flex;align-items:center;gap:.5rem;justify-content:space-between}.opacity-input[_ngcontent-%COMP%]{width:3rem;padding:.25rem;border:1px solid #d1d5db;border-radius:.375rem;font-size:.875rem;text-align:center}.button-container[_ngcontent-%COMP%]{margin-top:.5rem;display:flex;gap:.5rem}'],changeDetection:0})};var qo=(e=>(e.ACTIVE="1",e.INACTIVE="0",e))(qo||{});var Nn=class o{API=`${Le.storage}/multimedia`;apiService=b(Lt);loadingService=b(Yt);confirmationService=b(ft);auth=b(xe);toastrService=b(tt);states=[{code:"1",denomination:"Activo"},{code:"0",denomination:"Inactivo"}];stateMap=this.states.reduce((t,e)=>(t[e.code]=e.denomination,t),{});canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.canAdd=this.auth.hasSubPermission("multimedia-ADD"),this.canEdit=this.auth.hasSubPermission("multimedia-EDIT"),this.canRemove=this.auth.hasSubPermission("multimedia-REMOVE"),this.canChangeState=this.auth.hasSubPermission("multimedia-CHANGE-STATE"),this.canExport=this.auth.hasPermission("multimedia-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("multimedia-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("multimedia-EXPORT-PDF")}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}patch(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}changeStateMessage(t){let e=this.stateMap[t],i="";switch(t){case"1":i="text-success";break;case"0":i="text-danger";break}return{message:`
            <div class="text-center">
                <div class="mb-3">\xBFEst\xE1 seguro de cambiar el estado del registro?</div>
                <h3 >Nuevo estado: <b class="${i}">${e}</b></h3>
            </div>
        `,denomination:e}}changeStateSave(t){return P(this,null,function*(){return yield this.apiService.putPrivate(`${this.API}/state/change/${t.id}`,t)})}changeState(t){return P(this,null,function*(){let{message:e}=this.changeStateMessage(t.state);if(!(yield this.confirmationService.create("Confirmar",e)))return;this.loadingService.open();let n=yield this.changeStateSave(t);return this.loadingService.hide(),n})}delete(t){return P(this,null,function*(){let e=yield this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}export(t,e,i=!0){return P(this,null,function*(){if(i&&!(yield this.confirmationService.create("Confirmar","\xBFEst\xE1 seguro de exportar los datos?")))return;this.loadingService.open();let n=re(k({},t),{type_export:e,url:Le.storage_view,institution:this.auth.getInstitution()}),r=yield this.apiService.getPrivate(`${this.API}/export`,n);return this.loadingService.hide(),r&&r.state=="success"&&window.open(r.url),r})}saveOrder(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/order/list`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var NC=o=>({active:o});function AC(o,t){if(o&1&&(l(0,"table",0)(1,"thead")(2,"tr"),_(3,"th",2)(4,"th"),a()(),l(5,"tbody")(6,"tr")(7,"td",3)(8,"b"),u(9," Tama\xF1o "),a()(),l(10,"td"),u(11),a()(),l(12,"tr")(13,"td",3)(14,"b"),u(15," Tipo "),a()(),l(16,"td"),u(17),a()(),l(18,"tr")(19,"td",3)(20,"b"),u(21," Estado "),a()(),l(22,"td"),_(23,"app-text-state",4),a()(),l(24,"tr")(25,"td",3)(26,"b"),u(27," Fecha de registro "),a()(),l(28,"td"),u(29),Ii(30,"date"),a()(),l(31,"tr")(32,"td",3)(33,"b"),u(34," Origen "),a()(),l(35,"td"),u(36),a()(),l(37,"tr")(38,"td",3)(39,"b"),u(40," Denominaci\xF3n "),a()(),l(41,"td"),u(42),a()(),l(43,"tr")(44,"td",3)(45,"b"),u(46," \xBFPublico? "),a()(),l(47,"td"),u(48),a()(),l(49,"tr")(50,"td",3)(51,"b"),u(52," Destino "),a()(),l(53,"td"),u(54),a()()()()),o&2){let e=d();c(11),W(e.item.fileSize),c(6),W(e.item.fileType),c(6),f("state",e.item.state),c(6),W(Di(30,8,e.item.createAt,"dd/MM/yyyy HH:mm:ss")),c(7),W(e.item.origin),c(6),W(e.item.denomination),c(6),W(e.item.isPublic),c(6),W(e.item.destination)}}function jC(o,t){if(o&1&&_(0,"img",6),o&2){let e=d(2);f("alt",lt(e.item.fileName))("src",e.item.fileUrl,mt)}}function RC(o,t){if(o&1&&(l(0,"a",7),_(1,"i",8),u(2," Doc "),a()),o&2){let e=d(2);f("href",lt(e.item.fileUrl),mt)}}function LC(o,t){if(o&1){let e=M();l(0,"div")(1,"button",9),h("click",function(n){g(e);let r=d(2);return C(r.openMenuEmit(n))}),_(2,"i",10),a()()}}function UC(o,t){if(o&1&&(l(0,"div",1)(1,"div",5),D(2,jC,1,3,"img",6)(3,RC,3,2,"a",7),l(4,"span"),u(5),a()(),D(6,LC,3,0,"div"),a()),o&2){let e=d();f("ngClass",te(4,NC,e.isActived)),c(2),T(e.item.fileType.includes("image")?2:3),c(3),W(e.item.denomination),c(),T(e.showOption?6:-1)}}var Cr=class o{item={};isActived=!1;card="box";showOption=!1;openMenu=new q;modeData="";multimediaService=b(Nn);openMenuEmit(t){this.openMenu.emit(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-multimedia-card"]],inputs:{item:"item",isActived:"isActived",card:"card",showOption:"showOption",modeData:"modeData"},outputs:{openMenu:"openMenu"},decls:2,vars:1,consts:[[1,"table","table-datos","box-main"],[1,"items","box-main","p-1",2,"border-radius","5px",3,"ngClass"],[2,"width","100px"],["nowrap",""],[3,"state"],[1,"d-flex","gap-3","align-items-center"],[3,"src","alt"],["target","_blank",1,"btn","btn-md-custom","btn-warning",3,"href"],[1,"icon","ion-md-attach"],["type","button",1,"btn","btn-more",3,"click"],[1,"icon","ion-md-more"]],template:function(e,i){e&1&&D(0,AC,55,11,"table",0)(1,UC,7,6,"div",1),e&2&&T(i.card=="table"?0:1)},dependencies:[be,Gi,Oi],styles:["img[_ngcontent-%COMP%]{max-width:40px;max-height:40px;width:100%;display:block;object-fit:contain}"]})};var fl=class o{constructor(t){this.activeModal=t}isModal=!0;item={};eventChange=new q;multimediaService=b(Nn);EMultimediaState=qo;close(){this.isModal?this.activeModal.close():this.eventChange.emit({event:"close",data:this.item})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-multimedia-detail"]],inputs:{isModal:"isModal",item:"item"},outputs:{eventChange:"eventChange"},decls:1,vars:1,consts:[["card","table",3,"item"]],template:function(e,i){e&1&&_(0,"app-ui-multimedia-card",0),e&2&&f("item",i.item)},dependencies:[Cr],encapsulation:2})};var zC=["_content"];function BC(o,t){if(o&1){let e=M();l(0,"button",8),h("click",function(){g(e);let n=d();return C(n.onClose())}),_(1,"ng-icon",9),a()}}function WC(o,t){if(o&1){let e=M();l(0,"button",10),h("click",function(){g(e);let n=d();return C(n.onClose())}),u(1,"Cancelar"),a()}}function $C(o,t){if(o&1){let e=M();l(0,"button",11),h("click",function(){g(e);let n=d();return C(n.onConfirm())}),u(1,"Aceptar"),a()}}var hl=class o{element=b(an);cdr=b(jo);width=A("28rem");hiddenCloseButton=A(!1);hiddenConfirmButton=A(!1);hiddenButtons=A(!1);hiddenMargin=A(!1);hostClass=ce(()=>[this.hiddenButtons()?"hidden-buttons":"",this.hiddenMargin()?"hidden-margin":""]);set config(t){this._config=t,this.width.set(this.calculateModalWidth()),this.hiddenMargin.set(t.hiddenMargin===!0),this.hiddenCloseButton.set(t.hiddenCloseButton===!0),this.hiddenConfirmButton.set(t.hiddenConfirmButton===!0),this.hiddenButtons.set(t.hiddenButtons===!0)}constructor(){yt(()=>{let t=this.width(),e=this.modalContent();e&&(e.style.maxWidth=t,e.style.width="100%")})}closeOnOverlayClick=!1;close=new q;_content;componentRef=null;_config;_comp;modalContent=A(null);ngAfterViewInit(){this._comp&&this.loadComponent(this._comp);let t=this.element.nativeElement.closest(".modal-dialog");t&&this.modalContent.set(t)}calculateModalWidth(){let t;switch(this._config?.size){case"sm":t="400px";break;case"md":t="600px";break;case"lg":t="800px";break;case"xl":t="1000px";break;default:t=this._config?.size||"600px"}return t}loadComponent(t){return this._content?(this._content.clear(),this.componentRef=this._content.createComponent(t),this._config?.params&&Object.assign(this.componentRef.instance,this._config.params),this._config?.inputs&&this.componentRef&&Object.entries(this._config.inputs).forEach(([e,i])=>{e in this.componentRef.instance&&this.componentRef?.setInput(e,i)}),this.cdr.detectChanges(),this.componentRef):null}onClose(){this.close.emit({isOk:!1,data:null})}onConfirm(){this.close.emit({isOk:!0,data:null})}onOverlayClick(t){t.target.classList.contains("modal-overlay")&&this.closeOnOverlayClick&&this.onClose()}handleEscapeKey(t){t.key==="Escape"&&this._config?.dismissible!==!1&&this.onClose()}ngOnDestroy(){this.componentRef&&this.componentRef.destroy()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-modal"]],viewQuery:function(e,i){if(e&1&&ut(zC,5,er),e&2){let n;ct(n=dt())&&(i._content=n.first)}},hostVars:4,hostBindings:function(e,i){e&1&&h("keydown",function(r){return i.handleEscapeKey(r)},os),e&2&&(it(i.hostClass()),xt("max-width",i.width()))},inputs:{closeOnOverlayClick:"closeOnOverlayClick"},outputs:{close:"close"},features:[we([Te({lucideX:dr})])],decls:10,vars:4,consts:[["_content",""],[1,"close-button"],[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"footer"],["app-button","","variant","outline","color","secondary","size","lg"],["app-button","","size","lg"],[1,"close-button",3,"click"],["name","lucideX","size","20"],["app-button","","variant","outline","color","secondary","size","lg",3,"click"],["app-button","","size","lg",3,"click"]],template:function(e,i){e&1&&(D(0,BC,2,0,"button",1),l(1,"div",2)(2,"h3",3),u(3),a()(),l(4,"div",4),la(5,null,0),a(),l(7,"div",5),D(8,WC,2,0,"button",6),D(9,$C,2,0,"button",7),a()),e&2&&(T(i._config.dismissible!==!1?0:-1),c(3),W(i._config.title),c(5),T(i.hiddenCloseButton()?-1:8),c(),T(i.hiddenConfirmButton()?-1:9))},dependencies:[Je,he,Be],styles:["[_nghost-%COMP%]{display:block;color:var(--fuse-text-default)}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;overflow-y:auto;height:100%;width:100%;display:flex;align-items:center;flex-direction:column;padding:2rem}.modal-header[_ngcontent-%COMP%]{padding:var(--bs-modal-header-padding);display:flex;justify-content:space-between;align-items:center;border-top-left-radius:.5rem;border-top-right-radius:.5rem;position:relative;padding-top:5px;padding-bottom:5px;border-bottom:1px solid rgba(0,0,0,.1215686275);color:var(--fuse-text-default)}.modal-title[_ngcontent-%COMP%]{font-size:1.25rem}.close-button[_ngcontent-%COMP%]{background-color:var(--bs-red);color:#fff;border:none;border-radius:50%;width:50px;height:50px;display:flex;justify-content:center;align-items:center;cursor:pointer;position:absolute;right:0rem;top:0rem;transform:translate(50%,-50%);z-index:3}.close-button[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{transition:transform .2s ease}.close-button[_ngcontent-%COMP%]:hover > *[_ngcontent-%COMP%]{transform:scale(1.4)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem;color:var(--fuse-text-default)}.footer[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:.25rem 1rem;gap:.5rem;background:var(--modal-bg);border-radius:0 0 15px 15px!important}.hidden-buttons[_nghost-%COMP%]   .footer[_ngcontent-%COMP%]{display:none}.hidden-margin[_nghost-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:0}@media (max-width: 768px){.modal-overlay[_ngcontent-%COMP%]{padding:0}.close-button[_ngcontent-%COMP%]{height:40px;width:40px;transform:translate(0)}}[_nghost-%COMP%]     .modal-footer{width:calc(100% + 3rem);margin:1.5rem -1.5rem -1.5rem;display:flex;justify-content:center}[_nghost-%COMP%]     .hidden-margin .modal-body{margin:0}[_nghost-%COMP%]     .hidden-margin .footer{width:100%;margin:0}"],changeDetection:0})};var Ud=class{constructor(t){this.componentRef=t}result=()=>P(this,null,function*(){return yield this.componentRef.result})},St=class o{ngModal=b(Vi);modals=[];constructor(){this.ngModal.activeInstances.pipe(fs()).subscribe(t=>{this.modals=t})}open(t,e){let i=this.ngModal.open(hl,{size:e.size,backdrop:"static",keyboard:!1});i.componentInstance.config=e,i.componentInstance._comp=t,i.componentInstance.modalService=this;let n=new Ud(i);return i.componentInstance.close.subscribe(r=>{i.close(r)}),n}openAsync(t,e){return P(this,null,function*(){return yield this.open(t,e).result()})}ok(t){if(this.modals.length===0)return;this.modals[this.modals.length-1].close({isOk:!0,data:t})}close(){if(this.modals.length===0)return;this.modals[this.modals.length-1].dismiss({isOk:!1,data:null})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var HC=o=>({"has-danger":o});function GC(o,t){if(o&1){let e=M();l(0,"div",8)(1,"button",9),h("click",function(){g(e);let n=d();return C(n.close())}),u(2,"Cancelar"),a(),l(3,"button",10),h("click",function(){g(e);let n=d();return C(n.save())}),u(4,"Guardar"),a()()}}function qC(o,t){o&1&&_(0,"app-loading")}var gl=class o{modalService=b(St);accion="add";multimedia;isModal=!0;idinstitucion="";uid="";fileType="";state="1";origin_id="";destination="local";showOption=!0;onSave=new ki(!1);eventChange=new q;multimediaService=b(Nn);authService=b(xe);uploadService=b(mr);toastService=b(tt);states=this.multimediaService.states;autoOpen=!1;subscriptions=[];ngOnInit(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.uid===""&&(this.uid=this.authService.userData.id+"");let t=this.onSave.subscribe(e=>{e&&this.save()});if(this.subscriptions.push(t),this.accion=="update"){if(!this.multimedia)return;this.form.patchValue({fileSize:this.multimedia.fileSize+"",fileType:this.multimedia.fileType,state:this.multimedia.state,origin:this.multimedia.origin,originId:this.multimedia.origin_id,denomination:this.multimedia.denomination,orderList:this.multimedia.orderList+"",isPublic:this.multimedia.isPublic,destination:this.multimedia.destination}),this.multimedia.fileUrl==""&&(this.file.type="link"),this.file.name=this.multimedia.fileName??"",this.file.url=this.multimedia.fileUrl??"",this.file.required=!1}else this.accion=="add"&&this.form.patchValue({fileType:this.fileType,state:this.state,originId:this.origin_id,destination:this.destination,denomination:"-"})})}ngAfterViewInit(){setTimeout(()=>{document.getElementById("fileSizeMu")?.focus()},150)}form=new ni({fileSize:new Fe("0",{validators:[ze.required],nonNullable:!0}),fileType:new Fe("",{validators:[ze.required],nonNullable:!0}),state:new Fe("1",{validators:[ze.required],nonNullable:!0}),origin:new Fe("",{validators:[],nonNullable:!0}),originId:new Fe("",{validators:[],nonNullable:!0}),denomination:new Fe("",{validators:[ze.required],nonNullable:!0}),orderList:new Fe("0",{validators:[ze.required],nonNullable:!0}),isPublic:new Fe("1",{validators:[ze.required],nonNullable:!0}),destination:new Fe("",{validators:[ze.required],nonNullable:!0})});get fileSizeControl(){return this.form.get("fileSize")}get fileTypeControl(){return this.form.get("fileType")}get stateControl(){return this.form.get("state")}get originControl(){return this.form.get("origin")}get originIdControl(){return this.form.get("originId")}get denominationControl(){return this.form.get("denomination")}get orderListControl(){return this.form.get("orderList")}get isPublicControl(){return this.form.get("isPublic")}get destinationControl(){return this.form.get("destination")}close(){this.isModal?this.modalService.close():this.eventChange.emit({event:"close",data:void 0})}submit=!1;loading=A(!1);save(){return P(this,null,function*(){if(console.log(" estas guardando"),this.submit=!0,!this.form.valid)return;this.submit=!1,console.log("estas guardando 2");let t=this.form.value;if(yield this.uploadFile()){if(this.accion=="add"){console.log("445545");let i={fileName:this.file.name,fileUrl:this.file.url,fileSize:+t.fileSize,fileType:t.fileType,state:t.state,createBy:this.uid,origin:t.origin,origin_id:t.originId,denomination:t.denomination,idinstitucion:this.idinstitucion,orderList:+t.orderList,isPublic:t.isPublic,destination:t.destination};this.loading.set(!0);let n=yield this.multimediaService.add(i);this.loading.set(!1),n.state=="success"&&(this.isModal?this.modalService.ok(n.data):this.eventChange.emit({event:"add",data:n.data}))}else if(this.accion=="update"){let i={id:+this.multimedia?.id,fileName:this.file.name,fileUrl:this.file.url,fileSize:+t.fileSize,fileType:t.fileType,state:t.state,origin:t.origin,origin_id:t.originId,denomination:t.denomination,idinstitucion:this.idinstitucion,orderList:+t.orderList,isPublic:t.isPublic,destination:t.destination};this.loading.set(!0);let n=yield this.multimediaService.update(i);this.loading.set(!1),n.state=="success"&&(this.isModal?this.modalService.ok(i):this.eventChange.emit({event:"update",data:i}))}}})}currentFiles=null;file={required:!0,type:"file",name:"",url:""};eventFile(t){return P(this,null,function*(){if(console.log(t),this.file.type="file",this.file.name="",this.file.url="",t.event=="clear"){this.currentFiles=null;return}if(t.event=="files"){if(this.currentFiles=t.files??null,this.currentFiles&&this.currentFiles.length>0){let e=this.currentFiles[0],i=e.type.split("/")[0];this.form.patchValue({fileSize:e.size+"",fileType:e.type,destination:i==="image"?"local":"drive"})}return}t.event=="link"&&(this.file.url=t.url??"",this.file.name=t.name??"",this.currentFiles=null,this.file.type="link")})}uploadFile(){return P(this,null,function*(){if(this.file.required&&this.accion=="add"&&this.file.type=="file"&&(!this.currentFiles||this.currentFiles?.length==0))return this.toastService.error("Debe seleccionar un archivo"),!1;if(this.file.type=="file"&&this.currentFiles&&this.currentFiles.length>0){let t=this.currentFiles[0];this.loading.set(!0);let e=yield this.uploadService.uploadFile("global-multimedia",t,{destino:this.destinationControl.value});if(this.loading.set(!1),e&&e.state=="success")this.file.url=e.url??"",this.file.name=e.nameFile??"";else return!1}return!0})}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-multimedia-form"]],inputs:{accion:"accion",multimedia:"multimedia",isModal:"isModal",idinstitucion:"idinstitucion",uid:"uid",fileType:"fileType",state:"state",origin_id:"origin_id",destination:"destination",showOption:"showOption",onSave:"onSave",autoOpen:"autoOpen"},outputs:{eventChange:"eventChange"},decls:11,vars:9,consts:[[1,"container",3,"submit","formGroup"],[1,"form-group","row",3,"ngClass"],["for","denominationMu",1,"control-label","col-12","col-md-3"],[1,"col-12","col-md-9"],["type","text","name","denominationMu","id","denominationMu","formControlName","denomination",1,"form-control"],[1,"left",3,"control","show"],[1,"form-group"],[3,"evento","url"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary","btn-lg-medio","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-lg-medio",3,"click"]],template:function(e,i){e&1&&(l(0,"form",0),h("submit",function(){return i.save()}),l(1,"div",1)(2,"label",2),u(3,"Denominaci\xF3n "),a(),l(4,"div",3),_(5,"input",4)(6,"app-control-messages",5),a()(),l(7,"div",6)(8,"app-file-upload",7),h("evento",function(r){return i.eventFile(r)}),a()()(),D(9,GC,5,0,"div",8),D(10,qC,1,0,"app-loading")),e&2&&(f("formGroup",i.form),c(),f("ngClass",te(7,HC,i.denominationControl.invalid&&(i.denominationControl.touched||i.submit))),c(5),f("control",i.denominationControl)("show",i.submit),c(2),f("url",i.file.url),c(),T(i.showOption?9:-1),c(),T(i.loading()?10:-1))},dependencies:[Kt,Zt,Qe,Ne,Xt,Qt,ri,bi,be,Ye,so],encapsulation:2})};var JC=o=>({active:o}),Ef=(o,t)=>({item:o,indice:t}),XC=(o,t)=>t.id;function ZC(o,t){if(o&1){let e=M();l(0,"button",8),h("click",function(){g(e);let n=d();return C(n.saveOrder())}),u(1,"Guardar orden"),a()}}function QC(o,t){if(o&1){let e=M();l(0,"tr",13,1),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))}),l(2,"td",14),u(3),a(),l(4,"td",14),u(5),a(),l(6,"td",14),u(7),a(),l(8,"td",14),u(9),a(),l(10,"td",14),u(11),a(),l(12,"td",14),_(13,"app-text-state",15),a(),l(14,"td",14),u(15),a(),l(16,"td",14),u(17),a(),l(18,"td",14),u(19),a(),l(20,"td",14),u(21),a(),l(22,"td",14),u(23),a(),l(24,"td",14)(25,"button",16),h("click",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),C(s.open(n))}),_(26,"i",17),a()()()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(5);f("ngClass",te(14,JC,e.id==n.selected.id))("contextMenu",r)("contextMenuValue",vt(16,Ef,e,i)),c(3),Ie(" ",(i+1).zfill(2)," "),c(2),W(e.fileName),c(2),W(e.fileUrl),c(2),W(e.fileSize),c(2),W(e.fileType),c(2),f("state",e.state),c(2),W(e.origin),c(2),W(e.denomination),c(2),W(e.orderList),c(2),W(e.isPublic),c(2),W(e.destination)}}function KC(o,t){if(o&1){let e=M();l(0,"div")(1,"table",9)(2,"thead")(3,"tr")(4,"th",10),u(5,"#"),a(),l(6,"th"),u(7,"Nombre"),a(),l(8,"th"),u(9,"URL"),a(),l(10,"th"),u(11,"Tama\xF1o"),a(),l(12,"th"),u(13,"Tipo"),a(),l(14,"th"),u(15,"Estado"),a(),l(16,"th"),u(17,"Origen"),a(),l(18,"th"),u(19,"Denominaci\xF3n"),a(),l(20,"th"),u(21,"Orden"),a(),l(22,"th"),u(23,"\xBFPublico?"),a(),l(24,"th"),u(25,"Destino"),a(),_(26,"th",10),a()(),l(27,"tbody",11),h("onUpdate",function(n){g(e);let r=d();return C(r.changeList(n))}),Y(28,QC,27,19,"tr",12,XC),a()()()}if(o&2){let e=d();c(27),f("items",e.multimedias()),c(),ee(e.multimedias())}}function YC(o,t){if(o&1){let e=M();l(0,"app-ui-multimedia-card",19,1),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))})("openMenu",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),C(s.open(n))}),a()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(5);f("card",Re("",n.mode," "))("item",e)("isActived",e.id==n.selected.id)("contextMenu",r)("showOption",!1)("contextMenuValue",vt(7,Ef,e,i))}}function e_(o,t){o&1&&_(0,"app-ui-message-empty")}function t_(o,t){if(o&1&&(l(0,"div"),Y(1,YC,2,10,"app-ui-multimedia-card",18,de,!1,e_,1,0,"app-ui-message-empty"),a()),o&2){let e=d();it(Re("_",e.mode)),c(),ee(e.multimedias())}}function i_(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",22),a(),l(3,"div",23),u(4,"Ver detalles"),a(),_(5,"div",24),a())}function n_(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",25),a(),l(3,"div",23),u(4,"Adicionar"),a(),l(5,"div",24),u(6,"F1"),a()())}function o_(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",26),a(),l(3,"div",23),u(4,"Editar"),a(),_(5,"div",24),a())}function r_(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",27),a(),l(3,"div",23),u(4,"Eliminar"),a(),_(5,"div",24),a())}function a_(o,t){}function s_(o,t){o&1&&(l(0,"div",20)(1,"div",28),_(2,"i",29),a(),l(3,"div",23),u(4,"Activar"),a(),_(5,"div",24),a())}function l_(o,t){o&1&&(l(0,"div",20)(1,"div",30),_(2,"i",31),a(),l(3,"div",23),u(4,"Bloquear"),a(),_(5,"div",24),a())}function c_(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",32),a(),l(3,"div",23),u(4,"Actualizar lista"),a(),_(5,"div",24),a())}function d_(o,t){o&1&&_(0,"app-loading")}var ho=class o{idinstitucion="";fileType="";state="1";origin_id="";destination="";showPagination=!0;mode="table";size="lg";modeSelection=le(!1);eventChange=new q;multimedias=A([]);load=!0;multimediaService=b(Nn);authService=b(xe);confirmationService=b(ft);modalService=b(St);filter={texto:""};EMultimediaState=qo;loading=A(!1);ngOnInit(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.filter.idinstitucion=this.idinstitucion,this.filter.fileType=this.fileType,this.filter.state=this.state,this.filter.origin_id=this.origin_id,this.filter.destination=this.destination,this.load&&this.resetPage()})}page=1;resetPage(){return P(this,null,function*(){this.page=1,this.list()})}onPage(){this.list()}list(){return P(this,null,function*(){this.loading.set(!0),this.showPagination&&(this.filter.page=this.page);let t=yield this.multimediaService.list(this.filter);this.loading.set(!1),t&&t.state=="success"&&this.multimedias.set(t.data??[])})}add(){this.openForm()}update(t){this.openForm("update",t)}openForm(t="add",e){return P(this,null,function*(){try{let n=yield this.modalService.open(gl,{title:t=="add"?"Agregar Multimedia":"Editar Multimedia",hiddenButtons:!0,params:{accion:t,idinstitucion:this.filter.idinstitucion,fileType:this.filter.fileType,origin_id:this.filter.origin_id,destination:this.filter.destination,multimedia:t=="update"?JSON.parse(JSON.stringify(e)):void 0,autoOpen:!0}}).result();if(n.isOk){if(t=="add")this.multimedias.set([...this.multimedias(),n.data]);else if(t=="update"){if(!e)return;Object.assign(e,n.data)}}}catch{}})}remove(t,e=-1){return P(this,null,function*(){if(!(yield this.confirmationService.create("Eliminar","\xBFEst\xE1 seguro de eliminar el registro?")))return;this.loading.set(!0);let n=yield this.multimediaService.delete({id:t.id,idinstitucion:t.idinstitucion});if(this.loading.set(!1),n.state=="success"){let r=this.multimedias();r.splice(e,1),this.multimedias.set([...r]),this.selected={}}})}openDetail(t){return P(this,null,function*(){try{this.modalService.open(fl,{title:"Detalle Multimedia",hiddenButtons:!0,hiddenMargin:!0,params:{item:t}})}catch{}})}changeState(t,e){return P(this,null,function*(){let i={id:t.id,idinstitucion:t.idinstitucion,state:e},n=yield this.multimediaService.changeState(i);n&&n.state=="success"&&(t.state=e)})}searchChange(){this.resetPage()}stateFilterChange(){this.resetPage()}selected={};select(t,e="click"){this.selected=t,e=="dblclick"&&!this.modeSelection()&&this.openDetail(t),this.eventChange.emit({event:e,data:JSON.parse(JSON.stringify(t))})}canAdd=()=>this.multimediaService.canAdd;canEdit=()=>this.multimediaService.canEdit;canRemove=()=>this.multimediaService.canRemove;canChangeState=()=>this.multimediaService.canChangeState;canChangeStateACTIVE=t=>this.multimediaService.canChangeState&&t.item.state!="1";canChangeStateINACTIVE=t=>this.multimediaService.canChangeState&&t.item.state!="0";changeMode(t){this.mode=t}changes=[];changeList(t){if(this.multimedias().forEach((e,i)=>{e.order_new=i+1}),this.detectSaveOrder(),this.mode!="table"){let e=this.mode;this.mode="table",setTimeout(()=>{this.mode=e})}}detectSaveOrder(){}saveOrder(){return P(this,null,function*(){})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-multimedia-list"]],inputs:{idinstitucion:"idinstitucion",fileType:"fileType",state:"state",origin_id:"origin_id",destination:"destination",showPagination:"showPagination",mode:"mode",size:"size",modeSelection:[1,"modeSelection"],load:"load"},outputs:{eventChange:"eventChange"},decls:16,vars:18,consts:[["menu",""],["ngxContextMenu","ngxContextMenu"],["type","button",1,"btn","btn-warning","btn-md-custom","btn-order"],[3,"stateChange","searchChange","onAdd","onSearch","reload","pageChange","modeChange","state","search","page","showPagination","canNew","mode","showMode","size","showExport"],[3,"class"],["contextMenuItem","",3,"execute"],["contextMenuItem","",3,"execute","visible"],["contextMenuItem","",3,"divider"],["type","button",1,"btn","btn-warning","btn-md-custom","btn-order",3,"click"],[1,"table","table-sm","table-box","table-fixed"],[2,"width","40px"],["sortablejs","",3,"onUpdate","items"],[3,"ngClass","contextMenu","contextMenuValue"],[3,"elementEvents","ngClass","contextMenu","contextMenuValue"],[1,"text-center"],[3,"state"],[1,"btn","btn-more",3,"click"],[1,"ion-md-more"],[3,"item","isActived","card","contextMenu","showOption","contextMenuValue"],[3,"elementEvents","openMenu","item","isActived","card","contextMenu","showOption","contextMenuValue"],[1,"_items"],[1,"icons"],[1,"icons","icon","ion-md-list-box"],[1,"label","w-100"],[1,"atajo"],[1,"icons","icon","ion-md-add"],[1,"icons","icon","ion-md-create"],[1,"icons","icon","ion-md-trash"],[1,"icons","text-success"],[1,"icon","ion-md-eye"],[1,"icons","text-danger"],[1,"icon","ion-md-eye-off"],[1,"icons","icon","ion-md-refresh"]],template:function(e,i){if(e&1){let n=M();D(0,ZC,2,0,"button",2),l(1,"app-ui-header-management",3),ne("stateChange",function(s){return g(n),Z(i.filter.state,s)||(i.filter.state=s),C(s)})("searchChange",function(s){return g(n),Z(i.filter.texto,s)||(i.filter.texto=s),C(s)}),h("onAdd",function(){return g(n),C(i.add())})("onSearch",function(){return g(n),C(i.searchChange())})("reload",function(){return g(n),C(i.resetPage())}),ne("pageChange",function(s){return g(n),Z(i.page,s)||(i.page=s),C(s)}),h("pageChange",function(){return g(n),C(i.onPage())}),ne("modeChange",function(s){return g(n),Z(i.mode,s)||(i.mode=s),C(s)}),a(),D(2,KC,30,1,"div")(3,t_,4,4,"div",4),l(4,"context-menu",null,0),Se(6,i_,6,0,"ng-template",5),h("execute",function(s){return g(n),C(i.openDetail(s.value.item))}),Se(7,n_,7,0,"ng-template",6),h("execute",function(){return g(n),C(i.add())}),Se(8,o_,6,0,"ng-template",6),h("execute",function(s){return g(n),C(i.update(s.value.item))}),Se(9,r_,6,0,"ng-template",6),h("execute",function(s){return g(n),C(i.remove(s.value.item,s.value.indice))}),Se(10,a_,0,0,"ng-template",7)(11,s_,6,0,"ng-template",6),h("execute",function(s){return g(n),C(i.changeState(s.value.item,i.EMultimediaState.ACTIVE))}),u(12,", "),Se(13,l_,6,0,"ng-template",6),h("execute",function(s){return g(n),C(i.changeState(s.value.item,i.EMultimediaState.INACTIVE))}),Se(14,c_,6,0,"ng-template",5),h("execute",function(){return g(n),C(i.list())}),a(),D(15,d_,1,0,"app-loading")}e&2&&(T(i.changes.length?0:-1),c(),ie("state",i.filter.state)("search",i.filter.texto)("page",i.page),f("showPagination",i.showPagination)("canNew",i.multimediaService.canAdd),ie("mode",i.mode),f("showMode",!1)("size",i.size)("showExport",!1),c(),T(i.mode=="table"?2:3),c(5),f("visible",i.canAdd),c(),f("visible",i.canEdit),c(),f("visible",i.canRemove),c(),f("divider",!0),c(),f("visible",i.canChangeStateACTIVE),c(2),f("visible",i.canChangeStateINACTIVE),c(2),T(i.loading()?15:-1))},dependencies:[si,Si,wi,xi,be,pe,Gi,Ye,Ke,At,Cr,Ei,dn,Ni,lo],encapsulation:2})};var m_=()=>["checkerboard","mixed"];function p_(o,t){if(o&1&&ii(0,"div")(1,"div"),o&2){let e=d();xt("background",e.colorWithoutAlpha()),c(),xt("background",e.colorWithAlpha())}}function u_(o,t){if(o&1&&ii(0,"div"),o&2){let e=d();xt("background",e.colorWithAlpha())}}function f_(o,t){if(o&1&&ii(0,"div")(1,"div"),o&2){let e=d();xt("background",e.colorWithoutAlpha()),c(),xt("background",e.colorWithAlpha())}}var Ki=class o{set color(t){this.processColor(t)}size=le("32px");displayMode=le("normal");colorWithoutAlpha=A("#000");colorWithAlpha=A("#000");processColor(t){let i=new OffscreenCanvas(1,1).getContext("2d");if(i){i.clearRect(0,0,1,1),i.fillStyle=t,i.fillRect(0,0,1,1);let[n,r,s,m]=i.getImageData(0,0,1,1).data;this.colorWithoutAlpha.set(`rgb(${n}, ${r}, ${s})`),this.colorWithAlpha.set(`rgba(${n}, ${r}, ${s}, ${m/255})`)}}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-color-box"]],hostVars:9,hostBindings:function(e,i){e&2&&(it(Xi(8,m_).includes(i.displayMode())?"checkerboard-background":""),xt("width",i.size())("height",i.size())("--checker-color",i.colorWithoutAlpha()))},inputs:{color:"color",size:[1,"size"],displayMode:[1,"displayMode"]},decls:3,vars:1,consts:[[3,"background"]],template:function(e,i){e&1&&D(0,p_,2,4)(1,u_,1,2,"div",0)(2,f_,2,4),e&2&&T(i.displayMode()==="normal"?0:i.displayMode()==="checkerboard"?1:i.displayMode()==="mixed"?2:-1)},styles:["[_nghost-%COMP%]{display:inline-flex;overflow:hidden;justify-content:stretch;align-items:stretch}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{flex:1}.color-box[_ngcontent-%COMP%]{position:relative;flex:1}.checkerboard-background[_nghost-%COMP%]{background-image:linear-gradient(45deg,var(--checker-color) 25%,transparent 25%),linear-gradient(-45deg,var(--checker-color) 25%,transparent 25%),linear-gradient(45deg,transparent 75%,var(--checker-color) 75%),linear-gradient(-45deg,transparent 75%,var(--checker-color) 75%);background-size:8px 8px;background-position:0 0,0 4px,4px -4px,-4px 0px}"],changeDetection:0})};var Pf=o=>({background:o});function h_(o,t){if(o&1){let e=M();l(0,"div",0)(1,"button",4),h("click",function(){g(e);let n=d();return C(n.changeMode("base"))}),u(2,"Color"),a(),l(3,"button",4),h("click",function(){g(e);let n=d();return C(n.changeMode("linear"))}),u(4,"Linear"),a(),l(5,"button",4),h("click",function(){g(e);let n=d();return C(n.changeMode("image"))}),u(6,"Image"),a()()}if(o&2){let e=d();c(),f("variant",e.mode()=="base"?"flat":"outline"),c(2),f("variant",e.mode()=="linear"?"flat":"outline"),c(2),f("variant",e.mode()=="image"?"flat":"outline")}}function g_(o,t){if(o&1){let e=M();l(0,"app-color-selector",5),ne("colorChange",function(n){g(e);let r=d();return Z(r.activeColor,n)||(r.activeColor=n),C(n)}),h("colorChange",function(n){g(e);let r=d();return C(r.onColorChange(n))}),a()}if(o&2){let e=d();ie("color",e.activeColor)}}function C_(o,t){if(o&1){let e=M();l(0,"input",6),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.image,n)||(r.image=n),C(n)}),h("ngModelChange",function(){g(e);let n=d();return C(n.updateData())}),a(),_(1,"img",7)}if(o&2){let e=d();ie("ngModel",e.image),c(),f("src",e.image(),mt)}}function __(o,t){if(o&1){let e=M();l(0,"app-color-box",13),h("click",function(){let n=g(e).$implicit,r=d(2);return C(r.onCustomColorChange(n.color))}),a()}if(o&2){let e=t.$implicit;f("color",e.color)}}function v_(o,t){if(o&1){let e=M();l(0,"div")(1,"app-color-box",13),h("click",function(){let n=g(e).$implicit,r=d(2);return C(r.onCustomColorChange(n.color))}),a(),l(2,"span"),u(3),a()()}if(o&2){let e=t.$implicit;c(),f("color",e.color),c(2),W(e.name)}}function y_(o,t){if(o&1&&(l(0,"div",12),_(1,"div",14),l(2,"span"),u(3),a()()),o&2){let e=d(2);c(),pi(te(3,Pf,e.color())),c(2),W(e.color())}}function b_(o,t){if(o&1){let e=M();l(0,"div",16),h("click",function(){let n=g(e).$index,r=d(3);return C(r.changeActiveGradientColor(n))}),_(1,"div",14),l(2,"div",17)(3,"span"),u(4),a(),_(5,"ng-icon",18),a()()}if(o&2){let e=t.$implicit,i=t.$index,n=d(3);c(),pi(te(4,Pf,e[0])),c(3),W(e[0]),c(),f("name",n.activeGradientColor()==i?"lucideSquareCheck":"lucideSquare")}}function x_(o,t){if(o&1&&Y(0,b_,6,6,"div",15,de),o&2){let e=d(2);ee(e.gradient())}}function w_(o,t){if(o&1&&(l(0,"div",8),Y(1,__,1,1,"app-color-box",9,de),a(),l(3,"div",10),Y(4,v_,4,2,"div",null,de),a(),l(6,"div",11),D(7,y_,4,5,"div",12)(8,x_,2,0),a()),o&2){let e=d();c(),ee(e.sugestionColors),c(3),ee(e.designerSugestionColors),c(3),T(e.mode()=="base"?7:e.mode()=="linear"&&!e.modeOnlyColor()?8:-1)}}var Cl=class o{ds=b(Ue);activeColor=A("#000000FF");color=A("#000000FF");activeGradientColor=A(0);gradient=A([]);gradientType=A("linear");angle=A(0);image=A("");sugestionColors=[...pl,...ml];designerSugestionColors=this.ds.palettColors().map(t=>({name:t.label,color:t.color}));mode=A("base");background=A("#00000000");modeOnlyColor=A(!1);set onlyColor(t){this.modeOnlyColor.set(t)}set value(t){try{t=k(k({},ti),t),this.gradient.set(JSON.parse(t["ctrl-g"])),this.gradientType.set(t["ctrl-g-type"]),this.angle.set(parseInt(t["ctrl-g-a"])),this.image.set(t["ctrl-i"]),this.color.set(t["ctrl-c"]),this.background.set(t.background),this.changeMode(t["ctrl-mode"])}catch{this.gradient.set([]),this.gradientType.set("linear"),this.angle.set(0),this.image.set(""),this.color.set("#000000FF")}}valueChange=Oe();changeActiveGradientColor(t){this.activeGradientColor.set(t),this.activeColor.set(this.gradient()[this.activeGradientColor()][0])}changeMode(t){this.modeOnlyColor()&&t!=="base"||(this.mode.set(t),t=="base"&&this.activeColor.set(this.color()),t=="linear"&&(this.gradient().length==0&&this.gradient.set([[this.color(),"0%"],[this.color(),"100%"]]),this.activeGradientColor.set(0),this.activeColor.set(this.gradient()[this.activeGradientColor()][0])),t=="image"&&this.image()==""&&this.image.set("https://images.unsplash.com/photo-1742403949587-42a767b9ea5b"),this.updateData())}onCustomColorChange(t){this.activeColor.set(t),this.onColorChange(t)}onColorChange(t){if(this.mode()=="base"&&this.color.set(t),this.mode()=="linear"){let e=this.gradient();e[this.activeGradientColor()]=[t,e[this.activeGradientColor()][1]],this.gradient.set(e)}this.updateData()}onEvent(t){t.event=="click"&&(this.image.set(t.data.fileUrl),this.updateData())}updateData(){let t={};t["ctrl-c"]=this.color(),this.mode()=="base"&&(t.background=this.color(),t["ctrl-mode"]="base"),this.mode()=="linear"&&(t.background=`linear-gradient(${this.angle()}deg, ${this.gradient().map(e=>e[0]).join(", ")})`,t["ctrl-g"]=JSON.stringify(this.gradient()),t["ctrl-g-type"]=this.gradientType(),t["ctrl-g-a"]=this.angle()+"",t["ctrl-mode"]="linear"),this.mode()=="image"&&(t.background=`url(${this.image()}) center / cover no-repeat scroll`,t["ctrl-i"]=this.image(),t["ctrl-mode"]="image"),this.background()!=t.background&&(this.background.set(t.background),this.valueChange.emit(t))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-fill-picker"]],inputs:{onlyColor:"onlyColor",value:"value"},outputs:{valueChange:"valueChange"},features:[we([],[Te({lucideSquare:$s,lucideSquareCheck:Lu})])],decls:6,vars:8,consts:[[1,"d-flex","align-items-center","gap-1","p-1"],[3,"color"],[3,"hidden"],["mode","list",2,"max-height","400px","overflow-y","auto","display","block",3,"eventChange","modeSelection","size","showPagination"],["app-button","","size","sm",3,"click","variant"],[3,"colorChange","color"],["type","text","placeholder","Image URL",1,"url-input",3,"ngModelChange","ngModel"],["alt","Image",2,"width","100%","height","120px","object-fit","cover",3,"src"],[1,"color-selection"],["size","18px",3,"color"],[1,"color-selection-designer"],[1,"action-area"],[1,"d-flex","align-items-center","gap-2"],["size","18px",3,"click","color"],[1,"box-color"],[1,"gradient-item"],[1,"gradient-item",3,"click"],[1,"d-flex","align-items-center","justify-content-between","w-100"],["size","24",3,"name"]],template:function(e,i){e&1&&(D(0,h_,7,3,"div",0),D(1,g_,1,1,"app-color-selector",1),D(2,C_,2,2),l(3,"div",2)(4,"app-ui-multimedia-list",3),h("eventChange",function(r){return i.onEvent(r)}),a()(),D(5,w_,9,1)),e&2&&(T(i.modeOnlyColor()?-1:0),c(),T(i.mode()=="base"||i.mode()=="linear"?1:-1),c(),T(i.mode()=="image"&&!i.modeOnlyColor()?2:-1),c(),f("hidden",i.mode()!="image"||i.modeOnlyColor()),c(),f("modeSelection",!0)("size","sm")("showPagination",!1),c(),T(i.mode()=="linear"||i.mode()=="base"?5:-1))},dependencies:[ul,ho,he,Be,Je,Ki,pe,Qe,Ne,at],styles:[".box-color[_ngcontent-%COMP%]{width:30px;height:30px;min-width:30px;min-height:30px;border:1px solid #fff;border-radius:4px}.gradient-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer}.action-area[_ngcontent-%COMP%]{padding:10px;display:flex;flex-direction:column-reverse;gap:8px}.color-selection[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;background:#0003;padding:8px}.color-selection-designer[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;padding:8px;background:#0003}.color-selection-designer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}app-color-box[_ngcontent-%COMP%]{border-radius:4px;outline:1px solid rgba(255,255,255,.5);cursor:pointer}.url-input[_ngcontent-%COMP%]{height:32px;width:100%;border:none;outline:none;margin:0;padding:2px 8px;color:var(--form-control-color);background-color:var(--form-control-bg)}"]})},_r=class o{helperPanel=b(Vt);data=A({});set color(t){this.data.set(re(k({},this.data()),{"ctrl-c":t,background:t}))}onChangeValue(t){this.helperPanel.ok(t["ctrl-c"])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["ng-component"]],inputs:{color:"color"},decls:1,vars:2,consts:[[3,"valueChange","value","onlyColor"]],template:function(e,i){e&1&&(l(0,"app-fill-picker",0),ne("valueChange",function(r){return Z(i.data,r)||(i.data=r),r}),h("valueChange",function(r){return i.onChangeValue(r)}),a()),e&2&&(ie("value",i.data),f("onlyColor",!0))},dependencies:[Cl],encapsulation:2})},_l=class o{helperPanel=b(Vt);data=A({});set bg(t){this.data.set(k(k({},this.data()),t))}onChangeValue(t){this.helperPanel.ok(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["ng-component"]],decls:1,vars:1,consts:[[3,"valueChange","value"]],template:function(e,i){e&1&&(l(0,"app-fill-picker",0),ne("valueChange",function(r){return Z(i.data,r)||(i.data=r),r}),h("valueChange",function(r){return i.onChangeValue(r)}),a()),e&2&&ie("value",i.data)},dependencies:[Cl],encapsulation:2})};var vr=class o{ds=b(Ue);helperPanel=b(Vt);props=A(k({},ti));customColors=ce(()=>this.ds.palettColors().map(t=>({name:t.label,color:t.color})));valueChange=Oe();set value(t){this.props.set(k(k({},this.props()),t))}openColorPicker(){this.helperPanel.disableOutsideClick(),this.helperPanel.show(_l,{bg:this.props()},{title:"Seleccionar color",maxWidth:320}).subscribe(t=>{t&&(this.valueChange.emit(t),this.props.set(k({},t)))})}ngOnDestroy(){this.helperPanel.close()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-background-control"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[we([Te({lucideLink2:lr,lucideUnlink2:qs})])],decls:3,vars:2,consts:[[1,"preview",3,"click"]],template:function(e,i){e&1&&(_t(0,"span"),u(1,"Fondo"),Ft(),_t(2,"div",0),hi("click",function(){return i.openColorPicker()}),Ft()),e&2&&(c(2),xt("background",i.props().background))},dependencies:[pe,he,Ke],styles:["[_nghost-%COMP%]{display:flex;justify-content:space-between;align-items:center}span[_ngcontent-%COMP%]{font-size:11px;opacity:.7}.preview[_ngcontent-%COMP%]{height:22px;width:44px;border-radius:4px;border:1px solid #fff;cursor:pointer}"],changeDetection:0})};var yr=class o{cloudName="dlmbu4o28";uploadPreset="uploadimages";apiUrl=`https://api.cloudinary.com/v1_1/${this.cloudName}/image/upload`;uploadImage(t){return P(this,null,function*(){let e=new FormData;e.append("file",t),e.append("upload_preset",this.uploadPreset);let i=yield fetch(this.apiUrl,{method:"POST",body:e});if(!i.ok)throw new Error("Network response was not ok");return yield i.json()})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};function S_(o,t){o&1&&(_t(0,"p"),u(1,"Uploading..."),Ft())}function E_(o,t){if(o&1&&(_t(0,"div")(1,"p"),u(2,"Upload successful! Here's your image:"),Ft(),ii(3,"img",3),_t(4,"p"),u(5," Image URL: "),_t(6,"a",4),u(7),Ft()()()),o&2){let e=d();c(3),Jn("src",e.imageUrl,mt),c(3),Jn("href",e.imageUrl,mt),c(),W(e.imageUrl)}}function P_(o,t){if(o&1&&(_t(0,"p",2),u(1),Ft()),o&2){let e=d();c(),W(e.errorMessage)}}var vl=class o{uploadService=b(yr);selectedFile=null;imageUrl=null;errorMessage=null;uploading=!1;onFileSelected(t){let i=t.target.files?.[0]||null;i&&(this.selectedFile=i,this.imageUrl=null,this.errorMessage=null)}uploadImage(){return P(this,null,function*(){if(!this.selectedFile){this.errorMessage="Please select a file first.";return}this.uploading=!0,this.errorMessage=null;try{let t=yield this.uploadService.uploadImage(this.selectedFile);this.imageUrl=t.secure_url}catch(t){this.errorMessage="Upload failed. Please try again.",console.error("Error uploading to Cloudinary:",t)}finally{this.uploading=!1}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-cloudinary-uploader"]],decls:8,vars:4,consts:[["type","file","accept","image/*",3,"change"],[3,"click","disabled"],[2,"color","red"],["alt","Uploaded image",2,"max-width","500px",3,"src"],["target","_blank",3,"href"]],template:function(e,i){e&1&&(_t(0,"h2"),u(1,"Cloudinary Image Uploader"),Ft(),_t(2,"input",0),hi("change",function(r){return i.onFileSelected(r)}),Ft(),_t(3,"button",1),hi("click",function(){return i.uploadImage()}),u(4,"Upload to Cloudinary"),Ft(),D(5,S_,2,0,"p"),D(6,E_,8,3,"div"),D(7,P_,2,1,"p",2)),e&2&&(c(3),Jn("disabled",!i.selectedFile||i.uploading),c(2),T(i.uploading?5:-1),c(),T(i.imageUrl?6:-1),c(),T(i.errorMessage?7:-1))},dependencies:[pe],styles:["[_nghost-%COMP%]{display:block;padding:20px;font-family:Arial,sans-serif}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{margin:10px 0;padding:5px}button[_ngcontent-%COMP%]{cursor:pointer}button[_ngcontent-%COMP%]:disabled{cursor:not-allowed}"]})};var M_=["canvas"],I_=["hueCanvas"];function D_(o,t){if(o&1){let e=M();l(0,"button",28),h("click",function(){g(e);let n=d();return C(n.useEyeDropper())}),_(1,"ng-icon",29),a()}}function T_(o,t){if(o&1){let e=M();l(0,"div",30),h("click",function(){let n=g(e).$implicit,r=d();return C(r.selectSuggestedColor(n))}),a()}if(o&2){let e=t.$implicit,i=t.$index;pi(Re("--color: ",e)),it(Re("suggested-color ",i==2?"selected":""))}}function F_(o,t){if(o&1){let e=M();l(0,"app-color-box",31),h("click",function(){let n=g(e).$implicit,r=d(2);return C(r.selectSuggestedColor(n.color))}),a()}if(o&2){let e=t.$implicit;f("color",e.color)}}function k_(o,t){if(o&1&&(l(0,"span",23),u(1,"Colores personalizados"),a(),l(2,"div",26),Y(3,F_,1,1,"app-color-box",27,de),a()),o&2){let e=d();c(3),ee(e.customColors())}}function O_(o,t){if(o&1){let e=M();l(0,"app-color-box",31),h("click",function(){let n=g(e).$implicit,r=d();return C(r.selectSuggestedColor(n.color))}),a()}if(o&2){let e=t.$implicit;f("color",e.color)}}function V_(o,t){if(o&1){let e=M();l(0,"app-color-box",31),h("click",function(){let n=g(e).$implicit,r=d();return C(r.selectSuggestedColor(n.color))}),a()}if(o&2){let e=t.$implicit;f("color",e.color)}}var yl=class o{elementRef=b(an);ngZone=b(fi);canvasRef;hueCanvasRef;grayScales=pl;materialColors=ml;customColors=le([]);set color(t){this.parseColor(t),this.hexColor.set(this.colorUtils.rgbaToHex(...this.selectedColor,this.alpha())),this.updateSuggestedColors(),this.updateAllComponents()}colorChange=new q;isEyeDropperSupported=typeof window<"u"&&"EyeDropper"in window;colorUtils=new fo;toastr=b(tt);selectedColor=[0,0,0];hue=0;alpha=ce(()=>this.opacityPercentage()/100);hexColor=A("#000000");opacityPercentage=A(100);hueIndicatorPosition=A("0%");isInitialized=A(!1);colorIndicatorPosition=A({left:"0px",top:"0px"});suggestedColors=A([]);isColorDragging=!1;isHueDragging=!1;isAlphaDragging=!1;cleanup=null;resizeObserver=null;initResizeObserver(){let t=this.canvasRef.nativeElement.parentElement;t&&(this.resizeObserver=new ResizeObserver(()=>{let e=t.clientWidth,i=this.canvasRef.nativeElement;i.width=e;let n=this.hueCanvasRef.nativeElement;n.width=e,this.updateAllComponents()}),this.resizeObserver.observe(t))}updateAllComponents(){this.isInitialized()&&(Qi.drawColorPicker(this.canvasRef.nativeElement,this.hue),Qi.drawHueCanvas(this.hueCanvasRef.nativeElement),this.updateColorIndicator(),this.updateHueIndicator())}ngAfterViewInit(){this.isInitialized.set(!0),this.updateAllComponents(),this.initResizeObserver(),this.cleanup=this.ngZone.runOutsideAngular(()=>{let t=this.onMouseMove.bind(this);document.addEventListener("mousemove",t);let e=this.onMouseUp.bind(this);return document.addEventListener("mouseup",e),()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",e)}})}copyColor(){let t=this.getColorString();navigator.clipboard.writeText(t).then(()=>{this.toastr.success("Color copied",`The color ${t} has been copied to the clipboard`)},e=>{console.error("Error copying color:",e),this.toastr.error("Error copying","Could not copy the color to the clipboard")})}onCanvasMouseDown(t){this.isColorDragging=!0,this.handleColorSelection(t)}onHueCanvasMouseDown(t){this.isHueDragging=!0,this.htmlTarget=t.target,this.handleHueSelection(t)}htmlTarget=null;onAlphaCanvasMouseDown(t){this.isAlphaDragging=!0,this.htmlTarget=t.target,this.handleAlphaSelection(t)}onMouseMove(t){this.isColorDragging?this.handleColorSelection(t):this.isHueDragging?this.handleHueSelection(t):this.isAlphaDragging&&this.handleAlphaSelection(t)}onMouseUp(){this.isColorDragging=!1,this.isHueDragging=!1,this.isAlphaDragging=!1;let t=this.getColorString();this.colorChange.emit(t),this.htmlTarget=null}handleColorSelection(t){let e=this.canvasRef.nativeElement,i=e.getBoundingClientRect(),n=Math.max(0,Math.min(t.clientX-i.left,e.width)),r=Math.max(0,Math.min(t.clientY-i.top,e.height)),s=Math.max(0,Math.min(1,n/e.width))*100,m=Math.max(0,Math.min(1,1-r/e.height))*100,p=this.colorUtils.hsvToRgb(this.hue,s,m);this.selectedColor=[p[0],p[1],p[2]],this.opacityPercentage()===0&&this.opacityPercentage.set(100),this.updateColor(),this.updateColorIndicator(n,r)}handleHueSelection(t){let e=this.hueCanvasRef.nativeElement.getBoundingClientRect(),n=Math.max(0,Math.min(t.clientX-e.left,e.width))/e.width*100;this.hue=Math.round(n/100*360),this.updateSelectedColorFromHue(),Qi.drawColorPicker(this.canvasRef.nativeElement,this.hue),this.updateColor(),this.updateHueIndicator(n)}handleAlphaSelection(t){if(!this.htmlTarget)return;let e=this.htmlTarget.getBoundingClientRect(),i=Math.max(0,Math.min(t.clientX-e.left,e.width));this.opacityPercentage.set(Math.round(i/e.width*100)),this.updateColor()}useEyeDropper(){return P(this,null,function*(){if(!this.isEyeDropperSupported){this.toastr.warning("El cuentagotas no est\xE1 soportado en este navegador","No soportado");return}try{let e=yield new window.EyeDropper().open();this.parseColor(e.sRGBHex),this.updateAllComponents(),this.colorChange.emit(this.getColorString()),this.toastr.success("Color seleccionado",`Se ha seleccionado el color ${e.sRGBHex}`)}catch(t){t instanceof DOMException&&t.name==="AbortError"||(console.error("Error al usar el cuentagotas:",t),this.toastr.error("No se pudo seleccionar el color","Error"))}})}updateSelectedColorFromHue(){let t=this.colorUtils.rgbToHsv(...this.selectedColor),e=this.colorUtils.hsvToRgb(this.hue,t[1],t[2]);this.selectedColor=[e[0],e[1],e[2]]}updateColorIndicator(t,e){let i=this.canvasRef.nativeElement;if(t===void 0||e===void 0){let n=this.colorUtils.rgbToHsv(...this.selectedColor);t=n[1]*i.width/100,e=(1-n[2]/100)*i.height}this.colorIndicatorPosition.set({left:`${t}px`,top:`${e}px`})}updateHueIndicator(t){t===void 0&&(t=this.hue/360*100),this.hueIndicatorPosition.set(`${t}%`)}updateColor(){this.hexColor.set(this.colorUtils.rgbaToHex(...this.selectedColor,this.alpha())),this.updateSuggestedColors()}makeTransparent(){this.selectedColor=[0,0,0],this.hexColor.set("#00000000"),this.opacityPercentage.set(0),this.updateAllComponents(),this.colorChange.emit("#00000000")}getColorString(){return this.colorUtils.rgbaToHex(...this.selectedColor,this.alpha())}onHexInput(t){this.parseColor(t)&&(this.updateColor(),this.updateColorIndicator(),this.updateHueIndicator(),Qi.drawColorPicker(this.canvasRef.nativeElement,this.hue),Qi.drawHueCanvas(this.hueCanvasRef.nativeElement),this.colorChange.emit(this.getColorString()))}onOpacityChange(){this.updateColor(),this.colorChange.emit(this.getColorString())}parseColor(t){try{let e=fo.stringToRgba(t);this.selectedColor=[e[0],e[1],e[2]],this.opacityPercentage.set(Math.round(e[3]*100));let i=this.colorUtils.rgbToHsv(...this.selectedColor);return this.hue=i[0],!0}catch{return!1}}updateSuggestedColors(){this.suggestedColors.set(this.colorUtils.generateSuggestedColors(this.selectedColor,this.alpha()))}selectSuggestedColor(t){this.parseColor(t),this.updateAllComponents(),this.colorChange.emit(this.getColorString())}ngOnDestroy(){this.cleanup?.(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-color-selector"]],viewQuery:function(e,i){if(e&1&&(ut(M_,5),ut(I_,5)),e&2){let n;ct(n=dt())&&(i.canvasRef=n.first),ct(n=dt())&&(i.hueCanvasRef=n.first)}},inputs:{customColors:[1,"customColors"],color:"color"},outputs:{colorChange:"colorChange"},features:[we([],[Te({lucideCopy:Fn,lucideCircleX:Ss,lucideCircleOff:ws,lucideDroplet:Ms,lucideTrash2:ao,lucidePipette:zs,lucideGhost:ks})])],decls:40,vars:10,consts:[["canvas",""],["hueCanvas",""],[1,"color-picker"],[1,"color-picker-container",2,"height","120px"],["height","120",1,"color-canvas",3,"mousedown"],[1,"color-indicator"],[1,"hue-canvas-container","position-relative"],["height","20",1,"hue-canvas",3,"mousedown"],[1,"hue-indicator"],[1,"p-2"],[1,"gap-1","d-flex","align-items-center"],[1,"alpha-canvas-container","bg-transparent-fx"],[1,"alpha-canvas",3,"mousedown"],[1,"alpha-indicator"],[1,"opacity-container"],["app-icon-button","","variant","text","size","sm","color","secondary","title","Remover color",3,"click"],["name","lucideGhost","size","1rem"],["app-icon-button","","variant","text","size","sm","color","secondary","title","Usar cuentagotas"],[1,"color-input-container"],["id","opacity-input","type","number","min","0","max","100","step","1",1,"opacity-input","number-input-clean",3,"ngModelChange","ngModel"],["type","text","placeholder","color",1,"hex-input",3,"ngModelChange","ngModel"],["app-icon-button","","variant","outline","size","xs","color","secondary","title","Copiar",3,"click"],["name","lucideCopy","size","1rem"],[1,"label"],[1,"color-suggestions"],[3,"class","style"],[1,"palette"],["displayMode","checkerboard","size","24px",3,"color"],["app-icon-button","","variant","text","size","sm","color","secondary","title","Usar cuentagotas",3,"click"],["name","lucidePipette","size","1rem"],[3,"click"],["displayMode","checkerboard","size","24px",3,"click","color"]],template:function(e,i){if(e&1){let n=M();l(0,"div",2)(1,"div",3)(2,"canvas",4,0),h("mousedown",function(s){return g(n),C(i.onCanvasMouseDown(s))}),a(),_(4,"div",5),a(),l(5,"div",6)(6,"canvas",7,1),h("mousedown",function(s){return g(n),C(i.onHueCanvasMouseDown(s))}),a(),_(8,"div",8),a(),l(9,"div",9)(10,"div",10)(11,"div",11)(12,"canvas",12),h("mousedown",function(s){return g(n),C(i.onAlphaCanvasMouseDown(s))}),a(),_(13,"div",13),a()(),l(14,"div",14)(15,"div")(16,"button",15),h("click",function(){return g(n),C(i.makeTransparent())}),_(17,"ng-icon",16),a(),D(18,D_,2,0,"button",17),a()(),l(19,"div",18)(20,"input",19),ne("ngModelChange",function(s){return g(n),Z(i.opacityPercentage,s)||(i.opacityPercentage=s),C(s)}),h("ngModelChange",function(){return g(n),C(i.onOpacityChange())}),a(),l(21,"input",20),ne("ngModelChange",function(s){return g(n),Z(i.hexColor,s)||(i.hexColor=s),C(s)}),h("ngModelChange",function(s){return g(n),C(i.onHexInput(s))}),a(),l(22,"button",21),h("click",function(){return g(n),C(i.copyColor())}),_(23,"ng-icon",22),a()(),l(24,"span",23),u(25,"Tonos sugeridos"),a(),l(26,"div",24),Y(27,T_,1,6,"div",25,de),a(),D(29,k_,5,0),l(30,"span",23),u(31,"Grises"),a(),l(32,"div",26),Y(33,O_,1,1,"app-color-box",27,de),a(),l(35,"span",23),u(36,"Colores generales"),a(),l(37,"div",26),Y(38,V_,1,1,"app-color-box",27,de),a()()()}e&2&&(c(4),pi(i.colorIndicatorPosition()),c(4),xt("left",i.hueIndicatorPosition()),c(5),xt("left",i.opacityPercentage()+"%"),c(5),T(i.isEyeDropperSupported?18:-1),c(2),ie("ngModel",i.opacityPercentage),c(),ie("ngModel",i.hexColor),c(6),ee(i.suggestedColors()),c(2),T(i.customColors().length>0?29:-1),c(4),ee(i.grayScales),c(5),ee(i.materialColors))},dependencies:[pe,Qe,Dn,Ne,or,nr,at,he,Ge,Je,Ki],styles:["[_nghost-%COMP%]{min-width:240px;max-width:240px;display:block}.label[_ngcontent-%COMP%]{color:gray;font-size:.875rem;margin-top:.5rem}.color-picker[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.color-canvas-container[_ngcontent-%COMP%]{position:relative}.color-canvas[_ngcontent-%COMP%]{cursor:crosshair}.hue-alpha-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.color-picker-container[_ngcontent-%COMP%]{position:relative;border-radius:.5rem .5rem 0 0;overflow:hidden}.alpha-canvas-container[_ngcontent-%COMP%]{position:relative;height:20px;border-radius:.375rem}.alpha-canvas-container[_ngcontent-%COMP%]{flex:1}.hue-canvas[_ngcontent-%COMP%], .alpha-canvas[_ngcontent-%COMP%]{cursor:pointer}.alpha-canvas[_ngcontent-%COMP%]{background:linear-gradient(to right,#0000,#000);height:20px;width:100%}.color-indicator[_ngcontent-%COMP%]{position:absolute;width:16px;height:16px;border:2px solid white;border-radius:50%;pointer-events:none;box-shadow:0 0 0 1px #000;transform:translate(-50%,-50%)}.hue-indicator[_ngcontent-%COMP%], .alpha-indicator[_ngcontent-%COMP%]{position:absolute;width:4px;height:20px;border-radius:0;box-shadow:none;border:1px solid black;transform:translate(-50%);background-color:#fff;top:0;pointer-events:none}.color-input-container[_ngcontent-%COMP%]{margin-top:.5rem;display:flex;gap:.5rem;align-items:center}.color-preview[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:.375rem;border:1px solid #d1d5db}.hex-input[_ngcontent-%COMP%]{flex:1;padding:.25rem .5rem;border:1px solid #d1d5db;border-radius:.375rem;font-size:.875rem;width:100%}.opacity-container[_ngcontent-%COMP%]{margin-top:.5rem;display:flex;align-items:center;gap:.5rem;justify-content:space-between}.opacity-input[_ngcontent-%COMP%]{width:2.5rem;padding:0 .25rem;border:1px solid #d1d5db;border-radius:.375rem;font-size:.875rem;text-align:center}.button-container[_ngcontent-%COMP%]{margin-top:.5rem;display:flex;gap:.5rem}.color-suggestions[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);gap:.5rem}.suggested-color[_ngcontent-%COMP%]{height:1.5rem;border-radius:.375rem;cursor:pointer;border:1px solid #d1d5db;background-color:var(--color, white)}.suggested-color.selected[_ngcontent-%COMP%]{outline:2px solid #d1d5db;outline-offset:2px}.palette[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:4px}.palette[_ngcontent-%COMP%]   .suggested-color[_ngcontent-%COMP%]{height:1.5rem;width:1.5rem;border-radius:1rem}app-color-box[_ngcontent-%COMP%]{cursor:pointer;background:#fff;border-radius:50%;border:1px solid #dfdfdf;overflow:hidden}"],changeDetection:0})};function N_(o,t){if(o&1&&(l(0,"span",4),u(1),a()),o&2){let e=d();c(),W(e.label())}}var An=class o{color=nt("#000000");label=le();customColors=le([]);static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-color-picker"]],inputs:{color:[1,"color"],label:[1,"label"],customColors:[1,"customColors"]},outputs:{color:"colorChange"},decls:5,vars:4,consts:[["ngbDropdown","",1,"color-picker-container"],["size","24px","displayMode","checkerboard","ngbDropdownToggle","",3,"color"],["ngbDropdownMenu","","aria-labelledby","colorPickerDropdown",2,"padding","0rem"],[3,"colorChange","color","customColors"],["ngbDropdownToggle",""]],template:function(e,i){e&1&&(l(0,"div",0),_(1,"app-color-box",1),l(2,"div",2)(3,"app-color-selector",3),ne("colorChange",function(r){return Z(i.color,r)||(i.color=r),r}),a()(),D(4,N_,2,1,"span",4),a()),e&2&&(c(),f("color",i.color()),c(2),ie("color",i.color),f("customColors",i.customColors()),c(),T(i.label()!=null?4:-1))},dependencies:[yl,Ke,ai,yi,vi,Ki],styles:["[_nghost-%COMP%], .color-picker-container[_ngcontent-%COMP%]{display:inline-flex;align-items:center}.color-picker-container[_ngcontent-%COMP%]{gap:.5rem}app-color-box[_ngcontent-%COMP%]{cursor:pointer;background:#fff;border-radius:4px;border:1px solid #fff;overflow:hidden}[_nghost-%COMP%]     :after{display:none}[_nghost-%COMP%]     .dropdown-menu{border-radius:.5rem}"],changeDetection:0})};var br=class o{valueChange=Oe();value=le(k({},Bo),{transform:t=>k({},wt(t,Bo))});updateProperty(t,e){this.valueChange.emit(re(k({},this.value()),{[t]:e}))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-shadow-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},decls:19,vars:7,consts:[[1,"shadow-control"],[1,"d-flex","gap-3","flex-column"],[1,"row"],[1,"col-md-6"],["prefix","X",3,"valueChange","value"],["prefix","Y",3,"valueChange","value"],["for","blur",1,"form-label"],[3,"valueChange","value","min"],["for","spread",1,"form-label"],[1,"w-100","d-flex","gap-3","align-items-center","justify-content-between"],["for","color",1,"form-label"],[3,"colorChange","color"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-unit-selector",4),h("valueChange",function(r){return i.updateProperty("ctrl-h",r)}),a()(),l(5,"div",3)(6,"app-unit-selector",5),h("valueChange",function(r){return i.updateProperty("ctrl-v",r)}),a()(),l(7,"div",3)(8,"label",6),u(9,"Desenfoque:"),a(),l(10,"app-unit-selector",7),h("valueChange",function(r){return i.updateProperty("ctrl-b",r)}),a()(),l(11,"div",3)(12,"label",8),u(13,"Propagaci\xF3n:"),a(),l(14,"app-unit-selector",7),h("valueChange",function(r){return i.updateProperty("ctrl-s",r)}),a()()(),l(15,"div",9)(16,"label",10),u(17,"Color"),a(),l(18,"app-color-picker",11),h("colorChange",function(r){return i.updateProperty("ctrl-c",r)}),a()()()()),e&2&&(c(4),f("value",i.value()["ctrl-h"]),c(2),f("value",i.value()["ctrl-v"]),c(4),f("value",i.value()["ctrl-b"])("min",0),c(4),f("value",i.value()["ctrl-s"])("min",0),c(4),f("color",i.value()["ctrl-c"]))},dependencies:[pe,An,ei],styles:[".shadow-control[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}label[_ngcontent-%COMP%]{font-weight:lighter}"]})};function A_(o,t){o&1&&(l(0,"option",5),u(1,"Fija"),a())}function j_(o,t){if(o&1){let e=M();l(0,"div",0)(1,"span"),u(2,"Posici\xF3n"),a(),l(3,"select",2),h("ngModelChange",function(n){g(e);let r=d(2);return C(r.updatePosition(n))}),l(4,"option",3),u(5,"Absoluta"),a(),l(6,"option",4),u(7,"Relativa"),a(),D(8,A_,2,0,"option",5),a()()}if(o&2){let e=d(2);c(3),f("ngModel",e.props().position),c(5),T(e.ds.isCurrentFormNodeTopLevel()?8:-1)}}function R_(o,t){o&1&&(l(0,"i"),u(1,"Position"),a())}function L_(o,t){if(o&1){let e=M();l(0,"div",1),_(1,"div"),l(2,"app-unit-selector",6),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateProp("top",n))}),a(),_(3,"div"),l(4,"app-unit-selector",7),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateProp("left",n))}),a(),_(5,"div"),l(6,"app-unit-selector",8),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateProp("right",n))}),a(),_(7,"div"),l(8,"app-unit-selector",9),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateProp("bottom",n))}),a()()}if(o&2){let e=d(2);c(2),f("disabled",e.props()["ctrl-mv"]==="1")("value",e.props().top),c(2),f("disabled",e.props()["ctrl-mh"]==="1")("value",e.props().left),c(2),f("disabled",e.props()["ctrl-mh"]==="1")("value",e.props().right),c(2),f("disabled",e.props()["ctrl-mv"]==="1")("value",e.props().bottom)}}function U_(o,t){if(o&1&&(D(0,j_,9,2,"div",0)(1,R_,2,0,"i"),D(2,L_,9,8,"div",1)),o&2){let e=d();T(e.ds.isDocumentMode()?1:0),c(2),T(e.isRelative()?-1:2)}}function z_(o,t){o&1&&(l(0,"i"),u(1,"El editor no esta habilitado"),a())}var xr=class o{ds=b(Ue);isContextEditorReady=this.ds.isContextEditorReady;props=A(k({},Vn));initialValue=A(k({},Vn));valueChange=new q;set value(t){JSON.stringify(this.initialValue())!==JSON.stringify(t)&&(this.initialValue.set(k({},t)),this.props.set(k({},wt(t,Vn))))}isRelative=ce(()=>this.props().position==="relative");updatePosition(t){let e=re(k({},this.props()),{position:t});e=re(k({},e),{top:"",left:"",bottom:"",right:"","ctrl-mv":"","ctrl-mh":"",transform:"initial"}),this.updateProps(e),this.emitChange()}updateProp(t,e){this.props.update(i=>re(k({},i),{[t]:e})),this.emitChange()}updateProps(t){this.props.update(e=>k(k({},e),t)),this.emitChange()}emitChange(){JSON.stringify(this.initialValue())!==JSON.stringify(this.props)&&(this.initialValue.set(k({},this.props())),this.valueChange.emit(k({},this.props())))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-position-control"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},decls:2,vars:1,consts:[[1,"type-selector"],[1,"editor-grid"],[1,"form-control-sm",3,"ngModelChange","ngModel"],["value","absolute"],["value","relative"],["value","fixed"],["placeholder","Top","prefix","T",1,"top-input",3,"valueChange","disabled","value"],["placeholder","Left","prefix","L",1,"left-input",3,"valueChange","disabled","value"],["placeholder","Right","prefix","R",1,"right-input",3,"valueChange","disabled","value"],["placeholder","Bottom","prefix","B",1,"bottom-input",3,"valueChange","disabled","value"]],template:function(e,i){e&1&&D(0,U_,3,2)(1,z_,2,0,"i"),e&2&&T(i.isContextEditorReady()?0:1)},dependencies:[pe,Ht,Gt,$t,Ne,at,ei],styles:[".editor-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr 1fr 1fr;gap:4px;align-items:center}.center-box[_ngcontent-%COMP%]{background-color:#0000001a;border-radius:4px;height:32px;position:relative;cursor:pointer}.h[_ngcontent-%COMP%], .v[_ngcontent-%COMP%]{position:absolute;background-color:#666;transition:background-color .2s;top:50%;left:50%;transform:translate(-50%,-50%);width:6px;height:6px}.h[_ngcontent-%COMP%]{height:30px}.v[_ngcontent-%COMP%]{width:30px}.h[_ngcontent-%COMP%]:hover, .v[_ngcontent-%COMP%]:hover{background-color:#007bff;z-index:1}.h.active[_ngcontent-%COMP%], .v.active[_ngcontent-%COMP%]{background-color:#007bff}.type-selector[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:12px}"]})};var wr=class o{value=le(k({},xn),{transform:t=>k({},wt(t,xn))});valueChange=Oe();emitUpdate(t){this.valueChange.emit(k(k({},this.value()),t))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-text-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},features:[we([Te({lucideWrapText:qu,lucideType:Gs,lucideBold:ys,lucideItalic:Ns,lucideStrikethrough:Hs})])],decls:21,vars:9,consts:[[1,"d-flex","gap-2"],["app-icon-button","","size","xs",3,"click","variant"],["name","lucideBold"],["name","lucideItalic"],["name","lucideStrikethrough"],["app-button","","size","xs",3,"click","variant"],["name","lucideWrapText"],[1,"d-flex","gap-2","align-items-center"],[1,"form-label"],["placeholder","ingrese","size","sm",3,"valueChange","value","min"]],template:function(e,i){e&1&&(l(0,"div")(1,"div",0)(2,"button",1),h("click",function(){return i.emitUpdate({"font-weight":i.value()["font-weight"]==="normal"?"bold":"normal"})}),_(3,"ng-icon",2),a(),l(4,"button",1),h("click",function(){return i.emitUpdate({"font-style":i.value()["font-style"]==="normal"?"italic":"normal"})}),_(5,"ng-icon",3),a(),l(6,"button",1),h("click",function(){return i.emitUpdate({"text-decoration":i.value()["text-decoration"]==="none"?"line-through":"none"})}),_(7,"ng-icon",4),a(),l(8,"button",5),h("click",function(){return i.emitUpdate({"white-space":i.value()["white-space"]==="normal"?"nowrap":"normal"})}),_(9,"ng-icon",6),l(10,"span"),u(11),a()()()(),l(12,"div",7)(13,"div")(14,"label",8),u(15,"Espaciado letras"),a(),l(16,"app-unit-selector",9),h("valueChange",function(r){return i.emitUpdate({"letter-spacing":r})}),a()(),l(17,"div")(18,"label",8),u(19,"Espaciado lineas"),a(),l(20,"app-unit-selector",9),h("valueChange",function(r){return i.emitUpdate({"line-height":r})}),a()()()),e&2&&(c(2),f("variant",i.value()["font-weight"]==="bold"?"flat":"outline"),c(2),f("variant",i.value()["font-style"]==="italic"?"flat":"outline"),c(2),f("variant",i.value()["text-decoration"]==="line-through"?"flat":"outline"),c(2),f("variant",i.value()["white-space"]==="nowrap"?"flat":"outline"),c(3),W(i.value()["white-space"]==="normal"?"Con salto":"Sin salto"),c(5),f("value",i.value()["letter-spacing"])("min",0),c(4),f("value",i.value()["line-height"])("min",0))},dependencies:[Je,he,Be,Ge,pe,ei],styles:["label[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]{display:flex;flex-direction:column;gap:1rem;width:100%}"]})};var un=class o{value=nt(null);placeholder=le("Ingrese #");min=le(-1/0);max=le(1/0);step=le(1);onKeyDown(t){let e=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Backspace","Delete","Enter","Tab","Home","End","Control","Meta","."];this.min()<0&&e.push("-"),!(t.ctrlKey||t.metaKey)&&!e.includes(t.key)&&!/^\d$/.test(t.key)&&t.preventDefault()}add(t){let e=this.parseValue(this.value())+t;e<this.min()&&(e=this.min()),e>this.max()&&(e=this.max()),this.value.set(e)}parseValue(t){return typeof t=="number"?t||0:typeof t=="string"&&parseFloat(t)||0}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-number"]],inputs:{value:[1,"value"],placeholder:[1,"placeholder"],min:[1,"min"],max:[1,"max"],step:[1,"step"]},outputs:{value:"valueChange"},decls:5,vars:3,consts:[["type","number","placeholder","Ingrese #",1,"form-control","form-control-sm","number-input-clean",3,"ngModelChange","keydown","ngModel","min","max"],["app-icon-button","","size","xs",3,"click"]],template:function(e,i){e&1&&(l(0,"input",0),ne("ngModelChange",function(r){return Z(i.value,r)||(i.value=r),r}),h("keydown",function(r){return i.onKeyDown(r)}),a(),l(1,"button",1),h("click",function(){return i.add(-i.step())}),u(2,"-"),a(),l(3,"button",1),h("click",function(){return i.add(i.step())}),u(4,"+"),a()),e&2&&(ie("ngModel",i.value),f("min",i.min())("max",i.max()))},dependencies:[pe,Qe,Dn,Ne,or,nr,at,he,Ge],styles:["[_nghost-%COMP%]{display:flex;gap:.25rem;align-items:stretch;flex-direction:row;width:100%}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{flex:1}"]})};var Sr=class o{columns=A("1");rows=A("1");valueChange=new q;extractNumber(t){let e=t.match(/\d+/);return e?e[0]:"1"}set value(t){let e=wt(t,fr),i=this.extractNumber(e["grid-column"]),n=this.extractNumber(e["grid-row"]);this.columns.set(i),this.rows.set(n)}updateGridSpan(){this.valueChange.emit({"grid-column":`span ${this.columns()}`,"grid-row":`span ${this.rows()}`})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-grid-span-control"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[we([Te({lucideArrowUpRight:Jp,lucideArrowRight:qp,lucideArrowDownRight:Hp,lucideArrowDown:vs})])],decls:8,vars:6,consts:[[1,"grid-span-control"],["placeholder","Columnas",3,"valueChange","value","min","max"],["placeholder","Filas",3,"valueChange","value","min","max"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"span"),u(2,"Columnas"),a(),l(3,"app-number",1),ne("valueChange",function(r){return Z(i.columns,r)||(i.columns=r),r}),h("valueChange",function(){return i.updateGridSpan()}),a()(),l(4,"div",0)(5,"span"),u(6,"Filas"),a(),l(7,"app-number",2),ne("valueChange",function(r){return Z(i.rows,r)||(i.rows=r),r}),h("valueChange",function(){return i.updateGridSpan()}),a()()),e&2&&(c(3),ie("value",i.columns),f("min",1)("max",12),c(4),ie("value",i.rows),f("min",1)("max",12))},dependencies:[un],styles:["[_nghost-%COMP%]{display:flex;gap:.5rem;flex-direction:column}.grid-span-control[_ngcontent-%COMP%]{display:grid;align-items:center;grid-template-columns:1fr 3fr}span[_ngcontent-%COMP%]{font-size:11px;opacity:.7}"]})};function B_(o,t){if(o&1){let e=M();l(0,"button",5),h("click",function(){let n=g(e).$implicit,r=d(2);return C(r.addFilter(n))}),u(1),a()}if(o&2){let e=t.$implicit,i=d(2);c(),W(i.filterDetails[e].name)}}function W_(o,t){if(o&1&&(l(0,"div",1)(1,"button",2),u(2,"fx"),a(),l(3,"div",3),Y(4,B_,2,1,"button",4,bn),a()()),o&2){let e=d();c(),f("id","dropdown"+e.id),c(2),sn("aria-labelledby","dropdown"+e.id),c(),ee(e.availableFilters())}}function $_(o,t){if(o&1){let e=M();l(0,"div",0)(1,"label"),u(2),a(),l(3,"app-unit-selector",6),h("valueChange",function(n){let r=g(e).$implicit,s=d();return C(s.handleFilterChange(r,n))}),a(),l(4,"button",7),h("click",function(){let n=g(e).$implicit,r=d();return C(r.removeFilter(n))}),_(5,"ng-icon",8),a()()}if(o&2){let e=t.$implicit,i=d();c(2),W(i.filterDetails[e].name),c(),f("value",i.filters()[e])("min",0)}}var zd=class o{title="";id=Go();filterChange=new q;filterDetails={blur:{name:"Desenfoque",defaultValue:"0px"},brightness:{name:"Brillo",defaultValue:"100%"},contrast:{name:"Contraste",defaultValue:"100%"},saturate:{name:"Saturaci\xF3n",defaultValue:"100%"}};filters=A({});initialValue=A("");availableFilters=ce(()=>Object.keys(this.filterDetails).filter(t=>this.filters()[t]===void 0));activeFilters=ce(()=>Object.keys(this.filters()).filter(t=>this.filters()[t]!==void 0));set value(t){this.initialValue.set(t);let e=this.parseFilters(t);this.filters.set(e)}addFilter(t){this.filters.update(e=>re(k({},e),{[t]:this.filterDetails[t].defaultValue})),this.updateOutputStyle()}removeFilter(t){this.filters.update(e=>{let r=e,{[t]:i}=r;return qn(r,[ep(t)])}),this.updateOutputStyle()}handleFilterChange(t,e){this.filters.update(i=>re(k({},i),{[t]:e})),this.updateOutputStyle()}updateOutputStyle(){let t="";if(Object.keys(this.filters()).length===0)t="none;";else{t="";for(let[e,i]of Object.entries(this.filters()))t+=`${e}(${i}) `;t=t.trim()}t!==this.initialValue()&&(this.initialValue.set(t),this.filterChange.emit(t))}parseFilters(t){let e={},i=new RegExp("\\s*((?:blur|brightness|contrast|saturate)\\([^)]+\\)(?:\\s*(?:blur|brightness|contrast|saturate)\\([^)]+\\))*)"),n=t.match(i);if(n){let r=/(blur|brightness|contrast|saturate)\(([^)]+)\)/g,s;for(;(s=r.exec(n[1]))!==null;)e[s[1]]=s[2]}return e}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-filter-control"]],inputs:{title:"title",value:"value"},outputs:{filterChange:"filterChange"},features:[we([Te({lucideWandSparkles:Hu,lucidePlus:kn,lucideMinus:cr})])],decls:6,vars:2,consts:[[1,"d-flex","gap-1","align-items-center","justify-content-between"],["ngbDropdown","",1,"d-inline-block"],["app-button","","size","xs","ngbDropdownToggle","",3,"id"],["ngbDropdownMenu",""],["ngbDropdownItem",""],["ngbDropdownItem","",3,"click"],[3,"valueChange","value","min"],["size","xs","app-icon-button","",3,"click"],["name","lucideMinus"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"span"),u(2),a(),D(3,W_,6,2,"div",1),a(),Y(4,$_,6,3,"div",0,bn)),e&2&&(c(2),Ie(" ",i.title," "),c(),T(i.availableFilters().length>0?3:-1),c(),ee(i.activeFilters()))},dependencies:[Je,ei,he,Be,Ge,Ke,ai,yi,vi,$i,Hi],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:.25rem}label[_ngcontent-%COMP%]{width:108px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-left:.5rem}span[_ngcontent-%COMP%]{font-size:11px;opacity:.7}"]})},Er=class o{props=k({},mo);initialValue=A(k({},mo));valueChange=new q;set value(t){JSON.stringify(this.initialValue())!==JSON.stringify(t)&&(this.initialValue.set(Ee(t)),this.props=k({},wt(t,mo)))}handleFilterChange(t,e){this.props=re(k({},this.props),{[e]:t}),JSON.stringify(this.initialValue())!==JSON.stringify(this.props)&&(this.initialValue.set(Ee(this.props)),this.valueChange.emit(this.props))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-filter-box-control"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},decls:2,vars:2,consts:[["title","Efectos",3,"filterChange","value"],["title","Efectos de fondo",3,"filterChange","value"]],template:function(e,i){e&1&&(l(0,"app-filter-control",0),h("filterChange",function(r){return i.handleFilterChange(r,"filter")}),a(),l(1,"app-filter-control",1),h("filterChange",function(r){return i.handleFilterChange(r,"backdrop-filter")}),a()),e&2&&(f("value",i.props.filter),c(),f("value",i.props["backdrop-filter"]))},dependencies:[zd],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:.5rem}"]})};function H_(o,t){if(o&1){let e=M();l(0,"button",10),h("click",function(){let n=g(e).$implicit,r=d();return C(r.enableStyle(n.key))}),u(1),a()}if(o&2){let e=t.$implicit;c(),Ie(" ",e.label," ")}}function G_(o,t){if(o&1){let e=M();l(0,"select",11),h("ngModelChange",function(n){g(e);let r=d();return C(r.sizeChange(n,"width"))}),l(1,"option",12),u(2,"Auto"),a(),l(3,"option",13),u(4,"full"),a(),l(5,"option",14),u(6,"%"),a(),l(7,"option",15),u(8,"px"),a()()}if(o&2){let e=d();f("ngModel",e.widthUnit())}}function q_(o,t){if(o&1){let e=M();l(0,"select",11),h("ngModelChange",function(n){g(e);let r=d();return C(r.sizeChange(n,"height"))}),l(1,"option",12),u(2,"Auto"),a(),l(3,"option",13),u(4,"full"),a(),l(5,"option",14),u(6,"%"),a(),l(7,"option",15),u(8,"px"),a(),l(9,"option",16),u(10,"vh"),a()()}if(o&2){let e=d();f("ngModel",e.heightUnit())}}function J_(o,t){if(o&1){let e=M();l(0,"div",17)(1,"label",18),u(2),a(),l(3,"div",19)(4,"app-unit-selector",20),h("valueChange",function(n){g(e);let r=d().$implicit,s=d();return C(s.updateProperty(r.key,n))}),a(),l(5,"button",21),h("click",function(){g(e);let n=d().$implicit,r=d();return C(r.disableStyle(n.key))}),_(6,"ng-icon",22),a()()()}if(o&2){let e=d().$implicit,i=d();c(2),W(e.label),c(2),f("prefix",i.getPrefix(e.key))("value",i.props[e.key])("min",0)}}function X_(o,t){if(o&1&&D(0,J_,7,4,"div",17),o&2){let e=t.$implicit,i=d();T(i.isStyleEnabled(e.key)?0:-1)}}var Pr=class o{designerService=b(Ue);props=k({},Bt);initialValue=A(k({},Bt));htmlSize=ce(()=>{this.designerService.device();let t=this.designerService.htmlNode()?.getBoundingClientRect();return t?{width:t.width,height:t.height}:{width:0,height:0}});styleOptions=[{key:"min-width",label:"Ancho m\xEDn",enabled:!1},{key:"max-width",label:"Ancho m\xE1x",enabled:!1},{key:"min-height",label:"Alto m\xEDn",enabled:!1},{key:"max-height",label:"Alto m\xE1x",enabled:!1}];valueChange=new q;set value(t){JSON.stringify(this.initialValue())!==JSON.stringify(t)&&(this.initialValue.set(Ee(t)),this.props=k({},wt(t,Bt)),this.updateEnabledStyles(),this.updateUntis("width",this.props.width),this.updateUntis("height",this.props.height))}enableInteractor=ce(()=>!this.designerService.isDisabledDesigner());get availableStyles(){return this.styleOptions.filter(t=>!this.isStyleEnabled(t.key))}updateEnabledStyles(){this.styleOptions.forEach(t=>{t.enabled=this.props[t.key]!=="initial"})}isStyleEnabled=t=>this.props[t]!=="initial";enableStyle=t=>this.updateProperty(t,"");disableStyle=t=>this.updateProperty(t,"initial");getPrefix(t){return t.startsWith("min-")?"min":t.startsWith("max-")?"max":t.charAt(0).toUpperCase()}widthUnit=A("auto");heightUnit=A("auto");updateUntis(t,e){let i=po(e);t==="width"&&this.widthUnit.set(i.unit),t==="height"&&this.heightUnit.set(i.unit)}updateProperty(t,e){this.updateUntis(t,e),this.props=re(k({},this.props),{[t]:e}),this.updateSize()}sizeChange(t,e){let i=this.designerService.createNodeProcessor(),n=i?.htmlData();if(i==null||n==null)return;let r=n.width,s=n.height,m=n.percentWidth,p=n.percentHeight;e==="width"?(t==="full"&&this.updateProperty("width","100%"),t==="auto"&&this.updateProperty("width","auto"),t==="%"&&this.updateProperty("width",m+"%"),t==="px"&&this.updateProperty("width",r+"px")):e==="height"&&(t==="full"&&this.updateProperty("height","100%"),t==="auto"&&this.updateProperty("height","auto"),t==="%"&&this.updateProperty("height",p+"%"),t==="px"&&this.updateProperty("height",s+"px"),t==="vh"&&this.updateProperty("height","100vh"))}updateSize(){JSON.stringify(this.initialValue())!==JSON.stringify(this.props)&&(this.initialValue.set(k({},this.props)),this.valueChange.emit(this.props)),this.updateEnabledStyles()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-size-control"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[we([Te({lucideMaximize2:yu,lucideMinimize2:bu,lucidePlus:kn,lucideMinus:cr})])],decls:22,vars:8,consts:[[1,"control-header"],["ngbDropdown","",1,"dropdown"],["app-button","","size","xs","ngbDropdownToggle",""],["ngbDropdownMenu","",1,"dropdown-menu"],[1,"dropdown-item"],[1,"grid-container"],[1,"unit-wrapper"],["prefix","W","size","sm",3,"valueChange","value","min","referenceValue"],["name","","id","",3,"ngModel"],["prefix","H","size","sm",3,"valueChange","value","min","referenceValue"],[1,"dropdown-item",3,"click"],["name","","id","",3,"ngModelChange","ngModel"],["value","auto"],["value","full"],["value","%"],["value","px"],["value","vh"],[1,"style-control"],[1,"form-label"],[1,"control-group"],["size","sm",3,"valueChange","prefix","value","min"],["app-icon-button","","size","xs",3,"click"],["name","lucideMinus"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"label"),u(2,"Tama\xF1o"),a(),l(3,"div",1)(4,"button",2),u(5,"M\xE1s"),a(),l(6,"div",3),Y(7,H_,2,1,"button",4,de),a()()(),l(9,"div",5)(10,"span"),u(11,"Ancho"),a(),l(12,"div",6)(13,"app-unit-selector",7),h("valueChange",function(r){return i.updateProperty("width",r)}),a(),D(14,G_,9,1,"select",8),a(),l(15,"span"),u(16,"Alto"),a(),l(17,"div",6)(18,"app-unit-selector",9),h("valueChange",function(r){return i.updateProperty("height",r)}),a(),D(19,q_,11,1,"select",8),a(),Y(20,X_,1,1,null,null,de),a()),e&2&&(c(7),ee(i.availableStyles),c(6),f("value",i.props.width)("min",0)("referenceValue",i.htmlSize().width),c(),T(i.enableInteractor()?14:-1),c(4),f("value",i.props.height)("min",0)("referenceValue",i.htmlSize().height),c(),T(i.enableInteractor()?19:-1),c(),ee(i.styleOptions))},dependencies:[Je,pe,Ht,Gt,$t,Ne,at,ei,he,Be,Ge,Ke,ai,yi,vi],styles:[".control-header[_ngcontent-%COMP%]{margin-bottom:.5rem;display:flex;justify-content:space-between;align-items:center}.unit-wrapper[_ngcontent-%COMP%]{display:flex;gap:.5rem}.unit-wrapper[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{text-align:center;appearance:none;padding:0 .25rem;border-radius:.375rem;outline:none;border:1px solid #ced4da;cursor:pointer}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 3fr;gap:.5rem;align-items:center}.form-label[_ngcontent-%COMP%]{margin-right:1rem;white-space:nowrap}.style-control[_ngcontent-%COMP%]{display:contents}.control-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}[_nghost-%COMP%]{display:block;width:100%}span[_ngcontent-%COMP%]{font-size:11px;opacity:.7}"]})};var Z_=()=>["column","row","column-reverse","row-reverse"];function Q_(o,t){if(o&1){let e=M();l(0,"button",9),h("click",function(){let n=g(e).$implicit,r=d();return C(r.setMode(n))}),_(1,"ng-icon",10),a()}if(o&2){let e=t.$implicit,i=d();f("title",i.getModeLabel(e))("variant",i.props()["ctrl-mode"]===e?"flat":"text"),c(),f("name",i.getModeIcon(e))}}function K_(o,t){if(o&1){let e=M();l(0,"button",11),h("click",function(){let n=g(e).$implicit,r=d();return C(r.setAlignment(n.value))}),_(1,"ng-icon",10),a()}if(o&2){let e=t.$implicit,i=d();f("variant",i.props()["align-items"]===e.value?"flat":"text")("title",e.value),c(),f("name",e.icon)}}function Y_(o,t){if(o&1){let e=M();l(0,"button",13),h("click",function(){let n=g(e).$implicit,r=d(2);return C(r.setJustification(n.value))}),_(1,"ng-icon",10),a()}if(o&2){let e=t.$implicit,i=d(2);f("variant",i.props()["justify-content"]===e.value?"flat":"text")("title",e.value),c(),f("name",e.icon)}}function ev(o,t){if(o&1&&(l(0,"div",4)(1,"span"),u(2,"Distribuci\xF3n"),a(),l(3,"div",5),Y(4,Y_,2,3,"button",12,de),a()()),o&2){let e=d();c(4),ee(e.justificationOptions())}}function tv(o,t){if(o&1){let e=M();l(0,"span"),u(1,"Columnas"),a(),l(2,"app-number",14),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue("ctrl-gc",n??"1"))}),a()}if(o&2){let e=d();c(2),f("value",e.props()["ctrl-gc"])("min",1)("max",12)}}function iv(o,t){if(o&1){let e=M();l(0,"span"),u(1,"Ancho cols."),a(),l(2,"app-unit-selector",15),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue("ctrl-gmcw",n))}),a()}if(o&2){let e=d();c(2),f("value",e.props()["ctrl-gmcw"])("onlyPixels",!0)}}var nv={row:"Horizontal","row-reverse":"Horizontal (Invr.)",column:"Vertical","column-reverse":"Vertical (Invr.)",grid:"Cuadr\xEDcula",responsive:"Responsivo"},ov={column:"lucideMoveDown",row:"lucideMoveRight",grid:"lucideGrid3x3",responsive:"lucideLayoutGrid","row-reverse":"lucideMoveLeft","column-reverse":"lucideMoveUp"},Mr=class o{props=A(k({},Ai));initialValue=A(k({},Ai));modeOptions=["row","row-reverse","column","column-reverse","grid","responsive"];alignmentOptions=ce(()=>this.getAlignmentOptions(this.props()["ctrl-mode"]));justificationOptions=ce(()=>this.getJustificationOptions(this.props()["ctrl-mode"]));valueChange=new q;set value(t){JSON.stringify(this.initialValue())!==JSON.stringify(t)&&(this.initialValue.set(Ee(t)),this.props.set(k({},wt(t,Ai))))}updateValue(t,e){this.props.update(i=>re(k({},i),{[t]:e})),this.updateLayout()}updateLayout(){this.props.update(t=>{let e=k({},t);return e["ctrl-mode"]==="grid"?e["grid-template-columns"]=`repeat(${e["ctrl-gc"]}, minmax(0, 1fr))`:e["ctrl-mode"]==="responsive"?e["grid-template-columns"]=`repeat(auto-fit, minmax(${e["ctrl-gmcw"]}, 1fr))`:e["grid-template-columns"]="",e.display=["grid","responsive"].includes(e["ctrl-mode"])?"grid":"flex",e}),JSON.stringify(this.initialValue())!==JSON.stringify(this.props())&&(this.initialValue.set(Ee(this.props())),this.valueChange.emit(this.props()))}setMode(t){this.props.update(e=>re(k({},e),{"ctrl-mode":t,"flex-direction":t==="grid"||t==="responsive"?"":t})),this.updateLayout()}setAlignment(t){this.props.update(e=>re(k({},e),{"align-items":t})),this.updateLayout()}setJustification(t){this.props.update(e=>re(k({},e),{"justify-content":t})),this.updateLayout()}getModeLabel(t){return nv[t]}getModeIcon(t){return ov[t]}getAlignmentOptions(t){return[{value:"flex-start",icon:t==="column"?"lucideAlignStartVertical":"lucideAlignStartHorizontal"},{value:"center",icon:t==="column"?"lucideAlignCenterVertical":"lucideAlignCenterHorizontal"},{value:"flex-end",icon:t==="column"?"lucideAlignEndVertical":"lucideAlignEndHorizontal"},{value:"stretch",icon:t==="column"?"lucideStretchHorizontal":"lucideStretchVertical"}]}getJustificationOptions(t){return[{value:"flex-start",icon:t==="column"?"lucideAlignStartHorizontal":"lucideAlignStartVertical"},{value:"center",icon:t==="column"?"lucideAlignCenterHorizontal":"lucideAlignCenterVertical"},{value:"flex-end",icon:t==="column"?"lucideAlignEndHorizontal":"lucideAlignEndVertical"},{value:"space-between",icon:t==="column"?"lucideAlignVerticalSpaceBetween":"lucideAlignHorizontalSpaceBetween"},{value:"space-around",icon:t==="column"?"lucideAlignVerticalSpaceAround":"lucideAlignHorizontalSpaceAround"}]}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-layout-control"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[we([],[Te({lucideAlignStartHorizontal:zp,lucideAlignCenterHorizontal:Ap,lucideAlignEndHorizontal:jp,lucideAlignStartVertical:Bp,lucideAlignCenterVertical:hs,lucideAlignEndVertical:Rp,lucideStretchHorizontal:zu,lucideStretchVertical:Bu,lucideAlignHorizontalSpaceBetween:Up,lucideAlignVerticalSpaceBetween:$p,lucideLayoutGrid:As,lucideChevronsUpDown:eu,lucideRows3:Ou,lucideColumns3:iu,lucideGrid3x3:Os,lucideAlignVerticalSpaceAround:Wp,lucideAlignHorizontalSpaceAround:Lp,lucideMoveDown:xu,lucideMoveUp:Eu,lucideMoveRight:Su,lucideMoveLeft:wu})])],decls:21,vars:7,consts:[[1,"mode-dropdown"],["ngbDropdown","",1,"align-buttons"],["app-icon-button","","size","sm","app-icon-button","","color","secondary",3,"title","variant"],[1,"d-flex","flex-column","gap-2"],[1,"align-buttons"],[1,"button-group"],["app-icon-button","","size","sm","type","button",3,"variant","title"],[1,"inputs"],["prefix","gap",3,"valueChange","value","onlyPixels","min"],["app-icon-button","","size","sm","app-icon-button","","color","secondary",3,"click","title","variant"],[3,"name"],["app-icon-button","","size","sm","type","button",3,"click","variant","title"],["app-icon-button","","size","sm",3,"variant","title"],["app-icon-button","","size","sm",3,"click","variant","title"],[3,"valueChange","value","min","max"],["prefix","ideal",3,"valueChange","value","onlyPixels"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"span"),u(3,"Modo"),a(),l(4,"div"),Y(5,Q_,2,3,"button",2,de),a()()(),l(7,"div",3)(8,"div",4)(9,"span"),u(10,"Alineaci\xF3n"),a(),l(11,"div",5),Y(12,K_,2,3,"button",6,de),a()(),D(14,ev,6,0,"div",4),a(),l(15,"div",7),D(16,tv,3,3),D(17,iv,3,2),l(18,"span"),u(19,"Espaciado"),a(),l(20,"app-unit-selector",8),h("valueChange",function(r){return i.updateValue("gap",r)}),a()()),e&2&&(c(5),ee(i.modeOptions),c(7),ee(i.alignmentOptions()),c(2),T(Xi(6,Z_).includes(i.props()["ctrl-mode"])?14:-1),c(2),T(i.props()["ctrl-mode"]==="grid"?16:-1),c(),T(i.props()["ctrl-mode"]==="responsive"?17:-1),c(3),f("value",i.props().gap)("onlyPixels",!0)("min",0))},dependencies:[pe,Je,he,Ge,ei,Ke,ai,un],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:.5rem;font-family:Arial,sans-serif}.mode-dropdown[_ngcontent-%COMP%], .button-group[_ngcontent-%COMP%]{display:flex}.inputs[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 3fr;gap:.5rem;align-items:center}input[type=range][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{width:100%}span[_ngcontent-%COMP%]{font-size:11px;opacity:.7}.align-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 3fr;gap:.5rem;align-items:center;width:100%}"]})};var bl=class o{background={"bg-img":"linear-gradient(#2830a7ff, #2830a7ff), url('https://www.iestpjorgebasadregrohman.edu.pe/assets/img/logo.png')","bg-pos":"center","bg-s":"cover","bg-r":"no-repeat","bg-att":"scroll","ctrl-mode":"base"};dddd="100px";static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-test"]],features:[we([],[Te({lucideCopy:Fn,lucidePaintbrush:Mu})])],decls:28,vars:3,consts:[["disabled","","app-button","","color","success"],["app-button","","color","success","variant","outline"],["app-button","","color","secondary","variant","text"],["app-button","","color","danger","variant","flat"],["app-icon-button","","color","secondary","variant","flat","title","Flat Icon Button"],["name","lucidePaintbrush","size","1rem"],["app-icon-button","","color","success","variant","outline","title","Outline Icon Button"],["app-icon-button","","color","danger","variant","text","title","Text Icon Button"],[3,"valueChange","value"]],template:function(e,i){e&1&&(l(0,"button",0),u(1,"Primary Button"),a(),l(2,"button",1),u(3,"Primary Button"),a(),l(4,"button",2),u(5,"Text Button"),a(),l(6,"button",1),u(7,"Outline Button"),a(),l(8,"button",3),u(9,"Flat Button"),a(),l(10,"button",4),_(11,"ng-icon",5),a(),l(12,"button",6),_(13,"ng-icon",5),a(),l(14,"button",7),_(15,"ng-icon",5),a(),l(16,"app-unit-selector",8),ne("valueChange",function(r){return Z(i.dddd,r)||(i.dddd=r),r}),a(),l(17,"app-background-control",8),ne("valueChange",function(r){return Z(i.background,r)||(i.background=r),r}),a(),l(18,"div"),u(19),a(),_(20,"app-cloudinary-uploader")(21,"app-shadow-control")(22,"app-position-control")(23,"app-text-control")(24,"app-grid-span-control")(25,"app-filter-box-control")(26,"app-size-control")(27,"app-layout-control")),e&2&&(c(16),ie("value",i.dddd),c(),ie("value",i.background),c(2),Ie(" ",i.background,`
`))},dependencies:[Je,ei,pe,vr,vl,br,xr,wr,Sr,Er,Pr,Mr,he,Be,Ge],encapsulation:2})};var ha=(e=>(e.ACTIVE="1",e.INACTIVE="0",e))(ha||{});var fn=class o{API=`${Le.web_maker}/component`;apiService=b(Lt);loadingService=b(Yt);confirmationService=b(ft);auth=b(xe);toastrService=b(tt);states=[];stateMap=this.states.reduce((t,e)=>(t[e.code]=e.denomination,t),{});canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.canAdd=this.auth.hasSubPermission("component-ADD"),this.canEdit=this.auth.hasSubPermission("component-EDIT"),this.canRemove=this.auth.hasSubPermission("component-REMOVE"),this.canChangeState=this.auth.hasSubPermission("component-CHANGE-STATE"),this.canExport=this.auth.hasPermission("component-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("component-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("component-EXPORT-PDF")}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}delete(t){return P(this,null,function*(){return this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,{id:t.id})})}export(t,e){return P(this,null,function*(){if(!(yield this.confirmationService.create("Confirmar","\xBFEst\xE1 seguro de exportar los datos?")))return;this.loadingService.open();let n=re(k({},t),{type_export:e,url:Le.storage}),r=yield this.apiService.getPrivate(`${this.API}/export`,n);return this.loadingService.hide(),r&&r.state=="success"&&window.open(r.url),r})}fetchContent(t){return P(this,null,function*(){let e=yield fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.text()})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var Mf={type:"content",icon:"https://cdn-icons-png.flaticon.com/128/3524/3524878.png",name:"Contenedor",formFields:[...Ee(bt)],styleControl:{},styleList:[],minifyScript:Ut("content","<slot></slot>","",{})};var If=[...Ee(bt)],Df={type:"box",icon:"https://cdn-icons-png.flaticon.com/128/0/8.png",name:"Caja",formFields:If,styleControl:{size:We(re(k({},Bt),{width:"50px",height:"50px"})),background:We(re(k({},ti),{background:"#000000ff","ctrl-c":"#000000ff"})),general:We(Ti)},styleList:[],minifyScript:Ut("box","","",Ot(If))};var rv=`<div tag="{{${ot}.headerType}}" style="font-family: {{${ot}.font}}; font-weight: inherit; font-size: inherit;">{{${ot}.text}}</div>`,Tf=[{type:"text",optional:!1,label:"Texto",field:"text",default:"Tu texto aqu\xED"},{type:"group",optional:!1,label:"Fuente",field:"font",default:" ",options:[{value:" ",label:"Fuente Global"},{value:"'Tangerine', cursive",label:"Tangerine"},{value:"'Playwrite CU', cursive",label:"Playwrite "},{value:"'Raleway', sans-serif",label:"Raleway"},{value:"'Pacifico', cursive",label:"Pacifico"},{value:"'Poppins', sans-serif",label:"Poppins"},{value:"'Lato', sans-serif",label:"Lato"},{value:"'Roboto', sans-serif",label:"Roboto"},{value:"'Merriweather', serif",label:"Merriweather"},{value:"'Playfair Display', serif",label:"Playfair Display"},{value:"'Montserrat', system-ui",label:"Montserrat"},{value:"'Orbitron', sans-serif",label:"Orbitron"},{value:"'Chakra Petch', sans-serif",label:"Chakra Petch"}]},{type:"group",optional:!1,label:"Encabezado HTML",field:"headerType",default:"p",options:[{value:"h1",label:"T\xEDtulo 1 (h1)"},{value:"h2",label:"T\xEDtulo 2 (h2)"},{value:"h3",label:"T\xEDtulo 3 (h3)"},{value:"h4",label:"Subt\xEDtulo 4 (h4)"},{value:"h5",label:"Subt\xEDtulo 5 (h5)"},{value:"h6",label:"Subt\xEDtulo 6 (h6)"},{value:"p",label:"P\xE1rrafo normal (p)"}]},...Ee(bt)],Ff={type:"header-text",icon:"https://cdn-icons-png.flaticon.com/128/2087/2087807.png",name:"Texto",formFields:Tf,styleControl:{textAlign:We(tn),textStyle:We(xn),fontSize:We(en),textColor:We(nn),general:We(Ti)},styleList:["textAlign","textStyle","fontSize","textColor"],minifyScript:Ut("header-text",rv,"",Ot(Tf))};var av=`<i class="bi {{${ot}.icon}}"></i>`,kf=[{type:"icon",optional:!1,label:"Icono",field:"icon",default:"bi-star-fill"},...Ee(bt)],Of={type:"icon",icon:"https://cdn-icons-png.flaticon.com/128/2893/2893811.png",name:"Icono",formFields:kf,styleControl:{fontSize:We({"font-size":"32px"}),textColor:We(nn),v:We(k({},Mi))},styleList:["fontSize","textColor"],minifyScript:Ut("icon",av,"",Ot(kf))};var sv=`<img style="object-fit: {{${ot}.objectFit}}; height: 100%; width: 100%; display: block;" src="{{${ot}.imageUrl}}" alt="{{${ot}.imageAlt}}" class="image">`,Vf=[{type:"image",optional:!1,label:"Url",field:"imageUrl",default:"https://res.cloudinary.com/dlmbu4o28/image/upload/v1733322586/tv_hfsnqw.jpg"},{type:"text",optional:!1,label:"Texto alternativo",field:"imageAlt",default:"Scenic landscape"},{type:"group",optional:!1,label:"Relleno de imagen",field:"objectFit",default:"cover",options:[{value:"cover",label:"Adap. y Rellenar"},{value:"contain",label:"Adaptar"},{value:"fill",label:"Rellenar"}]},...Ee(bt)],Nf={type:"image",icon:"https://cdn-icons-png.flaticon.com/128/9261/9261193.png",name:"Imagen",formFields:Vf,styleControl:{size:We(re(k({},Bt),{width:"100px",height:"100px"})),v:We(k({},Mi))},styleList:[],minifyScript:Ut("image",sv,"",Ot(Vf))};var lv="<slot></slot>",Af={type:"layout",icon:"https://cdn-icons-png.flaticon.com/128/721/721047.png",name:"Capa",formFields:[...Ee(bt)],styleControl:{layout:We(re(k({},Ai),{"ctrl-mode":"column","flex-direction":"column"})),v:We(k({},Mi)),size:We(re(k({},Bt),{width:"100%"})),background:We(re(k({},ti),{background:"#f0f0f0ff","ctrl-c":"#f0f0f0ff"}))},styleList:["layout"],minifyScript:Ut("layout",lv,"",{})};var cv=`
<iframe 
    width="100%" 
    height="100%" 
    frameborder="0" scrolling="no" 
    src="https://www.openstreetmap.org/export/embed.html?bbox={{${ot}.longitude}},{{${ot}.latitude - (1/Math.pow(2,${ot}.zoom)) * 10}},{{${ot}.longitude}},{{${ot}.latitude + (1/Math.pow(2,${ot}.zoom)) * 10}}&layer=mapnik&marker={{${ot}.latitude}},{{${ot}.longitude}}"
></iframe>`,jf=[{type:"number",optional:!1,label:"Latitud",field:"latitude",default:-12.592431032751838},{type:"number",optional:!1,label:"Longitud",field:"longitude",default:-69.1945414727067},{type:"number",optional:!1,label:"Zoom",field:"zoom",default:12},...Ee(bt)],Rf={type:"maps",icon:"https://cdn-icons-png.flaticon.com/128/854/854878.png",name:"Mapa",formFields:jf,styleControl:{size:We(re(k({},Bt),{width:"100%",height:"400px"})),general:We(Ti)},styleList:[],minifyScript:Ut("maps",cv,"",Ot(jf))};var dv=`<div class="paragraph-container" [html]="${ot}.paragraph"></div>`,Lf=[{type:"paragraph",optional:!1,label:"P\xE1rrafo",field:"paragraph",default:"<b>Lorem </b>ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur."},...Ee(bt)],mv=".paragraph-container {line-height: 1.5;} .paragraph-container *:not([color]), .paragraph-container *[color] *:not() {}",Uf={type:"paragraph",icon:"https://cdn-icons-png.flaticon.com/128/15758/15758303.png",name:"P\xE1rrafo",formFields:Lf,minifyStyle:mv,styleControl:{textAlign:We(tn),general:We(Ti),fontSize:We(en)},styleList:["textAlign","fontSize","textColor"],minifyScript:Ut("paragraph",dv,"",Ot(Lf))};var zf=[{type:"group",optional:!1,label:"Posici\xF3n",field:"side",default:"bottom",options:[{value:"top",label:"Superior"},{value:"bottom",label:"Inferior"},{value:"left",label:"Izquierda"},{value:"right",label:"Derecha"}]},{type:"group",optional:!1,label:"Alineaci\xF3n",field:"align",default:"center",options:[{value:"start",label:"Inicio"},{value:"center",label:"Centro"},{value:"end",label:"Fin"}]},...Ee(bt)],Bf={type:"overlay",icon:"https://cdn-icons-png.flaticon.com/128/660/660366.png",name:"Dropdown",formFields:zf,styleControl:{layout:We(Ai),size:We(re(k({},Bt),{width:"300px"})),background:We(re(k({},ti),{background:"#f0f0f0ff","ctrl-c":"#f0f0f0ff"})),v:We(k({},Mi))},styleList:["layout"],minifyScript:Ut("overlay","<slot></slot>","",Ot(zf)),wrapComponent:"true"};var pv="<slot></slot>",uv=`
const [activeTab, setActiveTab] = useState(0);
const tabs = children.map((child, index) => h('button', {class: 'tab', onclick: () => changeTab(index), style: {backgroundColor: activeTab === index ? 'white' : '', color: activeTab === index ? '#ff6a00' : 'white'}}, '#' + (index + 1)))
const changeTab = (index) => setActiveTab(index);
const tempChildren = children.map((x, index)=> h('div', {class: 'tab-content', style: {display: activeTab === index ? 'block' : 'none'}}, x))
proxyData(({channel, action, value}) => {
    if(channel === __id && action === 'change') setActiveTab(value)
})

children = [
    !(modeview === 'preview') && h('div', {class: 'tab-area'}, [
        h('div', {class: 'tab-action'}, tabs),
        h('button', {class: 'tab', onClick: () => editorTab(${ot}['wmid'])}, 'editar pesta\xF1as'),
    ]),
    ...tempChildren
]
`,Wf={type:"tab",icon:"https://cdn-icons-png.flaticon.com/128/711/711732.png",name:"Pesta\xF1as",formFields:[...Ee(bt)],minifyStyle:"",styleControl:{general:We(Ti),size:We(re(k({},Bt),{width:"100%"})),background:We(re(k({},ti),{background:"#f0f0f0ff","ctrl-img":"#f0f0f0ff"}))},styleList:[],minifyScript:Ut("tab",pv,uv,{})};var xl=class o{API=`${Le.web_maker}/project-element`;auth=b(xe);toastrService=b(tt);apiService=b(Lt);canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;constructor(){this.canAdd=this.auth.hasSubPermission("project-element-ADD"),this.canEdit=this.auth.hasSubPermission("project-element-EDIT"),this.canRemove=this.auth.hasSubPermission("project-element-REMOVE"),this.canChangeState=this.auth.hasSubPermission("project-element-CHANGE-STATE")}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}findOne(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}remove(t,e){return P(this,null,function*(){let i=yield this.apiService.deletePrivate(`${this.API}/delete/${t}`,e);return i.state=="success"&&this.toastrService.success(i.message),i})}updateState(t,e){return P(this,null,function*(){let i=yield this.apiService.putPrivate(`${this.API}/state/change/${t}`,e);return i.state=="success"&&this.toastrService.success(i.message),i})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var Ui=[];for(let o=0;o<256;++o)Ui.push((o+256).toString(16).slice(1));function $f(o,t=0){return(Ui[o[t+0]]+Ui[o[t+1]]+Ui[o[t+2]]+Ui[o[t+3]]+"-"+Ui[o[t+4]]+Ui[o[t+5]]+"-"+Ui[o[t+6]]+Ui[o[t+7]]+"-"+Ui[o[t+8]]+Ui[o[t+9]]+"-"+Ui[o[t+10]]+Ui[o[t+11]]+Ui[o[t+12]]+Ui[o[t+13]]+Ui[o[t+14]]+Ui[o[t+15]]).toLowerCase()}var Bd,fv=new Uint8Array(16);function Wd(){if(!Bd){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Bd=crypto.getRandomValues.bind(crypto)}return Bd(fv)}var hv=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),$d={randomUUID:hv};function gv(o,t,e){o=o||{};let i=o.random??o.rng?.()??Wd();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){if(e=e||0,e<0||e+16>t.length)throw new RangeError(`UUID byte range ${e}:${e+15} is out of buffer bounds`);for(let n=0;n<16;++n)t[e+n]=i[n];return t}return $f(i)}function Cv(o,t,e){return $d.randomUUID&&!t&&!o?$d.randomUUID():gv(o,t,e)}var ga=Cv;var ji=class o{static generateFields(t){let e=k({},t.fields),i=t.vars??{};return Object.entries(i).forEach(([n,r])=>e[n]=`\${${r}}`),t.htmlId&&(e.id=t.htmlId),e}static parseVariableString(t){let e=/^\$\{(?:(.*?):)?(.*?)\}$/.exec(t);return e?{category:e[1]??null,key:e[2]}:null}static fieldStringify(t,e={isParentCms:!1,isCustomComponent:!1}){let i=[];return Object.entries(t).forEach(([n,r])=>{let s=typeof r=="string"&&r.startsWith("${")?o.parseVariableString(r):null,m=["...dataset"];e.isParentCms&&m.push("...contextDataset"),e.isCustomComponent&&m.push(`...${ot}`),s?n==="__link"&&e.isParentCms?i.push(`'${n}': ({${m.join(",")}}['${s.key}']).replaceAll(':slug', contextDataset['slug'])`):i.push(`'${n}': {${m.join(",")}}['${s.key}']`):i.push(`'${n}': ${JSON.stringify(r)}`)}),`{${i.join(",")}}`}static extractStyles(t,e={}){if(!t)return{};let i={};for(let n of Object.keys(t)){if(n=="margin"||e.isCustomComponent===!0&&e.level===0&&["size","position"].includes(n))continue;let r=t[n];if(r)for(let s of oi){let m=r[s];if(i[s]||(i[s]={}),!!m){if(n=="tf"){let p=+(m._fx||"1"),v=+(m._fy||"1"),y=+(m._s||"1")*v;m={transform:`scale(${+(m._s||"1")*p}, ${y})  rotate(${m._r}deg)`}}n=="z"&&(m={"z-index":m.z}),n=="shadow"&&(m={"box-shadow":`${m["ctrl-h"]} ${m["ctrl-v"]} ${m["ctrl-b"]} ${m["ctrl-s"]} ${m["ctrl-c"]}`});for(let[p,v]of Object.entries(m)){let y=((v??"")+"").trim();p.startsWith("ctrl-")||y==="initial"||(i[s][p]=y==""?"initial":y)}e.enableTransition===!0&&(i[s].transition="ease 0.3s all")}}}return i}static generateStylesSheet(t,e,i){let n=[],r="",s="";return t.forEach((m,p)=>{if(p==0&&(s="flex"),Object.keys(i[m.device]??{}).length==0)return;let v=k({},i[m.device]||{}),y=v.show??r,x=v.display??s;v.display=y==="none"?"none":x??"flex",delete v.show,r=y,s=x;let E=Object.entries(v).map(([w,O])=>`${w}: ${O}`).join(";");p===0?n.push(`${e} {${E}}`):n.push(`@media screen and (max-width: ${m.width}px) {${e} {${E}}}`)}),n.join(`
`)}static designerSheet(t,e,i,n){let r=[],s="",m="";return t.forEach((p,v)=>{if(v==0&&(m="flex"),Object.keys(n[p.device]??{}).length==0)return;let y=k({},n[p.device]||{}),x=y.show??s,E=y.display??m;if(y.display=x==="none"?"none":E??"flex",delete y.show,s=x,m=E,y.height&&y.height.toLowerCase().endsWith("vh")){let F=parseInt(y.height)/100*df;y.height=`${F}px`}let w=Object.entries(y).map(([F,V])=>`${F}: ${V}`).join(";"),O=t.slice(0,v+1).reduce((F,V)=>`${F}.d-${V.width}`,"");r.push(`${O} ${e} ${i} {${w}}`)}),r.join(`
`)}static designStyles(t,e,i={isSheetMode:!0}){if(!e)return{css:""};let n=e.id;e.css==null&&(e.css={main:{}});let r=e.css.main,s=e.css.h,m=e.css["main:h"],p=o.extractStyles(r,{level:i.level}),v=s?o.extractStyles(s,{level:i.level}):{},y=m?o.extractStyles(m,{level:i.level}):{},x=o.designerSheet(t,"",`.${n}`,p)??"",E=s?o.designerSheet(t,"",`.${n}.hover`,v)??"":"",w=m?o.designerSheet(t,".main\\:h",`.${n}`,y)??"":"",O=[x,w,E].filter(Boolean).join(`
`);return{css:i.isSheetMode?`<style id="${e.id}">${O}</style>`:O}}};var _v="<slot></slot>",vv="",Hf=[...Ee(bt)],Gf={type:"cms-list",icon:"https://cdn-icons-png.flaticon.com/128/16419/16419459.png",name:"Lista CMS",formFields:Hf,styleControl:{layout:We(re(k({},Ai),{"ctrl-mode":"column","flex-direction":"column"})),size:We(re(k({},Bt),{width:"100%"})),background:We(re(k({},ti),{background:"#f0f0f0ff","ctrl-c":"#f0f0f0ff"})),v:We(k({},Mi))},styleList:["layout"],minifyScript:Ut("layout",_v,vv,Ot(Hf))};var qf=[{type:"group",optional:!1,label:"Posici\xF3n",field:"side",default:"center",options:[{value:"top",label:"Superior"},{value:"bottom",label:"Inferior"},{value:"left",label:"Izquierda"},{value:"right",label:"Derecha"},{value:"center",label:"Centro"}]},...Ee(bt)],Jf={type:"dialog",icon:"https://cdn-icons-png.flaticon.com/128/660/660366.png",name:"Dialogo",formFields:qf,styleControl:{layout:We(Ai),size:We(re(k({},Bt),{width:"300px",height:"300px"})),background:We(re(k({},ti),{background:"#f0f0f0ff","ctrl-c":"#f0f0f0ff"})),v:We(k({},Mi))},styleList:["layout"],minifyScript:Ut("dialog","<slot></slot>","",Ot(qf)),wrapComponent:"true"};var yv=`<div class="button {{${ot}.displayMode}}" style="--icon-position: {{${ot}.iconPosition}}; --button-justify: {{${ot}.align}};">
    <i class="{{${ot}.icon}} icon-start"></i>
    <span>{{${ot}.text}}</span>
</div>`,bv=`
    .button {
        display: inline-flex;
        align-items: center;
        justify-content: var(--button-justify);
        flex-direction: var(--icon-position, row);
        gap: 0.5rem;
        width: 100%;
        height: 100%;
        cursor: pointer;
    }
    .button.icon-only span {display: none}
    .button.text-only i {display: none}
    .button span{text-align: inherit;}
`,Xf=[{type:"text",optional:!1,label:"Texto",field:"text",default:"Bot\xF3n"},{type:"icon",optional:!1,label:"Icono",field:"icon",default:"bi-house-door-fill"},{type:"group",optional:!1,label:"Posici\xF3n del icono",field:"iconPosition",default:"row",options:[{value:"row",label:"Izquierda"},{value:"row-reverse",label:"Derecha"}]},{type:"group",optional:!1,label:"Distribucion",field:"align",default:"center",options:[{value:"center",label:"Centro"},{value:"space-between",label:"Lateral"}]},{type:"group",optional:!1,label:"Visualizaci\xF3n",field:"displayMode",default:"icon-and-text",options:[{value:"icon-and-text",label:"Icono y texto"},{value:"icon-only",label:"Solo icono"},{value:"text-only",label:"Solo texto"}]},...Ee(bt)],Zf={type:"button",icon:"https://cdn-icons-png.flaticon.com/128/12653/12653546.png",name:"Bot\xF3n",formFields:Xf,styleControl:{textAlign:We(tn),textStyle:We(xn),fontSize:We(en),textColor:We(re(k({},nn),{color:"#ffffff"})),size:We(re(k({},Bt),{width:"auto",height:"38px"})),background:We(re(k({},ti),{background:"#000000ff","ctrl-c":"#000000ff"})),borderRadius:We(re(k({},Qn),{"border-radius":"4px"})),v:We(k({},Mi)),padding:We(re(k({},Kn),{padding:"8px 16px"}))},styleList:["textAlign","textStyle","fontSize","textColor","size","background"],minifyStyle:bv,minifyScript:Ut("button",yv,"",Ot(Xf))};var xv=[Af,Mf,Uf,Ff,Of,Df,Nf,Rf,Bf,Jf,Wf,Gf,Zf],Dt=class o{isComponentReady=A(!1);systemComponents=A([]);mapSystemComponents=A({});isUserComponentsReady=A(!1);userComponents=A([]);mapUserComponents=A({});mapUserComponentElements=A({});isReady=ce(()=>this.isComponentReady()&&this.isUserComponentsReady());components=ce(()=>[...this.systemComponents(),...this.userComponents()]);mapComponents=ce(()=>k(k({},this.mapSystemComponents()),this.mapUserComponents()));componentService=b(fn);ds=b(Ue);projectElementService=b(xl);createInstanceOf(t,e={}){let i=this.mapComponents()[t],n=this.getDefaultValueField(t);return{id:Go(),type:t,fields:Ee(k(k({},n.fields),e)),children:[],css:Ee(n.css),icon:i?.icon??"",name:i?.name??"",isCustom:i?.isCustom===!0}}createUserComponent(t,e,i){return P(this,null,function*(){let[n]=o.elementToBase([t]),r=yield this.projectElementService.add({name:e,nodes:JSON.stringify(n),project_id:i,state:"1",fields:"[]"});r.state==="success"&&r.data&&(yield this.loadProjectComponents(i))})}updateComponentData(t,e,i){return P(this,null,function*(){let[n]=o.elementToBase(e);return yield this.projectElementService.update({nodes:JSON.stringify(n),id:t,fields:JSON.stringify(i)})})}createComponent(t){let e=this.generateComponents([t.baseNodes],{isCustomComponent:!0,masterComponentType:t.type,generateNewId:!0,fullCss:t.fullCss}),i=bf(t.type,e.components,"",t.dataset),n=[...t.fields,...Ee(bt)];return{type:t.type,icon:"https://cdn-icons-png.flaticon.com/512/8287/8287848.png",name:t.name,formFields:n,styleControl:{},styleList:[],minifyScript:i,minifyStyle:e.styleSheet,isCustom:!0,dependencies:e.dependencies}}updateProjectComponent(t,e,i,n){return P(this,null,function*(){if((yield this.updateComponentData(t,e,n)).state!="success")return;let s=this.mapUserComponentElements();if(s[i]){let x=k({},s);x[i]={nodes:e,id:t,fields:n},this.mapUserComponentElements.set(x)}let m=this.createComponent({type:i,name:this.mapUserComponents()[i]?.name||"",fields:n,baseNodes:e[0],dataset:Ot(n),fullCss:!1}),p=k({},this.mapUserComponents());p[i]=m,this.mapUserComponents.set(p);let y=this.userComponents().map(x=>x.type===i?m:x);this.userComponents.set(y)})}constructor(){this.loadComponents()}loadProjectComponents(t){return P(this,null,function*(){this.isUserComponentsReady.set(!1),this.mapUserComponentElements.set({}),this.mapUserComponents.set({}),this.userComponents.set([]);let i=((yield this.projectElementService.list({project_id:t})).data??[]).map(m=>{let p=JSON.parse(m.nodes),v=o.baseToElement([p])[0],y=JSON.parse(m.fields||"[]");return{baseNodes:v,type:m.normalizeName,name:m.name,id:m.id,fields:y,dataset:Ot(y),fullCss:!1}}),n=i.reduce((m,p)=>(m[p.type]||(m[p.type]={nodes:[p.baseNodes],id:p.id,fields:p.fields}),m),{});this.mapUserComponentElements.set(n);let r=i.map(m=>this.createComponent(m)),s=r.reduce((m,p)=>(m[p.type]=p,m),{});this.mapUserComponents.set(s),this.userComponents.set(r),this.isUserComponentsReady.set(!0)})}loadComponents(){return P(this,null,function*(){this.isComponentReady.set(!1),this.systemComponents.set([]),this.mapSystemComponents.set({});let t=yield this.componentService.list({});if(t.state=="success"){let e=t.data?.map(n=>({type:n.type,icon:n.icon,name:n.name,formFields:n.formFields.trim()?JSON.parse(n.formFields):[],minifyScript:n.minifyScript,minifyStyle:n.minifyStyle,styleControl:JSON.parse(n.styleControl??"{}"),styleList:JSON.parse(n.styleList??"[]")}))||[];e=[...xv,...e];let i=e.reduce((n,r)=>(n[r.type]=r,n),{})||{};this.mapSystemComponents.set(i),this.systemComponents.set(e),this.isComponentReady.set(!0)}})}createLayoutComponent(t,e={}){let i=this.createInstanceOf("layout",e);return i.css==null&&(i.css={main:{}}),i.css.main.layout=We(re(k({},Ai),{"flex-direction":t,"ctrl-mode":t})),i.css.main.background=We(re(k({},ti),{background:"#00000000","ctrl-c":"#00000000"})),i}createDropdownComponent(t={}){let e=this.createInstanceOf("overlay",t);this.ds.createNodeProcessor(e).addCssStyles({background:"#ffffff",padding:"8px 16px","border-radius":"8px",display:"flex","flex-direction":"column",width:"200px","justify-content":"center","box-shadow":"0 0 8px rgba(0,0,0,0.1)"},"div");let n=this.createInstanceOf("header-text",{text:"Lorem ipsum dolor sit amet"});return this.ds.createNodeProcessor(n).addCssStyles({color:"black","font-size":"12px"},"span"),e.children.push(n),e}createDialogComponent(t={}){let e=this.createInstanceOf("dialog",t);this.ds.createNodeProcessor(e).addCssStyles({background:"#ffffff",padding:"8px 16px","border-radius":"8px",display:"flex","flex-direction":"column",width:"300px",height:"300px","justify-content":"center","box-shadow":"0 0 8px rgba(0,0,0,0.1)"},"div");let n=this.createInstanceOf("header-text",{text:"Lorem ipsum dolor sit amet"});return this.ds.createNodeProcessor(n).addCssStyles({color:"black","font-size":"12px"},"span"),e.children.push(n),e}getDefaultValueField(t){let e=this.mapSystemComponents()[t];if(e==null)return{fields:{},css:{}};let i=e.formFields||[],n={};return i.forEach(r=>{n[r.field]=r.default}),{fields:k({},n),css:{main:k({},e.styleControl)}}}generateDesignerResources(t){let e=this.generateDevComponents(t),i=this.getResoursesDev(e.dependencies),n=Object.keys(i).map(s=>{let m=wn(s),p=i[s].script!=""?i[s].script:'() => h(__sysc.EmptyComponent, {text: "'+s+'"})';return`window['${m}'] = storeComponents['${m}'] = ${p};`}).join("");return{styles:Object.values(i).reduce((s,m)=>s+m.styles,""),components:e.components,componentScript:n,styleSheet:e.styleSheets}}generatePreviewResources(t){let e=this.generateComponents(t,{generateNewId:!1,fullCss:!0}),i=this.getResoursesDev(e.dependencies,this.mapComponents(),!0),n=[];Object.keys(i).forEach(s=>{n.push(`const ${wn(s)} = ${i[s].script};`)});let r=[];return Object.values(i).forEach(s=>{r.push(s.styles)}),{styles:r.join(""),components:e.components,classes:n.join(`
`),styleSheet:e.styleSheet}}getResoursesDev(t,e=this.mapComponents(),i=!1){let n={};return t.forEach(r=>{let s=e[r],m=s?.minifyScript??"",p=s?.minifyStyle??"";if(i&&s.isCustom){let v=this.mapUserComponentElements()[r];if(v){let{nodes:y,fields:x}=v,E=this.createComponent({type:r,name:s.name,fields:x,baseNodes:y[0],dataset:Ot(x),fullCss:!0});m=E.minifyScript??"",p=E.minifyStyle??""}}n[r]={script:m,styles:p,className:wn(r)}}),n}genarateSimpleDevComponent(t){let e=ji.designStyles(this.ds.deviceInfo(),t,{isSheetMode:!1}),i=t.isCustom===!0,n=(t.ghost?"ghost":"")+(i?" custom-component":""),r=re(k({},ji.generateFields(t)),{wmid:t.id,type:t.type,classes:n,parentId:t.parent?.id});return{id:t.id,fields:r,styleSheet:e.css}}generateDevComponents(t,e=!1){if(t.length==0)return{components:"null",styleSheets:"",overlayComponents:"[]",dependencies:[]};let i=[],n=[],r=[],s=new Set;return t.forEach(m=>{if(m==null)return;let p=this.mapComponents()[m.type],v=["content","layout","tab","overlay","cms-list","dialog"].includes(m.type)?'h("placeholder", {style: {color: "#E91E63"}}, "[agregar elemento]")':"null",y=this.generateDevComponents(m.children,m.type==="cms-list"||e),x=ji.designStyles(this.ds.deviceInfo(),m),E=ji.generateFields(m),w="[]";n.push(x.css,y.styleSheets),y.overlayComponents.length>0&&(w=y.overlayComponents);let O=y.components;if(m.type=="cms-list"){let Q=m.cmsSource?this.ds.dataHandler.cmsRows(m.cmsSource):[];O=`${JSON.stringify(Q)}.map((__c, __i) => {const contextDataset = {...__c, index: __i};return ${O};})`}let F=re(k(k({},E??{}),E??{}),{type:m.type,wmid:m.id,events:m.events??{},isLink:m.isLink===!0}),V=m.children.length===0?v:O,L=wn(m.type),B=[];m.isCustom===!0&&B.push("custom-component"),m.ghost===!0&&B.push("ghost"),F.classes=B.join(" "),s.add(m.type),y.dependencies.forEach(Q=>s.add(Q)),p?.dependencies?.forEach(Q=>s.add(Q));let z=`h(__sysc.ProxyComponent, {dataset: ${JSON.stringify(F)}, overlay: ${w}, type: '${L}', id: '${m.id}', key: '${ga()}', ${e?"contextDataset":""}}, ${V})`;m.type=="dialog"||m.type=="overlay"?r.push(z):i.push(z)}),{components:`[${i.join(",")}]`,overlayComponents:`[${r.join(",")}]`,styleSheets:n.join(`
`),dependencies:Array.from(s)}}generateComponents(t,e={},i=0){if(t.length==0)return{components:"null",styleSheet:"",overlayComponents:"[]",dependencies:[]};let n=[],r=[],s=[],m=new Set,p=e.isCustomComponent===!0&&i==0?{position:"relative",width:"100%",height:"100%"}:{};return t.forEach(v=>{if(v.ghost===!0)return;v.id=e.generateNewId===!0?Go():v.id;let y=this.mapComponents()[v.type],x=this.generateComponents(v.children,re(k({},e),{isParentCms:v.type==="cms-list"||e.isParentCms===!0}),i+1),E=this.generateStyles(v,{isCustomComponent:e.isCustomComponent,level:i,prefix:e.isCustomComponent===!0?e.masterComponentType:void 0}),w=ji.generateFields(v),O=x.components;if(v.type=="cms-list"&&v.cmsSource!=null){let fe=this.ds.dataHandler.cmsRows(v.cmsSource)||[];console.log(fe),O=`${JSON.stringify(fe)}.map((__c, __i) => {const contextDataset = {...__c, index: __i};return ${O};})`}let F=v.children.length===0?"null":O,V="[]";x.overlayComponents.length>0&&(V=x.overlayComponents),r.push(...e.fullCss===!0?[E.css,E.hoverCss,x.styleSheet]:[E.css,x.styleSheet]);let L=re(k({},w??{}),{type:v.type,wmid:e.isCustomComponent===!0?`${e.masterComponentType??""}_${v.id}`:v.id,events:v.events??{},isLink:v.isLink===!0}),B=wn(v.type),z=[];e.isCustomComponent===!0&&z.push(e.masterComponentType??""),L.classes=z.join(" ");let Q=Object.keys(p).length===0?"":`, style:${JSON.stringify(p)}`;m.add(v.type),x.dependencies.forEach(fe=>m.add(fe)),y?.dependencies?.forEach(fe=>m.add(fe));let K=`h(${B}, {dataset: ${ji.fieldStringify(L,{isCustomComponent:e.isCustomComponent===!0,isParentCms:v.type==="cms-list"||e.isParentCms===!0})}, overlay: ${V}, key: '${v.id}'${Q}}, ${F})`;v.type=="dialog"||v.type=="overlay"?s.push(K):n.push(K)}),{components:`[${n.join(",")}]`,styleSheet:r.join(`
`),overlayComponents:`[${s.join(",")}]`,dependencies:Array.from(m)}}generateStyles(t,e={}){if(!t)return{css:"",hoverCss:""};if(t.css==null)return{css:"",hoverCss:""};let i=t.css["main:h"]!=null,n=t.css.h!=null,r=ji.extractStyles(t.css.main??{},{isCustomComponent:e.isCustomComponent,level:e.level,enableTransition:i||n}),s=n?ji.extractStyles(t.css.h??{},{isCustomComponent:e.isCustomComponent,level:e.level}):{},m=i?ji.extractStyles(t.css["main:h"]??{},{isCustomComponent:e.isCustomComponent,level:e.level}):{},p=e.prefix?`${e.prefix}_${t.id}`:t.id,v=ji.generateStylesSheet(this.ds.deviceInfo(),`.${p}`,r)??"",y=n?ji.generateStylesSheet(this.ds.deviceInfo(),`.${p}:hover`,s)??"":"",x=e.prefix?`[wt='${e.prefix}']`:'[wt="content"]',E=i?ji.generateStylesSheet(this.ds.deviceInfo(),`${x}:hover .${p}`,m)??"":"";return{css:v,hoverCss:y+E}}normalizeNodes(t){t.forEach(e=>{let i=this.mapComponents()[e.type],n=k({main:{}},e.css);e.isCustom=i?.isCustom===!0,n.main.general==null&&(n.main=re(k({},n.main),{general:We(Ti)})),n.main.v==null&&(n.main=re(k({},n.main),{v:We(Mi)})),e.type=="header-text"&&(e.fields.text=e.fields.text??e.fields.title??"",delete e.fields.title),e.css=n,e.icon=i?.icon??"",e.name=e.name??i?.name??"",e.fields&&e.fields.__link!=null&&e.fields.__link!=="string"&&e.fields.__link.url&&(e.fields.__link=e.fields.__link.url),e.type=="button"&&e.isLink==null&&(e.isLink=!0),e.htmlId!=null&&e.htmlId.startsWith("WM")&&(console.log("htmlId",e.htmlId),delete e.htmlId),this.normalizeNodes(e.children??[])})}static createDuplicate(t,e={preserveId:!1}){let w=t,{children:i,parent:n,id:r,css:s,events:m,htmlId:p,fields:v,vars:y}=w,x=qn(w,["children","parent","id","css","events","htmlId","fields","vars"]);return re(k({},x),{id:e.preserveId?t.id:Go(),fields:Ee(t.fields||{}),children:t.children?.map(O=>o.createDuplicate(O,e))??[],css:Ee(t.css||{}),events:Ee(t.events||{}),vars:Ee(t.vars||{})})}static elementToBase=t=>t.map(e=>{let i={type:e.type,children:o.elementToBase(e.children),fields:Ee(e.fields),name:e.name,events:Ee(e.events),css:Ee(e.css)};return e.isLink===!0&&(i.isLink=!0),e.htmlId&&(i.htmlId=e.htmlId),e.ghost===!0&&(i.ghost=!0),e.hidden===!0&&(i.hidden=!0),e.vars!=null&&Object.keys(e.vars).length>0&&(i.vars=e.vars),e.cmsSource!=null&&(i.cmsSource=e.cmsSource),i});static baseToElement=t=>t.map(e=>({id:Go(),type:e.type,children:o.baseToElement(e.children),fields:Ee(e.fields),name:e.name,icon:"",ghost:e.ghost,hidden:e.hidden,htmlId:e.htmlId,events:Ee(e.events),isLink:e.isLink,vars:e.vars,css:Ee(e.css),cmsSource:e.cmsSource}));static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};function qd(o){let t=o.cloneNode(!0),e=t.querySelectorAll("[id]"),i=o.nodeName.toLowerCase();t.removeAttribute("id");for(let n=0;n<e.length;n++)e[n].removeAttribute("id");return i==="canvas"?Yf(o,t):(i==="input"||i==="select"||i==="textarea")&&Kf(o,t),Qf("canvas",o,t,Yf),Qf("input, textarea, select",o,t,Kf),t}function Qf(o,t,e,i){let n=t.querySelectorAll(o);if(n.length){let r=e.querySelectorAll(o);for(let s=0;s<n.length;s++)i(n[s],r[s])}}var wv=0;function Kf(o,t){t.type!=="file"&&(t.value=o.value),t.type==="radio"&&t.name&&(t.name=`mat-clone-${t.name}-${wv++}`)}function Yf(o,t){let e=t.getContext("2d");if(e)try{e.drawImage(o,0,0)}catch{}}function Yd(o){let t=o.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}}function Jd(o,t,e){let{top:i,bottom:n,left:r,right:s}=o;return e>=i&&e<=n&&t>=r&&t<=s}function Sv(o,t){let e=t.left<o.left,i=t.left+t.width>o.right,n=t.top<o.top,r=t.top+t.height>o.bottom;return e||i||n||r}function va(o,t,e){o.top+=t,o.bottom=o.top+o.height,o.left+=e,o.right=o.left+o.width}function eh(o,t,e,i){let{top:n,right:r,bottom:s,left:m,width:p,height:v}=o,y=p*t,x=v*t;return i>n-x&&i<s+x&&e>m-y&&e<r+y}var wl=class{_document;positions=new Map;constructor(t){this._document=t}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),t.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:Yd(e)})})}handleScroll(t){let e=ma(t),i=this.positions.get(e);if(!i)return null;let n=i.scrollPosition,r,s;if(e===this._document){let v=this.getViewportScrollPosition();r=v.top,s=v.left}else r=e.scrollTop,s=e.scrollLeft;let m=n.top-r,p=n.left-s;return this.positions.forEach((v,y)=>{v.clientRect&&e!==y&&e.contains(y)&&va(v.clientRect,m,p)}),n.top=r,n.left=s,{top:m,left:p}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function ph(o,t){let e=o.rootNodes;if(e.length===1&&e[0].nodeType===t.ELEMENT_NODE)return e[0];let i=t.createElement("div");return e.forEach(n=>i.appendChild(n)),i}function em(o,t,e){for(let i in t)if(t.hasOwnProperty(i)){let n=t[i];n?o.setProperty(i,n,e?.has(i)?"important":""):o.removeProperty(i)}return o}function Ir(o,t){let e=t?"":"none";em(o.style,{"touch-action":t?"":"none","-webkit-user-drag":t?"":"none","-webkit-tap-highlight-color":t?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function th(o,t,e){em(o.style,{position:t?"":"fixed",top:t?"":"0",opacity:t?"":"0",left:t?"":"-999em"},e)}function Sl(o,t){return t&&t!="none"?o+" "+t:o}function ih(o,t){o.style.width=`${t.width}px`,o.style.height=`${t.height}px`,o.style.transform=ya(t.left,t.top)}function ya(o,t){return`translate3d(${Math.round(o)}px, ${Math.round(t)}px, 0)`}function nh(o){let t=o.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(o)*t}function Ev(o){let t=getComputedStyle(o),e=Hd(t,"transition-property"),i=e.find(m=>m==="transform"||m==="all");if(!i)return 0;let n=e.indexOf(i),r=Hd(t,"transition-duration"),s=Hd(t,"transition-delay");return nh(r[n])+nh(s[n])}function Hd(o,t){return o.getPropertyValue(t).split(",").map(i=>i.trim())}var Pv=new Set(["position"]),Xd=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(t,e,i,n,r,s,m,p,v,y){this._document=t,this._rootElement=e,this._direction=i,this._initialDomRect=n,this._previewTemplate=r,this._previewClass=s,this._pickupPositionOnPage=m,this._initialTransform=p,this._zIndex=v,this._renderer=y}attach(t){this._preview=this._createPreview(),t.appendChild(this._preview),oh(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(t){this._preview.style.transform=t}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(t){this._preview.classList.add(t)}getTransitionDuration(){return Ev(this._preview)}addEventListener(t,e){return this._renderer.listen(this._preview,t,e)}_createPreview(){let t=this._previewTemplate,e=this._previewClass,i=t?t.template:null,n;if(i&&t){let r=t.matchSize?this._initialDomRect:null,s=t.viewContainer.createEmbeddedView(i,t.context);s.detectChanges(),n=ph(s,this._document),this._previewEmbeddedView=s,t.matchSize?ih(n,r):n.style.transform=ya(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else n=qd(this._rootElement),ih(n,this._initialDomRect),this._initialTransform&&(n.style.transform=this._initialTransform);return em(n.style,{"pointer-events":"none",margin:oh(n)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},Pv),Ir(n,!1),n.classList.add("cdk-drag-preview"),n.setAttribute("popover","manual"),n.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(r=>n.classList.add(r)):n.classList.add(e)),n}};function oh(o){return"showPopover"in o}var Mv={passive:!0},rh={passive:!1},Iv={passive:!1,capture:!0},Dv=800,ah="cdk-drag-placeholder",sh=new Set(["position"]),Zd=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=A(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new Tt;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=Ji.EMPTY;_pointerUpSubscription=Ji.EMPTY;_scrollSubscription=Ji.EMPTY;_resizeSubscription=Ji.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis=null;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(t){t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(e=>Ir(e,t)))}_disabled=!1;beforeStarted=new Tt;started=new Tt;released=new Tt;ended=new Tt;entered=new Tt;exited=new Tt;dropped=new Tt;moved=this._moveEvents;data;constrainPosition;constructor(t,e,i,n,r,s,m){this._config=e,this._document=i,this._ngZone=n,this._viewportRuler=r,this._dragDropRegistry=s,this._renderer=m,this.withRootElement(t).withParent(e.parentDragRef||null),this._parentPositions=new wl(i),s.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(i=>Xn(i)),this._handles.forEach(i=>Ir(i,this.disabled)),this._toggleNativeDragInteractions();let e=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&e.add(i)}),this._disabledHandles=e,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){let e=Xn(t);if(e!==this._rootElement){this._removeRootElementListeners();let i=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[i.listen(e,"mousedown",this._pointerDown,rh),i.listen(e,"touchstart",this._pointerDown,Mv),i.listen(e,"dragstart",this._nativeDragStart,rh)]),this._initialTransform=void 0,this._rootElement=e}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?Xn(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&Sv(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){let t=this._boundaryElement.getBoundingClientRect(),e=this._rootElement.getBoundingClientRect(),i=0,n=0;e.left<t.left?i=t.left-e.left:e.right>t.right&&(i=t.right-e.right),e.top<t.top?n=t.top-e.top:e.bottom>t.bottom&&(n=t.bottom-e.bottom);let r=this._activeTransform.x,s=this._activeTransform.y,m=r+i,p=s+n;this._rootElement.style.transform=ya(m,p),this._activeTransform={x:m,y:p},this._passiveTransform={x:m,y:p}}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),Ir(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),Ir(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){let t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){let t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){let e=this._getTargetHandle(t);e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)};_pointerMove=t=>{let e=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging()){let n=Math.abs(e.x-this._pickupPositionOnPage.x),r=Math.abs(e.y-this._pickupPositionOnPage.y);if(n+r>=this._config.dragStartThreshold){let m=Date.now()>=this._dragStartTime+this._getDragStartDelay(t),p=this._dropContainer;if(!m){this._endDragSequence(t);return}(!p||!p.isDragging()&&!p.isReceiving())&&(t.cancelable&&t.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(t)))}return}t.cancelable&&t.preventDefault();let i=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(i),this._dropContainer)this._updateActiveDropContainer(i,e);else{let n=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,r=this._activeTransform;r.x=i.x-n.x+this._passiveTransform.x,r.y=i.y-n.y+this._passiveTransform.y,this._applyRootElementTransform(r.x,r.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:i,event:t,distance:this._getDragDistance(i),delta:this._pointerDirectionDelta})})};_pointerUp=t=>{this._endDragSequence(t)};_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:t}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let e=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){Ca(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let e=this._getShadowRoot(),i=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(e,"selectstart",Tv,Iv)}),i){let n=this._rootElement,r=n.parentNode,s=this._placeholder=this._createPlaceholderElement(),m=this._marker=this._marker||this._document.createComment("");r.insertBefore(m,n),this._initialTransform=n.style.transform||"",this._preview=new Xd(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(r,e)),th(n,!1,sh),this._document.body.appendChild(r.replaceChild(s,n)),this.started.next({source:this,event:t}),i.start(),this._initialContainer=i,this._initialIndex=i.getItemIndex(this)}else this.started.next({source:this,event:t}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(i?i.getScrollableParents():[])}_initializeDragSequence(t,e){this._parentDragRef&&e.stopPropagation();let i=this.isDragging(),n=Ca(e),r=!n&&e.button!==0,s=this._rootElement,m=ma(e),p=!n&&this._lastTouchEventTime&&this._lastTouchEventTime+Dv>Date.now(),v=n?tf(e):ef(e);if(m&&m.draggable&&e.type==="mousedown"&&e.preventDefault(),i||r||p||v)return;if(this._handles.length){let E=s.style;this._rootElementTapHighlight=E.webkitTapHighlightColor||"",E.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(E=>this._updateOnScroll(E)),this._boundaryElement&&(this._boundaryRect=Yd(this._boundaryElement));let y=this._previewTemplate;this._pickupPositionInElement=y&&y.template&&!y.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,t,e);let x=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:x.x,y:x.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){th(this._rootElement,!0,sh),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let e=this._dropContainer,i=e.getItemIndex(this),n=this._getPointerPositionOnPage(t),r=this._getDragDistance(n),s=e._isOverContainer(n.x,n.y);this.ended.next({source:this,distance:r,dropPoint:n,event:t}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:r,dropPoint:n,event:t}),e.drop(this,i,this._initialIndex,this._initialContainer,s,r,n,t),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:i,y:n}){let r=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!r&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(r=this._initialContainer),r&&r!==this._dropContainer&&this._ngZone.run(()=>{let s=this._dropContainer.getItemIndex(this),m=this._dropContainer.getItemAtIndex(s+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(r,this._dropContainer,m),this._dropContainer=r,this._dropContainer.enter(this,t,e,r===this._initialContainer&&r.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:r,currentIndex:r.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,n),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(t,e):this._applyPreviewTransform(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let t=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);let e=this._preview.getTransitionDuration();return e===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{let n=m=>{(!m||this._preview&&ma(m)===this._preview.element&&m.propertyName==="transform")&&(s(),i(),clearTimeout(r))},r=setTimeout(n,e*1.5),s=this._preview.addEventListener("transitionend",n)}))}_createPlaceholderElement(){let t=this._placeholderTemplate,e=t?t.template:null,i;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),i=ph(this._placeholderRef,this._document)):i=qd(this._rootElement),i.style.pointerEvents="none",i.classList.add(ah),i}_getPointerPositionInElement(t,e,i){let n=e===this._rootElement?null:e,r=n?n.getBoundingClientRect():t,s=Ca(i)?i.targetTouches[0]:i,m=this._getViewportScrollPosition(),p=s.pageX-r.left-m.left,v=s.pageY-r.top-m.top;return{x:r.left-t.left+p,y:r.top-t.top+v}}_getPointerPositionOnPage(t){let e=this._getViewportScrollPosition(),i=Ca(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,n=i.pageX-e.left,r=i.pageY-e.top;if(this._ownerSVGElement){let s=this._ownerSVGElement.getScreenCTM();if(s){let m=this._ownerSVGElement.createSVGPoint();return m.x=n,m.y=r,m.matrixTransform(s.inverse())}}return{x:n,y:r}}_getConstrainedPointerPosition(t){let e=this._dropContainer?this._dropContainer.lockAxis:null,{x:i,y:n}=this.constrainPosition?this.constrainPosition(t,this,this._initialDomRect,this._pickupPositionInElement):t;if(this.lockAxis==="x"||e==="x"?n=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||e==="y")&&(i=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:r,y:s}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,m=this._boundaryRect,{width:p,height:v}=this._getPreviewRect(),y=m.top+s,x=m.bottom-(v-s),E=m.left+r,w=m.right-(p-r);i=lh(i,E,w),n=lh(n,y,x)}return{x:i,y:n}}_updatePointerDirectionDelta(t){let{x:e,y:i}=t,n=this._pointerDirectionDelta,r=this._pointerPositionAtLastDirectionChange,s=Math.abs(e-r.x),m=Math.abs(i-r.y);return s>this._config.pointerDirectionChangeThreshold&&(n.x=e>r.x?1:-1,r.x=e),m>this._config.pointerDirectionChangeThreshold&&(n.y=i>r.y?1:-1,r.y=i),n}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,Ir(this._rootElement,t))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(t=>t()),this._rootElementCleanups=void 0}_applyRootElementTransform(t,e){let i=1/this.scale,n=ya(t*i,e*i),r=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=r.transform&&r.transform!="none"?r.transform:""),r.transform=Sl(n,this._initialTransform)}_applyPreviewTransform(t,e){let i=this._previewTemplate?.template?void 0:this._initialTransform,n=ya(t,e);this._preview.setTransform(Sl(n,i))}_getDragDistance(t){let e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(t===0&&e===0||this.isDragging()||!this._boundaryElement)return;let i=this._rootElement.getBoundingClientRect(),n=this._boundaryElement.getBoundingClientRect();if(n.width===0&&n.height===0||i.width===0&&i.height===0)return;let r=n.left-i.left,s=i.right-n.right,m=n.top-i.top,p=i.bottom-n.bottom;n.width>i.width?(r>0&&(t+=r),s>0&&(t-=s)):t=0,n.height>i.height?(m>0&&(e+=m),p>0&&(e-=p)):e=0,(t!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){let e=this.dragStartDelay;return typeof e=="number"?e:Ca(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){let e=this._parentPositions.handleScroll(t);if(e){let i=ma(t);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&va(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=Js(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,e){let i=this._previewContainer||"global";if(i==="parent")return t;if(i==="global"){let n=this._document;return e||n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement||n.body}return Xn(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=t=>{if(this._handles.length){let e=this._getTargetHandle(t);e&&!this._disabledHandles.has(e)&&!this.disabled&&t.preventDefault()}else this.disabled||t.preventDefault()};_getTargetHandle(t){return this._handles.find(e=>t.target&&(t.target===e||e.contains(t.target)))}_conditionallyInsertAnchor(t,e,i){if(t===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(e===this._initialContainer&&e.hasAnchor){let n=this._anchor??=qd(this._placeholder);n.classList.remove(ah),n.classList.add("cdk-drag-anchor"),n.style.transform="",i?i.before(n):Xn(e.element).appendChild(n)}}};function lh(o,t,e){return Math.max(t,Math.min(e,o))}function Ca(o){return o.type[0]==="t"}function Tv(o){o.preventDefault()}function jn(o,t,e){let i=ch(t,o.length-1),n=ch(e,o.length-1);if(i===n)return;let r=o[i],s=n<i?-1:1;for(let m=i;m!==n;m+=s)o[m]=o[m+s];o[n]=r}function ch(o,t){return Math.max(0,Math.min(t,o))}var El=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(t){this._dragDropRegistry=t}_previousSwap={drag:null,delta:0,overlaps:!1};start(t){this.withItems(t)}sort(t,e,i,n){let r=this._itemPositions,s=this._getItemIndexFromPointerPosition(t,e,i,n);if(s===-1&&r.length>0)return null;let m=this.orientation==="horizontal",p=r.findIndex(V=>V.drag===t),v=r[s],y=r[p].clientRect,x=v.clientRect,E=p>s?1:-1,w=this._getItemOffsetPx(y,x,E),O=this._getSiblingOffsetPx(p,r,E),F=r.slice();return jn(r,p,s),r.forEach((V,L)=>{if(F[L]===V)return;let B=V.drag===t,z=B?w:O,Q=B?t.getPlaceholderElement():V.drag.getRootElement();V.offset+=z;let K=Math.round(V.offset*(1/V.drag.scale));m?(Q.style.transform=Sl(`translate3d(${K}px, 0, 0)`,V.initialTransform),va(V.clientRect,0,z)):(Q.style.transform=Sl(`translate3d(0, ${K}px, 0)`,V.initialTransform),va(V.clientRect,z,0))}),this._previousSwap.overlaps=Jd(x,e,i),this._previousSwap.drag=v.drag,this._previousSwap.delta=m?n.x:n.y,{previousIndex:p,currentIndex:s}}enter(t,e,i,n){let r=n==null||n<0?this._getItemIndexFromPointerPosition(t,e,i):n,s=this._activeDraggables,m=s.indexOf(t),p=t.getPlaceholderElement(),v=s[r];if(v===t&&(v=s[r+1]),!v&&(r==null||r===-1||r<s.length-1)&&this._shouldEnterAsFirstChild(e,i)&&(v=s[0]),m>-1&&s.splice(m,1),v&&!this._dragDropRegistry.isDragging(v)){let y=v.getRootElement();y.parentElement.insertBefore(p,y),s.splice(r,0,t)}else this._element.appendChild(p),s.push(t);p.style.transform="",this._cacheItemPositions()}withItems(t){this._activeDraggables=t.slice(),this._cacheItemPositions()}withSortPredicate(t){this._sortPredicate=t}reset(){this._activeDraggables?.forEach(t=>{let e=t.getRootElement();if(e){let i=this._itemPositions.find(n=>n.drag===t)?.initialTransform;e.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(t){return this._getVisualItemPositions().findIndex(e=>e.drag===t)}getItemAtIndex(t){return this._getVisualItemPositions()[t]?.drag||null}updateOnScroll(t,e){this._itemPositions.forEach(({clientRect:i})=>{va(i,t,e)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}withElementContainer(t){this._element=t}_cacheItemPositions(){let t=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(e=>{let i=e.getVisibleElement();return{drag:e,offset:0,initialTransform:i.style.transform||"",clientRect:Yd(i)}}).sort((e,i)=>t?e.clientRect.left-i.clientRect.left:e.clientRect.top-i.clientRect.top)}_getVisualItemPositions(){return this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(t,e,i){let n=this.orientation==="horizontal",r=n?e.left-t.left:e.top-t.top;return i===-1&&(r+=n?e.width-t.width:e.height-t.height),r}_getSiblingOffsetPx(t,e,i){let n=this.orientation==="horizontal",r=e[t].clientRect,s=e[t+i*-1],m=r[n?"width":"height"]*i;if(s){let p=n?"left":"top",v=n?"right":"bottom";i===-1?m-=s.clientRect[p]-r[v]:m+=r[p]-s.clientRect[v]}return m}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;let i=this._itemPositions,n=this.orientation==="horizontal";if(i[0].drag!==this._activeDraggables[0]){let s=i[i.length-1].clientRect;return n?t>=s.right:e>=s.bottom}else{let s=i[0].clientRect;return n?t<=s.left:e<=s.top}}_getItemIndexFromPointerPosition(t,e,i,n){let r=this.orientation==="horizontal",s=this._itemPositions.findIndex(({drag:m,clientRect:p})=>{if(m===t)return!1;if(n){let v=r?n.x:n.y;if(m===this._previousSwap.drag&&this._previousSwap.overlaps&&v===this._previousSwap.delta)return!1}return r?e>=Math.floor(p.left)&&e<Math.floor(p.right):i>=Math.floor(p.top)&&i<Math.floor(p.bottom)});return s===-1||!this._sortPredicate(s,t)?-1:s}},Qd=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(t,e){this._document=t,this._dragDropRegistry=e}start(t){let e=this._element.childNodes;this._relatedNodes=[];for(let i=0;i<e.length;i++){let n=e[i];this._relatedNodes.push([n,n.nextSibling])}this.withItems(t)}sort(t,e,i,n){let r=this._getItemIndexFromPointerPosition(t,e,i),s=this._previousSwap;if(r===-1||this._activeItems[r]===t)return null;let m=this._activeItems[r];if(s.drag===m&&s.overlaps&&s.deltaX===n.x&&s.deltaY===n.y)return null;let p=this.getItemIndex(t),v=t.getPlaceholderElement(),y=m.getRootElement();r>p?y.after(v):y.before(v),jn(this._activeItems,p,r);let x=this._getRootNode().elementFromPoint(e,i);return s.deltaX=n.x,s.deltaY=n.y,s.drag=m,s.overlaps=y===x||y.contains(x),{previousIndex:p,currentIndex:r}}enter(t,e,i,n){let r=this._activeItems.indexOf(t);r>-1&&this._activeItems.splice(r,1);let s=n==null||n<0?this._getItemIndexFromPointerPosition(t,e,i):n;s===-1&&(s=this._getClosestItemIndexToPointer(t,e,i));let m=this._activeItems[s];m&&!this._dragDropRegistry.isDragging(m)?(this._activeItems.splice(s,0,t),m.getRootElement().before(t.getPlaceholderElement())):(this._activeItems.push(t),this._element.appendChild(t.getPlaceholderElement()))}withItems(t){this._activeItems=t.slice()}withSortPredicate(t){this._sortPredicate=t}reset(){let t=this._element,e=this._previousSwap;for(let i=this._relatedNodes.length-1;i>-1;i--){let[n,r]=this._relatedNodes[i];n.parentNode===t&&n.nextSibling!==r&&(r===null?t.appendChild(n):r.parentNode===t&&t.insertBefore(n,r))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(t){return this._activeItems.indexOf(t)}getItemAtIndex(t){return this._activeItems[t]||null}updateOnScroll(){this._activeItems.forEach(t=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}withElementContainer(t){t!==this._element&&(this._element=t,this._rootNode=void 0)}_getItemIndexFromPointerPosition(t,e,i){let n=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(i)),r=n?this._activeItems.findIndex(s=>{let m=s.getRootElement();return n===m||m.contains(n)}):-1;return r===-1||!this._sortPredicate(r,t)?-1:r}_getRootNode(){return this._rootNode||(this._rootNode=Js(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(t,e,i){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let n=1/0,r=-1;for(let s=0;s<this._activeItems.length;s++){let m=this._activeItems[s];if(m!==t){let{x:p,y:v}=m.getRootElement().getBoundingClientRect(),y=Math.hypot(e-p,i-v);y<n&&(n=y,r=s)}}return r}},dh=.05,uh=.05,hn=(function(o){return o[o.NONE=0]="NONE",o[o.UP=1]="UP",o[o.DOWN=2]="DOWN",o})(hn||{}),qi=(function(o){return o[o.NONE=0]="NONE",o[o.LEFT=1]="LEFT",o[o.RIGHT=2]="RIGHT",o})(qi||{}),Kd=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis=null;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new Tt;entered=new Tt;exited=new Tt;dropped=new Tt;sorted=new Tt;receivingStarted=new Tt;receivingStopped=new Tt;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=Ji.EMPTY;_verticalScrollDirection=hn.NONE;_horizontalScrollDirection=qi.NONE;_scrollNode;_stopScrollTimers=new Tt;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(t,e,i,n,r){this._dragDropRegistry=e,this._ngZone=n,this._viewportRuler=r;let s=this.element=Xn(t);this._document=i,this.withOrientation("vertical").withElementContainer(s),e.registerDropContainer(this),this._parentPositions=new wl(i)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,e,i,n){this._draggingStarted(),n==null&&this.sortingDisabled&&(n=this._draggables.indexOf(t)),this._sortStrategy.enter(t,e,i,n),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,i,n,r,s,m,p={}){this._reset(),this.dropped.next({item:t,currentIndex:e,previousIndex:i,container:this,previousContainer:n,isPointerOverContainer:r,distance:s,dropPoint:m,event:p})}withItems(t){let e=this._draggables;return this._draggables=t,t.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(e.filter(n=>n.isDragging()).every(n=>t.indexOf(n)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(t){return this._direction=t,this._sortStrategy instanceof El&&(this._sortStrategy.direction=t),this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){if(t==="mixed")this._sortStrategy=new Qd(this._document,this._dragDropRegistry);else{let e=new El(this._dragDropRegistry);e.direction=this._direction,e.orientation=t,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,i)=>this.sortPredicate(e,i,this)),this}withScrollableParents(t){let e=this._container;return this._scrollableElements=t.indexOf(e)===-1?[e,...t]:t.slice(),this}withElementContainer(t){if(t===this._container)return this;let e=Xn(this.element),i=this._scrollableElements.indexOf(this._container),n=this._scrollableElements.indexOf(t);return i>-1&&this._scrollableElements.splice(i,1),n>-1&&this._scrollableElements.splice(n,1),this._sortStrategy&&this._sortStrategy.withElementContainer(t),this._cachedShadowRoot=null,this._scrollableElements.unshift(t),this._container=t,this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?this._sortStrategy.getItemIndex(t):this._draggables.indexOf(t)}getItemAtIndex(t){return this._isDragging?this._sortStrategy.getItemAtIndex(t):this._draggables[t]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,i,n){if(this.sortingDisabled||!this._domRect||!eh(this._domRect,dh,e,i))return;let r=this._sortStrategy.sort(t,e,i,n);r&&this.sorted.next({previousIndex:r.previousIndex,currentIndex:r.currentIndex,container:this,item:t})}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let i,n=hn.NONE,r=qi.NONE;if(this._parentPositions.positions.forEach((s,m)=>{m===this._document||!s.clientRect||i||eh(s.clientRect,dh,t,e)&&([n,r]=Fv(m,s.clientRect,this._direction,t,e),(n||r)&&(i=m))}),!n&&!r){let{width:s,height:m}=this._viewportRuler.getViewportSize(),p={width:s,height:m,top:0,right:s,bottom:m,left:0};n=fh(p,e),r=hh(p,t),i=window}i&&(n!==this._verticalScrollDirection||r!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=n,this._horizontalScrollDirection=r,this._scrollNode=i,(n||r)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let t=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let t=this._container.style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),np(0,ip).pipe(ko(this._stopScrollTimers)).subscribe(()=>{let t=this._scrollNode,e=this.autoScrollStep;this._verticalScrollDirection===hn.UP?t.scrollBy(0,-e):this._verticalScrollDirection===hn.DOWN&&t.scrollBy(0,e),this._horizontalScrollDirection===qi.LEFT?t.scrollBy(-e,0):this._horizontalScrollDirection===qi.RIGHT&&t.scrollBy(e,0)})};_isOverContainer(t,e){return this._domRect!=null&&Jd(this._domRect,t,e)}_getSiblingContainerFromPosition(t,e,i){return this._siblings.find(n=>n._canReceive(t,e,i))}_canReceive(t,e,i){if(!this._domRect||!Jd(this._domRect,e,i)||!this.enterPredicate(t,this))return!1;let n=this._getShadowRoot().elementFromPoint(e,i);return n?n===this._container||this._container.contains(n):!1}_startReceiving(t,e){let i=this._activeSiblings;!i.has(t)&&e.every(n=>this.enterPredicate(n,this)||this._draggables.indexOf(n)>-1)&&(i.add(t),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:t,receiver:this,items:e}))}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:t,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){let e=this._parentPositions.handleScroll(t);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let t=Js(this._container);this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let t=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,t))}};function fh(o,t){let{top:e,bottom:i,height:n}=o,r=n*uh;return t>=e-r&&t<=e+r?hn.UP:t>=i-r&&t<=i+r?hn.DOWN:hn.NONE}function hh(o,t){let{left:e,right:i,width:n}=o,r=n*uh;return t>=e-r&&t<=e+r?qi.LEFT:t>=i-r&&t<=i+r?qi.RIGHT:qi.NONE}function Fv(o,t,e,i,n){let r=fh(t,n),s=hh(t,i),m=hn.NONE,p=qi.NONE;if(r){let v=o.scrollTop;r===hn.UP?v>0&&(m=hn.UP):o.scrollHeight-v>o.clientHeight&&(m=hn.DOWN)}if(s){let v=o.scrollLeft;e==="rtl"?s===qi.RIGHT?v<0&&(p=qi.RIGHT):o.scrollWidth+v>o.clientWidth&&(p=qi.LEFT):s===qi.LEFT?v>0&&(p=qi.LEFT):o.scrollWidth-v>o.clientWidth&&(p=qi.RIGHT)}return[m,p]}var _a={capture:!0},Gd={passive:!1,capture:!0},kv=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275cmp=N({type:o,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(i,n){},styles:[`@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}
`],encapsulation:2,changeDetection:0})}return o})(),tm=(()=>{class o{_ngZone=b(fi);_document=b(kd);_styleLoader=b(Ju);_renderer=b(sa).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new Tt;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=A([]);_globalListeners;_draggingPredicate=e=>e.isDragging();_domNodesToDirectives=null;pointerMove=new Tt;pointerUp=new Tt;constructor(){}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,Gd)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),this._dragInstances.size===0&&this._cleanupDocumentTouchmove?.()}startDragging(e,i){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._styleLoader.load(kv),this._activeDragInstances.update(n=>[...n,e]),this._activeDragInstances().length===1)){let n=i.type.startsWith("touch"),r=m=>this.pointerUp.next(m),s=[["scroll",m=>this._scroll.next(m),_a],["selectstart",this._preventDefaultWhileDragging,Gd]];n?s.push(["touchend",r,_a],["touchcancel",r,_a]):s.push(["mouseup",r,_a]),n||s.push(["mousemove",m=>this.pointerMove.next(m),Gd]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=s.map(([m,p,v])=>this._renderer.listen(this._document,m,p,v))})}}stopDragging(e){this._activeDragInstances.update(i=>{let n=i.indexOf(e);return n>-1?(i.splice(n,1),[...i]):i}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){let i=[this._scroll];return e&&e!==this._document&&i.push(new Td(n=>this._ngZone.runOutsideAngular(()=>{let r=this._renderer.listen(e,"scroll",s=>{this._activeDragInstances().length&&n.next(s)},_a);return()=>{r()}}))),Ya(...i)}registerDirectiveNode(e,i){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(e,i)}removeDirectiveNode(e){this._domNodesToDirectives?.delete(e)}getDragDirectiveForNode(e){return this._domNodesToDirectives?.get(e)||null}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=e=>{this._activeDragInstances().length>0&&e.preventDefault()};_persistentTouchmoveListener=e=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&e.preventDefault(),this.pointerMove.next(e))};_clearGlobalListeners(){this._globalListeners?.forEach(e=>e()),this._globalListeners=void 0}static \u0275fac=function(i){return new(i||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Ov={dragStartThreshold:5,pointerDirectionChangeThreshold:5},im=(()=>{class o{_document=b(kd);_ngZone=b(fi);_viewportRuler=b(Qu);_dragDropRegistry=b(tm);_renderer=b(sa).createRenderer(null,null);constructor(){}createDrag(e,i=Ov){return new Zd(e,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry,this._renderer)}createDropList(e){return new Kd(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(i){return new(i||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Pl=new Oo("CDK_DRAG_PARENT");var gh=new Oo("CdkDragHandle"),go=(()=>{class o{element=b(an);_parentDrag=b(Pl,{optional:!0,skipSelf:!0});_dragDropRegistry=b(tm);_stateChanges=new Tt;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._stateChanges.next(this)}_disabled=!1;constructor(){this._parentDrag?._addHandle(this)}ngAfterViewInit(){if(!this._parentDrag){let e=this.element.nativeElement.parentElement;for(;e;){let i=this._dragDropRegistry.getDragDirectiveForNode(e);if(i){this._parentDrag=i,i._addHandle(this);break}e=e.parentElement}}}ngOnDestroy(){this._parentDrag?._removeHandle(this),this._stateChanges.complete()}static \u0275fac=function(i){return new(i||o)};static \u0275dir=Ao({type:o,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:[2,"cdkDragHandleDisabled","disabled",Ro]},features:[we([{provide:gh,useExisting:o}])]})}return o})(),Ch=new Oo("CDK_DRAG_CONFIG"),_h=new Oo("CdkDropList"),Co=(()=>{class o{element=b(an);dropContainer=b(_h,{optional:!0,skipSelf:!0});_ngZone=b(fi);_viewContainerRef=b(er);_dir=b(Nd,{optional:!0});_changeDetectorRef=b(jo);_selfHandle=b(gh,{optional:!0,self:!0});_parentDrag=b(Pl,{optional:!0,skipSelf:!0});_dragDropRegistry=b(tm);_destroyed=new Tt;_handles=new ki([]);_previewTemplate;_placeholderTemplate;_dragRef;data;lockAxis=null;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!!(this.dropContainer&&this.dropContainer.disabled)}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}_disabled;constrainPosition;previewClass;previewContainer;scale=1;started=new q;released=new q;ended=new q;entered=new q;exited=new q;dropped=new q;moved=new Td(e=>{let i=this._dragRef.moved.pipe(Qa(n=>({source:this,pointerPosition:n.pointerPosition,event:n.event,delta:n.delta,distance:n.distance}))).subscribe(e);return()=>{i.unsubscribe()}});_injector=b(lp);constructor(){let e=this.dropContainer,i=b(Ch,{optional:!0}),n=b(im);this._dragRef=n.createDrag(this.element,{dragStartThreshold:i&&i.dragStartThreshold!=null?i.dragStartThreshold:5,pointerDirectionChangeThreshold:i&&i.pointerDirectionChangeThreshold!=null?i.pointerDirectionChangeThreshold:5,zIndex:i?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),i&&this._assignDefaults(i),e&&(e.addItem(this),e._dropListRef.beforeStarted.pipe(ko(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){up(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){let i=e.rootElementSelector,n=e.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,n&&!n.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){let i=this._handles.getValue();i.push(e),this._handles.next(i)}_removeHandle(e){let i=this._handles.getValue(),n=i.indexOf(e);n>-1&&(i.splice(n,1),this._handles.next(i))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let e=this.element.nativeElement,i=e;this.rootElementSelector&&(i=e.closest!==void 0?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||e)}_getBoundaryElement(){let e=this.boundaryElement;return e?typeof e=="string"?this.element.nativeElement.closest(e):Xn(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){let i=this._dir,n=this.dragStartDelay,r=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,s=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.scale=this.scale,e.dragStartDelay=typeof n=="object"&&n?n:Vd(n),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(r).withPreviewTemplate(s).withPreviewContainer(this.previewContainer||"global"),i&&e.withDirection(i.value)}}),e.beforeStarted.pipe(rp(1)).subscribe(()=>{if(this._parentDrag){e.withParent(this._parentDrag._dragRef);return}let i=this.element.nativeElement.parentElement;for(;i;){let n=this._dragDropRegistry.getDragDirectiveForNode(i);if(n){e.withParent(n._dragRef);break}i=i.parentElement}})}_handleEvents(e){e.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),e.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(e){let{lockAxis:i,dragStartDelay:n,constrainPosition:r,previewClass:s,boundaryElement:m,draggingDisabled:p,rootElementSelector:v,previewContainer:y}=e;this.disabled=p??!1,this.dragStartDelay=n||0,this.lockAxis=i||null,r&&(this.constrainPosition=r),s&&(this.previewClass=s),m&&(this.boundaryElement=m),v&&(this.rootElementSelector=v),y&&(this.previewContainer=y)}_setupHandlesListener(){this._handles.pipe(sp(e=>{let i=e.map(n=>n.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),es(e=>Ya(...e.map(i=>i._stateChanges.pipe(Fd(i))))),ko(this._destroyed)).subscribe(e=>{let i=this._dragRef,n=e.element.nativeElement;e.disabled?i.disableHandle(n):i.enableHandle(n)})}static \u0275fac=function(i){return new(i||o)};static \u0275dir=Ao({type:o,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,n){i&2&&Ct("cdk-drag-disabled",n.disabled)("cdk-drag-dragging",n._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",Ro],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",Pp]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[we([{provide:Pl,useExisting:o}]),ns]})}return o})(),mh=new Oo("CdkDropListGroup");var _o=(()=>{class o{element=b(an);_changeDetectorRef=b(jo);_scrollDispatcher=b(Zu);_dir=b(Nd,{optional:!0});_group=b(mh,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new Tt;_scrollableParentsResolved;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation;id=b(Yu).getId("cdk-drop-list-");lockAxis=null;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=e}_disabled;sortingDisabled;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled;autoScrollStep;elementContainerSelector;hasAnchor;dropped=new q;entered=new q;exited=new q;sorted=new q;_unsortedItems=new Set;constructor(){let e=b(im),i=b(Ch,{optional:!0});this._dropListRef=e.createDropList(this.element),this._dropListRef.data=this,i&&this._assignDefaults(i),this._dropListRef.enterPredicate=(n,r)=>this.enterPredicate(n.data,r.data),this._dropListRef.sortPredicate=(n,r,s)=>this.sortPredicate(n,r.data,s.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),o._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(e){this._unsortedItems.add(e),e._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(i=>i._dragRef))}removeItem(e){if(this._unsortedItems.delete(e),this._latestSortedRefs){let i=this._latestSortedRefs.indexOf(e._dragRef);i>-1&&(this._latestSortedRefs.splice(i,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((e,i)=>e._dragRef.getVisibleElement().compareDocumentPosition(i._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let e=o._dropLists.indexOf(this);e>-1&&o._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(Fd(this._dir.value),ko(this._destroyed)).subscribe(i=>e.withDirection(i)),e.beforeStarted.subscribe(()=>{let i=Xu(this.connectedTo).map(n=>{if(typeof n=="string"){let r=o._dropLists.find(s=>s.id===n);return r}return n});if(this._group&&this._group._items.forEach(n=>{i.indexOf(n)===-1&&i.push(n)}),!this._scrollableParentsResolved){let n=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(r=>r.getElementRef().nativeElement);this._dropListRef.withScrollableParents(n),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let n=this.element.nativeElement.querySelector(this.elementContainerSelector);e.withElementContainer(n)}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=this.sortingDisabled,e.autoScrollDisabled=this.autoScrollDisabled,e.autoScrollStep=Vd(this.autoScrollStep,2),e.hasAnchor=this.hasAnchor,e.connectedTo(i.filter(n=>n&&n!==this).map(n=>n._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(i=>i._dragRef)),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:this,item:i.item.data,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:this,item:i.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(i=>{this.sorted.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,container:this,item:i.item.data})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,item:i.item.data,isPointerOverContainer:i.isPointerOverContainer,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),Ya(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){let{lockAxis:i,draggingDisabled:n,sortingDisabled:r,listAutoScrollDisabled:s,listOrientation:m}=e;this.disabled=n??!1,this.sortingDisabled=r??!1,this.autoScrollDisabled=s??!1,this.orientation=m||"vertical",this.lockAxis=i||null}_syncItemsWithRef(e){this._latestSortedRefs=e,this._dropListRef.withItems(e)}static \u0275fac=function(i){return new(i||o)};static \u0275dir=Ao({type:o,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(i,n){i&2&&(sn("id",n.id),Ct("cdk-drop-list-disabled",n.disabled)("cdk-drop-list-dragging",n._dropListRef.isDragging())("cdk-drop-list-receiving",n._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",Ro],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",Ro],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",Ro],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",Ro]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[we([{provide:mh,useValue:void 0},{provide:_h,useExisting:o}])]})}return o})();var Vv=new Oo("CdkDragPlaceholder"),Ml=(()=>{class o{templateRef=b(pp);_drag=b(Pl,{optional:!0});data;constructor(){this._drag?._setPlaceholderTemplate(this)}ngOnDestroy(){this._drag?._resetPlaceholderTemplate(this)}static \u0275fac=function(i){return new(i||o)};static \u0275dir=Ao({type:o,selectors:[["ng-template","cdkDragPlaceholder",""]],inputs:{data:"data"},features:[we([{provide:Vv,useExisting:o}])]})}return o})();var Dr=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=rs({type:o});static \u0275inj=ts({providers:[im],imports:[Ku]})}return o})();var vo=class o{API=`${Le.web_maker}/page`;apiService=b(Lt);loadingService=b(Yt);confirmationService=b(ft);auth=b(xe);toastrService=b(tt);states=[{code:"1",denomination:"Activo"},{code:"0",denomination:"Inactivo"}];stateMap=this.states.reduce((t,e)=>(t[e.code]=e.denomination,t),{});canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.canAdd=this.auth.hasSubPermission("page-ADD"),this.canEdit=this.auth.hasSubPermission("page-EDIT"),this.canRemove=this.auth.hasSubPermission("page-REMOVE"),this.canChangeState=this.auth.hasSubPermission("page-CHANGE-STATE"),this.canExport=this.auth.hasPermission("page-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("page-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("page-EXPORT-PDF")}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}patch(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}changeState(t){return P(this,null,function*(){let e=this.stateMap[t.state],i="";switch(t.state){case"1":i="text-success";break;case"0":i="text-danger";break}let n=`
            <div class="text-center">
                <div class="mb-3">\xBFEst\xE1 seguro de cambiar el estado del registro?</div>
                <h3 >Nuevo estado: <b class="${i}">${e}</b></h3>
            </div>
        `;if(!(yield this.confirmationService.create("Confirmar",n)))return;this.loadingService.open();let s=yield this.apiService.putPrivate(`${this.API}/state/change/${t.id}`,t);return this.loadingService.hide(),s})}delete(t){return P(this,null,function*(){return this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,t)})}export(t,e){return P(this,null,function*(){if(!(yield this.confirmationService.create("Confirmar","\xBFEst\xE1 seguro de exportar los datos?")))return;this.loadingService.open();let n=re(k({},t),{type_export:e,url:Le.production?Le.storage:Le.web_maker}),r=yield this.apiService.getPrivate(`${this.API}/export`,n);return this.loadingService.hide(),r&&r.state=="success"&&window.open(r.url),r})}saveOrder(t,e=!0){return P(this,null,function*(){let i=yield this.apiService.postPrivate(`${this.API}/order/list`,t);return i.state=="success"&&e&&this.toastrService.success(i.message),i})}clonePage(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/clone`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var Nv=["*"],Av=o=>({"to-right":o});function jv(o,t){if(o&1&&(l(0,"label"),u(1),a()),o&2){let e=d();c(),W(e.label)}}var Il=class o{checked=!1;label;toRight=!1;size="md";set value(t){this.checked=t}onChange=()=>{};onTouched=()=>{};checkedChange=new q;toggleCheck(){this.onChange(!this.checked),this.checkedChange.emit(!this.checked),this.onTouched()}writeValue(t){this.checked=t}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){}validate(t){return this.checked==null?{invalidCheckbox:{valid:!1,message:"Checkbox is invalid"}}:null}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-checkbox"]],inputs:{checked:"checked",label:"label",toRight:"toRight",size:"size",value:"value"},outputs:{checkedChange:"checkedChange"},features:[we([{provide:ms,useExisting:Yo(()=>o),multi:!0},{provide:us,useExisting:Yo(()=>o),multi:!0}])],ngContentSelectors:Nv,decls:6,vars:11,consts:[[3,"click","ngClass"],[1,"slider"],[1,"checkmark"]],template:function(e,i){e&1&&(Li(),l(0,"div",0),h("click",function(){return i.toggleCheck()}),l(1,"div",1),_(2,"div",2),a(),l(3,"div"),D(4,jv,2,1,"label"),gi(5),a()()),e&2&&(it(Re("md-checkbox ",i.size)),Ct("checked",i.checked),f("ngClass",te(9,Av,i.toRight)),c(3),xt("padding",i.toRight?"0 .5rem 0 0":"0 0 0 .5rem"),c(),T(i.label?4:-1))},dependencies:[be],styles:[".md-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;-webkit-user-select:none;user-select:none}.md-checkbox.sm[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{width:42px;height:22px}.md-checkbox.sm[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{width:20px;height:20px;font-size:12px}.md-checkbox.sm[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px}.md-checkbox.lg[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{width:82px;height:42px}.md-checkbox.lg[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{width:40px;height:40px;font-size:20px}.md-checkbox.lg[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:18px}.to-right[_ngcontent-%COMP%]{flex-direction:row-reverse}.md-checkbox[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:relative;width:62px;height:32px;background-color:#ccc;border-radius:32px;transition:background-color .1s}.md-checkbox.checked[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{background-color:var(--bs-primary)}.md-checkbox[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{position:absolute;left:1px;top:1px;width:30px;height:30px;background-color:#fff;border-radius:50%;transition:left .1s,transform .1s;display:flex;justify-content:center;align-items:center;font-size:16px;color:var(--bs-primary);transform:scale(.7)}.md-checkbox.checked[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{left:50%;transform:scale(.9)}.md-checkbox[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:10px;font-size:16px}"]})};var om=o=>({"has-danger":o}),Rv=(o,t)=>t.code;function Lv(o,t){if(o&1){let e=M();l(0,"div",1)(1,"app-checkbox",17),ne("checkedChange",function(n){g(e);let r=d();return Z(r.mode404,n)||(r.mode404=n),C(n)}),h("checkedChange",function(n){g(e);let r=d();return C(r.onChange(n))}),a()()}if(o&2){let e=d();c(),f("size","sm"),ie("checked",e.mode404)}}function Uv(o,t){if(o&1&&(l(0,"option",13),u(1),a()),o&2){let e=t.$implicit;f("value",e.code),c(),W(e.denomination)}}function zv(o,t){o&1&&_(0,"app-loading")}var Dl=class o{modalService=b(St);accion="add";page;isModal=!0;idinstitucion="";project_id="";type="";uid="";mode404=A(!1);eventChange=new q;pageService=b(vo);authService=b(xe);states=this.pageService.states;onInputChange(t){let e=t.target,i=e.value.replace(/[^a-zA-Z\-]/g,"");e.value=i,this.urlControl?.setValue(i)}onUrlKeyDown(t){["Backspace","ArrowLeft","ArrowRight","Delete","Tab"].includes(t.key)||t.key.length===1&&!/^[a-zA-Z\-]$/.test(t.key)&&t.preventDefault()}onChange(t){t?(this.urlControl.disable({onlySelf:!0}),this.titleControl.disable({emitEvent:!0}),this.form.patchValue({url:"404",title:"P\xE1gina de error 404"})):(this.form.patchValue({url:"",title:""}),this.urlControl.enable(),this.titleControl.enable())}ngOnInit(){return P(this,null,function*(){if(this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.uid===""&&(this.uid=this.authService.userData.id+""),this.accion=="update"||this.accion=="clone"){if(!this.page)return;this.form.patchValue({title:this.page.title+(this.accion=="clone"?" (Copia)":""),url:this.page.url+(this.accion=="clone"?"-copia":""),type:this.page.type,orderList:""+this.page.orderList,level:this.page.level+"",pageId:this.page.page_id,inNavBar:this.page.inNavBar,state:this.page.state,projectId:""+this.page.project_id})}else this.form.patchValue({projectId:this.project_id,type:this.type})})}ngAfterViewInit(){document.getElementById("title")?.focus()}form=new ni({title:new Fe("",{validators:[ze.required],nonNullable:!0}),url:new Fe("",{validators:[ze.required,ze.pattern(/^[a-zA-Z\-]+$/)],nonNullable:!0}),type:new Fe("",{validators:[ze.required],nonNullable:!0}),orderList:new Fe("0",{validators:[ze.required],nonNullable:!0}),level:new Fe("1",{validators:[ze.required],nonNullable:!0}),pageId:new Fe("",{validators:[],nonNullable:!0}),inNavBar:new Fe("1",{validators:[ze.required],nonNullable:!0}),state:new Fe("1",{validators:[ze.required],nonNullable:!0}),projectId:new Fe("",{validators:[ze.required],nonNullable:!0})});get titleControl(){return this.form.get("title")}get urlControl(){return this.form.get("url")}get typeControl(){return this.form.get("type")}get orderListControl(){return this.form.get("orderList")}get levelControl(){return this.form.get("level")}get pageIdControl(){return this.form.get("pageId")}get inNavBarControl(){return this.form.get("inNavBar")}get stateControl(){return this.form.get("state")}get projectIdControl(){return this.form.get("projectId")}close(){this.isModal?this.modalService.close():this.eventChange.emit({event:"close",data:void 0})}submit=!1;loading=A(!1);save(){return P(this,null,function*(){if(this.submit=!0,!this.form.valid)return;this.submit=!1;let t=this.form.getRawValue();if(console.log(t),this.accion=="add"){let e={title:t.title.trim(),url:t.url.trim(),type:t.type.trim(),orderList:+t.orderList,level:+t.level,page_id:t.pageId,inNavBar:t.inNavBar,state:t.state,createBy:this.uid,project_id:+t.projectId};this.loading.set(!0);let i=yield this.pageService.add(e);this.loading.set(!1),i.state=="success"&&(this.isModal?this.modalService.ok(i.data):this.eventChange.emit({event:"add",data:i.data}))}else if(this.accion=="update"){let e={id:this.page.id,title:t.title,url:t.url,type:t.type,orderList:+t.orderList,level:+t.level,page_id:t.pageId,inNavBar:t.inNavBar,state:t.state,project_id:+t.projectId};this.loading.set(!0);let i=yield this.pageService.update(e);this.loading.set(!1),i.state=="success"&&(this.isModal?this.modalService.ok(e):this.eventChange.emit({event:"update",data:i.data}))}else if(this.accion=="clone"){this.loading.set(!0);let e=yield this.pageService.clonePage({pageId:this.page.id,newUrl:t.url.trim(),pageTitle:t.title.trim()});this.loading.set(!1),e.state=="success"&&this.isModal&&this.modalService.ok(e.data)}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-page-form"]],inputs:{accion:"accion",page:"page",isModal:"isModal",idinstitucion:"idinstitucion",project_id:"project_id",type:"type",uid:"uid"},outputs:{eventChange:"eventChange"},decls:29,vars:18,consts:[[1,"container",3,"submit","formGroup"],[1,"d-flex","justify-content-between","gap-2","mb-3"],[1,"row"],[1,"col-12"],[1,"form-group",3,"ngClass"],["for","title",1,"control-label"],["type","text","name","title","id","title","formControlName","title","placeholder","Ingrese el t\xEDtulo",1,"form-control"],[1,"left",3,"control","show"],[1,"col-6"],["for","url",1,"control-label"],["type","text","name","url","id","url","formControlName","url","placeholder","Ingrese la URL",1,"form-control",3,"input","keydown"],["for","state",1,"control-label"],["name","state","id","state","formControlName","state",1,"form-select"],[3,"value"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary","btn-lg-medio","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-lg-medio",3,"click"],["label","\xBFEs pagina 404?",3,"checkedChange","size","checked"]],template:function(e,i){e&1&&(l(0,"form",0),h("submit",function(){return i.save()}),D(1,Lv,2,2,"div",1),l(2,"div",2)(3,"div",3)(4,"div",4)(5,"label",5),u(6,"Titulo"),a(),_(7,"input",6)(8,"app-control-messages",7),a()(),l(9,"div",8)(10,"div",4)(11,"label",9),u(12,"URL (letras y guiones)"),a(),l(13,"input",10),h("input",function(r){return i.onInputChange(r)})("keydown",function(r){return i.onUrlKeyDown(r)}),a(),_(14,"app-control-messages",7),a()(),l(15,"div",8)(16,"div",4)(17,"label",11),u(18,"Estado"),a(),l(19,"select",12),Y(20,Uv,2,2,"option",13,Rv),a(),_(22,"app-control-messages",7),a()()()(),l(23,"div",14)(24,"button",15),h("click",function(){return i.close()}),u(25,"Cancelar"),a(),l(26,"button",16),h("click",function(){return i.save()}),u(27,"Guardar"),a()(),D(28,zv,1,0,"app-loading")),e&2&&(f("formGroup",i.form),c(),T(i.accion=="add"?1:-1),c(3),f("ngClass",te(12,om,i.titleControl.invalid&&(i.titleControl.touched||i.submit))),c(4),f("control",i.titleControl)("show",i.submit),c(2),f("ngClass",te(14,om,i.urlControl.invalid&&(i.urlControl.touched||i.submit))),c(4),f("control",i.urlControl)("show",i.submit),c(2),f("ngClass",te(16,om,i.stateControl.invalid&&(i.stateControl.touched||i.submit))),c(4),ee(i.states),c(2),f("control",i.stateControl)("show",i.submit),c(6),T(i.loading()?28:-1))},dependencies:[Kt,Zt,Ht,Gt,Qe,$t,Ne,Xt,Qt,ri,bi,be,Ye,Il],styles:[".form-control[_ngcontent-%COMP%]:disabled{border:1px solid rgba(75,75,75,.5098039216)}"]})};var vh='<?xml version="1.0" encoding="utf-8"?><svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="8" fill="currentColor" fill-opacity="0.24"/><path d="M9.5 12L11.3939 13.8939C11.4525 13.9525 11.5475 13.9525 11.6061 13.8939L15.5 10" stroke="currentColor" stroke-width="1.2"/></svg>',yh=`<?xml version="1.0" encoding="utf-8"?>
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M19.3259 5.77772C20 6.78661 20 8.19108 20 11C20 13.8089 20 15.2134 19.3259 16.2223C19.034 16.659 18.659 17.034 18.2223 17.3259C17.3409 17.9148 16.1577 17.9892 14 17.9986V18L12.8944 20.2111C12.5259 20.9482 11.4741 20.9482 11.1056 20.2111L10 18V17.9986C7.8423 17.9892 6.65907 17.9148 5.77772 17.3259C5.34096 17.034 4.96596 16.659 4.67412 16.2223C4 15.2134 4 13.8089 4 11C4 8.19108 4 6.78661 4.67412 5.77772C4.96596 5.34096 5.34096 4.96596 5.77772 4.67412C6.78661 4 8.19108 4 11 4H13C15.8089 4 17.2134 4 18.2223 4.67412C18.659 4.96596 19.034 5.34096 19.3259 5.77772Z" fill="currentColor" fill-opacity="0.24"/>
<path d="M8.5 9.5L15.5 9.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M8.5 12.5L13.5 12.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>
</svg>`,bh='<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 24 24" fill="currentColor"><path fill="currentColor" d="m13.299 3.148l8.634 14.954a1.5 1.5 0 0 1-1.299 2.25H3.366a1.5 1.5 0 0 1-1.299-2.25l8.634-14.954c.577-1 2.02-1 2.598 0" class="duoicon-secondary-layer" opacity=".3"/><path fill="currentColor" d="M12 8a1 1 0 0 0-.993.883L11 9v4a1 1 0 0 0 1.993.117L13 13V9a1 1 0 0 0-1-1m0 7a1 1 0 1 0 0 2a1 1 0 0 0 0-2" class="duoicon-primary-layer"/></svg>',xh=`<?xml version="1.0" encoding="utf-8"?>
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path opacity="0.4" d="M17 18.4299H13L8.54999 21.39C7.88999 21.83 7 21.3599 7 20.5599V18.4299C4 18.4299 2 16.4299 2 13.4299V7.42993C2 4.42993 4 2.42993 7 2.42993H17C20 2.42993 22 4.42993 22 7.42993V13.4299C22 16.4299 20 18.4299 17 18.4299Z" fill="currentColor"/>
<path d="M11.9998 12.1099C11.5898 12.1099 11.2498 11.7699 11.2498 11.3599V11.1499C11.2498 9.9899 12.0998 9.41989 12.4198 9.19989C12.7898 8.94989 12.9098 8.7799 12.9098 8.5199C12.9098 8.0199 12.4998 7.60986 11.9998 7.60986C11.4998 7.60986 11.0898 8.0199 11.0898 8.5199C11.0898 8.9299 10.7498 9.2699 10.3398 9.2699C9.92984 9.2699 9.58984 8.9299 9.58984 8.5199C9.58984 7.1899 10.6698 6.10986 11.9998 6.10986C13.3298 6.10986 14.4098 7.1899 14.4098 8.5199C14.4098 9.6599 13.5698 10.2299 13.2598 10.4399C12.8698 10.6999 12.7498 10.8699 12.7498 11.1499V11.3599C12.7498 11.7799 12.4098 12.1099 11.9998 12.1099Z" fill="currentColor"/>
<path d="M12 14.6001C11.58 14.6001 11.25 14.2601 11.25 13.8501C11.25 13.4401 11.59 13.1001 12 13.1001C12.41 13.1001 12.75 13.4401 12.75 13.8501C12.75 14.2601 12.42 14.6001 12 14.6001Z" fill="currentColor"/>
</svg>`,wh=`<?xml version="1.0" encoding="utf-8"?>
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4 7.5C4 7.2643 4 7.14645 4.07322 7.07322C4.14645 7 4.2643 7 4.5 7H19.5C19.7357 7 19.8536 7 19.9268 7.07322C20 7.14645 20 7.2643 20 7.5V7.75155C20 7.84249 20 7.88797 19.986 7.92806C19.974 7.96233 19.9547 7.99358 19.9294 8.01963C19.8998 8.0501 19.8591 8.07044 19.7778 8.11111C19.127 8.43649 18.8017 8.59917 18.565 8.84298C18.3626 9.0514 18.2082 9.30138 18.1122 9.57554C18 9.89627 18 10.2601 18 10.9876V16C18 17.8856 18 18.8284 17.4142 19.4142C16.8284 20 15.8856 20 14 20H10C8.11438 20 7.17157 20 6.58579 19.4142C6 18.8284 6 17.8856 6 16V10.9876C6 10.2601 6 9.89627 5.88778 9.57554C5.79185 9.30138 5.63735 9.0514 5.43503 8.84298C5.19835 8.59917 4.87297 8.43649 4.22222 8.11111C4.14088 8.07044 4.10021 8.0501 4.07062 8.01963C4.04533 7.99358 4.02602 7.96233 4.01403 7.92806C4 7.88797 4 7.84249 4 7.75155V7.5Z" fill="currentColor" fill-opacity="0.24"/>
<path d="M10.0681 4.37059C10.1821 4.26427 10.4332 4.17033 10.7825 4.10332C11.1318 4.03632 11.5597 4 12 4C12.4403 4 12.8682 4.03632 13.2175 4.10332C13.5668 4.17033 13.8179 4.26427 13.9319 4.37059" stroke="currentColor" stroke-linecap="round"/>
<rect x="14" y="11" width="1" height="6" rx="0.5" fill="currentColor"/>
<rect x="9" y="11" width="1" height="6" rx="0.5" fill="currentColor"/>
</svg>`;var Tl=class o{constructor(t){this.el=t}ngOnInit(){setTimeout(()=>{this.adjustTextareaHeight()},50)}onInput(){this.adjustTextareaHeight()}adjustTextareaHeight(){let t=this.el.nativeElement;t.style.height="auto",t.style.height=`${t.scrollHeight+3}px`}static \u0275fac=function(e){return new(e||o)(gt(an))};static \u0275dir=Ao({type:o,selectors:[["","appTextareaResize",""]],hostBindings:function(e,i){e&1&&h("input",function(){return i.onInput()})}})};var Bv=["inputPrompt"];function Wv(o,t){if(o&1){let e=M();l(0,"textarea",12,0),ne("ngModelChange",function(n){g(e);let r=d(2);return Z(r.userPrompt,n)||(r.userPrompt=n),C(n)}),a()}if(o&2){let e=d(2);ie("ngModel",e.userPrompt)}}function $v(o,t){if(o&1){let e=M();l(0,"input",17,0),ne("ngModelChange",function(n){g(e);let r=d(3);return Z(r.userPrompt,n)||(r.userPrompt=n),C(n)}),a()}if(o&2){let e=d(3);ie("ngModel",e.userPrompt)}}function Hv(o,t){if(o&1){let e=M();l(0,"input",18,0),ne("ngModelChange",function(n){g(e);let r=d(3);return Z(r.userPrompt,n)||(r.userPrompt=n),C(n)}),a()}if(o&2){let e=d(3);ie("ngModel",e.userPrompt)}}function Gv(o,t){if(o&1){let e=M();l(0,"input",19,0),ne("ngModelChange",function(n){g(e);let r=d(3);return Z(r.userPrompt,n)||(r.userPrompt=n),C(n)}),a()}if(o&2){let e=d(3);ie("ngModel",e.userPrompt)}}function qv(o,t){if(o&1){let e=M();l(0,"input",20,0),ne("ngModelChange",function(n){g(e);let r=d(3);return Z(r.userPrompt,n)||(r.userPrompt=n),C(n)}),a()}if(o&2){let e=d(3);ie("ngModel",e.userPrompt)}}function Jv(o,t){if(o&1&&D(0,$v,2,1,"input",13)(1,Hv,2,1,"input",14)(2,Gv,2,1,"input",15)(3,qv,2,1,"input",16),o&2){let e,i=d(2);T((e=i.inputType())==="input-number"?0:e==="input-email"?1:e==="input-password"?2:3)}}function Xv(o,t){if(o&1&&(l(0,"div",11),u(1),a()),o&2){let e=d(2);c(),W(e.promptErrorMessage||"Entrada no v\xE1lida")}}function Zv(o,t){if(o&1&&(l(0,"div",6),D(1,Wv,2,1,"textarea",10)(2,Jv,4,1),D(3,Xv,2,1,"div",11),a()),o&2){let e=d();c(),T(e.inputType()==="textarea"?1:2),c(2),T(e.showPromptError()?3:-1)}}var ba=class o{sanitizer=b(Ip);_message=A("\xBFEst\xE1 seguro de que desea continuar?");_type=A("confirm");confirmColor=ce(()=>this._type()==="confirm"?"warning":this._type()==="delete"?"danger":this._type());mapping={confirm:"Confirmar",success:"Aceptar",delete:"Eliminar",info:"Continuar",warning:"Confirmar"};confirmButtonText=ce(()=>this.mapping[this._type()]||"Confirmar");title="Confirm";set message(t){this._message.set(this.sanitizer.bypassSecurityTrustHtml(t))}hasPrompt=!1;userPrompt=A("");leaving=A(!1);inputType=A("input");set type(t){this._type.set(t)}confirm=Oe();minPromptLength;maxPromptLength;promptRegex;promptErrorMessage;inputPrompt=Ep("inputPrompt");constructor(){yt(()=>{this.inputPrompt()?.nativeElement?.focus()})}isPromptValid=ce(()=>{let t=this.userPrompt().toString().trim(),e=t.length||0;if(e===0||this.minPromptLength!==void 0&&e<this.minPromptLength||this.maxPromptLength!==void 0&&e>this.maxPromptLength)return!1;if(this.promptRegex){let i;if(typeof this.promptRegex=="string")try{i=new RegExp(this.promptRegex)}catch(n){return console.error("Error al crear expresi\xF3n regular:",n),!1}else i=this.promptRegex;return i.test(t)}return!0});showPromptError=ce(()=>this.userPrompt().toString().trim().length>0&&!this.isPromptValid());onConfirm(){this.hasPrompt?this.isPromptValid()&&(this.confirm.emit({isOk:!0,prompt:this.userPrompt().toString().trim()}),this.leaving.set(!0)):(this.confirm.emit({isOk:!0,prompt:null}),this.leaving.set(!0))}onCancel(){this.confirm.emit({isOk:!1,prompt:null}),this.leaving.set(!0)}handleEnterKey(t){this.inputType()!="textarea"&&this.onConfirm()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-confirm"]],viewQuery:function(e,i){e&1&&gp(i.inputPrompt,Bv,5),e&2&&Cp()},hostBindings:function(e,i){e&1&&h("keydown.enter",function(r){return i.handleEnterKey(r)},os)},inputs:{title:"title",message:"message",hasPrompt:"hasPrompt",type:"type",minPromptLength:"minPromptLength",maxPromptLength:"maxPromptLength",promptRegex:"promptRegex",promptErrorMessage:"promptErrorMessage"},outputs:{confirm:"confirm"},features:[we([],[Te({success:vh,info:yh,warning:bh,confirm:xh,danger:wh})])],decls:13,vars:13,consts:[["inputPrompt",""],[1,"confirm-overlay"],[1,"confirm-dialog",3,"ngClass"],["size","100px",3,"name"],[1,"confirm-content"],[1,"text-muted",3,"innerHTML"],[1,"input-container"],[1,"confirm-actions"],["app-button","","size","lg","color","dark",3,"click"],["app-button","","size","lg",3,"click","color","disabled"],["appTextareaResize","","placeholder","Ingrese valor","rows","5",3,"ngModel"],[1,"prompt-error"],["appTextareaResize","","placeholder","Ingrese valor","rows","5",3,"ngModelChange","ngModel"],["type","number","placeholder","Ingrese un n\xFAmero",3,"ngModel"],["type","email","placeholder","Ingrese un correo electr\xF3nico",3,"ngModel"],["type","password","placeholder","Ingrese una contrase\xF1a",3,"ngModel"],["type","text","placeholder","Ingrese valor",3,"ngModel"],["type","number","placeholder","Ingrese un n\xFAmero",3,"ngModelChange","ngModel"],["type","email","placeholder","Ingrese un correo electr\xF3nico",3,"ngModelChange","ngModel"],["type","password","placeholder","Ingrese una contrase\xF1a",3,"ngModelChange","ngModel"],["type","text","placeholder","Ingrese valor",3,"ngModelChange","ngModel"]],template:function(e,i){e&1&&(l(0,"div",1)(1,"div",2),_(2,"ng-icon",3),l(3,"div",4)(4,"h2"),u(5),a(),_(6,"p",5),D(7,Zv,4,2,"div",6),l(8,"div",7)(9,"button",8),h("click",function(){return i.onCancel()}),u(10,"Cancelar"),a(),l(11,"button",9),h("click",function(){return i.onConfirm()}),u(12),a()()()()()),e&2&&(Ct("confirm-leaving",i.leaving()),c(),f("ngClass",i._type),c(),it(Re("color-",i.confirmColor())),f("name",i.confirmColor()),c(3),W(i.title),c(),f("innerHTML",i._message(),mp),c(),T(i.hasPrompt?7:-1),c(4),f("color",i.confirmColor())("disabled",i.hasPrompt&&!i.isPromptValid()),c(),W(i.confirmButtonText()))},dependencies:[be,he,Be,pe,Qe,Dn,Ne,at,Tl,Je],styles:[".confirm-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#0006;display:flex;justify-content:center;align-items:center;z-index:1999}.confirm-dialog[_ngcontent-%COMP%]{background-color:var(--bg-card);padding:2rem;border-radius:15px;box-shadow:0 0 10px #0000004d;max-width:400px;width:100%;text-align:center;animation:_ngcontent-%COMP%_chicle .3s cubic-bezier(.34,1.56,.64,1) forwards}.confirm-leaving[_ngcontent-%COMP%]   .confirm-dialog[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideOutScale .2s cubic-bezier(.55,.085,.68,.53) forwards}h2[_ngcontent-%COMP%]{margin-top:0;color:var(--text-color);font-weight:lighter}p[_ngcontent-%COMP%]{line-height:normal}.confirm-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:25px;gap:.5rem}.confirm-btn[_ngcontent-%COMP%]{color:#fff}.danger[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]{background-color:var(--bs-danger)}.success[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]{background-color:var(--bs-success)}.info[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]{background-color:var(--bs-info)}.warning[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]{background-color:var(--bs-warning)}.confirm-btn[_ngcontent-%COMP%]:hover{opacity:.9}.icon-container[_ngcontent-%COMP%]{margin:0 auto 1rem}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:8px;padding:.5rem 1rem;width:100%;margin:.5rem 0}input[_ngcontent-%COMP%]{height:2.5rem}textarea[_ngcontent-%COMP%]{max-height:400px}.input-container[_ngcontent-%COMP%]{position:relative;width:100%;margin:.5rem 0}.prompt-error[_ngcontent-%COMP%]{color:var(--bs-danger);font-size:.8rem;margin-top:.25rem;text-align:left;padding-left:1rem}@keyframes _ngcontent-%COMP%_chicle{0%{opacity:0;transform:scale(.5)}70%{opacity:1;transform:scale(1.1)}80%{transform:scale(.9)}to{opacity:1;transform:scale(1)}}@keyframes _ngcontent-%COMP%_slideOutScale{0%{opacity:1;transform:scale(1)}50%{transform:scale(.6)}90%{opacity:0}to{opacity:0;transform:scale(1.5)}}"],changeDetection:0})};var li=class o{constructor(t,e,i){this.appRef=t;this.injector=e;this.rendererFactory=i;this.renderer=i.createRenderer(null,null),this.createContainer()}containerElement=null;activeComponentRef=null;renderer;createContainer(){this.containerElement||(this.containerElement=this.renderer.createElement("div"),this.containerElement.id="confirm-container",this.renderer.setStyle(this.containerElement,"z-index","99999"),this.renderer.setStyle(this.containerElement,"position","fixed"),this.renderer.appendChild(document.body,this.containerElement))}show(t){return new Promise(e=>{this.removeExistingComponent();let i=da(ba,{environmentInjector:this.injector,hostElement:document.createElement("div")});this.activeComponentRef=i,this.containerElement.appendChild(i.location.nativeElement);let n={title:"Confirm",message:"Are you sure?",type:"confirm"};Object.assign(i.instance,k(k({},n),t)),i.instance.confirm.subscribe(r=>{this.removeExistingComponent(!0),e(r.isOk)}),this.appRef.attachView(i.hostView)})}confirm=(t,e,i="confirm")=>this.show({title:t,message:e,type:i});delete=(t,e)=>this.show({title:t,message:e,type:"delete"});success=(t,e)=>this.show({title:t,message:e,type:"success"});info=(t,e)=>this.show({title:t,message:e,type:"info"});warning=(t,e)=>this.show({title:t,message:e,type:"warning"});prompt(t){return new Promise(e=>{this.removeExistingComponent();let i=da(ba,{environmentInjector:this.injector,hostElement:document.createElement("div")});this.activeComponentRef=i,this.containerElement.appendChild(i.location.nativeElement);let n={title:"Prompt",message:"Ingrese un valor:",type:"confirm"};Object.assign(i.instance,re(k(k({},n),t),{hasPrompt:!0,minPromptLength:t.minPromptLength,maxPromptLength:t.maxPromptLength,promptRegex:t.promptRegex,promptErrorMessage:t.promptErrorMessage})),i.instance.userPrompt.set(t.textDefault||""),i.instance.inputType.set(t.inputTypeDefault||"input"),i.instance.confirm.subscribe(r=>{this.removeExistingComponent(!0),e(r)}),this.appRef.attachView(i.hostView)})}removeExistingComponent(t=!1){let e=()=>{this.activeComponentRef&&(this.activeComponentRef.location.nativeElement.classList.add("confirm-leaving"),this.appRef.detachView(this.activeComponentRef.hostView),this.containerElement&&this.containerElement.contains(this.activeComponentRef.location.nativeElement)&&this.containerElement.removeChild(this.activeComponentRef.location.nativeElement),this.activeComponentRef.destroy(),this.activeComponentRef=null)};t?setTimeout(e,300):e()}static \u0275fac=function(e){return new(e||o)(Vo(as),Vo(is),Vo(sa))};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var Fl=class o{API=`${Le.web_maker}/page-cms`;apiService=b(Lt);loadingService=b(Yt);confirmationService=b(ft);auth=b(xe);toastrService=b(tt);states=[{code:"1",denomination:"Activo"},{code:"0",denomination:"Inactivo"}];stateMap=this.states.reduce((t,e)=>(t[e.code]=e.denomination,t),{});canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.canAdd=this.auth.hasSubPermission("page-cms-ADD"),this.canEdit=this.auth.hasSubPermission("page-cms-EDIT"),this.canRemove=this.auth.hasSubPermission("page-cms-REMOVE"),this.canChangeState=this.auth.hasSubPermission("page-cms-CHANGE-STATE"),this.canExport=this.auth.hasPermission("page-cms-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("page-cms-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("page-cms-EXPORT-PDF")}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}simpleData(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/simple-data/${t.project_cms_id}`)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}patch(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}changeStateMessage(t){let e=this.stateMap[t],i="";switch(t){case"1":i="text-success";break;case"0":i="text-danger";break}return{message:`
            <div class="text-center">
                <div class="mb-3">\xBFEst\xE1 seguro de cambiar el estado del registro?</div>
                <h3 >Nuevo estado: <b class="${i}">${e}</b></h3>
            </div>
        `,denomination:e}}changeStateSave(t){return P(this,null,function*(){return yield this.apiService.putPrivate(`${this.API}/state/change/${t.id}`,t)})}changeState(t){return P(this,null,function*(){let{message:e}=this.changeStateMessage(t.state);if(!(yield this.confirmationService.create("Confirmar",e)))return;this.loadingService.open();let n=yield this.changeStateSave(t);return this.loadingService.hide(),n})}delete(t){return P(this,null,function*(){let e=yield this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}export(t,e,i=!0){return P(this,null,function*(){if(i&&!(yield this.confirmationService.create("Confirmar","\xBFEst\xE1 seguro de exportar los datos?")))return;this.loadingService.open();let n=re(k({},t),{type_export:e,url:Le.storage_view,institution:this.auth.getInstitution()}),r=yield this.apiService.postPrivate(`${this.API}/export`,n);return this.loadingService.hide(),r&&r.state=="success"&&window.open(r.url),r})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var Kv=(o,t)=>({active:o,"box-main":t}),Yv=(o,t)=>({item:o,indice:t});function e1(o,t){if(o&1){let e=M();l(0,"button",16),h("click",function(){g(e);let n=d(2);return C(n.level(-1))}),_(1,"i",17),a(),l(2,"button",16),h("click",function(){g(e);let n=d(2);return C(n.level(1))}),_(3,"i",18),a()}if(o&2){let e=d(2);f("disabled",e.selectedS().level==1),c(2),f("disabled",e.selectedS().level>=3)}}function t1(o,t){if(o&1){let e=M();l(0,"div",2)(1,"h6",10),u(2,"P\xE1ginas"),a(),l(3,"div",11),D(4,e1,4,2),l(5,"button",12),h("click",function(){g(e);let n=d();return C(n.listPages())}),_(6,"i",13),a(),l(7,"button",14),h("click",function(){g(e);let n=d();return C(n.add())}),_(8,"i",15),u(9," Adicionar"),a()()()}if(o&2){let e=d();c(4),T(e.selectedS().id&&e.cardData!=="link"?4:-1)}}function i1(o,t){o&1&&_(0,"i",25)}function n1(o,t){if(o&1&&(l(0,"a",26),u(1,"Dise\xF1ar"),a()),o&2){let e=d().$implicit,i=d();f("routerLink",tr("/",i.base,"/design/",e.project_id,"/page/",e.id))}}function o1(o,t){if(o&1){let e=M();l(0,"div",19,1),h("elementEvents",function(n){let r=g(e).$implicit,s=d();return C(s.select(r,n))}),l(2,"div",20),_(3,"ng-icon",21),a(),l(4,"div",22)(5,"a",23),u(6),a()(),l(7,"div",24),D(8,i1,1,0,"i",25),D(9,n1,2,4,"a",26),l(10,"button",27),h("click",function(n){let r=g(e).$implicit,s=Xe(1);return d().select(r),s.open(n),C(n.stopPropagation())}),_(11,"i",28),a()()()}if(o&2){let e=t.$implicit,i=t.$index,n=d(),r=Xe(7);it(Re("items level",e.level," px-2")),f("ngClass",vt(13,Kv,e.id==n.selected.id,n.cardData!=="link"))("contextMenu",r)("contextMenuValue",vt(16,Yv,e,i)),c(5),f("routerLink",tr("/",n.base,"/design/",e.project_id,"/page/",e.id)),c(),Ie(" ",e.title," "),c(2),T(n.mainPage()==e.id?8:-1),c(),T(n.cardData!="link"?9:-1)}}function r1(o,t){if(o&1&&(l(0,"div",30)(1,"span"),u(2),a(),l(3,"span"),u(4),a()()),o&2){let e=d().$implicit,i=d(2);f("routerLink",tr("/",i.base,"/design/",e.project_id,"/cms/",e.id)),c(2),W(e.name),c(2),Ie("[",e.rows.length,"]")}}function a1(o,t){if(o&1&&(l(0,"div",31)(1,"span"),u(2),a(),l(3,"span"),u(4,"[0]"),a()()),o&2){let e=d().$implicit;c(2),W(e.name)}}function s1(o,t){if(o&1&&D(0,r1,5,6,"div",30)(1,a1,5,1,"div",31),o&2){let e=t.$implicit;T(e.rows.length>0?0:1)}}function l1(o,t){if(o&1&&(l(0,"div",5)(1,"h6",29),u(2,"P\xE1ginas CMS"),a(),Y(3,s1,2,1,null,null,de),a()),o&2){let e=d();c(3),ee(e.cmsList())}}function c1(o,t){if(o&1){let e=M();l(0,"div",6),_(1,"img",32),l(2,"h3"),u(3,"Bienvenido"),a(),l(4,"b"),u(5),_(6,"br"),u(7," puedes crear una p\xE1gina para empezar a trabajar."),a(),_(8,"br"),l(9,"button",33),h("click",function(){g(e);let n=d();return C(n.add())}),u(10,"Crear p\xE1gina"),a()()}if(o&2){let e=d();c(5),Ie("Tu proyecto ",e.projectName()," no tiene p\xE1ginas creadas, ")}}function d1(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"i",36),a(),l(3,"div",37),u(4,"Adicionar"),a(),l(5,"div",38),u(6,"F1"),a()())}function m1(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"i",39),a(),l(3,"div",37),u(4,"Editar"),a(),_(5,"div",38),a())}function p1(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"i",40),a(),l(3,"div",37),u(4,"Eliminar"),a(),_(5,"div",38),a())}function u1(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"i",41),a(),l(3,"div",37),u(4,"Duplicar"),a(),_(5,"div",38),a())}function f1(o,t){}function h1(o,t){o&1&&(l(0,"div",34)(1,"div",42),_(2,"i",43),a(),l(3,"div",37),u(4,"Activar"),a(),_(5,"div",38),a())}function g1(o,t){o&1&&(l(0,"div",34)(1,"div",44),_(2,"i",45),a(),l(3,"div",37),u(4,"Bloquear"),a(),_(5,"div",38),a())}function C1(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"i",46),a(),l(3,"div",37),u(4,"Establecer como principal"),a(),_(5,"div",38),a())}function _1(o,t){}function v1(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"i",47),a(),l(3,"div",37),u(4,"Actualizar lista"),a(),_(5,"div",38),a())}function y1(o,t){o&1&&_(0,"app-loading")}var Tr=class o{modal=b(St);pageService=b(vo);cmsPagesService=b(Fl);projectService=b(Pi);dialogService=b(li);auth=b(xe);projectName=A("");base=this.auth.projectPath();page_id="";type="";state="1";project_id="";mode="table";size="lg";cardData="box";eventChange=new q;onDeletePage=Oe();cmsList=le([]);selectedPage_id;projectData;filter={texto:""};pages=A([]);EPageState=ha;loading=!1;mainPage=A(null);idinstitucion=this.auth.institucionData?.idinstitucion+"";ngOnInit(){return P(this,null,function*(){this.filter.page_id=this.page_id,this.filter.state=this.state,this.filter.project_id=this.project_id,this.filter.type=this.type,this.listPages(),this.projectService.data({id:+this.project_id,idinstitucion:this.idinstitucion}).then(t=>{let e=t.data;this.projectName.set(e?.denomination.toUpperCase()??""),this.mainPage.set(e?.mainPage_id??null)})})}listPages(){return P(this,null,function*(){this.loading=!0;let t=yield this.pageService.list(this.filter);this.loading=!1,this.pages.set(t.data??[])})}add(){this.openForm()}update(t){this.openForm("update",t)}openForm(t="add",e){return P(this,null,function*(){let i=(t=="add"?"Agregar":t=="update"?"Editar":"Clonar")+" P\xE1gina";try{this.modal.open(Dl,{title:i,hiddenButtons:!0,params:{accion:t,type:this.filter.type,project_id:this.filter.project_id,page:t=="update"||t=="clone"?JSON.parse(JSON.stringify(e)):void 0,isModal:!0}}).result().then(r=>{if(r.isOk&&r.data)if(t=="add")this.pages.set([...this.pages(),r.data]);else if(t=="update"){if(!e)return;Object.assign(e,r.data)}else t=="clone"&&this.pages.set([...this.pages(),r.data])})}catch{}})}remove(t,e=-1){return P(this,null,function*(){if(!(yield this.dialogService.show({title:"Eliminar P\xE1gina",message:"\xBFEst\xE1 seguro de eliminar esta p\xE1gina?",type:"delete"})))return;this.loading=!0;let n=yield this.pageService.delete({id:t.id,project_id:t.project_id});this.loading=!1,n.state=="success"&&(this.pages.set(this.pages().filter(r=>r.id!=t.id)),this.selected={},this.onDeletePage.emit(t.id))})}changeState(t,e){return P(this,null,function*(){let i={id:t.id,project_id:t.project_id,state:e},n=yield this.pageService.changeState(i);n&&n.state=="success"&&(t.state=e)})}setMainPage(t){return P(this,null,function*(){if(!(yield this.dialogService.show({title:"P\xE1gina Principal",message:"\xBFEst\xE1 seguro de establecer esta p\xE1gina como p\xE1gina principal?",type:"confirm"})))return;this.loading=!0;let i=yield this.projectService.setMainPage({id:+this.project_id,mainPage_id:t.id,idinstitucion:this.idinstitucion});this.loading=!1,i.state==="success"&&this.mainPage.set(t.id)})}searchChange(){this.listPages()}stateFilterChange(){this.listPages()}suiteFilterChange(){this.listPages()}selected={};selectedS=A({});select(t,e="click"){t.id==this.selected.id&&e!="dblclick"||(this.selected=t,this.selectedS.set(k({},t)),this.eventChange.emit({event:e,data:JSON.parse(JSON.stringify(t))}))}canAdd=()=>this.pageService.canAdd;canEdit=()=>this.pageService.canEdit;canRemove=()=>this.pageService.canRemove;canChangeState=()=>this.pageService.canChangeState;canExport=()=>this.pageService.canExport;canExportExcel=()=>this.pageService.canExportExcel;canExportPdf=()=>this.pageService.canExportPdf;canChangeStateActive=t=>this.pageService.canChangeState&&t.item.state!="1";canChangeStateInactive=t=>this.pageService.canChangeState&&t.item.state!="0";export(t="pdf"){return P(this,null,function*(){yield this.pageService.export(this.filter,t)})}changeMode(t){this.mode=t}drop(t){return P(this,null,function*(){let e=[...this.pages()];jn(e,t.previousIndex,t.currentIndex),this.pages.set(e),this.pages().forEach((r,s)=>{r.order_new=s+1});let i=[];if(this.pages().forEach((r,s)=>{typeof r.order_new<"u"&&r.order_new!=r.orderList&&i.push({id:r.id,orderList:r.order_new,project_id:r.project_id})}),i.length==0)return;if(this.loading=!0,(yield this.pageService.saveOrder(i,!1)).state=="success"){let r=this.pages();r.forEach(s=>{s.orderList=s.order_new??s.orderList,delete s.order_new}),this.pages.set([...r])}this.loading=!1})}level(t){return P(this,null,function*(){let e={id:this.selectedS().id,project_id:this.selectedS().project_id,level:+this.selectedS().level+t};if(console.log("params",e),(yield this.pageService.patch(e)).state=="success"){let n=this.selectedS();n.level=e.level,this.selectedS.set(k({},n)),this.pages.update(r=>r.map(s=>s.id===n.id?re(k({},s),{level:n.level}):s))}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-page-list"]],inputs:{page_id:"page_id",type:"type",state:"state",project_id:"project_id",mode:"mode",size:"size",cardData:"cardData",cmsList:[1,"cmsList"],selectedPage_id:"selectedPage_id"},outputs:{eventChange:"eventChange",onDeletePage:"onDeletePage"},features:[we([Te({lucideLayoutTemplate:js,lucideGripVertical:Vs})])],decls:19,vars:12,consts:[["menu",""],["ngxContextMenu","ngxContextMenu"],[1,"gap-1","d-flex","align-items-center","justify-content-between","py-1"],["cdkDropList","",3,"cdkDropListDropped"],["routerLinkActive","active","cdkDrag","",3,"class","ngClass","contextMenu","contextMenuValue"],[1,"mt-3"],[1,"w-100","h-100","d-flex","text-center","py-3",2,"justify-content","center","align-items","center","flex-direction","column","min-height","200px"],["contextMenuItem","",3,"execute","visible"],["contextMenuItem","",3,"divider"],["contextMenuItem","",3,"execute"],[1,"m-0"],[1,"d-flex","gap-1","align-items-center"],["app-icon-button","","size","sm",3,"click"],[1,"icon","ion-md-refresh"],["app-button","","size","sm",3,"click"],[1,"icon","ion-md-add"],["app-button","","size","sm",3,"click","disabled"],[1,"icon","ion-md-arrow-round-back"],[1,"icon","ion-md-arrow-round-forward"],["routerLinkActive","active","cdkDrag","",3,"elementEvents","ngClass","contextMenu","contextMenuValue"],["cdkDragHandle","",1,"drag-handle","d-flex","align-items-center","justify-content-center"],["name","lucideGripVertical","size","16"],[1,"text-truncate","d-flex","align-items-center","justify-content-between",2,"flex","1","line-height","normal"],[1,"d-flex","align-items-center",2,"height","30px",3,"routerLink"],[1,"action-buttons"],[1,"icon","ion-md-star",2,"color","var(--bs-yellow)"],["app-button","","size","xs","variant","outline",3,"routerLink"],["app-icon-button","","variant","text","size","xs",3,"click"],[1,"icon","ion-md-more"],[1,"m-0","py-1"],["routerLinkActive","active",1,"items","px-3","d-flex","align-items-center","justify-content-between",2,"cursor","pointer",3,"routerLink"],[1,"items","px-3","d-flex","align-items-center","justify-content-between"],["src","assets/icons/pages.svg","alt","",1,"mb-3",2,"width","100px","filter","var(--filter)"],["app-button","","size","lg",3,"click"],[1,"_items"],[1,"icons"],[1,"icons","icon","ion-md-add"],[1,"label","w-100"],[1,"atajo"],[1,"icons","icon","ion-md-create"],[1,"icons","icon","ion-md-trash"],[1,"icons","ion-md-copy"],[1,"icons","text-success"],[1,"icon","ion-md-eye"],[1,"icons","text-danger"],[1,"icon","ion-md-eye-off"],[1,"icons","icon","ion-md-home"],[1,"icons","icon","ion-md-refresh"]],template:function(e,i){if(e&1){let n=M();D(0,t1,10,1,"div",2),l(1,"div",3),h("cdkDropListDropped",function(s){return g(n),C(i.drop(s))}),Y(2,o1,12,19,"div",4,de),a(),D(4,l1,5,0,"div",5),D(5,c1,11,1,"div",6),l(6,"context-menu",null,0),Se(8,d1,7,0,"ng-template",7),h("execute",function(){return g(n),C(i.add())}),Se(9,m1,6,0,"ng-template",7),h("execute",function(s){return g(n),C(i.update(s.value.item))}),Se(10,p1,6,0,"ng-template",7),h("execute",function(s){return g(n),C(i.remove(s.value.item,s.value.indice))}),Se(11,u1,6,0,"ng-template",7),h("execute",function(s){return g(n),C(i.openForm("clone",s.value.item))}),Se(12,f1,0,0,"ng-template",8)(13,h1,6,0,"ng-template",7),h("execute",function(s){return g(n),C(i.changeState(s.value.item,i.EPageState.ACTIVE))}),Se(14,g1,6,0,"ng-template",7),h("execute",function(s){return g(n),C(i.changeState(s.value.item,i.EPageState.INACTIVE))}),Se(15,C1,6,0,"ng-template",9),h("execute",function(s){return g(n),C(i.setMainPage(s.value.item))}),Se(16,_1,0,0,"ng-template",8)(17,v1,6,0,"ng-template",9),h("execute",function(){return g(n),C(i.listPages())}),a(),D(18,y1,1,0,"app-loading")}e&2&&(T(i.pages().length>0?0:-1),c(2),ee(i.pages()),c(2),T(i.cmsList().length>0?4:-1),c(),T(i.pages().length==0?5:-1),c(3),f("visible",i.canAdd),c(),f("visible",i.canEdit),c(),f("visible",i.canRemove),c(),f("visible",!0),c(),f("divider",!0),c(),f("visible",i.canChangeStateActive),c(),f("visible",i.canChangeStateInactive),c(2),f("divider",!0),c(2),T(i.loading?18:-1))},dependencies:[Dr,_o,Co,go,cn,Je,ir,be,si,Si,wi,xi,pe,Ye,Ke,At,Ei,he,Be,Ge],styles:["[_nghost-%COMP%]{display:block}.items[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem;margin-bottom:.25rem;background:var(--fuse-bg-card);font-size:11px}.items.box-main[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:.5rem}.items[_ngcontent-%COMP%]:not(.box-main){border-radius:.5rem;padding:.25rem .05rem}.items[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;width:100%;color:var(--navbar-color)}.items[_ngcontent-%COMP%]:hover, .items[_ngcontent-%COMP%]:hover   a[_ngcontent-%COMP%]{color:var(--primary-hover)}.items.active[_ngcontent-%COMP%]{background-color:var(--primary-pastel);color:var(--primary);font-weight:700}.items.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--primary)}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.25rem;align-items:center}.level2[_ngcontent-%COMP%]{margin-left:1rem}.level3[_ngcontent-%COMP%]{margin-left:2rem}"]})};var Ph=tp(Eh());var Rn=class o{renderTemplateService=b(Dt);buildProject(t,e,i){return P(this,null,function*(){let[n,r,s,m]=[t.header,t.footer,t.pages,t.cmsPages],p=[],v=t.fontFamily?`body {font-family: ${t.fontFamily};}`:"",y=t.faviconUrl?`<link rel="icon" type="image/x-icon" href="${t.faviconUrl}">`:"",x=t.faviconUrl?yield wf(t.faviconUrl):null,E=new Ph.default,[w,O,F]=yield Promise.all([cl("/assets/sandbox/reset.style.css"),cl("/assets/sandbox/main.style.css"),cl("/assets/sandbox/production.bundle.js")]),V=""+v,L=this.renderTemplateService.generateComponents(n,{generateNewId:!0,fullCss:!0}),B=this.renderTemplateService.generateComponents(r,{generateNewId:!0,fullCss:!0});V+=L.styleSheet+B.styleSheet,p=[...L.dependencies,...B.dependencies];let z=E.folder("assets"),Q=`const __routes__ = {};
`,K=[],fe=!1,ae="";s.forEach((Ve,_e)=>{let pt=this.renderTemplateService.generateComponents(Ve.nodes,{generateNewId:!0,fullCss:!0});p=[...p,...pt.dependencies],V+=pt.styleSheet,Q+=`__routes__['${Ve.url}'] = () => ${pt.components};
`,K.push(`h(__routes__['${Ve.url}'], { path: '${Ve.url}' })`),Ve.url==="index"&&(fe=!0),_e===0&&(ae=Ve.url)}),m.forEach(Ve=>{let _e=this.renderTemplateService.generateComponents(Ve.nodes,{generateNewId:!0,fullCss:!0});p=[...p,..._e.dependencies],V+=_e.styleSheet,Q+=`
__routes__['${Ve.url}'] = (props) => {
                const data = ${JSON.stringify(Ve.info)}
                const slug = props['slug'];
                const cmsData = data.find((x) => x.slug === slug);
                dataset = {...dataset, ...cmsData}
            return ${_e.components};}
`,K.push(`h(__routes__['${Ve.url}'], { path: '${Ve.url}/:slug' })`)});let ye=this.renderTemplateService.getResoursesDev(p,this.renderTemplateService.mapComponents(),!0),qe=Object.values(ye).map(Ve=>Ve.styles).join(`
`),U=Object.keys(ye).map(Ve=>`const ${wn(Ve)} = ${ye[Ve].script};`).join(`
`);K.push(`h(__routes__['${fe?"index":ae}'], { path: '/' })`);let me=`
const NotFound = () => h('h1', { class: 'not-found' }, '404 - Not Found');
const __layout = ({ children }) => [h(__sysc.OverlayManager, null),${L.components}, children, h('div', { class: 'footer' }, [${B.components}])];
${Q}
const App = () => h(__layout, null, h(Router, {onChange: (e) => { window.scrollTo({ top: 0, behavior: 'smooth'})}}, [${K}, h(NotFound, { default: true })]));
render(h(App, null), document.getElementById('app'));
`;z?.file("main.js",me),z?.file("main.css",V),z?.file("bundle.js",F),z?.file("style.css",w+`
#app {min-height: 100vh; min-height: 100dvh;}#app{display: flex; flex-direction: column; justify-content: space-between;}.not-found{text-align: center;margin: 5rem 1rem;}
`+O+`
`+qe),z?.file("script.js",`Object.assign(window, {dataset: ${JSON.stringify(i)}});`+U),x&&(z?.file(`favicon.${x.extension}`,x.blob),y=`<link rel="icon" type="image/x-icon" href="assets/favicon.${x.extension}">`);let I=new Date().getTime();for(let Ve of s){let _e=`<html>
<head>
    <title>${Ve.title}</title>
    <meta charset="UTF-8">
    <base href="/">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    ${y}
    <script>window.modeview = null;<\/script>
    <link rel="stylesheet" href="/assets/style.css?v=${I}">
    <link rel="stylesheet" href="/assets/main.css?v=${I}">
</head>
<body>
    <div id="app"></div>
    <script src="/assets/bundle.js?v=${I}"><\/script>                
    <script src="/assets/script.js?v=${I}"><\/script>
    <script src="/assets/main.js?v=${I}"><\/script>
</body>
</html>`;E.file(`${Ve.main?"index":Ve.url}.html`,_e)}for(let Ve of m){let _e=`<html>
<head>
    <title>${Ve.url}</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    ${y}
    <script>window.modeview = null;<\/script>
    <link rel="stylesheet" href="/assets/style.css?v=${I}">
    <link rel="stylesheet" href="/assets/main.css?v=${I}">
</head>
<body>
    <div id="app"></div>
    <script src="/assets/bundle.js?v=${I}"><\/script>                
    <script src="/assets/script.js?v=${I}"><\/script>
    <script src="/assets/main.js?v=${I}"><\/script>
</body>
</html>`;E.file(`${Ve.url}.html`,_e)}return yield E.generateAsync({type:e})})}generateSandboxPage(){return P(this,null,function*(){return`
          <html>
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
                <link rel="stylesheet" href="/assets/sandbox/reset.style.css">                
                <script>
                    Object.assign(window, {dataset: {}, modeview: 'designer'});
                    console.log('Sandbox created');
                <\/script>
                <style id="style-resources"></style>                
                <script id="classes-resources"><\/script>
                
            </head>
            <body>
                <div id="app-wrapper"></div>
                <script src="/assets/sandbox/design.bundle.js"><\/script>            
                <script id="script-resources"><\/script>
                <style-components></style-components>
                <link rel="stylesheet" href="/assets/sandbox/design.css">
                <link rel="stylesheet" href="/assets/sandbox/design-tools.css">
            </body>
          </html>
        `})}generatePreviewPage(t,e,i,n){return P(this,null,function*(){let r=this.renderTemplateService.generatePreviewResources(t),s=n.trim()?`font-family: ${n};`:"";return console.log("fontFamily",n,s),`
          <html>
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="initial-scale=1">
                <link rel="stylesheet" href="/assets/sandbox/reset.style.css">
                <link rel="stylesheet" href="/assets/sandbox/main.style.css">
                <style>
                    body{
                        background: #a9a9a9;
                        ${s}
                    }
                    #app{
                        background: #fcfcfc;
                    }

                    .wmw[wt='content'] {
                        display: flex;
                        flex-direction: column;
                    }
                    body[mode='component-editor'], #app{
                        background: transparent;
                    }
                    body[mode='component-editor'] [wt='content']{
                        width: fit-content;
                    }
                    ${r.styles}
                    ${r.styleSheet}
                </style>
                <script>
                    window.modeview = 'preview';
                    Object.assign(window, {dataset: ${JSON.stringify(e)}})
                <\/script>                
                <script>
                    ${r.classes}
                <\/script>                
                <script>
                    window.location.assign = function(url) {
                        console.log('Blocked redirect to ' + url);
                    };
                    window.location.replace = function(url) {
                        console.log('Blocked redirect to ' + url);
                    };
                    window.open = function(url, name, specs) {
                        console.log('Blocked open window to ' + url);
                    };
                <\/script>
            </head>
            <body mode="${i}">
                <div id="app"></div>
                <script src="/assets/sandbox/preview.bundle.js"><\/script>
                <script>
                    render([h(__sysc.OverlayManager, null),${r.components}], document.getElementById('app'));
                <\/script>
            </body>
          </html>
        `})}generateComponentDesigner(){return P(this,null,function*(){return`
            <html>
                <head>
                    <link rel="stylesheet" href="/assets/sandbox/reset.style.css">
                    <link rel="stylesheet" href="/assets/sandbox/main.style.css">
                    <script>
                        window.modeview = 'component-designer';
                    <\/script>
                    <style>
                        #render-area{
							margin: 1rem;
                        }
                        body{
                            background-color: #707070;
							padding: 1rem;
                        }
                        .html-text{
                            background-color: #f1f1f1;
                            padding: 1rem;
                            margin: 1rem auto;
                            font-family: Monospace;
							width: 100%;
                        }
                    </style>
                    <style id="style-resources"></style>                    
                </head>
                <body>
                    <div id="render-area"></div>
                    <pre class="html-text" id="json-text"></pre>
                    <script src="/assets/sandbox/component.bundle.js"><\/script>
                    <script id="script-resources"><\/script>         
                </body>
            </html>
            `})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};function b1(o,t){o&1&&_(0,"span")}function x1(o,t){if(o&1&&(l(0,"div",8),u(1),a()),o&2){let e=d().$implicit;c(),ca("",e.value==null?null:e.value.label," (",e.value==null?null:e.value.target,")")}}function w1(o,t){if(o&1&&(l(0,"div",8),u(1),a()),o&2){let e=d().$implicit;c(),W(e.value)}}function S1(o,t){if(o&1){let e=M();l(0,"button",14),h("click",function(n){g(e);let r=d().$index;return d().moveItem(r,-1),C(n.stopPropagation())}),_(1,"ng-icon",15),a()}if(o&2){let e=d().$implicit;f("color",e.type==="image"?"light":"primary")}}function E1(o,t){if(o&1){let e=M();l(0,"button",16),h("click",function(n){g(e);let r=d().$index;return d().moveItem(r,1),C(n.stopPropagation())}),_(1,"ng-icon",17),a()}if(o&2){let e=d().$implicit;f("color",e.type==="image"?"light":"primary")}}function P1(o,t){if(o&1){let e=M();l(0,"div",6),h("click",function(){let n=g(e).$index,r=d();return C(r.index.emit(n))}),l(1,"div",7),D(2,b1,1,0,"span")(3,x1,2,2,"div",8)(4,w1,2,1,"div",8),a(),l(5,"div",9),D(6,S1,2,1,"button",10),D(7,E1,2,1,"button",11),l(8,"button",12),h("click",function(n){let r=g(e).$index;return d().removeItem(r),C(n.stopPropagation())}),_(9,"ng-icon",13),a()()()}if(o&2){let e,i=t.$implicit,n=t.$index,r=d();xt("background-image",i.type==="image"?"linear-gradient(#00000082, #00000082), url("+i.value+")":"none"),c(2),T((e=i.type)==="image"?2:e==="link"?3:4),c(4),T(n!=0?6:-1),c(),T(n!=r.value().length-1?7:-1),c(),f("color",i.type==="image"?"light":"danger")}}var kl=class o{index=new q;set inValue(t){this.value.set(t||[])}field;valueChange=new q;confirmService=b(li);value=A([]);maxItems;valueType=ce(()=>{if(this.field.formFields==null)return[];let t=this.field.formFields[0];return this.value().map((e,i)=>({value:e[t.field]||t.default||"",type:t.type}))});addItem(){return P(this,null,function*(){if(!this.isMaxItemsReached()){let t={};this.field.formFields?.forEach(e=>{t[e.field]=e.default||""}),this.value.update(e=>[...e,t]),this.emitChange()}})}removeItem(t){return P(this,null,function*(){this.value().length==0||!(yield this.confirmService.show({title:"Eliminar item",message:"\xBFEst\xE1s seguro de que deseas eliminar este item?",type:"delete"}))||(this.value.update(i=>i.filter((n,r)=>r!==t)),this.emitChange())})}updateValue(t,e,i){this.value.update(n=>n.map((r,s)=>s===t?re(k({},r),{[e]:i}):r)),this.emitChange()}isMaxItemsReached(){return this.maxItems!==void 0&&this.value().length>=this.maxItems}emitChange(){this.valueChange.emit(this.value())}moveItem(t,e){let i=t+e;i>=0&&i<this.value().length&&(this.value.update(n=>{let r=[...n],[s]=r.splice(t,1);return r.splice(i,0,s),r}),this.emitChange())}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-array-field"]],inputs:{inValue:[0,"value","inValue"],field:"field"},outputs:{index:"index",valueChange:"valueChange"},features:[we([Te({lucidePlus:kn,lucideTrash:On,lucideChevronLeft:Yp,lucideChevronRight:sr,lucideArrowUp:Xp,lucideArrowDown:vs})])],decls:9,vars:2,consts:[[1,"array-field-container"],[1,"header"],["app-icon-button","","size","sm",3,"click"],["name","lucidePlus","size","16"],[1,"array-items-container"],[1,"array-item",3,"background-image"],[1,"array-item",3,"click"],[1,"item-preview"],[1,"preview-text"],[1,"item-actions"],["app-icon-button","","variant","text","size","xs","type","button","title","Mover arriba",3,"color"],["app-icon-button","","variant","text","size","xs","type","button","title","Mover abajo",3,"color"],["app-icon-button","","variant","text","size","xs","type","button","title","Eliminar",3,"click","color"],["name","lucideTrash"],["app-icon-button","","variant","text","size","xs","type","button","title","Mover arriba",3,"click","color"],["name","lucideArrowUp"],["app-icon-button","","variant","text","size","xs","type","button","title","Mover abajo",3,"click","color"],["name","lucideArrowDown"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"b"),u(3),a(),l(4,"button",2),h("click",function(){return i.addItem()}),_(5,"ng-icon",3),a()(),l(6,"div",4),Y(7,P1,10,6,"div",5,de),a()()),e&2&&(c(3),ca(" ",i.field.label,": Items ",i.value().length," "),c(4),ee(i.valueType()))},dependencies:[Je,he,Ge],styles:[".header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.array-items-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;height:fit-content}.array-item[_ngcontent-%COMP%]{display:flex;align-items:center;border:2px solid #e5e7eb;border-radius:.5rem;height:40px;width:100%;cursor:pointer;position:relative;overflow:hidden;background-color:#fff;background-size:cover;background-position:center;transition:border-color .2s ease}.array-item[_ngcontent-%COMP%]:hover{border-color:#3b82f6}.item-preview[_ngcontent-%COMP%]{flex:1;height:100%;display:flex;align-items:center;padding:0 1rem;overflow:hidden}.preview-text[_ngcontent-%COMP%]{font-size:.9rem;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.item-actions[_ngcontent-%COMP%]{position:absolute;right:.25rem;display:flex}"]})};var gn=class o{type="primary";disabled=!1;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-simple-button"]],inputs:{type:"type",disabled:"disabled"},features:[we([],[Te({lucideSigma:Ws,lucideEllipsis:au})])],decls:1,vars:0,consts:[["name","lucideEllipsis"]],template:function(e,i){e&1&&_(0,"ng-icon",0)},dependencies:[Je],styles:["[_nghost-%COMP%]{display:inline-flex;align-items:center;justify-content:center;border-radius:.25rem;border:1px solid transparent;transition:all .15s ease-in-out;color:#fff;background-color:var(--primary);height:14px;cursor:pointer;-webkit-user-select:none;user-select:none;line-height:normal;padding:0 .25rem}[_nghost-%COMP%]:after{display:none!important}[_nghost-%COMP%]:hover:not(:disabled){background-color:var(--primary-hover)}"]})};var Cn=class o{label=nt("");isIcon=le(!1);clear=Oe();vars=le([]);fullWidth=le(!1);value=ce(()=>this.vars().find(t=>t.id===this.label())?.name);static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-view-vars"]],inputs:{label:[1,"label"],isIcon:[1,"isIcon"],vars:[1,"vars"],fullWidth:[1,"fullWidth"]},outputs:{label:"labelChange",clear:"clear"},decls:5,vars:4,consts:[["app-button","","size","sm","color","light"],["app-icon-button","","size","xs","color","danger",3,"click"],[1,"bi-x-lg"]],template:function(e,i){e&1&&(l(0,"button",0)(1,"span"),u(2),a()(),l(3,"button",1),h("click",function(){return i.clear.emit()}),_(4,"i",2),a()),e&2&&(pi(Re("flex: ",i.fullWidth()?"1":"none")),c(2),W(i.value()))},dependencies:[he,Be,Ge],styles:["[_nghost-%COMP%]{display:flex;align-items:center;gap:.5rem}"],changeDetection:0})};var Ol=class o{helperPanel=b(Vt);onEvent(t){t.event!=="contextmenu"&&this.helperPanel.ok(t.data.fileUrl)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-image-picker"]],decls:1,vars:3,consts:[["mode","box",3,"eventChange","modeSelection","size","showPagination"]],template:function(e,i){e&1&&(l(0,"app-ui-multimedia-list",0),h("eventChange",function(r){return i.onEvent(r)}),a()),e&2&&f("modeSelection",!0)("size","sm")("showPagination",!1)},dependencies:[ho],encapsulation:2})};var Mh=o=>({display:o});function M1(o,t){o&1&&_(0,"div",8)}function I1(o,t){if(o&1){let e=M();l(0,"button",7),h("click",function(){g(e);let n=d(2);return C(n.convert())}),u(1,"Convertir a variable"),a(),D(2,M1,1,0,"div",8)}if(o&2){let e=d(2);c(2),T(e.ds.dataHandler.imageVars().length>0?2:-1)}}function D1(o,t){if(o&1){let e=M();l(0,"button",9),h("click",function(){let n=g(e).$implicit,r=d(2);return C(r.variable.set(n.id))}),u(1),a()}if(o&2){let e=t.$implicit;f("title",e.name),c(),Ie(" ",e.name," ")}}function T1(o,t){if(o&1&&(_(0,"app-simple-button",4),l(1,"div",5),D(2,I1,3,1),Y(3,D1,2,2,"button",6,de),a()),o&2){let e=d();c(2),T(e.variable()==null?2:-1),c(),ee(e.ds.dataHandler.imageVars())}}function F1(o,t){if(o&1){let e=M();l(0,"button",16),h("click",function(){g(e);let n=d(2);return C(n.openImagePicker())}),_(1,"ng-icon",17),a()}}function k1(o,t){if(o&1){let e=M();l(0,"div",1)(1,"div",10)(2,"input",11),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.internalValue,n)||(r.internalValue=n),C(n)}),h("ngModelChange",function(){g(e);let n=d();return C(n.onValueChange())})("keydown",function(n){return g(e),C(n.stopPropagation())}),a(),D(3,F1,2,0,"button",12),a(),l(4,"div",13)(5,"img",14),h("load",function(){g(e);let n=d();return C(n.imageLoaded=!0)})("error",function(){g(e);let n=d();return C(n.handleImageError())}),a(),l(6,"div",15)(7,"span"),u(8,"No image"),a()()()()}if(o&2){let e=d();c(2),ie("ngModel",e.internalValue),sn("aria-invalid",e.error)("aria-describedby",e.error?"error-message":null),c(),T(e.ds.isDisabledDesigner()?-1:3),c(2),pi(te(9,Mh,e.imageLoaded?"block":"none")),f("src",e.value(),mt),c(),pi(te(11,Mh,e.imageLoaded?"none":"block"))}}function O1(o,t){if(o&1){let e=M();l(0,"app-view-vars",18),h("clear",function(){g(e);let n=d();return C(n.variable.set(null))}),a()}if(o&2){let e=d();f("fullWidth",!0)("label",e.variable())("vars",e.ds.dataHandler.imageVars())}}function V1(o,t){if(o&1&&(l(0,"p",3),u(1),a()),o&2){let e=d();c(),W(e.errorMessage)}}var Vl=class o{label=le("Imagen");valueChange=new q;focused=!1;error=!1;errorMessage="";imageLoaded=!1;internalValue="";ds=b(Ue);confirmService=b(li);value=nt("");variable=nt(null);helperPanel=b(Vt);ngOnInit(){this.value.set(this.internalValue)}ngOnChanges(){this.value()!==this.internalValue&&(this.internalValue=this.value())}convert(){this.confirmService.prompt({message:'Ingrese el nombre para: "'+this.value()+'"',title:"Crear variable",promptRegex:/^[a-zA-Z0-9_ ]+$/,minPromptLength:3}).then(t=>{if(t.isOk&&this.ds.isComponentMode()){let e=this.ds.createField("image",this.value(),t.prompt);setTimeout(()=>this.variable.set(e.field),200)}})}onValueChange(){this.validateInput(),this.value.set(this.internalValue),this.valueChange.emit(this.internalValue),this.imageLoaded=!1}clearValue(){this.internalValue="",this.value.set(this.internalValue),this.valueChange.emit(""),this.error=!1,this.errorMessage="",this.imageLoaded=!1}handleImageError(){this.internalValue&&(this.error=!0,this.errorMessage="Failed to load image. Please check the URL.",this.imageLoaded=!1)}openImagePicker(){this.helperPanel.disableOutsideClick(),this.helperPanel.show(Ol,{},{title:"Seleccionar imagen"}).subscribe(t=>{t&&(this.internalValue=t,this.onValueChange(),this.helperPanel.close())})}validateInput(){if(this.error=!1,this.errorMessage="",!this.internalValue||this.internalValue.trim()===""){this.error=!0,this.errorMessage="Este campo es requerido";return}}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-image-field"]],inputs:{label:[1,"label"],value:[1,"value"],variable:[1,"variable"]},outputs:{valueChange:"valueChange",value:"valueChange",variable:"variableChange"},features:[we([Te({lucideLink2:lr})]),ns],decls:7,vars:4,consts:[["ngbDropdown","",1,"d-flex","gap-1"],[1,"image-field-container"],[3,"fullWidth","label","vars"],["id","error-message",1,"error-message"],["ngbDropdownToggle",""],["ngbDropdownMenu",""],["ngbDropdownItem","",3,"title"],["ngbDropdownItem","",3,"click"],[1,"dropdown-divider"],["ngbDropdownItem","",3,"click","title"],[1,"input-area","d-flex","align-items-center","gap-1"],["type","text","placeholder","https://example.com/image.jpg",1,"form-control","form-control-sm",3,"ngModelChange","keydown","ngModel"],["app-icon-button","","size","xs"],[1,"image-preview-container"],["alt","Image preview",1,"image-preview",3,"load","error","src"],[1,"placeholder"],["app-icon-button","","size","xs",3,"click"],["name","lucideLink2"],[3,"clear","fullWidth","label","vars"]],template:function(e,i){e&1&&(l(0,"div",0),D(1,T1,5,1),l(2,"label"),u(3),a()(),D(4,k1,9,13,"div",1)(5,O1,1,3,"app-view-vars",2),D(6,V1,2,1,"p",3)),e&2&&(c(),T(i.ds.canUseVariables()?1:-1),c(2),W(i.label()),c(),T(i.variable()==null?4:5),c(2),T(i.error?6:-1))},dependencies:[pe,Qe,Ne,at,Ke,ai,yi,vi,$i,Hi,gn,Cn,Je,he,Ge],styles:["label[_ngcontent-%COMP%]{color:var(--fuse-text-default);font-weight:700;line-height:1;margin-bottom:.25rem}","[_nghost-%COMP%]{--error: #ef4444;display:block}.image-field-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.image-preview-container[_ngcontent-%COMP%]{width:100%;height:40px;border-radius:8px;overflow:hidden}.image-preview[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.placeholder[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:.75rem}.input-area[_ngcontent-%COMP%]{width:100%}.input-container[_ngcontent-%COMP%]{position:relative;border-radius:4px;transition:all .2s}.input-container.error[_ngcontent-%COMP%]{border-color:var(--error)}.error-message[_ngcontent-%COMP%]{margin-top:.25rem;font-size:.75rem;color:var(--error)}"]})};var N1=["editor"];function A1(o,t){if(o&1){let e=M();l(0,"button",5),h("click",function(){let n=g(e).$implicit,r=d();return C(r.applyStyle(n.command))}),_(1,"ng-icon",9),a()}if(o&2){let e=t.$implicit;c(),f("name",e.icon)}}function j1(o,t){if(o&1){let e=M();l(0,"button",5),h("click",function(){let n=g(e).$implicit,r=d();return C(r.applyHeading(n.tag))}),u(1),a()}if(o&2){let e=t.$implicit;c(),Ie(" ",e.label," ")}}var yo=class o{initialValue=A("");editorElement;set value(t){this.initialValue()!=t&&(this._value=t,this.setEditorValue(t))}get value(){return this._value}valueChange=new q;_value="";textAlign="left";headings=[{tag:"p",label:"P"},{tag:"h1",label:"H1"},{tag:"h2",label:"H2"},{tag:"h3",label:"H3"},{tag:"h4",label:"H4"},{tag:"h5",label:"H5"}];styles=[{command:"bold",icon:"lucideBold"},{command:"italic",icon:"lucideItalic"},{command:"strikeThrough",icon:"lucideStrikethrough"}];alignments=[{value:"left",icon:"lucideAlignLeft"},{value:"center",icon:"lucideAlignCenter"},{value:"right",icon:"lucideAlignRight"},{value:"justify",icon:"lucideAlignJustify"}];ngAfterViewInit(){this.editorElement&&(this.editorElement.nativeElement.contentEditable="true",this.setEditorValue(this._value))}setEditorValue(t){this.editorElement?.nativeElement!=null&&(this.editorElement.nativeElement.innerHTML=t||"")}onInputChange(t){let e=t.target.innerHTML;this._value=e,e!==this.initialValue()&&(this.initialValue.set(e),this.valueChange.emit(e))}applyStyle(t){document.execCommand(t,!1),this.focusAndUpdate()}applyHeading(t){document.execCommand("formatBlock",!1,`<${t}>`),this.focusAndUpdate()}applyIndent(t){document.execCommand(t,!1),this.focusAndUpdate()}handlePaste(t){t.preventDefault();let n=(t.clipboardData?.getData("text/plain")||"").trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>");document.execCommand("insertHTML",!1,n),this.focusAndUpdate()}focusAndUpdate(){this.editorElement.nativeElement.focus(),this.onInputChange({target:this.editorElement.nativeElement})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-text-editor"]],viewQuery:function(e,i){if(e&1&&ut(N1,5),e&2){let n;ct(n=dt())&&(i.editorElement=n.first)}},inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[we([Te({lucideBold:ys,lucideItalic:Ns,lucideStrikethrough:Hs,lucideAlignLeft:ar,lucideAlignCenter:gs,lucideAlignRight:_s,lucideAlignJustify:Cs,lucideIndentIncrease:gu,lucideIndentDecrease:hu,lucideX:dr})])],decls:15,vars:2,consts:[["editor",""],[1,"editor-container"],[1,"actions"],[1,"d-flex","group-buttons"],["app-button","","size","xs"],["app-button","","size","xs",3,"click"],["name","lucideIndentIncrease","size","14"],["name","lucideIndentDecrease","size","14"],["contenteditable","true",1,"editor-content",3,"input","paste"],["size","14",3,"name"]],template:function(e,i){if(e&1){let n=M();l(0,"div",1)(1,"div",2)(2,"div",3),Y(3,A1,2,1,"button",4,de),a(),l(5,"div",3)(6,"button",5),h("click",function(){return g(n),C(i.applyIndent("indent"))}),_(7,"ng-icon",6),a(),l(8,"button",5),h("click",function(){return g(n),C(i.applyIndent("outdent"))}),_(9,"ng-icon",7),a()(),l(10,"div",3),Y(11,j1,2,1,"button",4,de),a()(),l(13,"div",8,0),h("input",function(s){return g(n),C(i.onInputChange(s))})("paste",function(s){return g(n),C(i.handlePaste(s))}),a()()}e&2&&(c(3),ee(i.styles),c(8),ee(i.headings),c(2),xt("text-align",i.textAlign))},dependencies:[pe,Je,he,Be],styles:[".group-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:nth-child(1){border-top-right-radius:0;border-bottom-right-radius:0}.group-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{border-top-left-radius:0;border-bottom-left-radius:0}.group-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(:first-child):not(:last-child){border-radius:0}.actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-bottom:.5rem;flex-wrap:wrap}.editor-container[_ngcontent-%COMP%]{overflow:hidden}.editor-content[_ngcontent-%COMP%]{min-height:6em;max-height:20em;overflow-y:auto;white-space:pre-wrap;line-height:1.2;padding:.5rem;border:1px solid var(--form-control-border);background-color:var(--fuse-bg-card-200);border-radius:.5rem}.editor-content[_ngcontent-%COMP%]:focus-visible{outline:none}.editor-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem}.editor-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem}.editor-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.75rem}.editor-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.5rem}.editor-content[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1.25rem}.editor-content[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:1rem}"]})};function R1(o,t){o&1&&_(0,"div",7)}function L1(o,t){if(o&1){let e=M();l(0,"button",6),h("click",function(){g(e);let n=d(2);return C(n.convert())}),u(1,"Convertir a variable"),a(),D(2,R1,1,0,"div",7)}if(o&2){let e=d(2);c(2),T(e.ds.dataHandler.paragraphVars().length>0?2:-1)}}function U1(o,t){if(o&1){let e=M();l(0,"button",8),h("click",function(){let n=g(e).$implicit,r=d(2);return C(r.variable.set(n.id))}),u(1),a()}if(o&2){let e=t.$implicit;f("title",e.name),c(),Ie(" ",e.name," ")}}function z1(o,t){if(o&1&&(_(0,"app-simple-button",3),l(1,"div",4),D(2,L1,3,1),Y(3,U1,2,2,"button",5,de),a()),o&2){let e=d();c(2),T(e.variable()==null?2:-1),c(),ee(e.ds.dataHandler.paragraphVars())}}function B1(o,t){if(o&1){let e=M();l(0,"app-text-editor",9),ne("valueChange",function(n){g(e);let r=d();return Z(r.value,n)||(r.value=n),C(n)}),a()}if(o&2){let e=d();ie("value",e.value)}}function W1(o,t){if(o&1){let e=M();l(0,"app-view-vars",10),h("clear",function(){g(e);let n=d();return C(n.variable.set(null))}),a()}if(o&2){let e=d();f("fullWidth",!0)("label",e.variable())("vars",e.ds.dataHandler.paragraphVars())}}var Nl=class o{ds=b(Ue);confirmService=b(li);label=le("label");value=nt("value");variable=nt(null);convert(){this.confirmService.prompt({message:"Ingrese el nombre para el p\xE1rrafo",title:"Crear variable",promptRegex:/^[a-zA-Z0-9_ ]+$/,minPromptLength:3}).then(t=>{if(t.isOk){let e=this.ds.createField("paragraph",this.value(),t.prompt);setTimeout(()=>this.variable.set(e.field),200)}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-paragraph-field"]],inputs:{label:[1,"label"],value:[1,"value"],variable:[1,"variable"]},outputs:{value:"valueChange",variable:"variableChange"},decls:6,vars:3,consts:[["ngbDropdown","",1,"d-flex","gap-1"],[3,"value"],[3,"fullWidth","label","vars"],["ngbDropdownToggle",""],["ngbDropdownMenu",""],["ngbDropdownItem","",3,"title"],["ngbDropdownItem","",3,"click"],[1,"dropdown-divider"],["ngbDropdownItem","",3,"click","title"],[3,"valueChange","value"],[3,"clear","fullWidth","label","vars"]],template:function(e,i){e&1&&(l(0,"div",0),D(1,z1,5,1),l(2,"label"),u(3),a()(),D(4,B1,1,1,"app-text-editor",1)(5,W1,1,3,"app-view-vars",2)),e&2&&(c(),T(i.ds.canUseVariables()?1:-1),c(2),W(i.label()),c(),T(i.variable()==null?4:5))},dependencies:[pe,yo,Ke,ai,yi,vi,$i,Hi,gn,Cn],styles:["label[_ngcontent-%COMP%]{color:var(--fuse-text-default);font-weight:700;line-height:1;margin-bottom:.25rem}","[_nghost-%COMP%]{display:flex;flex-direction:column}"]})};var $1=(o,t,e,i,n,r)=>({active:o,"size-sm":t,"size-md":e,"variant-primary":i,"variant-secondary":n,icon:r});function H1(o,t){if(o&1&&_(0,"i"),o&2){let e=d().$implicit;it(e.icon)}}function G1(o,t){if(o&1&&u(0),o&2){let e=d().$implicit;Ie(" ",e.label," ")}}function q1(o,t){if(o&1){let e=M();l(0,"button",1),h("click",function(){let n=g(e).$implicit,r=d();return C(r.value.set(n.value))}),D(1,H1,1,2,"i",2)(2,G1,1,1),a()}if(o&2){let e=t.$implicit,i=d();f("disabled",e.disabled===!0)("ngClass",wp(3,$1,i.value()===e.value,i.size()==="sm",i.size()==="md",i.variant()==="primary",i.variant()==="secondary",e.icon)),c(),T(e.icon?1:2)}}var Ln=class o{list=le([]);value=nt(null);size=le("md");variant=le("primary");static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-group-selector"]],inputs:{list:[1,"list"],value:[1,"value"],size:[1,"size"],variant:[1,"variant"]},outputs:{value:"valueChange"},decls:2,vars:0,consts:[["type","button",3,"disabled","ngClass"],["type","button",3,"click","disabled","ngClass"],[3,"class"]],template:function(e,i){e&1&&Y(0,q1,3,10,"button",0,de),e&2&&ee(i.list())},dependencies:[be],styles:["[_nghost-%COMP%]{display:flex;overflow:hidden;border-radius:.5rem;background-color:#ebebeb;justify-content:center;align-items:center;gap:.1rem;padding:1px}button[_ngcontent-%COMP%]{flex:1;padding:0 .25rem;background-color:#ebebeb;border:none;cursor:pointer;height:32px;font-size:.7rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}button.icon[_ngcontent-%COMP%]{flex:initial;font-size:1.25rem!important;width:32px}button.size-sm[_ngcontent-%COMP%]{height:24px;font-size:.7rem}button.size-md[_ngcontent-%COMP%]{height:34px;font-size:.75rem}button[_ngcontent-%COMP%]:disabled{cursor:default;opacity:.6;background-color:#ebebeb!important;color:inherit!important}button.active[_ngcontent-%COMP%], button[_ngcontent-%COMP%]:hover{border-radius:.5rem}button[_ngcontent-%COMP%]:not(:disabled):hover{background-color:var(--primary-hover);color:#fff}button[_ngcontent-%COMP%]:not(:disabled).active{background-color:var(--primary);color:#fff}button[_ngcontent-%COMP%]:not(:disabled):hover.variant-primary{background-color:var(--primary);color:#fff}button[_ngcontent-%COMP%]:not(:disabled):hover.variant-secondary{background-color:var(--bs-secondary);color:#fff}button[_ngcontent-%COMP%]:not(:disabled).active.variant-primary{background-color:var(--primary);color:#fff}button[_ngcontent-%COMP%]:not(:disabled).active.variant-secondary{background-color:var(--bs-secondary);color:#fff}"]})};function J1(o,t){if(o&1){let e=M();l(0,"app-group-selector",3),ne("valueChange",function(n){g(e);let r=d();return Z(r.value,n)||(r.value=n),C(n)}),a()}if(o&2){let e=d();ie("value",e.value),f("list",e.options())}}function X1(o,t){if(o&1&&(l(0,"option",6),u(1),a()),o&2){let e=t.$implicit;f("value",e.value),c(),W(e.label)}}function Z1(o,t){if(o&1){let e=M();l(0,"select",4),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.value,n)||(r.value=n),C(n)}),l(1,"option",5),u(2,"Selecciona una opci\xF3n"),a(),Y(3,X1,2,2,"option",6,de),a()}if(o&2){let e=d();ie("ngModel",e.value),c(3),ee(e.options())}}var Al=class o{options=le([]);label=le("Opciones");value=nt("");small=le(!1);static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-group-field"]],hostVars:4,hostBindings:function(e,i){e&2&&Ct("horizontal",i.small())("vertical",!i.small())},inputs:{options:[1,"options"],label:[1,"label"],value:[1,"value"],small:[1,"small"]},outputs:{value:"valueChange"},decls:5,vars:2,consts:[[1,"group-field-container"],["size","sm","variant","secondary",3,"value","list"],[1,"select-input","form-select-sm",3,"ngModel"],["size","sm","variant","secondary",3,"valueChange","value","list"],[1,"select-input","form-select-sm",3,"ngModelChange","ngModel"],["value","","disabled","","selected",""],[3,"value"]],template:function(e,i){e&1&&(l(0,"label"),u(1),a(),l(2,"div",0),D(3,J1,1,2,"app-group-selector",1)(4,Z1,5,1,"select",2),a()),e&2&&(c(),W(i.label()),c(2),T(i.options().length<=4?3:4))},dependencies:[pe,Ht,Gt,$t,Ne,at,Ln],styles:["label[_ngcontent-%COMP%]{color:var(--fuse-text-default);font-weight:700;line-height:1;margin-bottom:.25rem}","[_nghost-%COMP%]{display:flex;width:100%}.horizontal[_nghost-%COMP%]{flex-direction:row;align-items:center;display:grid;grid-template-columns:1fr 3fr;gap:.5rem}.horizontal[_nghost-%COMP%]   label[_ngcontent-%COMP%]{border:0}.vertical[_nghost-%COMP%]{flex-direction:column}.group-field-container[_ngcontent-%COMP%], .select-input[_ngcontent-%COMP%]{width:100%}"]})};function Q1(o,t){if(o&1){let e=M();l(0,"button",6),h("click",function(){g(e);let n=d(2);return C(n.convert())}),u(1,"Convertir a variable"),a(),_(2,"div",7)}}function K1(o,t){if(o&1){let e=M();l(0,"button",8),h("click",function(){let n=g(e).$implicit,r=d(2);return C(r.variable.set(n.id))}),u(1),a()}if(o&2){let e=t.$implicit;f("title",e.name),c(),Ie(" ",e.name," ")}}function Y1(o,t){if(o&1&&(_(0,"app-simple-button",3),l(1,"div",4),D(2,Q1,3,0),Y(3,K1,2,2,"button",5,de),a()),o&2){let e=d();c(2),T(e.variable()==null?2:-1),c(),ee(e.ds.dataHandler.textVars())}}function ey(o,t){if(o&1){let e=M();l(0,"input",9),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.value,n)||(r.value=n),C(n)}),a()}if(o&2){let e=d();ie("ngModel",e.value),f("placeholder","Ingrese "+e.field.label.toLowerCase())}}function ty(o,t){if(o&1){let e=M();l(0,"app-view-vars",10),h("clear",function(){g(e);let n=d();return C(n.variable.set(null))}),a()}if(o&2){let e=d();f("fullWidth",!0)("label",e.variable())("vars",e.ds.dataHandler.textVars())}}var jl=class o{ds=b(Ue);confirmService=b(li);value=nt("");variable=nt(null);field;errorMessage=ce(()=>this.validateInput());validateInput(){return!this.field.optional&&(!this.value||this.value().trim()==="")?"Campo requerido":""}convert(){this.confirmService.prompt({message:'Ingrese el nombre para: "'+this.value()+'"',title:"Crear variable",promptRegex:/^[a-zA-Z0-9_ ]+$/,minPromptLength:5}).then(t=>{if(t.isOk&&this.ds.isComponentMode()){let e=this.ds.createField("text",this.value(),t.prompt);setTimeout(()=>this.variable.set(e.field),200)}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-text-field"]],inputs:{value:[1,"value"],variable:[1,"variable"],field:"field"},outputs:{value:"valueChange",variable:"variableChange"},decls:6,vars:3,consts:[["ngbDropdown","",1,"d-flex","gap-1"],[1,"form-control","form-control-sm","text-edit",3,"ngModel","placeholder"],[3,"fullWidth","label","vars"],["ngbDropdownToggle",""],["ngbDropdownMenu",""],["ngbDropdownItem","",3,"title"],["ngbDropdownItem","",3,"click"],[1,"dropdown-divider"],["ngbDropdownItem","",3,"click","title"],[1,"form-control","form-control-sm","text-edit",3,"ngModelChange","ngModel","placeholder"],[3,"clear","fullWidth","label","vars"]],template:function(e,i){e&1&&(l(0,"div",0),D(1,Y1,5,1),l(2,"label"),u(3),a()(),D(4,ey,1,2,"input",1)(5,ty,1,3,"app-view-vars",2)),e&2&&(c(),T(i.ds.canUseVariables()?1:-1),c(2),W(i.field.label),c(),T(i.variable()==null?4:5))},dependencies:[pe,Qe,Ne,at,Ke,ai,yi,vi,$i,Hi,he,gn,Cn],styles:["label[_ngcontent-%COMP%]{color:var(--fuse-text-default);font-weight:700;line-height:1;margin-bottom:.25rem}","[_nghost-%COMP%]{display:flex;flex-direction:column}.error-message[_ngcontent-%COMP%]{color:var(--error);font-size:.75rem;margin-top:.25rem}.input-group[_ngcontent-%COMP%]{display:flex;gap:.5rem}.input-group[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{flex:1}"]})};var Rl=class o{value=nt("#000000");label="";static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-color-field"]],inputs:{value:[1,"value"],label:"label"},outputs:{value:"valueChange"},features:[we([Te({lucideEyeOff:Is})])],decls:3,vars:2,consts:[[1,"m-0"],[3,"colorChange","color"]],template:function(e,i){e&1&&(l(0,"label",0),u(1),a(),l(2,"app-color-picker",1),ne("colorChange",function(r){return Z(i.value,r)||(i.value=r),r}),a()),e&2&&(c(),W(i.label),c(),ie("color",i.value))},dependencies:[pe,An],styles:["label[_ngcontent-%COMP%]{color:var(--fuse-text-default);font-weight:700;line-height:1;margin-bottom:.25rem}","[_nghost-%COMP%]{display:flex;gap:1rem;align-items:center;justify-content:space-between}"]})};var Fr=class o{value=nt(!1);label=le("");targetOptions=[{label:"NO",value:!1},{label:"SI",value:!0}];static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-bool-field"]],inputs:{value:[1,"value"],label:[1,"label"]},outputs:{value:"valueChange"},decls:4,vars:3,consts:[[1,"d-flex","align-items-center","gap-2","w-100","justify-content-between"],[1,"mb-0"],["size","sm",2,"min-width","80px",3,"valueChange","list","value"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"label",1),u(2),a(),l(3,"app-group-selector",2),ne("valueChange",function(r){return Z(i.value,r)||(i.value=r),r}),a()()),e&2&&(c(2),W(i.label()),c(),f("list",i.targetOptions),ie("value",i.value))},dependencies:[Ln],styles:["label[_ngcontent-%COMP%]{color:var(--fuse-text-default);font-weight:700;line-height:1;margin-bottom:.25rem}"]})};var Ll=class o{value=nt(0);label=le("N\xFAmero");static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-number-field"]],inputs:{value:[1,"value"],label:[1,"label"]},outputs:{value:"valueChange"},decls:3,vars:4,consts:[[1,"m-0"],[3,"valueChange","value","placeholder"]],template:function(e,i){e&1&&(l(0,"label",0),u(1),a(),l(2,"app-number",1),ne("valueChange",function(r){return Z(i.value,r)||(i.value=r),r}),a()),e&2&&(c(),W(i.label()),c(),f("placeholder",lt(i.label())),ie("value",i.value))},dependencies:[pe,he,un],styles:["label[_ngcontent-%COMP%]{color:var(--fuse-text-default);font-weight:700;line-height:1;margin-bottom:.25rem}"]})};var Un=class o{navigationForms=A([]);currentElementId$=new ki(void 0);addNavigationForm(t){this.navigationForms.update(e=>[...e,t])}removeLastNavigationForm(){this.navigationForms.update(t=>(t.pop(),t))}resetNavigationForms(){this.navigationForms.set([])}setCurrentElementId(t){this.currentElementId$.next(t)}getCurrentElementId=this.currentElementId$.asObservable();static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var Ul=class o{value=nt("0px");label=le("N\xFAmero");static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-unit-field"]],inputs:{value:[1,"value"],label:[1,"label"]},outputs:{value:"valueChange"},decls:3,vars:2,consts:[[3,"valueChange","value"]],template:function(e,i){e&1&&(l(0,"label"),u(1),a(),l(2,"app-unit-selector",0),ne("valueChange",function(r){return Z(i.value,r)||(i.value=r),r}),a()),e&2&&(c(),W(i.label()),c(),ie("value",i.value))},dependencies:[pe,ei],styles:["label[_ngcontent-%COMP%]{color:var(--fuse-text-default);font-weight:700;line-height:1;margin-bottom:.25rem}","[_nghost-%COMP%]{display:flex;flex-direction:column}"],changeDetection:0})};function iy(o,t){if(o&1){let e=M();l(0,"input",2),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.value,n)||(r.value=n),C(n)}),h("keydown",function(n){g(e);let r=d();return C(r.onKeyDown(n))}),a()}if(o&2){let e=d();ie("ngModel",e.value),f("placeholder",e.placeholder())}}function ny(o,t){o&1&&(l(0,"i"),u(1,"Variable no existe"),a())}function oy(o,t){if(o&1&&u(0),o&2){let e,i=d(2);Ie(" ",(e=i.variable())==null?null:e.name," ")}}function ry(o,t){if(o&1){let e=M();l(0,"div",1)(1,"span"),u(2," [v] "),D(3,ny,2,0,"i")(4,oy,1,1),a(),l(5,"i",3),h("click",function(){g(e);let n=d();return C(n.clearValue())}),a()()}if(o&2){let e=d();c(3),T(e.variable()==null?3:4)}}var zl=class o{designerService=b(Ue);value=nt("");variable=ce(()=>this.designerService.computeVariable(this.value()));placeholder=le("");clearValue(){this.value.set(this.variable()?.value??"")}onKeyDown(t){t.stopPropagation()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["input-vars"]],inputs:{value:[1,"value"],placeholder:[1,"placeholder"]},outputs:{value:"valueChange"},decls:2,vars:1,consts:[["type","text",1,"form-control","form-control-sm","text-edit",3,"ngModel","placeholder"],["tabindex","0",1,"variable-container"],["type","text",1,"form-control","form-control-sm","text-edit",3,"ngModelChange","keydown","ngModel","placeholder"],["role","button","title","Eliminar variable",1,"bi","bi-x-circle-fill","remove-icon",3,"click"]],template:function(e,i){e&1&&D(0,iy,1,2,"input",0)(1,ry,6,1,"div",1),e&2&&T(0)},dependencies:[pe,Qe,Ne,at],styles:["[_nghost-%COMP%]{display:inline-flex}.variable-container[_ngcontent-%COMP%]{display:flex;gap:.5rem;padding:.25rem .5rem;background-color:#d7edff;border-radius:4px;max-width:100%;justify-content:space-between;align-items:center;width:100%;-webkit-user-select:none;user-select:none;font-size:.8rem;color:#1a2327;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.variable-container[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 1px var(--primary)}.remove-icon[_ngcontent-%COMP%]{color:#dc3545;font-size:.875rem;cursor:pointer;line-height:1}.remove-icon[_ngcontent-%COMP%]:hover{color:#c82333}"],changeDetection:0})};function ay(o,t){if(o&1){let e=M();l(0,"button",5),h("click",function(){g(e);let n=d();return C(n.openPanel())}),_(1,"i",6),a()}}var kr=class o{formsService=b(Un);designerService=b(Ue);panelService=b(Vt);variablesPage=this.designerService.dataHandler.pageVars;url=A("#");target=A("_self");enabled=A(!0);enableCheck=!1;label="Modo de enlace";set value(t){this.url.set(t.url||"#"),this.target.set(t.target||"_self")}valueChange=new q;targetOptions=[{label:"NO",value:"_self"},{label:"SI",value:"_blank"}];openPanel(){}updateTarget(t){this.target.set(t),this.emitValue()}toggleEnabled(t){this.enabled.set(t),this.emitValue()}emitValue(){let t={url:this.url(),target:this.target()};this.valueChange.emit(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-link-input"]],inputs:{enableCheck:"enableCheck",label:"label",value:"value"},outputs:{valueChange:"valueChange"},decls:7,vars:4,consts:[[1,"d-flex","align-items-center","justify-content-between","gap-2"],[1,"w-100",3,"valueChange","value"],["app-icon-button","","size","xs","type","button"],[1,"label"],["size","sm",2,"min-width","80px",3,"valueChange","list","value"],["app-icon-button","","size","xs","type","button",3,"click"],[1,"bi-three-dots-vertical"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"input-vars",1),ne("valueChange",function(r){return Z(i.url,r)||(i.url=r),r}),h("valueChange",function(){return i.emitValue()}),a(),D(2,ay,2,0,"button",2),a(),l(3,"div",0)(4,"label",3),u(5,"Nueva pesta\xF1a"),a(),l(6,"app-group-selector",4),ne("valueChange",function(r){return Z(i.target,r)||(i.target=r),r}),a()()),e&2&&(c(),ie("value",i.url),c(),T(i.variablesPage().length>0?2:-1),c(4),f("list",i.targetOptions),ie("value",i.target))},dependencies:[pe,Ke,Ln,zl,he,Ge],styles:["label[_ngcontent-%COMP%]{color:var(--fuse-text-default);font-weight:700;line-height:1;margin-bottom:.25rem}","[_nghost-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-check-input[_ngcontent-%COMP%]{cursor:pointer;width:3em}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#0d6efd;border-color:#0d6efd}.dropdown-menu[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto}.label[_ngcontent-%COMP%]{font-weight:400}.input-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;width:100%}.input-group[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{flex:1}"]})};function sy(o,t){o&1&&_(0,"div",3)}function ly(o,t){if(o&1){let e=M();l(0,"div",15),h("click",function(){g(e);let n=d().$implicit,r=d();return C(r.selectCategory(n.name))}),l(1,"span"),u(2),a(),l(3,"span",16),u(4),a()()}if(o&2){let e=d().$implicit,i=d();Ct("bg-light",i.selectedCategory===e.name),c(2),W(e.name),c(2),W(e.filteredCount)}}function cy(o,t){if(o&1&&D(0,ly,5,4,"div",14),o&2){let e=t.$implicit;T(e.filteredCount!=0||e.name==="Todos"?0:-1)}}function dy(o,t){o&1&&(l(0,"div",7),u(1,"No se encontraron iconos"),a())}function my(o,t){if(o&1){let e=M();l(0,"button",17),h("click",function(){let n=g(e).$implicit,r=d();return C(r.selectedIcon=n.name)})("dblclick",function(){let n=g(e).$implicit,r=d();return C(r.modalService.ok(n.name))}),_(1,"i"),a()}if(o&2){let e=t.$implicit,i=d();Ct("selected",i.selectedIcon===e.name),c(),it(e.name)}}function py(o,t){if(o&1){let e=M();l(0,"div",10)(1,"button",18),h("click",function(){g(e);let n=d();return C(n.page=n.page-1)}),_(2,"i",19),a(),l(3,"span"),u(4),a(),l(5,"button",18),h("click",function(){g(e);let n=d();return C(n.page=n.page+1)}),_(6,"i",20),a()()}if(o&2){let e=d();c(),f("disabled",e.page===1),c(3),ca("",e.page,"/",e.Math.ceil(e.filtered().length/120)),c(),f("disabled",e.page>=e.Math.ceil(e.filtered().length/120))}}var Or=class o{selectedIcon="bi bi-house";modalService=b(St);loading=A(!0);searchTerm="";selectedCategory=null;page=1;Math=Math;all=A([]);filtered=A([]);categories=A([]);get icons(){let t=(this.page-1)*120;return this.filtered().slice(t,t+120)}constructor(){fetch("assets/json/icons.bootstrap.json").then(t=>t.json()).then(t=>{let e=t.map(n=>re(k({},n),{name:"bi-"+n.name}));this.all.set(e),this.filtered.set(e);let i=new Map;i.set("Todos",e.length),e.forEach(n=>i.set(n.category,(i.get(n.category)||0)+1)),this.categories.set([...i].map(([n,r])=>({name:n,count:r,filteredCount:r})).sort((n,r)=>n.name==="Todos"?-1:r.name==="Todos"?1:n.name.localeCompare(r.name)))}).catch(console.error).finally(()=>this.loading.set(!1))}onSearch(t){this.page=1,this.updateFilters(t,this.selectedCategory)}selectCategory(t){this.page=1,this.selectedCategory=this.selectedCategory===t?null:t,this.updateFilters(this.searchTerm,this.selectedCategory)}normalizeText(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s]/g,"")}updateFilters(t,e){let i=this.normalizeText(t),n=t?this.all().filter(r=>{let s=this.normalizeText(r.name),m=this.normalizeText(r.tags);return s.includes(i)||m.includes(i)}):this.all();this.categories.update(r=>r.map(s=>re(k({},s),{filteredCount:s.name==="Todos"?n.length:n.filter(m=>m.category===s.name).length}))),this.filtered.set(e&&e!=="Todos"?n.filter(r=>r.category===e):n)}ngAfterViewInit(){document.getElementById("icon-search")?.focus()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-icon-select-modal"]],inputs:{selectedIcon:"selectedIcon"},decls:19,vars:7,consts:[[1,"icon-select-modal"],["type","text","placeholder","Buscar icono","id","icon-search",1,"form-control","mb-3",3,"ngModelChange","ngModel"],[2,"font-size","2rem"],[1,"spinner-border","text-primary","m-auto","d-block"],[1,"d-flex","gap-4",2,"height","600px"],[1,"categories","border-end","pe-2",2,"width","200px","overflow-y","auto"],[1,"flex-grow-1","overflow-auto","pe-3"],[1,"text-center"],[1,"d-grid","gap-2",2,"grid-template-columns","repeat(auto-fit, minmax(50px, 1fr))"],[1,"btn-item","btn","p-0","d-flex","align-items-center","justify-content-center",2,"height","50px",3,"selected"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"d-flex","justify-content-end","gap-2","mt-3"],["app-button","","variant","outline","color","secondary",3,"click"],["app-button","",3,"click"],[1,"d-flex","justify-content-between","p-2","rounded","mb-1","cursor-pointer",3,"bg-light"],[1,"d-flex","justify-content-between","p-2","rounded","mb-1","cursor-pointer",3,"click"],[1,"badge","bg-secondary","rounded-pill","d-flex","align-items-center"],[1,"btn-item","btn","p-0","d-flex","align-items-center","justify-content-center",2,"height","50px",3,"click","dblclick"],[1,"btn","btn-sm","btn-outline-secondary",3,"click","disabled"],[1,"bi-chevron-left"],[1,"bi-chevron-right"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"input",1),ne("ngModelChange",function(r){return Z(i.searchTerm,r)||(i.searchTerm=r),r}),h("ngModelChange",function(r){return i.onSearch(r)}),a(),_(2,"i",2),D(3,sy,1,0,"div",3),l(4,"div",4)(5,"div",5),Y(6,cy,1,1,null,null,de),a(),l(8,"div",6),D(9,dy,2,0,"div",7),l(10,"div",8),Y(11,my,2,4,"button",9,bn),a(),D(13,py,7,4,"div",10),a()(),l(14,"div",11)(15,"button",12),h("click",function(){return i.modalService.close()}),u(16,"Cerrar"),a(),l(17,"button",13),h("click",function(){return i.modalService.ok(i.selectedIcon)}),u(18,"Seleccionar"),a()()()),e&2&&(c(),ie("ngModel",i.searchTerm),c(),it(Re("d-block text-center mb-3 ",i.selectedIcon||"bi bi-house")),c(),T(i.loading()?3:-1),c(3),ee(i.categories()),c(3),T(!i.loading()&&!i.icons.length?9:-1),c(2),ee(i.icons),c(2),T(i.icons.length?13:-1))},dependencies:[pe,Qe,Ne,at,he,Be],styles:[".selected[_ngcontent-%COMP%]{background-color:#e7f1ff;border-color:#0d6efd!important}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.cursor-pointer[_ngcontent-%COMP%]:hover{background-color:var(--fuse-bg-card-accent)}.btn-item[_ngcontent-%COMP%]{background-color:var(--fuse-bg-card-accent);color:var(--fuse-text-default)}"]})};function uy(o,t){o&1&&_(0,"div",8)}function fy(o,t){if(o&1){let e=M();l(0,"button",7),h("click",function(){g(e);let n=d(2);return C(n.convert())}),u(1,"Convertir a variable"),a(),D(2,uy,1,0,"div",8)}if(o&2){let e=d(2);c(2),T(e.ds.dataHandler.iconVars().length>0?2:-1)}}function hy(o,t){if(o&1){let e=M();l(0,"button",9),h("click",function(){let n=g(e).$implicit,r=d(2);return C(r.variable.set(n.id))}),u(1),a()}if(o&2){let e=t.$implicit;f("title",e.name),c(),Ie(" ",e.name," ")}}function gy(o,t){if(o&1&&(_(0,"app-simple-button",4),l(1,"div",5),D(2,fy,3,1),Y(3,hy,2,2,"button",6,de),a()),o&2){let e=d();c(2),T(e.variable()==null?2:-1),c(),ee(e.ds.dataHandler.iconVars())}}function Cy(o,t){if(o&1){let e=M();l(0,"button",10),h("click",function(){g(e);let n=d();return C(n.openIconModal())}),_(1,"i"),l(2,"span"),u(3),a()()}if(o&2){let e=d();c(),it(e.value()),c(2),W(e.value())}}function _y(o,t){if(o&1){let e=M();l(0,"app-view-vars",11),h("clear",function(){g(e);let n=d();return C(n.variable.set(null))}),a()}if(o&2){let e=d();f("isIcon",!0)("label",e.variable())("vars",e.ds.dataHandler.iconVars())}}var Ih="bi bi-house",Vr=class o{confirmService=b(li);modalService=b(St);ds=b(Ue);label=le("Icono");valueChange=Oe();value=le(Ih,{transform:t=>typeof t!="string"?Ih:t});variable=nt(null);convert(){this.confirmService.prompt({message:'Ingrese el nombre para: "'+this.value()+'"',title:"Crear variable",promptRegex:/^[a-zA-Z0-9_ ]+$/,minPromptLength:3}).then(t=>{if(t.isOk){let e=this.ds.createField("icon",this.value(),t.prompt);setTimeout(()=>this.variable.set(e.field),200)}})}openIconModal(){this.modalService.open(Or,{title:"Seleccionar Icono",hiddenButtons:!0,params:{selectedIcon:this.value()},size:"900px"}).result().then(e=>{e.isOk&&this.valueChange.emit(e.data)})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-icon-select-field"]],inputs:{label:[1,"label"],value:[1,"value"],variable:[1,"variable"]},outputs:{valueChange:"valueChange",variable:"variableChange"},decls:6,vars:3,consts:[["ngbDropdown","",1,"d-flex","gap-1"],[1,"m-0"],["app-button","","size","sm"],[3,"isIcon","label","vars"],["ngbDropdownToggle",""],["ngbDropdownMenu",""],["ngbDropdownItem","",3,"title"],["ngbDropdownItem","",3,"click"],[1,"dropdown-divider"],["ngbDropdownItem","",3,"click","title"],["app-button","","size","sm",3,"click"],[3,"clear","isIcon","label","vars"]],template:function(e,i){e&1&&(l(0,"div",0),D(1,gy,5,1),l(2,"label",1),u(3),a()(),D(4,Cy,4,3,"button",2)(5,_y,1,3,"app-view-vars",3)),e&2&&(c(),T(i.ds.isComponentMode()?1:-1),c(2),W(i.label()),c(),T(i.variable()==null?4:5))},dependencies:[pe,he,Be,gn,Ke,ai,yi,vi,$i,Hi,Cn],styles:["label[_ngcontent-%COMP%]{color:var(--fuse-text-default);font-weight:700;line-height:1;margin-bottom:.25rem}","[_nghost-%COMP%]{display:flex;justify-content:space-between;align-items:center}"],changeDetection:0})};var Dh=o=>({active:o});function vy(o,t){if(o&1){let e=M();l(0,"button",2),h("click",function(){g(e);let n=d();return C(n.handle("create"))}),u(1,"Crea variable"),a()}}function yy(o,t){o&1&&(l(0,"label"),u(1,"Lista p\xE1ginas CMS"),a())}function by(o,t){if(o&1){let e=M();l(0,"p",3),h("click",function(){let n=g(e).$implicit,r=d();return C(r.handle("select",n.id))}),_(1,"i",4),l(2,"span"),u(3),a()()}if(o&2){let e,i=t.$implicit,n=d();f("ngClass",te(2,Dh,i.value==((e=n.variable())==null?null:e.value))),c(3),Ie(" /",i.name)}}function xy(o,t){if(o&1){let e=M();l(0,"p",3),h("click",function(){let n=g(e).$implicit,r=d();return C(r.handle("select",n.id))}),_(1,"i",4),l(2,"span"),u(3),a()()}if(o&2){let e,i=t.$implicit,n=d();f("ngClass",te(2,Dh,i.value==((e=n.variable())==null?null:e.value))),c(3),Ie(" /",i.name)}}var Bl=class o{panelOptions=b(Vt);ds=b(Ue);variables=A([]);slug=ce(()=>this.variables().filter(t=>t.type=="slug"));pages=ce(()=>this.variables().filter(t=>t.type=="link2"));currentUrl=A(null);variable=ce(()=>this.ds.dataHandler.computeVariable(this.currentUrl()));set variablesPage(t){this.variables.set(t)}set currentPage(t){this.currentUrl.set(t)}handle(t,e){this.panelOptions.ok({action:t,id:e})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-panel-links"]],decls:10,vars:2,consts:[["app-button","","color","light","size","sm",1,"w-100"],[3,"ngClass"],["app-button","","color","light","size","sm",1,"w-100",3,"click"],[3,"click","ngClass"],[1,"bi","bi-browser-edge"]],template:function(e,i){e&1&&(D(0,vy,2,0,"button",0),l(1,"div"),D(2,yy,2,0,"label"),Y(3,by,4,4,"p",1,de),a(),l(5,"div")(6,"label"),u(7,"Lista de p\xE1ginas"),a(),Y(8,xy,4,4,"p",1,de),a()),e&2&&(T(i.ds.isComponentMode()?0:-1),c(2),T(i.slug().length>0?2:-1),c(),ee(i.slug()),c(5),ee(i.pages()))},dependencies:[be,he,Be],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:8px}p[_ngcontent-%COMP%]{display:flex;padding:4px 8px;border-radius:4px;white-space:nowrap;cursor:pointer;gap:8px}p[_ngcontent-%COMP%]:hover, p.active[_ngcontent-%COMP%]{background-color:var(--primary)}label[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600;padding:4px 4px 4px 1rem;display:block}"]})};function wy(o,t){if(o&1){let e=M();l(0,"input",4),h("ngModelChange",function(n){g(e);let r=d();return C(r.valueChange.emit(n))}),a()}if(o&2){let e=d();f("ngModel",e.url())}}function Sy(o,t){if(o&1){let e=M();l(0,"app-view-vars",5),h("clear",function(){g(e);let n=d();return C(n.variable.set(null))}),a()}if(o&2){let e=d();f("fullWidth",!0)("label",e.variable())("vars",e.ds.dataHandler.pageVars())}}var Nr=class o{formsService=b(Un);ds=b(Ue);helperPanel=b(Vt);variable=nt(null);confirmService=b(li);url=A("#");label="Modo de enlace";set value(t){this.url.set(typeof t=="string"&&t||"#")}valueChange=Oe();openPanel(){this.helperPanel.show(Bl,{variablesPage:this.ds.dataHandler.pageVars(),currentPage:this.variable()},{title:"Seleccionar p\xE1gina"}).subscribe(t=>{this.helperPanel.close(),t.action==="create"&&this.confirmService.prompt({message:'Ingrese el nombre para: "'+this.url()+'"',title:"Crear variable",promptRegex:/^[a-zA-Z0-9_ ]+$/,minPromptLength:3}).then(e=>{if(e.isOk&&this.ds.isComponentMode()){let i=this.ds.createField("link2",this.url(),e.prompt);setTimeout(()=>this.variable.set(i.field),200)}}),t.action==="select"&&t.id&&this.variable.set(t.id)})}emitValue(){this.valueChange.emit(this.url())}ngOnDestroy(){this.helperPanel.close()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-link2-field"]],inputs:{variable:[1,"variable"],label:"label",value:"value"},outputs:{variable:"variableChange",valueChange:"valueChange"},decls:6,vars:2,consts:[[1,"d-flex","gap-1"],[3,"click"],["placeholder","Ingrese url",1,"form-control","form-control-sm","text-edit",3,"ngModel"],[3,"fullWidth","label","vars"],["placeholder","Ingrese url",1,"form-control","form-control-sm","text-edit",3,"ngModelChange","ngModel"],[3,"clear","fullWidth","label","vars"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"app-simple-button",1),h("click",function(){return i.openPanel()}),a(),l(2,"label"),u(3),a()(),D(4,wy,1,1,"input",2)(5,Sy,1,3,"app-view-vars",3)),e&2&&(c(3),Ie(" ",i.label," "),c(),T(i.variable()==null?4:5))},dependencies:[pe,Qe,Ne,at,Ke,he,gn,Cn],styles:["label[_ngcontent-%COMP%]{color:var(--fuse-text-default);font-weight:700;line-height:1;margin-bottom:.25rem}","[_nghost-%COMP%]{display:grid;align-items:center;grid-template-columns:1fr 3fr;gap:.5rem}label[_ngcontent-%COMP%]{margin:0}"]})};var Th=()=>["__link","_tLink"],am=()=>[];function Ey(o,t){if(o&1){let e=M();l(0,"div",1)(1,"button",3),h("click",function(){g(e);let n=d(2);return C(n.cancel.emit())}),_(2,"ng-icon",4),l(3,"span"),u(4,"Regresar"),a()()()}if(o&2){let e=d(2);c(2),f("name",e.isSubForm?"lucideArrowLeft":"lucideX")}}function Py(o,t){if(o&1){let e=M();l(0,"app-link2-field",8),h("variableChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.variableChange.emit({field:r.field,value:n}))}),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("variable",i.vars()[e.field]),ie("value",i.fieldValues()[e.field])}}function My(o,t){if(o&1){let e=M();l(0,"app-group-field",9),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("options",e.options??Xi(4,am))("label",e.label),ie("value",i.fieldValues()[e.field]),f("small",!0)}}function Iy(o,t){if(o&1&&(l(0,"div",5),D(1,Py,1,2,"app-link2-field",6)(2,My,1,5,"app-group-field",7),a()),o&2){let e,i=d().$implicit;c(),T((e=i.type)==="link2"?1:e==="group"?2:-1)}}function Dy(o,t){if(o&1&&D(0,Iy,3,1,"div",5),o&2){let e=t.$implicit,i=d(2);T(e.visible!=!1&&Xi(1,Th).includes(e.field)&&i.modeLink()?0:-1)}}function Ty(o,t){if(o&1){let e=M();l(0,"app-text-field",15),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))})("variableChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.variableChange.emit({field:r.field,value:n}))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("field",e)("value",i.fieldValues()[e.field])("variable",i.vars()[e.field])}}function Fy(o,t){if(o&1){let e=M();l(0,"app-number-field",16),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("label",e.label),ie("value",i.fieldValues()[e.field])}}function ky(o,t){if(o&1){let e=M();l(0,"app-paragraph-field",17),h("variableChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.variableChange.emit({field:r.field,value:n}))}),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("label",e.label)("variable",i.vars()[e.field]),ie("value",i.fieldValues()[e.field])}}function Oy(o,t){if(o&1){let e=M();l(0,"app-group-field",18),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("options",e.options??Xi(3,am))("label",e.label),ie("value",i.fieldValues()[e.field])}}function Vy(o,t){if(o&1){let e=M();l(0,"app-image-field",17),h("variableChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.variableChange.emit({field:r.field,value:n}))}),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("label",e.label)("variable",i.vars()[e.field]),ie("value",i.fieldValues()[e.field])}}function Ny(o,t){if(o&1){let e=M();l(0,"app-color-field",16),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("label",e.label),ie("value",i.fieldValues()[e.field])}}function Ay(o,t){if(o&1){let e=M();l(0,"app-bool-field",16),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("label",e.label),ie("value",i.fieldValues()[e.field])}}function jy(o,t){if(o&1){let e=M();l(0,"app-icon-select-field",17),h("variableChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.variableChange.emit({field:r.field,value:n}))}),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("label",e.label)("variable",i.vars()[e.field]),ie("value",i.fieldValues()[e.field])}}function Ry(o,t){if(o&1){let e=M();l(0,"app-link-input",16),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("label",e.label),ie("value",i.fieldValues()[e.field])}}function Ly(o,t){if(o&1){let e=M();l(0,"app-link2-field",17),h("variableChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.variableChange.emit({field:r.field,value:n}))}),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("label",e.label)("variable",i.vars()[e.field]),ie("value",i.fieldValues()[e.field])}}function Uy(o,t){if(o&1){let e=M();l(0,"app-unit-field",16),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("label",e.label),ie("value",i.fieldValues()[e.field])}}function zy(o,t){if(o&1){let e=M();l(0,"app-array-field",19),ne("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return Z(s.fieldValues()[r.field],n)||(s.fieldValues()[r.field]=n),C(n)}),h("index",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.openForm(n,r))})("valueChange",function(n){g(e);let r=d(2).$implicit,s=d(2);return C(s.onChangeField(n,r.field,r.type))}),a()}if(o&2){let e=d(2).$implicit,i=d(2);f("field",e),ie("value",i.fieldValues()[e.field])}}function By(o,t){if(o&1&&(l(0,"div",5),D(1,Ty,1,3,"app-text-field",10)(2,Fy,1,2,"app-number-field",11)(3,ky,1,3,"app-paragraph-field",12)(4,Oy,1,4,"app-group-field",13)(5,Vy,1,3,"app-image-field",12)(6,Ny,1,2,"app-color-field",11)(7,Ay,1,2,"app-bool-field",11)(8,jy,1,3,"app-icon-select-field",12)(9,Ry,1,2,"app-link-input",11)(10,Ly,1,3,"app-link2-field",12)(11,Uy,1,2,"app-unit-field",11)(12,zy,1,2,"app-array-field",14),a()),o&2){let e,i=d().$implicit;c(),T((e=i.type)==="text"?1:e==="number"?2:e==="paragraph"?3:e==="group"?4:e==="image"?5:e==="color"?6:e==="bool"?7:e==="icon"?8:e==="link"?9:e==="link2"?10:e==="units"?11:e==="array"?12:-1)}}function Wy(o,t){if(o&1&&D(0,By,13,1,"div",5),o&2){let e=t.$implicit;T(e.visible!=!1&&!Xi(1,Th).includes(e.field)?0:-1)}}function $y(o,t){if(o&1&&(D(0,Ey,5,1,"div",1),l(1,"div",2),Y(2,Dy,1,2,null,null,de),Y(4,Wy,1,2,null,null,de),a()),o&2){let e=d();T(e.isSubForm?0:-1),c(2),ee(e.form),c(2),ee(e.form)}}function Hy(o,t){if(o&1){let e=M();l(0,"app-dynamic-form",20),h("formSubmit",function(n){g(e);let r=d();return C(r.internalSubmit(n))})("cancel",function(){g(e);let n=d();return C(n.closeForm())}),a()}if(o&2){let e,i=d();f("form",((e=i.selectedListForm())==null||e.fieldConfig==null?null:e.fieldConfig.formFields)||Xi(4,am))("value",i.fieldValues()[i.selectedListForm().fieldConfig.field][i.selectedListForm().index])("isSubForm",!0)("name",i.selectedListForm().fieldConfig.label+" - ["+(i.selectedListForm().index+1)+"]")}}var Wl=class o{modeLink=le(!1);vars=le({});form=[];set value(t){this.setDefaultValues(t)}formSubmit=new q;cancel=new q;fieldChange=new q;variableChange=Oe();name=le("root");isSubForm=!1;enableLog=!1;selectedListForm=A(null);fieldValues=A({});dinamicFormService=b(Un);ngOnInit(){this.dinamicFormService.addNavigationForm(this.name())}subs=[];constructor(){let t=this.dinamicFormService.getCurrentElementId.pipe(ap()).subscribe(([e,i])=>{e!=i&&this.selectedListForm.set(null)});this.subs.push(t)}closeForm(){this.selectedListForm.set(null)}setDefaultValues(t){this.fieldValues.set({});let e=t||{};this.form.forEach(i=>{e[i.field]==null?i.type==="array"?this.fieldValues()[i.field]=[]:this.fieldValues()[i.field]=i.default:this.fieldValues()[i.field]=e[i.field]})}onSubmit(){this.formSubmit.emit(this.fieldValues())}internalSubmit(t){if(Object.keys(this.fieldValues()).length==0)return;let i=this.selectedListForm().fieldConfig.field,n=this.selectedListForm().index,r=Ee(this.fieldValues()[i]);r[n]=t,this.onChangeField(r,i,"array")}openForm(t,e){this.selectedListForm.set({index:t,fieldConfig:e})}ngOnDestroy(){this.dinamicFormService.removeLastNavigationForm(),this.selectedListForm.set(null),this.subs.forEach(t=>t.unsubscribe())}onChangeField(t,e,i){if(i!=null&&this.enableLog&&console.info("source input:",i),this.fieldValues.update(n=>(n[e]=t,n)),!this.isSubForm){this.fieldChange.emit({field:e,value:t});return}this.onSubmit()}keyEvent(t){t.stopPropagation()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-dynamic-form"]],hostBindings:function(e,i){e&1&&h("keydown",function(r){return i.keyEvent(r)})},inputs:{modeLink:[1,"modeLink"],vars:[1,"vars"],form:"form",value:"value",name:[1,"name"],isSubForm:"isSubForm"},outputs:{formSubmit:"formSubmit",cancel:"cancel",fieldChange:"fieldChange",variableChange:"variableChange"},features:[we([Te({lucideArrowLeft:Gp,lucideX:dr})])],decls:2,vars:2,consts:[[3,"form","value","isSubForm","name"],[1,"button-container"],[1,"form-container"],["app-button","","variant","outline","color","secondary",3,"click"],[3,"name"],[1,"field-container"],["label","Enlace",3,"variable","value"],[3,"options","label","value","small"],["label","Enlace",3,"variableChange","valueChange","variable","value"],[3,"valueChange","options","label","value","small"],[3,"field","value","variable"],[3,"label","value"],[3,"label","variable","value"],[3,"options","label","value"],[3,"field","value"],[3,"valueChange","variableChange","field","value","variable"],[3,"valueChange","label","value"],[3,"variableChange","valueChange","label","variable","value"],[3,"valueChange","options","label","value"],[3,"valueChange","index","field","value"],[3,"formSubmit","cancel","form","value","isSubForm","name"]],template:function(e,i){e&1&&(D(0,$y,6,1),D(1,Hy,1,5,"app-dynamic-form",0)),e&2&&(T(i.selectedListForm()==null?0:-1),c(),T(i.selectedListForm()!=null?1:-1))},dependencies:[o,pe,jl,Nl,Al,Vl,kl,Je,he,Be,Rl,Fr,Ll,Ul,Vr,kr,Nr],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.field-container[_ngcontent-%COMP%]{background-color:var(--fuse-bg-card);border-top:1px solid var(--border-color);padding:.6rem 1rem;transition:background-color .2s ease}.field-container[_ngcontent-%COMP%]:hover{background-color:var(--fuse-bg-card-accent)}.button-container[_ngcontent-%COMP%]{padding:.5rem 1rem 0;background-color:var(--fuse-bg-card)}"]})};var $l=class o{value=nt(!1);toggle(){this.value.set(!this.value())}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-switch2"]],inputs:{value:[1,"value"]},outputs:{value:"valueChange"},decls:3,vars:4,consts:[["role","switch",1,"switch",3,"click"],[1,"thumb"]],template:function(e,i){e&1&&(_t(0,"button",0),hi("click",function(){return i.toggle()}),_t(1,"span",1),u(2),Ft()()),e&2&&(Ct("active",i.value()),sn("aria-checked",i.value()),c(2),Ie(" ",i.value()?"on":""," "))},styles:["[_nghost-%COMP%]{-webkit-user-select:none;user-select:none}.switch[_ngcontent-%COMP%]{position:relative;width:20px;height:26px;border-radius:3px;background-color:var(--bg_a);border:none;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:space-between;padding:6px 0}.switch.active[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]{bottom:initial;top:2px;background-color:var(--primary);color:#fff}.thumb[_ngcontent-%COMP%]{position:absolute;height:14px;width:16px;left:2px;bottom:2px;top:initial;background-color:#fff;border-radius:2px;transition:all .3s ease;font-size:9px;color:gray;line-height:normal}"]})};var Gy=["*"],qy=(o,t)=>({"disabled-control":o,readonly:t});function Jy(o,t){if(o&1&&(l(0,"label",1),u(1),a()),o&2){let e=d();c(),Ie(" ",e.label()," ")}}function Xy(o,t){if(o&1){let e=M();l(0,"app-switch2",4),h("valueChange",function(n){g(e);let r=d();return C(r.onValueChange(n))}),a()}if(o&2){let e=d();f("value",e.states()[e.ds.device()])}}var Hl=class o{ds=b(Ue);readonly=le(!1);states=A(k({},pf));label=le("Control");icon=le("bi-gear-fill");float=le(!1);set devicesState(t){let e=Object.keys(t).reduce((i,n)=>(i[n]=t[n]!=null,i),{});this.states.set(e)}deviceChange=Oe();onValueChange=t=>this.deviceChange.emit(t);static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-mode-selector"]],inputs:{readonly:[1,"readonly"],label:[1,"label"],icon:[1,"icon"],float:[1,"float"],devicesState:"devicesState"},outputs:{deviceChange:"deviceChange"},ngContentSelectors:Gy,decls:5,vars:6,consts:[[1,"selector-body"],[1,"main-label"],[3,"ngClass"],[3,"value"],[3,"valueChange","value"]],template:function(e,i){e&1&&(Li(),l(0,"div",0),D(1,Jy,2,1,"label",1),l(2,"div",2),gi(3),a()(),D(4,Xy,1,1,"app-switch2",3)),e&2&&(c(),T(i.float()?-1:1),c(),f("ngClass",vt(3,qy,!i.states()[i.ds.device()],i.readonly())),c(2),T(i.readonly()?-1:4))},dependencies:[At,be,_i,$l],styles:["[_nghost-%COMP%]{display:flex;flex-direction:row;gap:.5rem;position:relative;padding:1rem .5rem 1rem 1rem;align-items:center}app-switch2[_ngcontent-%COMP%]{align-self:flex-start}.selector-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;flex:1}.disabled-control[_ngcontent-%COMP%]{pointer-events:none;filter:grayscale(1);opacity:.5;-webkit-user-select:none;user-select:none}.readonly[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;user-select:none}i[_ngcontent-%COMP%]{font-size:12px}"]})};function Zy(o,t){if(o&1){let e=M();l(0,"div",1),_(1,"div"),l(2,"app-unit-selector",4),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue(0,n))}),a(),_(3,"div"),l(4,"app-unit-selector",5),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue(3,n))}),a(),l(5,"button",6),h("click",function(){g(e);let n=d();return C(n.toggleChain())}),_(6,"ng-icon",7),a(),l(7,"app-unit-selector",8),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue(1,n))}),a(),_(8,"div"),l(9,"app-unit-selector",9),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue(2,n))}),a(),_(10,"div"),a()}if(o&2){let e=d();c(2),f("onlyPixels",!0)("min",0)("value",e.properties()[0]),c(2),f("onlyPixels",!0)("min",0)("value",e.properties()[3])("disabled",e.isChained()),c(),f("variant",e.isChained()?"flat":"outline"),c(),f("name",e.isChained()?"lucideLink2":"lucideUnlink2"),c(),f("onlyPixels",!0)("min",0)("value",e.properties()[1])("disabled",e.isChained()),c(2),f("onlyPixels",!0)("min",0)("value",e.properties()[2])("disabled",e.isChained())}}function Qy(o,t){if(o&1){let e=M();l(0,"div",2)(1,"div",10)(2,"app-unit-selector",11),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue(0,n))}),a(),l(3,"app-unit-selector",12),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue(3,n))}),a()(),l(4,"button",13),h("click",function(){g(e);let n=d();return C(n.toggleChain())}),_(5,"ng-icon",7),a(),l(6,"div",10)(7,"app-unit-selector",14),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue(1,n))}),a(),l(8,"app-unit-selector",15),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue(2,n))}),a()()()}if(o&2){let e=d();c(2),f("min",0)("value",e.properties()[0]),c(),f("min",0)("value",e.properties()[3])("disabled",e.isChained()),c(),f("variant",e.isChained()?"flat":"outline"),c(),f("name",e.isChained()?"lucideLink2":"lucideUnlink2"),c(2),f("min",0)("value",e.properties()[1])("disabled",e.isChained()),c(),f("min",0)("value",e.properties()[2])("disabled",e.isChained())}}function Ky(o,t){if(o&1){let e=M();l(0,"div",3)(1,"app-unit-selector",16),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue(0,n))}),a(),l(2,"app-unit-selector",17),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue(1,n))}),a(),l(3,"app-unit-selector",18),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue(2,n))}),a(),l(4,"app-unit-selector",19),h("valueChange",function(n){g(e);let r=d();return C(r.updateValue(3,n))}),a(),l(5,"button",13),h("click",function(){g(e);let n=d();return C(n.toggleChain())}),_(6,"ng-icon",7),a()()}if(o&2){let e=d();c(),f("min",0)("value",e.properties()[0]),c(),f("min",0)("value",e.properties()[1])("disabled",e.isChained()),c(),f("min",0)("value",e.properties()[2])("disabled",e.isChained()),c(),f("min",0)("value",e.properties()[3])("disabled",e.isChained()),c(),f("variant",e.isChained()?"flat":"outline"),c(),f("name",e.isChained()?"lucideLink2":"lucideUnlink2")}}function Yy(o){let t=o.split(" ").filter(e=>e.length>0);return t.length<=1?Array(4).fill(t[0]||"0px"):["0px","0px","0px","0px"].map((e,i)=>t[i]||"0px")}var zn=class o{mode="cross";initialValue=A("");isChained=A(!1);set value(t){let e=t?.trim()||"0px";this.properties.set(Yy(e)),this.isChained.set(!t.includes(" ")),this.initialValue.set(e)}valueChange=new q;properties=A(["0px","0px","0px","0px"]);toggleChain(){let t=!this.isChained();if(this.isChained.set(t),t){let e=this.properties()[0];this.properties.set(Array(4).fill(e))}this.emitValue()}updateValue(t,e){this.isChained()?this.properties.set(Array(4).fill(e)):this.properties.update(i=>{let n=[...i];return n[t]=e,n}),this.emitValue()}emitValue(){let t=this.properties(),e=this.isChained()?t[0]:t.join(" ");e!==this.initialValue()&&(this.initialValue.set(e),this.valueChange.emit(e))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-box-property"]],inputs:{mode:"mode",value:"value"},outputs:{valueChange:"valueChange"},features:[we([Te({lucideLink2:lr,lucideUnlink2:qs})])],decls:4,vars:7,consts:[[1,"box-property"],[1,"cross-layout"],[1,"box-property__box-layout"],[1,"box-property__inline-layout"],["placeholder","unit","prefix","T",3,"valueChange","onlyPixels","min","value"],["placeholder","unit","prefix","L",3,"valueChange","onlyPixels","min","value","disabled"],["app-icon-button","","size","xs",1,"box-property__chain-button",3,"click","variant"],[3,"name"],["placeholder","unit","prefix","R",3,"valueChange","onlyPixels","min","value","disabled"],["placeholder","unit","prefix","B",3,"valueChange","onlyPixels","min","value","disabled"],[1,"box-property__box-row"],["placeholder","unit","prefix","\u256D",3,"valueChange","min","value"],["placeholder","unit","prefix","\u2570",3,"valueChange","min","value","disabled"],["app-icon-button","","size","xs",3,"click","variant"],["placeholder","unit","prefix","\u256E",3,"valueChange","min","value","disabled"],["placeholder","unit","prefix","\u256F",3,"valueChange","min","value","disabled"],["placeholder","unit","prefix","T",3,"valueChange","min","value"],["placeholder","unit","prefix","R",3,"valueChange","min","value","disabled"],["placeholder","unit","prefix","B",3,"valueChange","min","value","disabled"],["placeholder","unit","prefix","L",3,"valueChange","min","value","disabled"]],template:function(e,i){e&1&&(l(0,"div",0),D(1,Zy,11,17,"div",1)(2,Qy,9,13,"div",2)(3,Ky,7,13,"div",3),a()),e&2&&(Ct("box-property--cross",i.mode==="cross")("box-property--box",i.mode==="box")("box-property--inline",i.mode==="inline"),c(),T(i.mode==="cross"?1:i.mode==="box"?2:3))},dependencies:[ei,Je,he,Ge],styles:["[_nghost-%COMP%]{display:block}.box-property[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px}.cross-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:repeat(3,auto);column-gap:4px;align-items:center;justify-items:center}.box-property__input[_ngcontent-%COMP%]{width:100%}.box-property__box-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto 1fr;column-gap:4px;align-items:center}.box-property__box-row[_ngcontent-%COMP%]{display:flex;gap:4px;align-items:center;flex-direction:column}.box-property__inline-layout[_ngcontent-%COMP%]{display:flex;gap:4px;align-items:center;width:100%}.box-property__chain-icon--rotated[_ngcontent-%COMP%]{transform:rotate(90deg)}app-unit-selector[_ngcontent-%COMP%]{width:100%}.box-property--inline[_ngcontent-%COMP%]{flex-direction:row;align-items:center}"]})};var Gl=class o{value=le(k({},Qn),{transform:t=>k({},wt(t,Qn))});valueChange=Oe();updateValue(t){this.valueChange.emit({"border-radius":t})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-border-radius-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},decls:1,vars:1,consts:[["mode","box",3,"valueChange","value"]],template:function(e,i){e&1&&(l(0,"app-box-property",0),h("valueChange",function(r){return i.updateValue(r)}),a()),e&2&&f("value",i.value()["border-radius"])},dependencies:[zn],encapsulation:2})};var ql=class o{value=le(k({},en),{transform:t=>k({},wt(t,en))});valueChange=Oe();handleSizeChange(t){this.valueChange.emit({"font-size":t})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-font-size-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},decls:1,vars:2,consts:[["prefix","T. Texto",3,"valueChange","min","value"]],template:function(e,i){e&1&&(l(0,"app-unit-selector",0),h("valueChange",function(r){return i.handleSizeChange(r)}),a()),e&2&&f("min",0)("value",i.value()["font-size"])},dependencies:[pe,ei],styles:["[_nghost-%COMP%]{display:block}"]})};function eb(o,t){if(o&1&&(l(0,"option",3),u(1),a()),o&2){let e=t.$implicit;f("value",e.value),c(),W(e.label)}}var Jl=class o{designerService=b(Ue);helperPanel=b(Vt);colors=ce(()=>this.designerService.palettColors().map(t=>({name:t.label,color:t.color})));value=le(k({},zo),{transform:t=>k({},wt(t,zo))});valueChange=Oe();listBorderStyles=[{value:"solid",label:"S\xD3LIDO"},{value:"dashed",label:"GUIONES"},{value:"dotted",label:"PUNTOS"}];emitUpdate(t){this.valueChange.emit(k(k({},this.value()),t))}openColorPicker(){this.helperPanel.disableOutsideClick(),this.helperPanel.show(_r,{color:this.value()["border-color"]},{title:"Seleccionar color",maxWidth:320}).subscribe(t=>{t&&this.emitUpdate({"border-color":t})})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-border-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},decls:7,vars:4,consts:[[1,"border-control"],[1,"d-flex","gap-2","align-items-center"],[1,"form-select-sm",3,"ngModelChange","ngModel"],[3,"value"],["size","22px",3,"click","color","displayMode"],["mode","inline",3,"valueChange","value"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"select",2),h("ngModelChange",function(r){return i.emitUpdate({"border-style":r})}),Y(3,eb,2,2,"option",3,bn),a(),l(5,"app-color-box",4),h("click",function(){return i.openColorPicker()}),a()(),l(6,"app-box-property",5),h("valueChange",function(r){return i.emitUpdate({"border-width":r})}),a()()),e&2&&(c(2),f("ngModel",i.value()["border-style"]),c(),ee(i.listBorderStyles),c(2),f("color",i.value()["border-color"])("displayMode","checkerboard"),c(),f("value",i.value()["border-width"]))},dependencies:[pe,Ht,Gt,$t,Ne,at,Ki,zn],styles:[".border-control[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;width:100%}.form-check[_ngcontent-%COMP%]{margin-bottom:.5rem}app-color-box[_ngcontent-%COMP%]{cursor:pointer;border-radius:4px;border:1px solid #fff;min-width:22px;min-height:22px}"]})};var Xl=class o{value=le(k({},Kn),{transform:t=>k({},wt(t,Kn))});valueChange=Oe();update(t){this.valueChange.emit({padding:t})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-padding-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},decls:1,vars:1,consts:[[3,"valueChange","value"]],template:function(e,i){e&1&&(l(0,"app-box-property",0),h("valueChange",function(r){return i.update(r)}),a()),e&2&&f("value",i.value().padding)},dependencies:[zn],encapsulation:2})};var Zl=class o{value=le(k({},Uo),{transform:t=>k({},wt(t,Uo))});valueChange=Oe();updateValue(t){this.valueChange.emit({margin:t})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-margin-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},decls:1,vars:1,consts:[[3,"valueChange","value"]],template:function(e,i){e&1&&(l(0,"app-box-property",0),h("valueChange",function(r){return i.updateValue(r)}),a()),e&2&&f("value",i.value().margin)},dependencies:[zn],encapsulation:2})};var Ql=class o{value=le(k({},tn),{transform:t=>k({},wt(t,tn))});valueChange=Oe();handleAlignmentChange(t){this.valueChange.emit({"text-align":t})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-text-alignment-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},features:[we([Te({lucideAlignLeft:ar,lucideAlignCenter:gs,lucideAlignRight:_s,lucideAlignJustify:Cs})])],decls:9,vars:4,consts:[[1,"d-flex","gap-1"],["app-icon-button","","size","xs",3,"click","variant"],["name","lucideAlignLeft"],["name","lucideAlignCenter"],["name","lucideAlignRight"],["name","lucideAlignJustify"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"button",1),h("click",function(){return i.handleAlignmentChange("left")}),_(2,"ng-icon",2),a(),l(3,"button",1),h("click",function(){return i.handleAlignmentChange("center")}),_(4,"ng-icon",3),a(),l(5,"button",1),h("click",function(){return i.handleAlignmentChange("right")}),_(6,"ng-icon",4),a(),l(7,"button",1),h("click",function(){return i.handleAlignmentChange("justify")}),_(8,"ng-icon",5),a()()),e&2&&(c(),f("variant",i.value()["text-align"]==="left"?"flat":"outline"),c(2),f("variant",i.value()["text-align"]==="center"?"flat":"outline"),c(2),f("variant",i.value()["text-align"]==="right"?"flat":"outline"),c(2),f("variant",i.value()["text-align"]==="justify"?"flat":"outline"))},dependencies:[Je,he,Ge],styles:["[_nghost-%COMP%]{display:block}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem}"]})};var Kl=class o{ds=b(Ue);helperPanel=b(Vt);colors=ce(()=>this.ds.palettColors().map(t=>({name:t.label,color:t.color})));value=le(k({},nn),{transform:t=>k({},wt(t,nn))});valueChange=Oe();handleColorChange(t){this.valueChange.emit({color:t})}openColorPicker(){this.helperPanel.disableOutsideClick(),this.helperPanel.show(_r,{color:this.value().color},{title:"Seleccionar color",maxWidth:320}).subscribe(t=>{t&&this.valueChange.emit({color:t})})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-text-color-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},decls:3,vars:2,consts:[["size","22px",3,"click","color","displayMode"]],template:function(e,i){e&1&&(l(0,"span"),u(1,"Color"),a(),l(2,"app-color-box",0),h("click",function(){return i.openColorPicker()}),a()),e&2&&(c(2),f("color",i.value().color)("displayMode","checkerboard"))},dependencies:[pe,Ke,he,Ki],styles:["[_nghost-%COMP%]{display:flex;align-items:center;gap:.5rem;justify-content:space-between}app-color-box[_ngcontent-%COMP%]{cursor:pointer;border-radius:4px;border:1px solid #fff}"]})};var tb=["groupItem",""],Fh=["*"],Yn=class o{constructor(t){this.group=t}value;disabled=!1;isActive=A(!1);get isDisabled(){return this.disabled?"":null}classes=ce(()=>{let t=[];return t.push(this.group.size()=="sm"?"size-sm":"size-md"),t.push(this.group.variant()=="primary"?"variant-primary":"variant-secondary"),this.isActive()&&t.push("active"),t});select(){this.disabled||this.group.setValue(this.value)}updateState(t){this.isActive.set(this.value===t)}static \u0275fac=function(e){return new(e||o)(gt(eo,5))};static \u0275cmp=N({type:o,selectors:[["","groupItem",""]],hostVars:3,hostBindings:function(e,i){e&1&&h("click",function(){return i.select()}),e&2&&(sn("disabled",i.isDisabled),it(i.classes()))},inputs:{value:"value",disabled:"disabled"},attrs:tb,ngContentSelectors:Fh,decls:1,vars:0,template:function(e,i){e&1&&(Li(),gi(0))},styles:["[_nghost-%COMP%]{flex:1;padding:0 .25rem;border:none;cursor:pointer;height:32px;font-size:.7rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;border-radius:.5rem;background-color:transparent;color:var(--fuse-text-default)}.size-sm[_nghost-%COMP%]{height:24px;font-size:.7rem}.size-md[_nghost-%COMP%]{height:34px;font-size:.75rem}[_nghost-%COMP%]:disabled{cursor:default;opacity:.6;color:inherit!important}[_nghost-%COMP%]:not(:disabled).active{color:#fff}[_nghost-%COMP%]:not(:disabled).active.variant-primary{background-color:var(--primary)}[_nghost-%COMP%]:not(:disabled).active.variant-secondary{background-color:var(--bs-secondary)}"]})},eo=class o{size=le("md");variant=le("primary");value=nt(null);items;setValue(t){this.value.set(t)}constructor(){yt(()=>{let t=this.value();Ci(()=>{this.updateItems(t)})})}updateItems(t){this.items&&this.items.forEach(e=>e.updateState(t))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-group-buttons"]],contentQueries:function(e,i,n){if(e&1&&hp(n,Yn,4),e&2){let r;ct(r=dt())&&(i.items=r)}},inputs:{size:[1,"size"],variant:[1,"variant"],value:[1,"value"]},outputs:{value:"valueChange"},ngContentSelectors:Fh,decls:1,vars:0,template:function(e,i){e&1&&(Li(),gi(0))},styles:["[_nghost-%COMP%]{display:flex;overflow:hidden;border-radius:.5rem;background-color:var(--fuse-bg-card-100);justify-content:center;align-items:center;gap:.1rem;outline:2px solid var(--fuse-bg-card-100);outline-offset:-1px}"]})},bo=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=rs({type:o});static \u0275inj=ts({})};var Yl=class o{value=le(k({},Ti),{transform:t=>k({},wt(t,Ti))});valueChange=Oe();static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-general-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},decls:8,vars:1,consts:[[1,"control-group"],["size","sm",3,"valueChange","value"],["groupItem","","value","initial"],["groupItem","","value","hidden"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"span"),u(2,"Desborde"),a(),l(3,"app-group-buttons",1),h("valueChange",function(r){return i.valueChange.emit({overflow:r})}),l(4,"button",2),u(5,"SI"),a(),l(6,"button",3),u(7,"NO"),a()()()),e&2&&(c(3),f("value",i.value().overflow))},dependencies:[pe,he,bo,eo,Yn],styles:["[_nghost-%COMP%]{width:100%;display:flex;flex-direction:column;gap:.5rem}span[_ngcontent-%COMP%]{font-size:11px;opacity:.7}.control-group[_ngcontent-%COMP%]{display:grid;align-items:center;grid-template-columns:1fr 3fr;gap:.5rem}"]})};var ec=class o{value=le(k({},Mi),{transform:t=>k({},wt(t,Mi))});valueChange=Oe();static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-visibility-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},decls:8,vars:1,consts:[[1,"control-group"],["size","sm",3,"valueChange","value"],["groupItem","","value","block"],["groupItem","","value","none"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"span"),u(2,"Visible"),a(),l(3,"app-group-buttons",1),h("valueChange",function(r){return i.valueChange.emit({show:r})}),l(4,"button",2),u(5,"SI"),a(),l(6,"button",3),u(7,"NO"),a()()()),e&2&&(c(3),f("value",i.value().show))},dependencies:[pe,he,bo,eo,Yn],styles:["[_nghost-%COMP%]{display:block}span[_ngcontent-%COMP%]{font-size:11px;opacity:.7}.control-group[_ngcontent-%COMP%]{display:grid;align-items:center;grid-template-columns:1fr 3fr;gap:.5rem}"]})};var tc=class o{valueChange=Oe();value=le(k({},sl),{transform:t=>k({},wt(t,sl))});updateScale=(t,e)=>this.valueChange.emit(re(k({},this.value()),{[t]:(+e).toFixed(2)}));update=(t,e)=>this.valueChange.emit(re(k({},this.value()),{[t]:e}));static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-transform-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},features:[we([],[Te({lucideFlipHorizontal2:lu,lucideFlipVertical2:cu})])],decls:12,vars:6,consts:[[1,"control-group"],["placeholder","Escala",3,"valueChange","value","min","max","step"],[1,"d-flex","gap-1"],["app-button","","size","xs",3,"click","variant"],["name","lucideFlipHorizontal2"],["name","lucideFlipVertical2"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"span"),u(2,"Zoom (%)"),a(),l(3,"app-number",1),h("valueChange",function(r){return i.updateScale("_s",r||"1")}),a()(),l(4,"div",0)(5,"span"),u(6,"Espejo"),a(),l(7,"div",2)(8,"button",3),h("click",function(){return i.update("_fx",i.value()._fx=="1"?"-1":"1")}),_(9,"ng-icon",4),a(),l(10,"button",3),h("click",function(){return i.update("_fy",i.value()._fy=="1"?"-1":"1")}),_(11,"ng-icon",5),a()()()),e&2&&(c(3),f("value",i.value()._s)("min",.1)("max",5)("step",.1),c(5),f("variant",i.value()._fx=="1"?"outline":"flat"),c(2),f("variant",i.value()._fy=="1"?"outline":"flat"))},dependencies:[pe,he,Be,un,Je],styles:["[_nghost-%COMP%]{width:100%;display:flex;flex-direction:column;gap:.5rem}.control-group[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 3fr;gap:.5rem;align-items:center}span[_ngcontent-%COMP%]{font-size:11px;opacity:.7}"]})};var ic=class o{value=le(k({},Wo),{transform:t=>k({},wt(t,Wo))});valueChange=Oe();static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-z-index-control"]],inputs:{value:[1,"value"]},outputs:{valueChange:"valueChange"},decls:4,vars:3,consts:[[1,"control-group"],[3,"valueChange","value","min","placeholder"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"span"),u(2,"Z-Index"),a(),l(3,"app-number",1),h("valueChange",function(r){return i.valueChange.emit({z:r||""})}),a()()),e&2&&(c(3),f("value",i.value().z)("min",0)("placeholder","auto"))},dependencies:[pe,he,un],styles:["[_nghost-%COMP%]{display:block}span[_ngcontent-%COMP%]{font-size:11px;opacity:.7}.control-group[_ngcontent-%COMP%]{display:grid;align-items:center;grid-template-columns:1fr 3fr;gap:.5rem}"]})};function ib(o,t){if(o&1){let e=M();l(0,"app-background-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function nb(o,t){if(o&1){let e=M();l(0,"app-border-radius-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function ob(o,t){if(o&1){let e=M();l(0,"app-font-size-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function rb(o,t){if(o&1){let e=M();l(0,"app-shadow-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function ab(o,t){if(o&1){let e=M();l(0,"app-border-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function sb(o,t){if(o&1){let e=M();l(0,"app-grid-span-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function lb(o,t){if(o&1){let e=M();l(0,"app-padding-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function cb(o,t){if(o&1){let e=M();l(0,"app-text-alignment-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function db(o,t){if(o&1){let e=M();l(0,"app-text-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function mb(o,t){if(o&1){let e=M();l(0,"app-layout-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n,r.control().controlName))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function pb(o,t){if(o&1){let e=M();l(0,"app-margin-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function ub(o,t){if(o&1){let e=M();l(0,"app-filter-box-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function fb(o,t){if(o&1){let e=M();l(0,"app-text-color-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function hb(o,t){if(o&1){let e=M();l(0,"app-general-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function gb(o,t){if(o&1){let e=M();l(0,"app-position-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function Cb(o,t){if(o&1){let e=M();l(0,"app-size-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function _b(o,t){if(o&1){let e=M();l(0,"app-visibility-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function vb(o,t){if(o&1){let e=M();l(0,"app-transform-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function yb(o,t){if(o&1){let e=M();l(0,"app-z-index-control",2),h("valueChange",function(n){g(e);let r=d(2);return C(r.updateValue(n))}),a()}if(o&2){let e=d(2);f("value",e.currentDeviceValue())}}function bb(o,t){if(o&1&&D(0,ib,1,1,"app-background-control",1)(1,nb,1,1,"app-border-radius-control",1)(2,ob,1,1,"app-font-size-control",1)(3,rb,1,1,"app-shadow-control",1)(4,ab,1,1,"app-border-control",1)(5,sb,1,1,"app-grid-span-control",1)(6,lb,1,1,"app-padding-control",1)(7,cb,1,1,"app-text-alignment-control",1)(8,db,1,1,"app-text-control",1)(9,mb,1,1,"app-layout-control",1)(10,pb,1,1,"app-margin-control",1)(11,ub,1,1,"app-filter-box-control",1)(12,fb,1,1,"app-text-color-control",1)(13,hb,1,1,"app-general-control",1)(14,gb,1,1,"app-position-control",1)(15,Cb,1,1,"app-size-control",1)(16,_b,1,1,"app-visibility-control",1)(17,vb,1,1,"app-transform-control",1)(18,yb,1,1,"app-z-index-control",1),o&2){let e=d();T(e.control().controlName=="background"?0:e.control().controlName=="borderRadius"?1:e.control().controlName=="fontSize"?2:e.control().controlName=="shadow"?3:e.control().controlName=="border"?4:e.control().controlName=="gridSpan"?5:e.control().controlName=="padding"?6:e.control().controlName=="textAlign"?7:e.control().controlName=="textStyle"?8:e.control().controlName=="layout"?9:e.control().controlName=="margin"?10:e.control().controlName=="filter"?11:e.control().controlName=="textColor"?12:e.control().controlName=="general"?13:e.control().controlName=="position"?14:e.control().controlName=="size"?15:e.control().controlName=="v"?16:e.control().controlName=="tf"?17:e.control().controlName=="z"?18:-1)}}var Ar=class o{ds=b(Ue);control=le.required();readonly=le(!1);typeComponent=le("");currentDeviceValue=ce(()=>ua(this.value(),this.defaultValue(),this.ds.device(),sf(this.control()?.controlName)));valueChange=Oe();value=A(k({},Ho));defaultValue=A(k({},Ho));set css(t){this.value.set(Rd(t.current)),this.defaultValue.set(Rd(t.default))}inherit=t=>this.update(t?this.currentDeviceValue():null);updateValue(t,e){this.value()[this.ds.device()]!=null&&this.update(t)}update(t){this.value.update(e=>re(k({},e),{[this.ds.device()]:Ee(t)})),this.valueChange.emit(this.value())}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-general-styles-control"]],inputs:{control:[1,"control"],readonly:[1,"readonly"],typeComponent:[1,"typeComponent"],css:"css"},outputs:{valueChange:"valueChange"},decls:2,vars:6,consts:[[3,"deviceChange","readonly","label","float","devicesState","icon"],[3,"value"],[3,"valueChange","value"]],template:function(e,i){e&1&&(l(0,"app-mode-selector",0),h("deviceChange",function(r){return i.inherit(r)}),D(1,bb,19,1),a()),e&2&&(f("readonly",i.readonly())("label",i.control().label)("float",i.control().float===!0)("devicesState",i.value())("icon",i.control().icon),c(),T(i.currentDeviceValue()!=null?1:-1))},dependencies:[pe,vr,Gl,ql,Mr,xr,br,Hl,Sr,Er,Jl,Xl,Pr,Zl,wr,Ql,Kl,Yl,ec,tc,ic],styles:["[_nghost-%COMP%]{display:block}"]})};var xb=(o,t)=>({current:o,default:t});function wb(o,t){if(o&1){let e=M();l(0,"div",0)(1,"app-general-styles-control",1),h("valueChange",function(n){g(e);let r=d(2).$implicit,s=d();return C(s.update(n,r.controlName))}),a()()}if(o&2){let e=d(2).$implicit,i=d();c(),f("typeComponent",i.typeComponent())("control",e)("css",vt(3,xb,i.current()[e.controlName],i.default()[e.controlName]))}}function Sb(o,t){if(o&1&&D(0,wb,2,6,"div",0),o&2){let e=d().$implicit,i=d();T(i.lockControlOnHover(e.controlName)?-1:0)}}function Eb(o,t){if(o&1&&D(0,Sb,1,1),o&2){let e=t.$implicit,i=d();T(e.controlName!="margin"&&e.enabled&&!((e.controlName=="size"||e.controlName=="padding")&&i.typeComponent()=="icon")?0:-1)}}var nc=class o{ds=b(Ue);formStyleControls=A([]);formStyleCustomControls=Ee(hf);form=ce(()=>this.isCustomComponent()?this.formStyleCustomControls:this.formStyleControls());current=A({});default=A({});formChange=new q;set css(t){this.updateEnabledControls(t.specialStyles),this.current.set(t.current||{}),this.default.set(t.default||{})}typeComponent=le.required();isCustomComponent=le.required();controlsDisabledOnHover=["v","position","size","padding","gridSpan"];controlsDisabledOnDocumentMode=["layout","gridSpan","padding"];lockControlOnHover(t){return this.controlsDisabledOnHover.includes(t)&&this.ds.isHoverMode()||this.controlsDisabledOnDocumentMode.includes(t)&&this.ds.isDocumentMode()}updateEnabledControls(t){let e=Ee(Sn);for(let i of t){let n=e.findIndex(r=>r.controlName===i);n!=-1&&(e[n].enabled=!0)}this.formStyleControls.set(e)}update(t,e){uf(t)?this.formChange.emit({value:void 0,field:e}):this.formChange.emit({value:t,field:e})}keyEvent(t){t.stopPropagation()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["forms-designer-styles"]],hostVars:2,hostBindings:function(e,i){e&1&&h("keydown",function(r){return i.keyEvent(r)}),e&2&&it("input-design")},inputs:{css:"css",typeComponent:[1,"typeComponent"],isCustomComponent:[1,"isCustomComponent"]},outputs:{formChange:"formChange"},decls:2,vars:0,consts:[[1,"field-row"],[3,"valueChange","typeComponent","control","css"]],template:function(e,i){e&1&&Y(0,Eb,1,1,null,null,de),e&2&&ee(i.form())},dependencies:[pe,Ar],styles:[".field-row[_ngcontent-%COMP%]{border-bottom:1px solid var(--border-color)}.field-row[_ngcontent-%COMP%]:hover{background-color:var(--fuse-bg-card-accent)}.field-row[_ngcontent-%COMP%]     .main-label{font-weight:700}.field-row[_ngcontent-%COMP%]:hover     .main-label{color:var(--primary)}[_nghost-%COMP%]{display:block;width:100%}"]})};var jr=class o{focusInput$=new Tt;listenFocus=this.focusInput$.asObservable();focusInput=()=>this.focusInput$.next();constructor(){}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var Pb=o=>({active:o});function Mb(o,t){if(o&1){let e=M();l(0,"span",2),h("click",function(){let n=g(e).$index,r=d().$implicit,s=d();return C(s.onChangeSelect("click",n,r.id))}),u(1),a()}if(o&2){let e=t.$index,i=d().$implicit,n=d();f("ngClass",te(2,Pb,n.getValue("click",i.id,"change")==e)),c(),Ie("PANEL #",e+1)}}function Ib(o,t){if(o&1&&(l(0,"div"),u(1),a(),l(2,"div",0),Y(3,Mb,2,4,"span",1,de),a()),o&2){let e=t.$implicit;c(),Ie("PANEL TAB (",e.id,")"),c(2),ee(e.children)}}var oc=class o{designerService=b(Ue);panelOptionsService=b(Vt);event="";events={};getValue(t,e,i){return this.events[t]?.find(r=>r.channel==e&&r.action==i)?.value??null}onChangeSelect(t,e,i){this.events[t]==null&&(this.events[t]=[]);let n=this.events[t]?.find(r=>r.channel==i&&r.action=="change");n?n.value=+e:this.events[t].push({channel:i,action:"change",value:+e}),this.panelOptionsService.ok(this.events)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-events"]],inputs:{event:"event",events:"events"},decls:2,vars:0,consts:[[1,"panel-tabs"],[3,"ngClass"],[3,"click","ngClass"]],template:function(e,i){e&1&&Y(0,Ib,5,1,null,null,de),e&2&&ee(i.designerService.nodeTabContainers())},dependencies:[pe,be],styles:[".panel-tabs[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.25rem}.panel-tabs[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:.5rem;cursor:pointer;background:var(--bg);color:var(--fuse-text-primary);transition:all .2s;font-size:.7rem}.panel-tabs[_ngcontent-%COMP%]   span.active[_ngcontent-%COMP%]{background:var(--primary)}"]})};var rc=class o{value=nt(!1);onLabel=le("ON");offLabel=le("OFF");label=ce(()=>this.value()?this.onLabel():this.offLabel());toggle(){this.value.set(!this.value())}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-switch"]],inputs:{value:[1,"value"],onLabel:[1,"onLabel"],offLabel:[1,"offLabel"]},outputs:{value:"valueChange"},decls:3,vars:4,consts:[["role","switch",1,"switch",3,"click"],[1,"thumb"]],template:function(e,i){e&1&&(_t(0,"button",0),hi("click",function(){return i.toggle()}),_t(1,"span",1),u(2),Ft()()),e&2&&(Ct("active",i.value()),sn("aria-checked",i.value()),c(2),Ie("",i.label()," "))},styles:["[_nghost-%COMP%]{-webkit-user-select:none;user-select:none}.switch[_ngcontent-%COMP%]{position:relative;width:38px;height:18px;border-radius:8px;background-color:#e4e4e7;border:none;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:space-between;padding:0 6px}.switch.active[_ngcontent-%COMP%]{background-color:var(--primary)}.switch.active[_ngcontent-%COMP%]   .thumb[_ngcontent-%COMP%]{left:initial;right:2px;color:var(--primary)}.thumb[_ngcontent-%COMP%]{position:absolute;height:calc(100% - 4px);left:2px;top:2px;background-color:#fff;border-radius:6px;width:70%;font-size:8px;line-height:1;display:flex;align-items:center;justify-content:center;font-weight:700;transition:all .3s ease}.active[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{opacity:1}"]})};function Db(o,t){if(o&1&&(l(0,"option",17),u(1),a()),o&2){let e=t.$implicit;f("value",e.id),c(),W(e.name)}}function Tb(o,t){if(o&1){let e=M();_(0,"div",10),l(1,"div",11)(2,"b"),u(3,"Fuente de datos"),a(),l(4,"select",15),h("ngModelChange",function(n){g(e);let r=d(2);return C(r.changeProp("cmsSource",n))}),l(5,"option",16),u(6,"-Seleccionar-"),a(),Y(7,Db,2,2,"option",17,de),a()()}if(o&2){let e=d(2);c(4),f("ngModel",e.info().cmsSource),c(),f("value",void 0),c(2),ee(e.ds.dataHandler.cmsList())}}function Fb(o,t){if(o&1){let e=M();l(0,"div",23)(1,"span"),u(2),a(),l(3,"button",24),h("click",function(){let n=g(e).$implicit,r=d(4);return C(r.onEditOverlay.emit(n.id))}),_(4,"i",25),a()()}if(o&2){let e=t.$implicit;c(2),Ie("Editar ",e.name=="dialog"?"Ventana":"Desplegable")}}function kb(o,t){if(o&1&&(l(0,"div",22),Y(1,Fb,5,1,"div",23,de),a()),o&2){let e=d(3);c(),ee(e.overlayInfo().overlayIds)}}function Ob(o,t){if(o&1){let e=M();_(0,"div",10),l(1,"div",11)(2,"div",7)(3,"b"),u(4,"Ventanas / Desplegable"),a(),l(5,"div",18)(6,"button",19),u(7,"Agregar"),a(),l(8,"div",20)(9,"button",21),h("click",function(){g(e);let n=d(2);return C(n.onOverlayChange.emit("dropdown"))}),u(10,"Deplegable"),a(),l(11,"button",21),h("click",function(){g(e);let n=d(2);return C(n.onOverlayChange.emit("dialog"))}),u(12,"Ventana"),a()()()(),D(13,kb,3,0,"div",22),_(14,"table"),a()}if(o&2){let e=d(2);c(13),T(e.overlayInfo().hasOverlay?13:-1)}}function Vb(o,t){if(o&1){let e=M();l(0,"span"),u(1,"Click"),a(),l(2,"button",26),h("click",function(){g(e);let n=d(3);return C(n.eventCloseOverlay("add"))}),u(3,"Cerrar vent/desple"),a()}}function Nb(o,t){if(o&1){let e=M();l(0,"span"),u(1,"Click "),a(),l(2,"div",27)(3,"span"),u(4,"Cerrar vent/desple"),a(),l(5,"button",24),h("click",function(){g(e);let n=d(3);return C(n.eventCloseOverlay("delete"))}),_(6,"i",28),a()()}}function Ab(o,t){if(o&1&&(_(0,"div",10),l(1,"div",11)(2,"div",7),D(3,Vb,4,0)(4,Nb,7,0),a()()),o&2){let e=d(2);c(3),T(e.haveCloseOverlay()?4:3)}}function jb(o,t){if(o&1){let e=M();l(0,"div",1)(1,"div",5)(2,"div",6)(3,"div",7)(4,"b"),u(5,"Modo enlace"),a(),l(6,"app-switch",8),h("valueChange",function(n){g(e);let r=d();return C(r.changeProp("isLink",n))}),a()()(),l(7,"app-dynamic-form",9),h("fieldChange",function(n){g(e);let r=d();return C(r.submit(n))})("variableChange",function(n){g(e);let r=d();return C(r.onVariableChange(n))}),a(),_(8,"div",10),l(9,"div",11)(10,"b"),u(11,"Identificador"),a(),l(12,"input",12),h("ngModelChange",function(n){g(e);let r=d();return C(r.changeProp("htmlId",n))}),a()(),D(13,Tb,9,2),D(14,Ob,15,1)(15,Ab,5,1),a(),l(16,"div",5)(17,"forms-designer-styles",13),h("formChange",function(n){g(e);let r=d();return C(r.submitStyle(n))}),a()(),_(18,"div",14),a()}if(o&2){let e=d();c(),f("hidden",e.activeForm()!="element"),c(5),f("value",e.info().isLink),c(),f("vars",e.vars())("modeLink",e.info().isLink)("form",e.form)("value",e.fields()),c(5),f("ngModel",e.info().htmlId),c(),T(e.info().type=="cms-list"?13:-1),c(),T(e.overlayInfo().insideOverlay?15:14),c(2),f("hidden",e.activeForm()!="styles"),c(),f("css",e.css())("isCustomComponent",e.info().isCustom)("typeComponent",e.info().type)}}var ac=class o{componentService=b(Dt);cd=b(jo);dynamicFormService=b(Un);editFormService=b(jr);ds=b(Ue);panelOptions=b(Vt);info=A(void 0);activeForm=A("element");fields=A({});css=A({current:{},default:{},specialStyles:[]});events=A({});haveCloseOverlay=ce(()=>{let t=this.events();return t.click==null?!1:t.click.find(e=>e.channel==="overlay"&&e.action==="close")!=null});vars=A({});overlayInfo=A({hasOverlay:!1,insideOverlay:!1,overlayIds:[]});isCustomComponent=A(!1);wrapperForm=Ee(bt);suscription=new Ji;form=[];navigationForms=this.dynamicFormService.navigationForms;componentDictionary=this.componentService.mapComponents;fieldChange=new q;close=Oe();onEventChange=Oe();onOverlayChange=Oe();onEditOverlay=Oe();onChangeProp=Oe();set activeComponent(t){t.id!==this.info()?.id&&this.resetComponent(),t.type!=null&&(this.info.set({id:t.id,isCustom:t.isCustom,type:t.type,htmlId:t.htmlId,isLink:t.isLink,cmsSource:t.cmsSource}),this.form=Ee(this.componentDictionary()[t.type]?.formFields||[]),this.css.set(Ee({default:t.cssDefault,current:t.cssContext,specialStyles:Ee(this.componentDictionary()[t.type]?.styleList||[])})),this.fields.set(t.fields),this.events.set(t.events||{}),this.vars.set(t.vars||{}),this.overlayInfo.set({hasOverlay:t.overlayIds.length>0,insideOverlay:t.insideOverlay,overlayIds:t.overlayIds}),this.isCustomComponent.set(t.isCustom))}openPanel(t){this.panelOptions.show(oc,{event:t,events:this.events()}).subscribe(e=>{this.onEventChange.emit(e)})}eventCloseOverlay(t){let e=this.events();e.click==null&&(e.click=[]);let i=e.click.find(n=>n.channel==="overlay"&&n.action==="close");t==="delete"&&i&&(e.click=e.click.filter(n=>n.channel!=="overlay"&&n.action!=="close")),t==="add"&&!i&&e.click.push({channel:"overlay",action:"close",value:null}),this.onEventChange.emit(k({},e))}changeProp=(t,e)=>this.onChangeProp.emit({key:t,value:e});onVariableChange(t){t.value==null?this.vars.update(e=>(delete e[t.field],k({},e))):this.vars.update(e=>re(k({},e),{[t.field]:t.value})),this.changeProp("vars",Ee(this.vars()))}resetComponent(){this.info.set(void 0),this.form=[],this.fields.set({}),this.css.set({default:{},current:{},specialStyles:[]}),this.events.set({}),this.vars.set({}),this.dynamicFormService.resetNavigationForms(),this.overlayInfo.set({hasOverlay:!1,insideOverlay:!1,overlayIds:[]}),this.panelOptions.close(),this.cd.detectChanges(),this.ds.isHoverMode.set(!1)}insideOverlay=t=>t==null?!1:t.type=="overlay"||t.type=="dialog"?!0:t.parent==null?!1:this.insideOverlay(t.parent);findCMSParent=t=>t==null?null:t.type=="cms-list"?t:t.parent==null?null:this.findCMSParent(t.parent);constructor(){let t=this.editFormService.listenFocus.subscribe(()=>{this.activeForm.set("element"),setTimeout(()=>{let e=document.querySelector("app-dynamic-form input.text-edit:not(.hex-input)");e?e.focus():document.querySelector("app-dynamic-form div[contenteditable='true']")?.focus()},200)});this.suscription.add(t),yt(()=>{let e=this.ds.formNode(),i=this.insideOverlay(e),n=this.findCMSParent(e),r=e?.children.filter(p=>p.type=="overlay"||p.type=="dialog").map(p=>({id:p.id,name:p.name}))||[],s=this.ds.cssComponentContext(),m=this.ds.isHoverMode();Ci(()=>{if(e){let p=e.css?.h||{},v=m?p:e.css?.[s]||{},y=m?uo(p,e.css?.main||{}):e.css?.main||{},x=[];n&&n.cmsSource&&(x=this.ds.dataHandler.cmsVariables(n.cmsSource)),this.ds.setContextVars(x);let E={id:e.id,type:e.type,fields:e.fields,cssContext:v,cssDefault:y,htmlId:e.htmlId||"",events:e.events||{},overlayIds:r,insideOverlay:i,isCustom:e.isCustom===!0,isLink:e.isLink===!0,vars:e.vars||{},cmsSource:e.cmsSource};this.activeComponent=Ee(E)}})})}submit(t){let e=this.fields()[t.field],i=Ee(t.value);Od(e,i)||(this.fields.update(n=>re(k({},n),{[t.field]:i})),this.fieldChange.emit({field:t.field,value:i,source:"field"}))}submitStyle(t){let e=Ee(t.value),i=this.css().current[t.field];Od(i,e)||(this.css.update(n=>re(k({},n),{current:re(k({},n.current),{[t.field]:e})})),this.fieldChange.emit({field:t.field,value:e,source:"styles"}))}reset(){this.close.emit(),this.dynamicFormService.resetNavigationForms(),this.info.set(void 0)}ngOnDestroy(){this.reset(),this.suscription.unsubscribe()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-edit-form"]],outputs:{fieldChange:"fieldChange",close:"close",onEventChange:"onEventChange",onOverlayChange:"onOverlayChange",onEditOverlay:"onEditOverlay",onChangeProp:"onChangeProp"},features:[we([Te({lucideList:Rs})])],decls:7,vars:2,consts:[[1,"forms-container","fade-in","input-design"],[1,"form-interactor"],[1,"ac",3,"valueChange","value"],["groupItem","","value","element"],["groupItem","","value","styles"],[3,"hidden"],[1,"p-2"],[1,"d-flex","justify-content-between"],[3,"valueChange","value"],[1,"dynamic-form",3,"fieldChange","variableChange","vars","modeLink","form","value"],[2,"border-top","1px solid var(--border-color)"],[1,"py-2","px-3"],["type","text","placeholder","html id",1,"form-control",3,"ngModelChange","ngModel"],[3,"formChange","css","isCustomComponent","typeComponent"],[2,"padding-bottom","4rem"],[1,"form-control",3,"ngModelChange","ngModel"],["disabled","",3,"value"],[3,"value"],["ngbDropdown","","placement","bottom-right"],["app-button","","size","xs","id","dropdownOverlay","ngbDropdownToggle",""],["ngbDropdownMenu","","aria-labelledby","dropdownOverlay"],["ngbDropdownItem","",3,"click"],[1,"overlay-area","mt-2"],[1,"d-flex","justify-content-between","align-items-center"],["app-icon-button","","size","xs",3,"click"],[1,"bi","bi-pencil"],["app-button","","size","xs",3,"click"],[1,"d-flex","align-items-center","gap-1"],[1,"bi","bi-x"]],template:function(e,i){e&1&&(l(0,"div",0),D(1,jb,19,13,"div",1),l(2,"app-group-buttons",2),ne("valueChange",function(r){return Z(i.activeForm,r)||(i.activeForm=r),r}),l(3,"button",3),u(4,"Propiedades"),a(),l(5,"button",4),u(6,"Estilos"),a()()()),e&2&&(c(),T(i.info()!=null?1:-1),c(),ie("value",i.activeForm))},dependencies:[pe,Ht,Gt,Qe,$t,Ne,at,Wl,nc,he,Be,Ge,rc,Ke,ai,yi,vi,$i,Hi,bo,eo,Yn],styles:["[_nghost-%COMP%]{display:flex;height:100%}.forms-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;width:100%;height:100%;position:relative}.form-interactor[_ngcontent-%COMP%]{flex:1;height:100%;overflow-y:auto;overflow-x:hidden}.ac[_ngcontent-%COMP%]{position:absolute;bottom:.5rem;left:.5rem;right:.5rem}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .2s ease-in}.overlay-area[_ngcontent-%COMP%]{background-color:var(--fuse-bg-card-100);padding:.5rem;display:flex;flex-direction:column;gap:.5rem;border-radius:.25rem;font-size:11px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}"]})};var lm=class{variableHandlerService=null;componentManagerService=null;nodes=[];treeNodes=A([]);treeChangeCallback;setComponentManager=t=>this.componentManagerService=t;setProjectHandler=t=>this.variableHandlerService=t;baseNormalize(t=this.nodes,e){let i=[];for(let n=0;n<t.length;n++){let r=t[n];r.parent=e;let s=r.fields.text||r.fields.title||r.name||r.type;this.variableHandlerService!=null;let m;if(r.type=="layout"){let y=oi.map(E=>r.css.main.layout?.[E]?.["ctrl-mode"]),x="row";for(let E=0;E<y.length;E++)y[E]=y[E]||x,x=y[E];m=oi.reduce((E,w,O)=>re(k({},E),{[w]:y[O]}),{})}let p=this.baseNormalize(r.children,r),v=r.children.some(y=>y.type==="overlay"||y.type==="dialog");r.hasOverlay=v,i.push({id:r.id,name:s,icon:r.icon,modes:m,children:p,isContainer:["layout","content","overlay","dialog","cms-list"].includes(r.type)||r.hasOverlay===!0,isCustomNode:r.isCustom===!0})}return i}internalNormalize(t){t&&console.log("%c NORMALIZADO POR: "+t,"background-color: purple; color: white; padding: 2px 5px; border-radius: 3px;"),this.treeNodes.set(this.baseNormalize()),this.treeChangeCallback?.()}timeOut=null;normalize(){this.timeOut&&clearTimeout(this.timeOut),this.timeOut=setTimeout(()=>{this.treeNodes.set(this.baseNormalize()),this.timeOut=null},200)}findBase(t,e=this.nodes,i){let n=e.findIndex(r=>r.id===t);if(n!==-1)return e[n].parent=i,{element:e[n],parent:i,index:n};for(let r=0;r<e.length;r++){let s=this.findBase(t,e[r].children,e[r]);if(s)return s}return null}find=t=>this.findBase(t)?.element??null;findContext(t){let e=this.findBase(t);return e?.parent==null?null:e}setNodes(t){this.nodes=t,this.internalNormalize("setNodes")}getElements(){return this.nodes}},xo=class o extends lm{history=[];toastrService=b(tt);saveHistory(){let t=this.nodes.map(e=>Dt.createDuplicate(e,{preserveId:!0}));this.history.push(t)}reset(){this.nodes=[],this.history=[],this.treeNodes.set([])}onNormalizeTree(t){this.treeChangeCallback=t}undo(){if(this.history.length>0){let t=this.history.pop();return t==null?!1:(this.nodes.forEach((e,i)=>{e.children=t[i].children}),this.internalNormalize("undo"),!0)}return!1}copyStyles(t,e,i={}){let n=[];if(i.sameType===!0&&t.type!==e.type)return[];if(t.type==e.type){let r=t.fields,{title:s,paragraph:m,description:p,text:v,icon:y,imageUrl:x,url:E,link:w,__link:O,__id:F}=r,V=qn(r,["title","paragraph","description","text","icon","imageUrl","url","link","__link","__id"]);e.css=Ee(t.css)}for(let s of gf)for(let m of Object.keys(t.css||{}))t.css[m][s]==null?delete e.css[m][s]:e.css[m][s]=Ee(t.css[m][s]);if(n.push(e),i.intensive===!0&&t.children&&e.children){let s=Math.min(t.children.length,e.children.length);for(let m=0;m<s;m++)n.push(...this.copyStyles(t.children[m],e.children[m],i))}return n}pasteStyles(t,e,i={intensive:!1}){if(t.length===0||e.length===0)return[];try{let n=[],r=e.map(s=>this.find(s)).filter(s=>s!==null);return r.length===0?(console.warn("No se encontraron elementos de destino"),[]):(r.forEach((s,m)=>{let p=t[m%t.length];n.push(...this.copyStyles(p,s,{intensive:i.intensive}))}),n)}catch(n){return console.error("Error al pegar estilos:",n),this.toastrService.error("Ocurri\xF3 un error al pegar los estilos"),[]}}moveNodes(t,e,i){if(t.length===0)return!1;let n=new Set(t),r=this.find(e);if(!r)return!1;let s=Math.max(0,Math.min(r.children.length,i));this.saveHistory();let m=[],p=r.children.map(y=>n.has(y.id)?null:y);t.forEach(y=>{let x=this.findContext(y);x!=null&&(En.resetCssPosition(x.element),m.push(x),x.parent.children=x.parent.children.filter(E=>E.id!==y))});let v=m.sort((y,x)=>y.index-x.index).map(y=>y.element);return p.splice(s,0,...v),r.children=p.filter(y=>y!=null),this.internalNormalize("moveNodes"),!0}moveSiblings(t,e){if(t.length===0||!this.isSameParent(t))return!1;this.saveHistory();let{parent:n}=this.findContext(t[0]),r=Sf(e==="toNext",n.children,t,s=>s.id);return n.children=r,this.internalNormalize("moveSiblings"),!0}duplicateNodes(t){if(t.length===0)return!1;try{this.saveHistory();let e=0;return t.forEach(i=>{let n=this.findContext(i);if(!n)return;let r=n.parent.children[n.index];if(!r||r.type==="content")return;let s=Dt.createDuplicate(r),m=n.parent.children;m.splice(n.index+1,0,s),n.parent.children=[...m],e++}),e===0&&console.warn("No se pudo duplicar ning\xFAn elemento"),this.internalNormalize("duplicateNodes"),!0}catch(e){return console.error("Error al duplicar elementos:",e),this.toastrService.error("Ocurri\xF3 un error al duplicar los elementos"),!1}}removeElements(t){if(t.length===0)return[];try{this.saveHistory();let e=[];return t.forEach(i=>{let n=this.findContext(i);if(n==null)return;let r=n.element;r==null||r.type==="content"||(n.parent.children=n.parent.children.filter(s=>s.id!==i),e.push(r))}),e.length===0&&console.warn("No se pudo remover ning\xFAn elemento"),this.internalNormalize("removeElements"),e}catch(e){return console.error("Error al remover elementos:",e),this.toastrService.error("Ocurri\xF3 un error al remover los elementos"),[]}}addChildren(t,e){let i=this.find(t);return i?(this.saveHistory(),i.children.push(...Array.isArray(e)?e:[e]),this.internalNormalize("addChildren"),!0):!1}addSibling(t,e,i="after"){let n=this.findContext(t);if(!n)return!1;this.saveHistory();let r=i==="before"?n.index:n.index+1;return n.parent.children.splice(r,0,...Array.isArray(e)?e:[e]),this.internalNormalize("addSibling"),!0}isSameParent(t){if(t.length<=1)return t.length===1;let[e]=t,i=this.findContext(e)?.parent;if(!i)return!1;let n=new Set(i.children.map(r=>r.id));return t.every(r=>n.has(r))}createClone(t){let e=this.find(t);return e?Dt.createDuplicate(e):null}createClones=t=>t.map(e=>this.createClone(e)).filter(e=>e!=null);wrapperInStack(t,e){let i=this.componentManagerService?.createLayoutComponent(e=="stack-row"?"column":"row");if(!i)return!1;let n=t.map(p=>this.findContext(p)).filter(p=>p!=null).sort((p,v)=>p.index-v.index),r=new Set(n.map(p=>p.element.id));if(n.length===0)return!1;let[s]=n;this.saveHistory(),i.children=n.map(p=>p.element);let m=s.parent.children.map(p=>r.has(p.id)?null:p);return m.splice(s.index,0,i),s.parent.children=m.filter(p=>p!=null),this.internalNormalize("wrapperInStack"),!0}isIrrelevantContent(t){return t.children.length===0||t.children.length==1&&t.children[0].type=="layout"&&t.children[0].children.length==0}addSection(t){let n=this.nodes.length===1?0:{hero:1,head:0,body:1,footer:2,error:1}[t.category],r=n!=null?this.nodes[n]:null;return r?(this.saveHistory(),this.isIrrelevantContent(r)?r.children=t.list:r.children=t.category=="hero"?[...t.list,...r.children]:[...r.children,...t.list],this.internalNormalize("addSection"),!0):!1}addNodeToDocument(t){if(this.nodes.length===0)return!1;let e=this.nodes[0],i=e.children.length>0?e.children[0]:null;return i?(this.saveHistory(),i.children.push(t),this.internalNormalize("addNodeToDocument"),!0):!1}replaceWith(t,e){let i=this.findContext(t);if(!i)return!1;if(this.saveHistory(),Array.isArray(e)){let n=e.map(r=>{let s=Dt.createDuplicate(r);return s.parent=i.parent,s});i.parent.children.splice(i.index,1,...n)}else{let n=Dt.createDuplicate(e);n.parent=i.parent,i.parent.children[i.index]=n}return this.internalNormalize("replaceWith"),!0}replaceMultipleWith(t,e){if(t.length===0)return!1;let i=typeof e=="string"?this.find(e):e;if(!i)return!1;try{this.saveHistory();let n=0;return t.forEach(r=>{let s=this.findContext(r);if(!s)return;let m=Dt.createDuplicate(i);m.parent=s.parent,s.parent.children[s.index]=m,n++}),n>0?(this.internalNormalize("replaceMultipleWith"),!0):!1}catch(n){return console.error("Error al reemplazar elementos:",n),this.toastrService.error("Ocurri\xF3 un error al reemplazar los elementos"),!1}}unwrapContainer(t){let e=this.findContext(t);if(!e)return this.toastrService.error("No se encontr\xF3 el contenedor especificado"),!1;let{parent:i,element:n,index:r}=e;if(!i)return this.toastrService.error("No se puede desenvolver un elemento ra\xEDz"),!1;let s=n.children;return s.length===0?(this.saveHistory(),i.children=i.children.filter(m=>m.id!==t),this.internalNormalize("unwrapContainer"),!0):(this.saveHistory(),s.forEach(m=>{m.parent=i}),i.children.splice(r,1,...s),this.internalNormalize("unwrapContainer"),!0)}propagateStyles(t){try{let e=this.findContext(t);if(!e)return this.toastrService.error("No se encontr\xF3 el elemento fuente"),[];let i=e.element,n=e.parent.children.filter(s=>s.id!==t);this.saveHistory();let r=[];return n.forEach(s=>{r.push(...this.copyStyles(i,s,{intensive:!0,sameType:!0}))}),r.length>0&&this.normalize(),r}catch(e){return console.error("Error al propagar estilos:",e),this.toastrService.error("Ocurri\xF3 un error al propagar los estilos"),[]}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=dp(o)))(i||o)}})();static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var _n=class o{nodesManagerService=b(xo);nodes=A({});nodeList=ce(()=>Object.values(this.nodes()).map(t=>t.node));lastNode=ce(()=>Object.entries(this.nodes()).sort((t,e)=>e[1].registerDate-t[1].registerDate)[0]?.[1]?.node);firstNode=ce(()=>Object.entries(this.nodes()).sort((t,e)=>t[1].registerDate-e[1].registerDate)[0]?.[1]?.node);selectedAreSiblings=ce(()=>{let t=this.nodeList();if(t.length<1)return!1;let e=t[0].parent?.id;return t.every(i=>i.parent?.id===e)});replaceWith=t=>this.addNode(t,"replace");append=t=>this.addNode(t,"append");size=()=>this.list().length;last=()=>this.lastNode()?.id||null;list=()=>Object.keys(this.nodes());first=()=>this.firstNode()?.id||null;isSelectedNode=t=>this.nodes()[t]!=null;add(t,e){if(e!=null&&(e.ctrlKey||e.shiftKey)&&e.button===0)this.isSelectedNode(t)?this.removeNode(t):this.append(t);else{if(this.isSelectedNode(t))return;this.replaceWith(t)}}addAfterClick(t,e){if(e.button!==0)return;!(e!=null&&(e.ctrlKey||e.shiftKey))&&this.nodes()[t]!=null&&this.replaceWith(t)}clear(){this.nodes.set({})}addNode(t,e="append"){let i=this.nodesManagerService.find(t);i&&(e==="replace"?this.nodes.set({[t]:{registerDate:Date.now(),node:i}}):(this.nodes.set(re(k({},this.nodes()),{[t]:{registerDate:Date.now(),node:i}})),this.unselectChildren(i.children),this.unselectParents(i)))}removeNode(t){let e=this.nodes();delete e[t],this.nodes.set(k({},e))}unselectChildren(t){for(let e of t)this.isSelectedNode(e.id)&&this.removeNode(e.id),e.children&&this.unselectChildren(e.children)}unselectParents(t){t.parent&&(this.isSelectedNode(t.parent.id)&&this.removeNode(t.id),this.unselectParents(t.parent))}selectParent(){let t=this.last();if(!t)return null;let e=this.nodesManagerService.find(t),i=e?.parent;return!i||i.type=="content"?(this.clear(),e):(i&&this.replaceWith(i.id),e)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var wo=class o{isMovingNode=A(!1);tagetMove=A(void 0);remoteExpand$=new ki(void 0);toogleCollapse$=new Tt;collapseAll$=new Tt;listenToogleCollapse=this.toogleCollapse$.asObservable();listenCollapseAll=this.collapseAll$.asObservable();listenRemoteExpand=this.remoteExpand$.asObservable();nodesHandlerService=b(_n);setToogleCollapse(t){this.toogleCollapse$.next(t)}collapseAll(){this.collapseAll$.next()}remoteExpand(t){setTimeout(()=>{this.remoteExpand$.next(t)},200)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var Rb=o=>({"custom-component":o});function Lb(o,t){if(o&1){let e=M();l(0,"section",0)(1,"div",11),h("mouseenter",function(n){g(e);let r=d();return C(r.mouseenter(n,r.index(),r.parentId()))})("mouseleave",function(n){g(e);let r=d();return C(r.mouseLeave(n))}),a()()}}function Ub(o,t){if(o&1&&_(0,"app-tree-node",9),o&2){let e=t.$implicit,i=t.$index,n=d();f("parentId",n.node().id)("hidden",!n.expanded())("index",i)("parentTreeNode",n)("node",e)("level",n.level()+1)}}var sc=class o{gap=22;ds=b(Ue);selectedNodesService=b(_n);currentDevice=this.ds.device;leftOffset=A(0);index=le(0);parentId=le(void 0);level=A(0);node=le({id:"",name:"",children:[],modes:{},icon:"",isContainer:!1,isCustomNode:!1});selected=ce(()=>this.selectedNodesService.isSelectedNode(this.node().id));set inLevel(t){this.level.set(t),this.leftOffset.set(this.level()*this.gap)}parentTreeNode;icons={column:"https://cdn-icons-png.flaticon.com/128/6473/6473951.png",row:"https://cdn-icons-png.flaticon.com/128/6473/6473958.png",grid:"https://cdn-icons-png.flaticon.com/128/721/721047.png",responsive:"https://cdn-icons-png.flaticon.com/128/721/721047.png"};children;expanded=A(!1);treeService=b(wo);subscriptions=new Ji;toggleExpanded(){this.expanded.set(!this.expanded())}expandNode(t){t.stopImmediatePropagation(),this.toggleExpanded()}mousedown(t){this.selectedNodesService.add(this.node().id,t)}mouseenter(t,e,i){!this.treeService.isMovingNode()||(t.stopPropagation(),t.target.classList.add("active"),i==null)||this.treeService.tagetMove.set({index:e,parentId:i})}mouseLeave(t){t.target.classList.remove("active")}clickNode(t){this.treeService.isMovingNode()||this.selectedNodesService.addAfterClick(this.node().id,t)}label=ce(()=>this.node().name);isCustomComponent=ce(()=>this.node().isCustomNode??!1);icon=ce(()=>{let t=this.node().modes;return t==null?this.node().icon||"https://cdn-icons-png.flaticon.com/128/7479/7479750.png":this.icons[t[this.currentDevice()]]});expand(t=!1){t||this.expanded.set(!0),this.parentTreeNode?.expand()}constructor(){this.subscriptions.add(this.treeService.listenRemoteExpand.subscribe(t=>{t==this.node().id&&this.expand(!0)})),this.subscriptions.add(this.treeService.listenToogleCollapse.subscribe(t=>{t==this.node().id&&this.toggleExpanded()})),this.subscriptions.add(this.treeService.listenCollapseAll.subscribe(()=>{this.expanded.set(!1)}))}ngOnDestroy(){this.subscriptions.unsubscribe()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-tree-node"]],viewQuery:function(e,i){if(e&1&&ut(o,5),e&2){let n;ct(n=dt())&&(i.children=n)}},hostVars:8,hostBindings:function(e,i){e&2&&(xt("--gap",i.gap+"px")("--left-offset",i.leftOffset()+"px"),Ct("is-container",i.node().isContainer)("selected",i.selected()))},inputs:{index:[1,"index"],parentId:[1,"parentId"],node:[1,"node"],inLevel:[0,"level","inLevel"],parentTreeNode:"parentTreeNode"},features:[we([Te({lucidePen:Zi,lucideTrash:On,lucideChevronDown:xs,lucideChevronRight:sr,lucideFolder:Fs,lucideFile:Ts})])],decls:14,vars:10,consts:[[1,"drop-wrapper","top-zone"],[1,"node-header",3,"dblclick","mousedown","click","ngClass"],[1,"node-text"],[1,"icon-item",3,"mousedown"],["size","12",3,"name"],[1,"node-icon"],[3,"src"],[1,"node-label"],[1,"drop-wrapper","special",3,"mouseenter","mouseleave"],[3,"parentId","hidden","index","parentTreeNode","node","level"],[1,"drop-wrapper","bottom-zone"],[1,"drop-zone",3,"mouseenter","mouseleave"]],template:function(e,i){e&1&&(D(0,Lb,2,0,"section",0),l(1,"div",1),h("dblclick",function(){return i.toggleExpanded()})("mousedown",function(r){return i.mousedown(r)})("click",function(r){return i.clickNode(r)}),l(2,"div",2)(3,"div",3),h("mousedown",function(r){return i.expandNode(r)}),_(4,"ng-icon",4),a(),l(5,"span",5),_(6,"img",6),a(),l(7,"span",7),u(8),a()(),l(9,"div",8),h("mouseenter",function(r){return i.mouseenter(r,0,i.node().id)})("mouseleave",function(r){return i.mouseLeave(r)}),a()(),Y(10,Ub,1,6,"app-tree-node",9,de),l(12,"section",10)(13,"div",11),h("mouseenter",function(r){return i.mouseenter(r,i.index()+1,i.parentId())})("mouseleave",function(r){return i.mouseLeave(r)}),a()()),e&2&&(T(i.index()===0?0:-1),c(),f("ngClass",te(8,Rb,i.isCustomComponent())),c(3),f("name",i.expanded()?"lucideChevronDown":"lucideChevronRight"),c(2),f("src",i.icon(),mt),c(2),Ie("",i.label()," "),c(2),ee(i.node().children),c(2),pi(Re("z-index: ",i.level()+1)))},dependencies:[o,Je,be],styles:['img[_ngcontent-%COMP%]{width:10px}.box-h[_ngcontent-%COMP%]{height:26px}[_nghost-%COMP%]{position:relative;display:block;border-radius:.5rem}[_nghost-%COMP%]   .node-header[_ngcontent-%COMP%]{border-radius:.5rem}[_nghost-%COMP%]   .node-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:var(--filter)}[_nghost-%COMP%]   .node-header.custom-component[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:brightness(0) saturate(100%) invert(28%) sepia(26%) saturate(2375%) hue-rotate(237deg) brightness(90%) contrast(103%)}.selected[_nghost-%COMP%]{background-color:var(--primary-opacity-1)}.selected[_nghost-%COMP%]     app-tree-node .drop-wrapper{display:none!important}.selected[_nghost-%COMP%] > .node-header[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff}.selected[_nghost-%COMP%] > .node-header.custom-component[_ngcontent-%COMP%]{background-color:#639}.selected[_nghost-%COMP%] > .node-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:invert(1)}.node-header[_ngcontent-%COMP%]{position:relative;-webkit-user-select:none;user-select:none}.node-header[_ngcontent-%COMP%]:hover{background-color:var(--primary-opacity-1)}.node-text[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;padding-left:var(--left-offset);height:26px}.node-info[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;width:100%}.node-label[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1;font-size:12px}.node-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:2px}.node-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:var(--gap)}.icon-item[_ngcontent-%COMP%]{align-items:center;justify-content:center;height:26px;width:var(--gap);cursor:pointer;display:none;transform:translateY(-2px)}.is-container[_nghost-%COMP%] > .node-header[_ngcontent-%COMP%]   .icon-item[_ngcontent-%COMP%]{display:flex}.drop-wrapper[_ngcontent-%COMP%]{position:relative;z-index:2;width:calc(100% - var(--left-offset));margin-left:var(--left-offset);display:none}.drop-wrapper.special[_ngcontent-%COMP%]{height:100%;width:100%;position:absolute;top:0;right:0;display:none;z-index:1}.drop-wrapper.special[_ngcontent-%COMP%]:hover{background-color:var(--primary-opacity-1)}.drop-wrapper[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:absolute;right:0;top:0;width:100%;height:6px;transform:translateY(-50%);display:flex;align-items:center}.drop-wrapper[_ngcontent-%COMP%] > div.active[_ngcontent-%COMP%]:before{background-color:#007bff;height:3px;content:"";width:100%}.horizontal-spacer[_ngcontent-%COMP%]{pointer-events:none;width:var(--gap)}'],changeDetection:0})};var Wb=["contextExplorer"],$b=["treeExplorer"],Hb=o=>({"init-move":o});function Gb(o,t){if(o&1&&_(0,"app-tree-node",8),o&2){let e=t.$implicit,i=t.$index,n=d().$implicit;f("parentId",n.id)("index",i)("node",e)}}function qb(o,t){if(o&1&&(l(0,"div",5)(1,"div",6),_(2,"ng-icon",7),a(),l(3,"span"),u(4),a()(),Y(5,Gb,1,3,"app-tree-node",8,de)),o&2){let e=t.$implicit;c(4),W(e.name),c(),ee(e.children)}}var lc=class o{treeService=b(wo);selectedNodesService=b(_n);ds=b(Ue);menu;treeExplorer;subscriptions=new Ji;startY=0;treeData=A([]);move=Oe();isSameParent=A(!1);set inTreeData(t){this.treeData.set(t)}isPressed=!1;mouseMoveEvent;ngAfterViewInit(){let t=this.treeExplorer?.nativeElement;t&&(this.mouseMoveEvent=this.mouseMove.bind(this),t.addEventListener("mousemove",this.mouseMoveEvent))}ngOnDestroy(){this.subscriptions.unsubscribe();let t=this.treeExplorer?.nativeElement;t&&this.mouseMoveEvent&&t.removeEventListener("mousemove",this.mouseMoveEvent)}mouseMove(t){this.selectedNodesService.size()==0||!this.isPressed||t.ctrlKey||t.shiftKey||Math.abs(t.clientY-this.startY)<8||this.treeService.isMovingNode.set(!0)}mouseUp(t){if(this.treeService.isMovingNode()){let e=this.treeService.tagetMove();if(e!=null){let i={targetParentId:e.parentId,targetIndex:Math.max(e.index,0)};this.move.emit(i)}this.treeService.tagetMove.set(void 0)}this.isPressed=!1,this.treeService.isMovingNode.set(!1)}mouseDownHandler(t){t.stopPropagation(),t.target.closest(".node-header")!=null&&t.button!==2&&(this.isPressed=!0,this.startY=t.clientY,this.ds.showMenu.set(!1))}mouseleave(){this.treeService.isMovingNode.set(!1),this.isPressed=!1}collapseAll(){this.treeService.collapseAll()}openMenu(t){t.preventDefault(),this.ds.showMenu.set(!0),this.ds.menuCoordinates.set({x:t.clientX,y:t.clientY})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-tree-explorer"]],viewQuery:function(e,i){if(e&1&&(ut(Wb,5),ut($b,5)),e&2){let n;ct(n=dt())&&(i.menu=n.first),ct(n=dt())&&(i.treeExplorer=n.first)}},inputs:{inTreeData:[0,"treeData","inTreeData"]},outputs:{move:"move"},features:[we([],[Te({lucideChevronRight:sr,lucideChevronDown:xs,lucideFolder:Fs,lucideFile:Ts,lucideRows2:Bs,lucideColumns2:tu,lucideMinus:cr,lucideScan:Nu})])],decls:9,vars:3,consts:[["treeExplorer",""],[1,"tree-actions"],["app-icon-button","","size","xs","variant","text","title","Contraer todo",3,"click"],["size","12","name","lucideMinus"],[1,"tree-explorer-content",3,"mousedown","mouseleave","click","contextmenu","ngClass"],[1,"group-name"],[1,"d-flex","justify-content-center","align-items-center",2,"width","26px"],["size","12","name","lucideFolder"],[3,"parentId","index","node"]],template:function(e,i){if(e&1){let n=M();l(0,"div",1)(1,"span"),u(2,"Contenido"),a(),l(3,"button",2),h("click",function(){return g(n),C(i.collapseAll())}),_(4,"ng-icon",3),a()(),l(5,"div",4,0),h("mousedown",function(s){return g(n),C(i.mouseDownHandler(s))})("mouseleave",function(){return g(n),C(i.mouseleave())})("click",function(s){return g(n),C(i.mouseUp(s))})("contextmenu",function(s){return g(n),C(i.openMenu(s))}),Y(7,qb,7,1,null,null,de),a()}e&2&&(c(5),f("ngClass",te(1,Hb,i.treeService.isMovingNode())),c(2),ee(i.treeData()))},dependencies:[sc,he,Ge,be,Je],styles:["[_nghost-%COMP%], .tree-explorer-content[_ngcontent-%COMP%]{display:flex;width:100%;flex-direction:column;position:relative}[_nghost-%COMP%]{padding:4px 8px}.tree-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px;justify-content:space-between;width:100%;font-size:11px}.btn-collapse[_ngcontent-%COMP%]{font-size:.8rem;padding:.25rem .5rem;border:1px solid #e0e0e0;border-radius:.25rem;background:#fff;cursor:pointer;display:flex;align-items:center;gap:.25rem}.btn-collapse[_ngcontent-%COMP%]:hover{background:#f7f7f7}.context-explorer[_ngcontent-%COMP%]{position:absolute;background:#fff;box-shadow:var(--bs-box-shadow);border-radius:.5rem;overflow:hidden;font-size:.8rem;z-index:100;flex-direction:column}.action-menu[_ngcontent-%COMP%]{padding:.25rem 1rem;cursor:pointer;display:flex;align-items:center;gap:.5rem;text-wrap:nowrap}.action-menu[action=delete][_ngcontent-%COMP%]{color:red}.context-explorer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1rem}.context-explorer[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:hover{background:#f7f7f7}.init-move[_ngcontent-%COMP%]     .selected .node-header{opacity:.5}.init-move[_ngcontent-%COMP%]     .drop-wrapper{display:block}.init-move[_ngcontent-%COMP%]     .is-container>.node-header .drop-wrapper{display:block}.group-name[_ngcontent-%COMP%]{font-size:11px;font-weight:700;border-top:1px solid rgba(0,0,0,.16);padding:.5rem 0;display:flex;align-items:center}"],changeDetection:0})};var Jb=o=>({active:o});function Xb(o,t){if(o&1){let e=M();l(0,"div",6),h("click",function(){let n=g(e).$implicit,r=d();return C(r.add(n.type))}),_(1,"img",7),l(2,"span",8),u(3),a()()}if(o&2){let e,i=t.$implicit,n=d();f("title",i.name)("ngClass",te(4,Jb,((e=n.standByComponent())==null?null:e.variant)==i.type)),c(),f("src",i.icon,mt),c(2),W(i.name)}}function Zb(o,t){o&1&&(l(0,"div",5),_(1,"ng-icon",9),l(2,"h5"),u(3,"No hay componentes"),a(),l(4,"p"),u(5,"No hay componentes disponibles para agregar."),a()())}var cc=class o{componentService=b(fn);designerService=b(Ue);componentManagerService=b(Dt);components=this.componentManagerService.components;standByComponent=this.designerService.standbyComponent;mapComponents=this.componentManagerService.mapComponents;displayedList=ce(()=>this.onSearch());searchTerm=A("");expludedTypes=["content","overlay","dialog"];add(t){let e=this.componentManagerService.createInstanceOf(t);this.standByComponent.set({component:e,variant:t})}onSearch(){let t=this.searchTerm();if(t=="")return this.components().filter(i=>!this.expludedTypes.includes(i.type));let e=t.toLowerCase();return console.log(this.components()),this.components().filter(i=>!this.expludedTypes.includes(i.type)&&(i.name.toLowerCase().includes(e)||i.type.toLowerCase().includes(e)))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-components-menu"]],features:[we([Te({lucideBox:bs,lucideSearch:Au})])],decls:7,vars:2,consts:[[1,"search-container"],["type","text","placeholder","Search components...",1,"search-input",3,"ngModelChange","ngModel"],["name","lucideSearch","size","18",1,"search-icon"],[1,"component-list"],[1,"component-button",3,"title","ngClass"],[1,"text-center","p-3"],[1,"component-button",3,"click","title","ngClass"],[1,"component-icon",3,"src"],[1,"component-name"],["name","lucideBox","size","24"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"input",1),ne("ngModelChange",function(r){return Z(i.searchTerm,r)||(i.searchTerm=r),r}),a(),_(2,"ng-icon",2),a(),l(3,"div",3),Y(4,Xb,4,6,"div",4,de),a(),D(6,Zb,6,0,"div",5)),e&2&&(c(),ie("ngModel",i.searchTerm),c(3),ee(i.displayedList()),c(2),T(i.displayedList().length===0?6:-1))},dependencies:[Je,pe,Qe,Ne,at,_i,be],styles:["[_nghost-%COMP%]{display:flex;padding:.5rem;flex-direction:column}.search-container[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem}.search-input[_ngcontent-%COMP%]{width:100%;padding:.5rem 2rem .5rem .5rem;border:1px solid #e5e7eb;border-radius:.375rem;font-size:.875rem}.search-icon[_ngcontent-%COMP%]{position:absolute;right:.5rem;top:50%;transform:translateY(-50%);color:#9ca3af}.component-list[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-direction:column}.component-button[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem;border-radius:.375rem;transition:background-color .2s;cursor:pointer;width:100%;background-color:var(--fuse-bg-card-100)}.component-button[_ngcontent-%COMP%]:hover{background-color:var(--fuse-bg-card-200)}.component-icon[_ngcontent-%COMP%]{width:1rem;height:1rem;margin-right:1rem;filter:var(--filter)}.component-name[_ngcontent-%COMP%]{font-size:.75rem;font-weight:500}button[_ngcontent-%COMP%]:focus{outline:none}.component-button.active[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff}"],changeDetection:0})};function Qb(o,t){if(o&1){let e=M();_t(0,"button",2),hi("click",function(){let n=g(e).$implicit,r=d();return C(r.ds.device.set(n.device))}),ii(1,"img",3),Ft()}if(o&2){let e=t.$implicit,i=d();Ct("active",i.ds.device()===e.device),c(),Jn("src",e.icon,mt)}}function Kb(o,t){if(o&1){let e=M();_t(0,"div",0)(1,"button",2),hi("click",function(){g(e);let n=d();return C(n.ds.isHoverMode.set(!1))}),ii(2,"img",4),Ft(),_t(3,"button",2),hi("click",function(){g(e);let n=d();return C(n.ds.isHoverMode.set(!0))}),ii(4,"img",5),Ft()()}if(o&2){let e=d();c(),Ct("active",!e.ds.isHoverMode()),c(2),Ct("active",e.ds.isHoverMode())}}var dc=class o{ds=b(Ue);showHoverMode=ce(()=>this.ds.formNode()!=null&&!this.ds.cssComponentContext().endsWith(":h"));static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-device-handler"]],decls:4,vars:1,consts:[["role","group",1,"btn-group","btn-group-sm"],["type","button",1,"btn","btn-dark",3,"active"],["type","button",1,"btn","btn-dark",3,"click"],["alt","",3,"src"],["src","https://cdn-icons-png.flaticon.com/128/8369/8369109.png","alt",""],["src","https://cdn-icons-png.flaticon.com/128/15836/15836118.png","alt",""]],template:function(e,i){e&1&&(_t(0,"div",0),Y(1,Qb,2,3,"button",1,de),Ft(),D(3,Kb,5,4,"div",0)),e&2&&(c(),ee(i.ds.deviceInfo()),c(2),T(i.showHoverMode()?3:-1))},styles:["[_nghost-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:.5rem;width:100%;padding:0 1rem}span[_ngcontent-%COMP%]{font-size:.8rem;font-weight:500;color:#fff}button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1rem}button.active[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{filter:invert(1)}button.active[_ngcontent-%COMP%]{color:#fff}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.25rem .5rem;border:0!important}.btn-group[_ngcontent-%COMP%]   .btn.active[_ngcontent-%COMP%]{background-color:var(--primary)}"]})};var Yb=["container"],ex=["*"];function tx(o,t){if(o&1){let e=M();_t(0,"div",5),hi("mousemove",function(n){g(e);let r=d();return C(r.handleMouseMove(n))}),Ft()}}var mc=class o{container;minWidth=300;width=nt(1024);isDragging=A(!1);ngZone=b(fi);onWindowResize=()=>{let t=window.innerWidth;this.width()>t&&this.width.set(t)};ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{window.addEventListener("resize",this.onWindowResize)}),this.onWindowResize()}ngOnDestroy(){this.detachListeners(),window.removeEventListener("resize",this.onWindowResize)}startResize(t){t.preventDefault(),this.isDragging.set(!0),this.ngZone.runOutsideAngular(()=>{document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)})}handleMouseMove=t=>{this.isDragging()&&this.updateWidth(t)};handleMouseUp=()=>{this.isDragging.set(!1),this.detachListeners()};updateWidth(t){let e=this.container.nativeElement.getBoundingClientRect(),i=e.left+e.width/2,n=Math.abs(t.clientX-i)*2,r=window.innerWidth,s=Math.round(Math.max(this.minWidth,Math.min(n,r)));this.width.set(s)}detachListeners(){document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-resizer"]],viewQuery:function(e,i){if(e&1&&ut(Yb,7),e&2){let n;ct(n=dt())&&(i.container=n.first)}},inputs:{minWidth:"minWidth",width:[1,"width"]},outputs:{width:"widthChange"},ngContentSelectors:ex,decls:6,vars:5,consts:[["container",""],[1,"wrapper-resizer","position-relative","h-100"],[1,"gutter-wrapper",3,"mousedown"],[1,"gutter"],[1,"resize-cover"],[1,"resize-cover",3,"mousemove"]],template:function(e,i){if(e&1){let n=M();Li(),_t(0,"div",1,0),gi(2),_t(3,"div",2),hi("mousedown",function(s){return g(n),C(i.startResize(s))}),ii(4,"div",3),Ft()(),D(5,tx,1,0,"div",4)}e&2&&(xt("width",i.width(),"px"),c(4),Ct("dragging",i.isDragging()),c(),T(i.isDragging()?5:-1))},styles:[".h-100[_ngcontent-%COMP%]{height:100%}.wrapper-resizer[_ngcontent-%COMP%]{max-width:100%;position:relative}.gutter-wrapper[_ngcontent-%COMP%]{position:absolute;top:0;right:-14px;width:8px;height:100%;display:flex;align-items:center;cursor:col-resize}.gutter[_ngcontent-%COMP%]{width:100%;height:160px;background:gray;border-radius:8px;transition:background .2s}.gutter.dragging[_ngcontent-%COMP%], .gutter[_ngcontent-%COMP%]:hover{background:#393939}.resize-cover[_ngcontent-%COMP%]{position:fixed;inset:0;background:transparent;cursor:col-resize;z-index:9999}[_nghost-%COMP%]{display:block}"],changeDetection:0})};var ix=["iframe"];function nx(o,t){if(o&1){let e=M();l(0,"button",11),h("click",function(){let n=g(e).$implicit,r=d();return C(r.setDeviceWidth(n.width))}),_(1,"img",12),a()}if(o&2){let e=t.$implicit;c(),f("src",e.icon,mt)}}var pc=class o{manager=b(xo);contextGeneratorService=b(Rn);toastrService=b(tt);ds=b(Ue);elements=[];iframe;with=A(this.ds.deviceInfo()[0].width);previewMode=this.ds.previewMode;devices=this.ds.deviceInfo();ngAfterViewInit(){return P(this,null,function*(){let t=this.iframe?.nativeElement.contentDocument,e=this.manager.getElements(),i=this.ds.formattedVariables(),n=this.ds.contextDesign().mode,r=yield this.contextGeneratorService.generatePreviewPage(e,i,n,this.ds.dataHandler.fontFamily());t&&(t.open(),t.write(r),t.close()),this.iframe?.nativeElement.contentWindow?.addEventListener("message",this.handleMessage)})}ngOnDestroy(){this.iframe?.nativeElement.contentWindow?.removeEventListener("message",this.handleMessage)}handleMessage=t=>{t.data.type==="navigate"&&this.toastrService.warning("En modo de vista previa, no se puede navegar a otras p\xE1ginas")};setDeviceWidth(t){this.with.set(t-1)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-preview"]],viewQuery:function(e,i){if(e&1&&ut(ix,5),e&2){let n;ct(n=dt())&&(i.iframe=n.first)}},inputs:{elements:"elements"},features:[we([Te({lucidePencilRuler:Us})])],decls:15,vars:2,consts:[["iframe",""],[1,"d-flex","flex-column","h-100",2,"background","darkgray"],[1,"toolbar","d-flex","align-items-center","justify-content-between","px-3"],[1,"d-flex","align-items-center","justify-content-center","gap-2","flex-grow-1"],["app-icon-button","","color","light"],[1,"ms-3","badge","bg-secondary"],["app-button","","color","secondary",3,"click"],["name","lucidePencilRuler"],[1,"flex-grow-1","d-flex","justify-content-center","align-items-center","p-3","overflow-auto"],[2,"height","100%","max-width","100%",3,"widthChange","width"],[2,"max-width","100%"],["app-icon-button","","color","light",3,"click"],["alt","",3,"src"]],template:function(e,i){if(e&1){let n=M();l(0,"div",1)(1,"div",2)(2,"div",3),Y(3,nx,2,1,"button",4,de),l(5,"span",5),u(6),a()(),l(7,"button",6),h("click",function(){return g(n),C(i.previewMode.set(!1))}),l(8,"span"),u(9,"Continuar editando"),a(),_(10,"ng-icon",7),a()(),l(11,"div",8)(12,"app-resizer",9),ne("widthChange",function(s){return g(n),Z(i.with,s)||(i.with=s),C(s)}),_(13,"iframe",10,0),a()()()}e&2&&(c(3),ee(i.devices),c(3),Ie("",i.with(),"px"),c(6),ie("width",i.with))},dependencies:[mc,he,Be,Ge,Je],styles:[".toolbar[_ngcontent-%COMP%]{height:48px;background-color:var(--bs-gray-dark);border-bottom:1px solid rgba(0,0,0,.1)}.iframe-container[_ngcontent-%COMP%]{height:100%;background:#fff;overflow:hidden}iframe[_ngcontent-%COMP%]{width:100%;height:100%;border:none}.toolbar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1rem}[_nghost-%COMP%]{display:block;width:100%;height:100%}"]})};var xa=(i=>(i.ACTIVE="1",i.INACTIVE="0",i.DEVELOP="2",i))(xa||{});var So=class o{API=`${Le.web_maker}/preset`;apiService=b(Lt);loadingService=b(Yt);confirmationService=b(ft);auth=b(xe);toastrService=b(tt);states=[{code:"1",denomination:"Activo"},{code:"0",denomination:"Inactivo"}];stateMap=this.states.reduce((t,e)=>(t[e.code]=e.denomination,t),{});canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.canAdd=this.auth.hasSubPermission("preset-ADD"),this.canEdit=this.auth.hasSubPermission("preset-EDIT"),this.canRemove=this.auth.hasSubPermission("preset-REMOVE"),this.canChangeState=this.auth.hasSubPermission("preset-CHANGE-STATE"),this.canExport=this.auth.hasPermission("preset-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("preset-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("preset-EXPORT-PDF")}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}changeState(t){return P(this,null,function*(){let e=this.stateMap[t.state],i="";switch(t.state){case"1":i="text-success";break;case"0":i="text-danger";break}let n=`
            <div class="text-center">
                <div class="mb-3">\xBFEst\xE1 seguro de cambiar el estado del registro?</div>
                <h3 >Nuevo estado: <b class="${i}">${e}</b></h3>
            </div>
        `;if(!(yield this.confirmationService.create("Confirmar",n)))return;this.loadingService.open();let s=yield this.apiService.putPrivate(`${this.API}/state/change/${t.id}`,t);return this.loadingService.hide(),s})}delete(t){return P(this,null,function*(){return this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,t)})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};function ox(o,t){if(o&1&&(_t(0,"div",1),ii(1,"div",2),Ft()),o&2){let e=d();xt("height",e.height,"px")}}var uc=class o{height=200;elementCount=4;get items(){return Array(this.elementCount)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-skeleton"]],inputs:{height:"height",elementCount:"elementCount"},decls:2,vars:0,consts:[[1,"skeleton-item",3,"height"],[1,"skeleton-item"],[1,"skeleton-img"]],template:function(e,i){e&1&&Y(0,ox,2,2,"div",0,de),e&2&&ee(i.items)},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:8px}.skeleton-item[_ngcontent-%COMP%]{border-radius:4px;background-color:#e0e0e0;overflow:hidden;position:relative}.skeleton-img[_ngcontent-%COMP%]{width:100%;height:100%;background:linear-gradient(90deg,#e0e0e0 25%,#ccc 37%,#e0e0e0 63%);background-size:400% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite linear}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:-200px 0}to{background-position:200px 0}}"]})};function rx(o,t){o&1&&_(0,"app-skeleton",1),o&2&&f("height",200)("elementCount",4)}function ax(o,t){if(o&1){let e=M();l(0,"div",6),h("click",function(){let n=g(e).$implicit,r=d().$implicit,s=d(2);return C(s.clonePreset(n,r.category))}),_(1,"img",7)(2,"div",8),a()}if(o&2){let e=t.$implicit;c(),f("src",e.imgUrl,mt)("alt",e.name)}}function sx(o,t){if(o&1&&(l(0,"div",2)(1,"div",3),u(2),a(),l(3,"div",4),Y(4,ax,3,2,"div",5,de),a()()),o&2){let e=t.$implicit,i=d(2);c(2),W(i.labels[e.category]),c(2),ee(e.list)}}function lx(o,t){if(o&1&&Y(0,sx,6,1,"div",2,de),o&2){let e=d();ee(e.categories())}}var fc=class o{designerService=b(Ue);presetService=b(So);loading=A(!0);categories=A([]);labels={hero:"Hero",head:"Cabecera",body:"Cuerpo",footer:"Pie de p\xE1gina",error:"P\xE1gina de error"};ngOnInit(){return P(this,null,function*(){try{let i=((yield this.presetService.list({type:"section"})).data||[]).reduce((n,r)=>{let s=n.find(m=>m.category===r.category);return s?s.list.push(r):n.push({category:r.category,list:[r]}),n},[]);this.categories.set(i)}finally{this.loading.set(!1)}})}clonePreset(t,e){let n=JSON.parse(t.element).map(r=>Dt.createDuplicate(r));this.designerService.newSection({category:e,list:n})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-section-list"]],decls:3,vars:1,consts:[[1,"preset-wrapper"],[2,"padding","0.25rem",3,"height","elementCount"],[1,"category"],[1,"category-label"],[1,"presets"],[1,"preset-item"],[1,"preset-item",3,"click"],[3,"src","alt"],[1,"preset-overlay"]],template:function(e,i){e&1&&(l(0,"div",0),D(1,rx,1,2,"app-skeleton",1)(2,lx,2,0),a()),e&2&&(c(),T(i.loading()?1:2))},dependencies:[uc],styles:["[_nghost-%COMP%]{display:block}.preset-wrapper[_ngcontent-%COMP%]{display:flex;gap:.25rem;flex-direction:column;cursor:pointer}.preset-wrapper[_ngcontent-%COMP%]   .preset-item[_ngcontent-%COMP%]{max-height:200px;object-fit:cover;object-position:center}.preset-wrapper[_ngcontent-%COMP%]   .preset-item[_ngcontent-%COMP%]:hover   .preset-overlay[_ngcontent-%COMP%]{display:none}.preset-wrapper[_ngcontent-%COMP%]   .preset-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .preset-wrapper[_ngcontent-%COMP%]   .preset-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;display:block;max-height:200px;object-fit:cover;object-position:center}.preset-item[_ngcontent-%COMP%]{position:relative;margin:4px 8px;width:calc(100% - 16px);overflow:hidden;border-radius:4px;min-height:40px;display:flex;justify-content:center;align-items:center}.preset-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;justify-content:center;align-items:center;background-color:#0000001a;z-index:2;color:#fff;font-weight:700}.category-label[_ngcontent-%COMP%]{font-weight:700;text-transform:uppercase;margin:1rem .5rem .5rem;letter-spacing:1px;color:var(--primary)}.presets[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}"]})};var cx=["splitView"],dx=[[["","pane1",""]],[["","pane2",""]],[["","pane3",""]]],mx=["[pane1]","[pane2]","[pane3]"],kh=o=>({active:o}),hc=class o{ngZone=b(fi);set initialPanel1Size(t){let e=this.parseSize(t);e&&this.panel1Size.set(e)}set initialPanel3Size(t){let e=this.parseSize(t);e&&this.panel3Size.set(e)}splitViewRef;panel1Size=A({value:33,unit:"%"});panel3Size=A({value:33,unit:"%"});containerSize=A(0);activeGutter=A(null);dragCoverVisible=A(!1);pane1Style=ce(()=>`${this.calculatePixelSize(this.panel1Size())}px`);pane3Style=ce(()=>`${this.calculatePixelSize(this.panel3Size())}px`);resizeObserver=null;ngAfterViewInit(){this.setupResizeObserver(),this.updateContainerSize()}ngOnDestroy(){this.resizeObserver?.disconnect(),this.teardownEvents()}setupResizeObserver(){this.resizeObserver=new ResizeObserver(()=>this.ngZone.run(()=>this.updateContainerSize())),this.resizeObserver.observe(this.splitViewRef.nativeElement)}onGutterMouseDown=(t,e)=>{t.preventDefault(),this.activeGutter.set(e),this.dragCoverVisible.set(!0),this.ngZone.runOutsideAngular(()=>{document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)})};onMouseMove=t=>{let e=this.splitViewRef.nativeElement.getBoundingClientRect(),i=t.clientX-e.left;requestAnimationFrame(()=>{if(this.activeGutter()===1)this.panel1Size.set({value:Math.min(Math.max(i,10),this.containerSize()-20),unit:"px"});else if(this.activeGutter()===2){let n=this.calculatePixelSize(this.panel1Size()),r=this.containerSize()-n,s=this.containerSize()-i,m=r-10;this.panel3Size.set({value:Math.min(Math.max(s,10),m),unit:"px"})}})};onMouseUp=()=>{this.activeGutter.set(null),this.dragCoverVisible.set(!1),this.teardownEvents()};teardownEvents(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)}updateContainerSize(){this.containerSize.set(this.splitViewRef.nativeElement.getBoundingClientRect().width)}parseSize(t){let e=t.match(/^(\d+)(px|%)$/);return e?{value:parseInt(e[1],10),unit:e[2]}:null}calculatePixelSize(t){return t.unit==="px"?t.value:t.value/100*this.containerSize()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-3split-view"]],viewQuery:function(e,i){if(e&1&&ut(cx,5),e&2){let n;ct(n=dt())&&(i.splitViewRef=n.first)}},inputs:{initialPanel1Size:"initialPanel1Size",initialPanel3Size:"initialPanel3Size"},ngContentSelectors:mx,decls:14,vars:12,consts:[["splitView",""],[1,"split-container"],[1,"drag-cover"],[1,"split-view"],[1,"pane","pane-1"],[1,"gutter-container"],[1,"gutter","gutter-1",3,"mousedown","ngClass"],[1,"pane","pane-2"],[1,"gutter","gutter-2",3,"mousedown","ngClass"],[1,"pane","pane-3"]],template:function(e,i){if(e&1){let n=M();Li(dx),l(0,"div",1),_(1,"div",2),l(2,"div",3,0)(4,"div",4),gi(5),a(),l(6,"div",5)(7,"div",6),h("mousedown",function(s){return g(n),C(i.onGutterMouseDown(s,1))}),a()(),l(8,"div",7),gi(9,1),a(),l(10,"div",5)(11,"div",8),h("mousedown",function(s){return g(n),C(i.onGutterMouseDown(s,2))}),a()(),l(12,"div",9),gi(13,2),a()()()}e&2&&(c(),Ct("active",i.dragCoverVisible()),c(3),xt("width",i.pane1Style()),c(3),f("ngClass",te(8,kh,i.activeGutter()===1)),c(4),f("ngClass",te(10,kh,i.activeGutter()===2)),c(),xt("width",i.pane3Style()))},dependencies:[_i,be],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%;position:relative}.split-container[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;position:relative}.split-view[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;height:100%}.pane[_ngcontent-%COMP%]{overflow:auto}.pane-2[_ngcontent-%COMP%]{flex:1}.gutter-container[_ngcontent-%COMP%]{position:relative;width:0;flex-shrink:0}.gutter[_ngcontent-%COMP%]{position:absolute;width:4px;height:100%;top:0;left:0;transform:translate(-50%);cursor:col-resize;background:transparent;transition:background-color .2s;z-index:2}.gutter.active[_ngcontent-%COMP%], .gutter[_ngcontent-%COMP%]:hover{background-color:var(--primary)}.drag-cover[_ngcontent-%COMP%]{position:fixed;inset:0;background:transparent;cursor:col-resize;display:none;z-index:1}.drag-cover.active[_ngcontent-%COMP%]{display:block}"],changeDetection:0})};function px(o,t){if(o&1){let e=M();l(0,"tr")(1,"td",3),u(2),a(),l(3,"td")(4,"input",7),h("change",function(n){let r=g(e).$implicit,s=d();return C(s.valueChange(n,r.id,"name"))}),a()(),l(5,"td")(6,"input",7),h("change",function(n){let r=g(e).$implicit,s=d();return C(s.valueChange(n,r.id,"value"))}),a()(),l(7,"td")(8,"button",8),h("click",function(){let n=g(e).$implicit,r=d();return C(r.removeVariable(n))}),_(9,"ng-icon",9),a()()()}if(o&2){let e=t.$implicit;c(2),Ie(" ",e.type," "),c(2),f("value",e.name),c(2),f("value",e.value)}}var gc=class o{ds=b(Ue);modalService=b(St);confirmService=b(li);createVar=A("empty");general=ce(()=>this.ds.dataHandler.projectVars().filter(t=>t.category==="general"&&(t.type==="text"||t.type==="string")));valueChange(t,e,i){let n=t.target.value;this.ds.updateVariable(i,e,n)}colorChange(t,e){this.ds.updateVariable("value",e,t)}createVariable(t){t=="string"&&this.ds.addStringVariable("variable","value")}removeVariable(t){this.confirmService.show({message:"\xBFEst\xE1s seguro de eliminar esta variable?",type:"delete",title:"Eliminar"}).then(e=>{e&&this.ds.removeVariableById(t.id)})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-variables"]],features:[we([Te({lucidePen:Zi,lucideTrash:On})])],decls:24,vars:1,consts:[[1,"table","table-box"],[2,"width","1px"],[2,"width","20%"],[1,"text-center","text-uppercase"],[3,"ngModelChange","ngModel"],["value","empty","disabled",""],["value","string"],["type","text",1,"form-control",3,"change","value"],["app-icon-button","","variant","text","size","sm","color","danger",3,"click"],["name","lucideTrash"]],template:function(e,i){e&1&&(l(0,"table",0)(1,"thead")(2,"tr")(3,"th",1),u(4,"Tipo"),a(),l(5,"th",2),u(6,"Nombre"),a(),l(7,"th"),u(8,"Valor"),a(),l(9,"th",1),u(10,".."),a()()(),l(11,"tbody"),Y(12,px,10,3,"tr",null,de),l(14,"tr")(15,"td",3)(16,"select",4),ne("ngModelChange",function(r){return Z(i.createVar,r)||(i.createVar=r),r}),h("ngModelChange",function(r){return i.createVariable(r)}),l(17,"option",5),u(18,"Crear variable"),a(),l(19,"option",6),u(20,"Texto"),a()()(),_(21,"td")(22,"td")(23,"td"),a()()()),e&2&&(c(12),ee(i.general()),c(4),ie("ngModel",i.createVar))},dependencies:[pe,Ht,Gt,$t,Ne,at,Je,he,Ge],styles:["select[_ngcontent-%COMP%]{background:var(--fuse-bg-card-accent);color:var(--fuse-text-default);padding:4px 8px;border:none;border-radius:.35rem}  :after{display:none!important}"]})};var Bn=class o{modalService=b(St);eventChange=Oe();size=le("sm");modeSelection=!1;onEvent(t){this.eventChange.emit(t),this.modalService.ok(t.data)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-storage"]],inputs:{size:[1,"size"],modeSelection:"modeSelection"},outputs:{eventChange:"eventChange"},decls:1,vars:3,consts:[["mode","box",3,"eventChange","modeSelection","size","showPagination"]],template:function(e,i){e&1&&(l(0,"app-ui-multimedia-list",0),h("eventChange",function(r){return i.onEvent(r)}),a()),e&2&&f("modeSelection",!0)("size",i.size())("showPagination",!1)},dependencies:[ho],encapsulation:2})};var qt=tp(I0(),1),D0=qt.default,SK=qt.default.stringify,EK=qt.default.fromJSON,PK=qt.default.plugin,MK=qt.default.parse,IK=qt.default.list,DK=qt.default.document,TK=qt.default.comment,FK=qt.default.atRule,kK=qt.default.rule,OK=qt.default.decl,VK=qt.default.root,NK=qt.default.CssSyntaxError,AK=qt.default.Declaration,jK=qt.default.Container,RK=qt.default.Processor,LK=qt.default.Document,UK=qt.default.Comment,zK=qt.default.Warning,BK=qt.default.AtRule,WK=qt.default.Result,$K=qt.default.Input,HK=qt.default.Rule,GK=qt.default.Root,qK=qt.default.Node;var Ga=class o{constructor(t,e){this.html=e;this.cssAst=D0.parse(t)}cssAst;parse(){let i=new DOMParser().parseFromString(this.html,"text/html").querySelector("body");if(!i)throw new Error("No se encontr\xF3 la etiqueta <body> en el HTML proporcionado.");return Array.from(i.childNodes).map(n=>this.processNode(n)).filter(n=>n!==null)}processNode(t,e={}){if(t.nodeType===Node.TEXT_NODE){let i=t.textContent?.trim();return i?{htmlTag:"span",attributes:{},styles:{},textContent:i,children:[]}:null}if(t.nodeType===Node.ELEMENT_NODE){let i=t,n=i.tagName.toLowerCase(),r=k({},e),s={};if(this.cssAst.walkRules(w=>{w.selector.split(",").map(O=>O.trim()).forEach(O=>{try{i.matches(O)&&w.walkDecls(F=>{s[F.prop]=F.value})}catch{}})}),i.hasAttribute("style")){let w=i.getAttribute("style");Object.assign(s,o.parseInlineStyle(w))}let m=k(k({},r),s),p={htmlTag:n,attributes:{},styles:m,children:[]};i.hasAttributes()&&Array.from(i.attributes).forEach(w=>{p.attributes[w.name]=w.value});let v=new Set(["p","span","h1","h2","h3","h4","h5","h6","td","th","label"]),y=new Set(["a","button"]);if(v.has(n)||y.has(n)){let w=i.textContent?.trim();w&&(p.textContent=w)}else if(i.childNodes.length===1&&i.childNodes[0].nodeType===Node.TEXT_NODE){let w=i.childNodes[0].textContent?.trim();w&&(p.textContent=w,p.htmlTag="span")}let x={},E=["color","font-size","text-align"];for(let w of E)m[w]!=null&&(x[w]=m[w]);return v.has(n)||i.childNodes.forEach(w=>{let O=this.processNode(w,x);O&&p.children.push(O)}),p}return null}static parseInlineStyle(t){let e={};return t.split(";").forEach(i=>{let[n,r]=i.split(":");n&&r&&(e[n.trim()]=r.trim())}),e}};var qr=class o{componentManagerService=b(Dt);generateComponent(t){return P(this,null,function*(){let e=yield this.generateHtmlComponent(t);if(!e)return null;let n=new Ga(e.sheet,e.html).parse();return this.j2Component(n)})}htmlStringToNodes(t){let i=new Ga("",t).parse();return this.j2Component(i)}generateHtmlComponent(t){return P(this,null,function*(){try{return yield(yield fetch(Le.web_maker+"/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:t})})).json()}catch(e){console.log("ERROR SERVER",e)}return null})}j2Component(t){let e=[];return t.forEach(i=>{let n=null,r=this.j2Component(i.children),s=i.attributes.id,p=(i.children.find(x=>x.htmlTag==="i")?.attributes.class??"").split(" ").find(x=>x.startsWith("bi-")),v=i.textContent,y=p?"icon-and-text":"text-only";if(v||(y="icon-only"),i.htmlTag==="web-galery")n=this.componentManagerService.createInstanceOf("galleryImage",{});else if(["div","section","footer","main","nav","aside","header"].includes(i.htmlTag))n=this.componentManagerService.createInstanceOf("layout",{}),n.children=r;else if(i.htmlTag==="ul")n=this.componentManagerService.createInstanceOf("layout",{}),n.children=r;else if(i.htmlTag==="li"){let x=r.length;x===1?n=this.componentManagerService.createInstanceOf("header-text",{text:i.textContent}):x>1&&(n=this.componentManagerService.createInstanceOf("layout",{"flex-direction":"row"}),n.children=r,console.log("LI",n,r))}else if(i.htmlTag==="p")n=this.componentManagerService.createInstanceOf("header-text",{text:i.textContent});else if(i.htmlTag==="img")n=this.componentManagerService.createInstanceOf("image",{imageUrl:i.attributes.src,imageAlt:i.attributes.alt});else if(["h1","h2","h3","h4","h5","h6","span"].includes(i.htmlTag))n=this.componentManagerService.createInstanceOf("header-text",{text:i.textContent});else if(i.htmlTag==="a"){let x={__link:{url:i.attributes.href,target:i.attributes.target,enabled:!0},text:i.textContent,displayMode:y};(p||y=="icon-only")&&(x.icon=p??"bi-link"),n=this.componentManagerService.createInstanceOf("button",x)}else if(i.htmlTag==="button"){let x={text:i.textContent,displayMode:y};p&&(x.icon=p),n=this.componentManagerService.createInstanceOf("button",x)}else if(i.htmlTag==="i"){let x={},E=(i?.attributes.class??"").split(" ").find(w=>w.startsWith("bi-"));E&&(x.icon=E),n=this.componentManagerService.createInstanceOf("icon",x)}n!==null&&(new En(n,hr,"main").addCssStyles(i.styles,i.htmlTag),e.push(n))}),e}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};function iS(o,t){if(o&1&&(l(0,"option",5),u(1),a()),o&2){let e=t.$implicit;f("value",e.value),c(),W(e.label)}}function nS(o,t){if(o&1){let e=M();l(0,"input",13),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("ngModel",e.field.default)}}function oS(o,t){if(o&1){let e=M();l(0,"input",14),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("ngModel",e.field.default)}}function rS(o,t){if(o&1){let e=M();l(0,"div",9)(1,"span"),u(2,"Seleccionar"),a(),l(3,"button",15),h("click",function(){g(e);let n=d();return C(n.onSelectIcon())}),u(4),a()()}if(o&2){let e=d();c(4),W(e.field.default||"Seleccionar")}}function aS(o,t){if(o&1){let e=M();l(0,"input",16),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("ngModel",e.field.default)}}function sS(o,t){if(o&1){let e=M();l(0,"textarea",17),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("ngModel",e.field.default)}}var Rc=class o{modalService=b(St);panelOptionsService=b(Vt);field={type:"text",label:"",field:"",default:""};availableFieldTypes=[];onFieldTypeChange(){this.field.type==="link2"?this.field.default="":this.field.type==="text"?this.field.default="":this.field.type==="icon"?this.field.default="":this.field.type==="image"?this.field.default="":this.field.type==="paragraph"&&(this.field.default="")}onSave(){this.field.label===""||this.field.field===""||this.field.default==null||this.panelOptionsService.ok(this.field)}onSelectIcon(){this.panelOptionsService.disableOutsideClick(),this.modalService.open(Or,{title:"Seleccionar Icono",hiddenButtons:!0,params:{selectedIcon:this.field.default},size:"900px"}).result().then(e=>{e.isOk&&(this.field.default=e.data),this.panelOptionsService.enableCloseOnOutside()})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-custom-field-form"]],inputs:{field:"field",availableFieldTypes:"availableFieldTypes"},decls:22,vars:3,consts:[[1,"mb-3"],["for","fieldLabel",1,"form-label"],["type","text","id","fieldLabel","name","fieldLabel","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","fieldType",1,"form-label"],["id","fieldType","name","fieldType","required","",1,"form-select",3,"ngModelChange","change","ngModel"],[3,"value"],[1,"form-label"],["type","text","name","fieldDefault",1,"form-control",3,"ngModel"],["type","text","name","defaultUrl",1,"form-control",3,"ngModel"],[1,"d-flex","justify-content-between"],["type","text","name","defaultImage",1,"form-control",3,"ngModel"],["name","defaultParagraph",1,"form-control",3,"ngModel"],["type","button",1,"btn","btn-primary",3,"click"],["type","text","name","fieldDefault",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","defaultUrl",1,"form-control",3,"ngModelChange","ngModel"],["app-button","","size","sm","type","button",3,"click"],["type","text","name","defaultImage",1,"form-control",3,"ngModelChange","ngModel"],["name","defaultParagraph",1,"form-control",3,"ngModelChange","ngModel"]],template:function(e,i){if(e&1&&(l(0,"div",0)(1,"label",1),u(2,"Etiqueta"),a(),l(3,"input",2),ne("ngModelChange",function(r){return Z(i.field.label,r)||(i.field.label=r),r}),a()(),l(4,"div",0)(5,"label",3),u(6,"Tipo"),a(),l(7,"select",4),ne("ngModelChange",function(r){return Z(i.field.type,r)||(i.field.type=r),r}),h("change",function(){return i.onFieldTypeChange()}),Y(8,iS,2,2,"option",5,bn),a()(),l(10,"div",0)(11,"label",6),u(12,"Valor por defecto"),a(),D(13,nS,1,1,"input",7)(14,oS,1,1,"input",8)(15,rS,5,1,"div",9)(16,aS,1,1,"input",10)(17,sS,1,1,"textarea",11),a(),l(18,"div",9),_(19,"div"),l(20,"button",12),h("click",function(){return i.onSave()}),u(21,"Guardar"),a()()),e&2){let n;c(3),ie("ngModel",i.field.label),c(4),ie("ngModel",i.field.type),c(),ee(i.availableFieldTypes),c(5),T((n=i.field.type)==="text"?13:n==="link2"?14:n==="icon"?15:n==="image"?16:n==="paragraph"?17:-1)}},dependencies:[pe,Ht,Gt,Qe,$t,Ne,Fp,at,he,Be],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding:1rem}"]})};function lS(o,t){if(o&1){let e=M();l(0,"div",5)(1,"div")(2,"strong"),u(3),a(),l(4,"small",7),u(5),a()(),l(6,"div",8)(7,"button",9),h("click",function(){let n=g(e).$implicit,r=d();return C(r.editField(n))}),_(8,"ng-icon",10),a(),l(9,"button",9),h("click",function(){let n=g(e).$index,r=d();return C(r.deleteField(n))}),_(10,"ng-icon",11),a()()()}if(o&2){let e=t.$implicit;c(3),W(e.label),c(2),Ie("(",e.type,")")}}function cS(o,t){o&1&&(l(0,"div",6),u(1,"No hay campos configurados"),a())}var Lc=class o{panelHelper=b(Vt);ds=b(Ue);availableFieldTypes=[{value:"text",label:"Texto"},{value:"link2",label:"Enlace"},{value:"icon",label:"Icono"},{value:"image",label:"Imagen"},{value:"paragraph",label:"P\xE1rrafo"}];editField(t){return P(this,null,function*(){let e=t==null?{type:"text",label:"",field:fa("f_"),default:""}:k({},t);this.panelHelper.show(Rc,{field:e,availableFieldTypes:this.availableFieldTypes}).subscribe(n=>{this.ds.saveCustomField(n),this.panelHelper.close()})})}deleteField(t){if(confirm("\xBFEst\xE1 seguro de eliminar este campo?")){let e=[...this.ds.customFields()];e.splice(t,1),this.ds.setCustomFields(e)}}ngOnDestroy(){this.panelHelper.close()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-custom-component-fields-form"]],features:[we([],[Te({lucideTrash2:ao,lucidePen:Zi})])],decls:10,vars:1,consts:[[1,"fields-list-view"],[1,"d-flex","justify-content-between","mb-3"],["app-icon-button","","size","sm",3,"click"],[1,"bi","bi-plus"],[1,"list"],[1,"list-item","d-flex","justify-content-between","align-items-center"],[1,"list-item","text-center"],[1,"text-muted"],[1,"d-flex","gap-1"],["app-icon-button","","variant","text","size","xs",3,"click"],["name","lucidePen","size","14"],["name","lucideTrash2","size","14"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"b"),u(3,"Lista de Campos"),a(),l(4,"button",2),h("click",function(){return i.editField()}),_(5,"i",3),a()(),l(6,"div",4),Y(7,lS,11,2,"div",5,de,!1,cS,2,0,"div",6),a()()),e&2&&(c(7),ee(i.ds.customFields()))},dependencies:[pe,he,Ge,Je],styles:[".fields-list-view[_ngcontent-%COMP%], .field-edit-view[_ngcontent-%COMP%]{border-radius:8px;padding:1rem;margin-bottom:1rem}.list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.list[_ngcontent-%COMP%]   .list-item[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:8px;background-color:var(--bg_a)}pre[_ngcontent-%COMP%]{padding:10px;border-radius:5px;font-size:.9rem;max-height:200px;overflow-y:auto}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem;display:inline-flex;align-items:center;justify-content:center}.btn-sm[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin:0}"]})};var Uc=class{scrollTop=A(16);scrollLeft=A(32);scaleApp=A(.8);window=null;document=null;ds;designerComponent;iframe=null;setContext(t){this.iframe=t,this.window=t.contentWindow,this.document=t.contentDocument,this.window?.addEventListener("wheel",this.onWheel.bind(this),{passive:!1}),this.window?.addEventListener("keydown",this.onKeydown.bind(this)),this.window?.addEventListener("contextmenu",this.onContextMenu.bind(this)),this.window?.addEventListener("mousedown",this.onMouseDown.bind(this))}setDesignerService=t=>this.ds=t;setDesignerComponent=t=>this.designerComponent=t;reestarDesignerView(t){this.scrollTop.set(16),this.scaleApp.set(.8);let e=this.iframe?.offsetWidth??0,i=this.ds.currentDeviceInfo()?.width??t??0,n=(e-i*.8)/2;this.scrollLeft.set(n)}addZoom(t){let e=this.iframe?.offsetWidth??0,i=this.scaleApp(),n=Math.max(.2,Math.min(i+t,1.5)),r=(e/2-this.scrollLeft())/i,s=e/2-n*r;this.scaleApp.set(n),this.scrollLeft.set(s)}onMouseDown=t=>{t.button!=2&&this.ds.showMenu.set(!1)};onWheel=t=>{let e=t.ctrlKey||t.metaKey,i=t.shiftKey;if(this.ds.showMenu()){t.preventDefault();return}if(!e&&!i&&this.scrollTop.set(this.scrollTop()+-t.deltaY),i&&!e&&this.scrollLeft.set(this.scrollLeft()+-(t.deltaY===0?t.deltaX:t.deltaY)),e){t.preventDefault();let n=this.scaleApp(),r=t.deltaY>0?-.1:.1,s=Math.max(.2,Math.min(n+r,1.5)),m=t.clientX,p=t.clientY,v=(m-this.scrollLeft())/n,y=(p-this.scrollTop())/n,x=m-s*v,E=p-s*y;this.scaleApp.set(+s.toFixed(4)),this.scrollLeft.set(x),this.scrollTop.set(E)}};onKeydown=t=>this.designerComponent.keyboardEvents(t);onContextMenu=t=>{t.preventDefault(),this.iframe?.contentWindow?.scrollTo(0,0);let e=t.clientX,i=t.clientY,n=this.iframe?.getBoundingClientRect().left??0,r=this.iframe?.getBoundingClientRect().top??0;this.ds.menuCoordinates.set({x:e+n,y:i+r});let s=t.target.closest(".wmw"),m=s?.getAttribute("wt");s==null||m=="content"||this.ds.showMenu.set(!0)};runEffects(){yt(()=>{this.ds.sandboxIsReady()&&(this.document?.body.style.setProperty("--scale-app",`${this.scaleApp()}`),this.document?.body.style.setProperty("--scroll-translate-x",`${this.scrollLeft()}px`),this.document?.body.style.setProperty("--scroll-translate-y",`${this.scrollTop()}px`))})}cleanup=()=>{this.window&&(this.window.removeEventListener("wheel",this.onWheel.bind(this)),this.window.removeEventListener("keydown",this.onKeydown.bind(this)),this.window.removeEventListener("contextmenu",this.onContextMenu.bind(this)),this.window.removeEventListener("mousedown",this.onMouseDown.bind(this))),this.window=null}};function dS(o,t){if(o&1&&ii(0,"img",0),o&2){let e=d();Jn("src",lt(e.image()),mt)}}function mS(o,t){if(o&1&&ii(0,"i",3),o&2){let e=d();it(e.icon())}}var zc=class o{icon=le(null);title=le(null);text=le("Text");image=le("https://cdn-icons-png.flaticon.com/128/16449/16449090.png");static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-menu-item"]],inputs:{icon:[1,"icon"],title:[1,"title"],text:[1,"text"],image:[1,"image"]},decls:4,vars:3,consts:[["alt","Image",1,"image","img-icon",3,"src"],["aria-hidden","true",3,"class"],[1,"text",3,"title"],["aria-hidden","true"]],template:function(e,i){e&1&&(D(0,dS,1,2,"img",0)(1,mS,1,2,"i",1),_t(2,"div",2),u(3),Ft()),e&2&&(T(i.icon()==null?0:1),c(2),Jn("title",i.title()??i.text()),c(),W(i.text()))},styles:["[_nghost-%COMP%]{display:flex;gap:.5rem;align-items:center;padding:.5rem 1rem;cursor:pointer;transition:background-color .2s ease-in-out}[_nghost-%COMP%]:hover{background-color:#ffffff1a}img[_ngcontent-%COMP%]{width:1rem}i[_ngcontent-%COMP%]{font-size:1rem}.text[_ngcontent-%COMP%]{font-size:.8rem}"]})};var pS=["menu"];function uS(o,t){if(o&1){let e=M();l(0,"app-menu-item",7),h("click",function(){g(e);let n=d();return C(n.emitAction("paste"))}),a()}}function fS(o,t){if(o&1){let e=M();l(0,"app-menu-item",8),h("click",function(){g(e);let n=d();return C(n.emitAction("save-image"))}),a(),l(1,"app-menu-item",9),h("click",function(){g(e);let n=d();return C(n.emitAction("generate-image"))}),a(),l(2,"app-menu-item",10),h("click",function(){g(e);let n=d();return C(n.emitAction("replace-image"))}),a()}}function hS(o,t){if(o&1){let e=M();l(0,"app-menu-item",19),h("click",function(){g(e);let n=d(2);return C(n.emitAction("pasteStyles"))}),a(),l(1,"app-menu-item",20),h("click",function(){g(e);let n=d(2);return C(n.emitAction("intensivePasteStyles"))}),a()}}function gS(o,t){if(o&1){let e=M();l(0,"app-menu-item",21),h("click",function(){g(e);let n=d(2);return C(n.emitAction("propagatePasteStyles"))}),a()}}function CS(o,t){if(o&1){let e=M();l(0,"app-menu-item",22),h("click",function(){g(e);let n=d(2);return C(n.emitAction("edit-component"))}),a(),_(1,"div",6)}}function _S(o,t){if(o&1){let e=M();l(0,"app-menu-item",23),h("click",function(){g(e);let n=d(2);return C(n.emitAction("to-component"))}),a(),_(1,"div",6)}}function vS(o,t){if(o&1){let e=M();l(0,"app-menu-item",24),h("click",function(){g(e);let n=d(2);return C(n.emitAction("ghost"))}),a()}}function yS(o,t){if(o&1){let e=M();_(0,"div",6),l(1,"div",2)(2,"app-menu-item",25),h("click",function(){g(e);let n=d(2);return C(n.emitAction("stack-row"))}),a(),l(3,"app-menu-item",26),h("click",function(){g(e);let n=d(2);return C(n.emitAction("stack-column"))}),a()()}}function bS(o,t){if(o&1){let e=M();l(0,"app-menu-item",27),h("click",function(){g(e);let n=d(2);return C(n.emitAction("ungroup"))}),a()}}function xS(o,t){if(o&1){let e=M();D(0,hS,2,0),D(1,gS,1,0,"app-menu-item",11),_(2,"div",6),D(3,CS,2,0),D(4,_S,2,0),l(5,"app-menu-item",12),h("click",function(){g(e);let n=d();return C(n.emitAction("duplicate"))}),a(),D(6,vS,1,0,"app-menu-item",13),_(7,"div",6),l(8,"app-menu-item",14),h("click",function(){g(e);let n=d();return C(n.emitAction("toPrev"))}),a(),l(9,"app-menu-item",15),h("click",function(){g(e);let n=d();return C(n.emitAction("toNext"))}),a(),_(10,"div",6),l(11,"app-menu-item",16),h("click",function(){g(e);let n=d();return C(n.emitAction("selectParent"))}),a(),D(12,yS,4,0),D(13,bS,1,0,"app-menu-item",17),_(14,"div",6),l(15,"app-menu-item",18),h("click",function(){g(e);let n=d();return C(n.emitAction("delete"))}),a()}if(o&2){let e=d();T(e.hasCachePaste()?0:-1),c(),T(e.manySelected()?-1:1),c(2),T(e.isComponent()?3:-1),c(),T(!e.manySelected()&&!e.isComponent()?4:-1),c(2),T(e.isGhost()?-1:6),c(6),T(e.selectedNodesService.selectedAreSiblings()?12:-1),c(),T(e.isLayout()?13:-1)}}var Bc=class o{menu;ds=b(Ue);selectedNodesService=b(_n);isComponent=ce(()=>this.selectedNodesService.size()==1&&this.selectedNodesService.lastNode()?.isCustom);manySelected=ce(()=>this.selectedNodesService.size()>1);isGhost=ce(()=>this.selectedNodesService.size()==1&&this.selectedNodesService.lastNode()?.ghost===!0);hasCachePaste=ce(()=>this.ds.copyCacheElements().length>0);isLayout=ce(()=>this.selectedNodesService.size()==1&&this.selectedNodesService.lastNode()?.type=="layout");action=Oe();constructor(){yt(()=>{this.ds.menuCoordinates(),this.ds.showMenu()&&setTimeout(()=>this.checkMenuPosition(),100)})}onClick(t){let e=t.target;this.menu.nativeElement&&!this.menu.nativeElement.contains(e)&&this.ds.showMenu.set(!1)}onContextMenu(t){t.preventDefault(),t.stopPropagation()}emitAction(t){this.action.emit(t),this.ds.showMenu.set(!1)}checkMenuPosition(){if(!this.menu?.nativeElement||!this.ds.showMenu())return;let e=this.menu.nativeElement.getBoundingClientRect(),i=window.innerWidth,n=window.innerHeight,r=this.ds.menuCoordinates(),s=!1;e.right>i&&(r=re(k({},r),{x:r.x-e.width}),s=!0),e.bottom>n&&(r=re(k({},r),{y:r.y-e.height}),s=!0),s&&this.ds.menuCoordinates.set(r)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-menu-designer"]],viewQuery:function(e,i){if(e&1&&ut(pS,5),e&2){let n;ct(n=dt())&&(i.menu=n.first)}},hostBindings:function(e,i){e&1&&h("mousedown",function(r){return i.onClick(r)},No)("contextmenu",function(r){return i.onContextMenu(r)})},outputs:{action:"action"},decls:9,vars:7,consts:[["menu",""],[3,"hidden"],[1,"d-flex","align-items-center"],["text","Copiar","icon","bi-clipboard",3,"click"],["text","Cortar","icon","bi-scissors",3,"click"],["text","Pegar","icon","bi-clipboard"],[1,"separator"],["text","Pegar","icon","bi-clipboard",3,"click"],["text","Guardar","image","https://cdn-icons-png.flaticon.com/512/4738/4738831.png",3,"click"],["text","Descargar imagen","image","https://cdn-icons-png.flaticon.com/128/446/446991.png",3,"click"],["text","Reemplazar imagen","image","https://cdn-icons-png.flaticon.com/512/3342/3342137.png",3,"click"],["text","Propagar estilos","icon","bi-patch-plus"],["text","Duplicar","icon","bi-files",3,"click"],["text","Fantasma","icon","bi-transparency"],["text","Mover atras","icon","bi-arrow-left",3,"click"],["text","Mover adelante","icon","bi-arrow-right",3,"click"],["text","Selccionar contenedor","icon","bi-box",3,"click"],["text","Desagrupar","image","https://cdn-icons-png.flaticon.com/128/13955/13955789.png"],["text","Eliminar","icon","bi-trash",3,"click"],["text","Superficial (solo elemento)","icon","bi-patch-plus",3,"click"],["text","Intensivo (incl. subelementos)","icon","bi-patch-plus",3,"click"],["text","Propagar estilos","icon","bi-patch-plus",3,"click"],["text","Editar componente","icon","bi-pencil-square",3,"click"],["text","Crear componente","icon","bi-box",3,"click"],["text","Fantasma","icon","bi-transparency",3,"click"],["text","Grupo","image","http://localhost:4201/assets/icons/row.svg",2,"flex","1",3,"click"],["text","Grupo H.","image","http://localhost:4201/assets/icons/col.svg",2,"flex","1",3,"click"],["text","Desagrupar","image","https://cdn-icons-png.flaticon.com/128/13955/13955789.png",3,"click"]],template:function(e,i){if(e&1){let n=M();l(0,"section",1,0)(2,"div",2)(3,"app-menu-item",3),h("click",function(){return g(n),C(i.emitAction("copy"))}),a(),l(4,"app-menu-item",4),h("click",function(){return g(n),C(i.emitAction("cut"))}),a(),D(5,uS,1,0,"app-menu-item",5),a(),_(6,"div",6),D(7,fS,3,0)(8,xS,16,7),a()}e&2&&(xt("top",i.ds.menuCoordinates().y+"px")("left",i.ds.menuCoordinates().x+"px"),f("hidden",!i.ds.showMenu()),c(5),T(i.hasCachePaste()?5:-1),c(2),T(i.ds.isDocumentMode()?7:8))},dependencies:[zc],styles:["[_nghost-%COMP%]{position:absolute;-webkit-user-select:none;user-select:none}[_nghost-%COMP%] > *[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}section[_ngcontent-%COMP%]{position:fixed;top:0;left:0;z-index:99999;min-width:280px;background-color:var(--ngx-contextmenu-background-color);color:var(--fuse-text-default);border-radius:.5rem;box-shadow:0 2px 10px #0003;overflow:hidden}.separator[_ngcontent-%COMP%]{height:1px;background-color:#5816161a}"]})};var wS=o=>({active:o});function SS(o,t){if(o&1){let e=M();l(0,"div",12),h("click",function(){let n=g(e).$implicit,r=d();return C(r.addVariant(n.variant))}),_(1,"img",13),a()}if(o&2){let e,i=t.$implicit,n=d();f("title",lt(i.label))("ngClass",te(5,wS,i.variant===((e=n.ds.standbyComponent())==null?null:e.variant))),c(),f("src",lt(i.icon),mt)}}function ES(o,t){if(o&1){let e=M();_(0,"div",14),l(1,"div",15),h("click",function(){g(e);let n=d();return C(n.addOthersComponents())}),_(2,"i",16),a()}}function PS(o,t){if(o&1){let e=M();l(0,"div",8),h("click",function(){g(e);let n=d();return C(n.ds.currentOverlayIdOpen.set(null))}),u(1,"Terminar"),a()}}var Wc=class o{ds=b(Ue);renderUtilsService=b(Dt);mediatorDesigner=le();addZoom(t){this.mediatorDesigner()?.addZoom(t)}openComponents=Oe();save=Oe();defaultComponents=[{variant:"header-text",label:"",icon:"https://cdn-icons-png.flaticon.com/128/2087/2087807.png"},{variant:"image",label:"",icon:"https://cdn-icons-png.flaticon.com/128/9261/9261193.png"},{variant:"icon",label:"Icono",icon:"https://cdn-icons-png.flaticon.com/128/2893/2893811.png"},{variant:"button",label:"Bot\xF3n",icon:"https://cdn-icons-png.flaticon.com/128/12653/12653546.png"},{variant:"column",label:"Pila",icon:"/assets/icons/row.svg"},{variant:"row",label:"Pila H.",icon:"/assets/icons/col.svg"}];documentComponets=[{variant:"header-text",label:"",icon:"https://cdn-icons-png.flaticon.com/128/2087/2087807.png"},{variant:"image",label:"",icon:"https://cdn-icons-png.flaticon.com/128/9261/9261193.png"},{variant:"icon",label:"Icono",icon:"https://cdn-icons-png.flaticon.com/128/2893/2893811.png"},{variant:"paragraph",label:"Parrafo",icon:"https://cdn-icons-png.flaticon.com/128/15758/15758303.png"},{variant:"box",label:"Caja",icon:"https://cdn-icons-png.flaticon.com/128/0/8.png"}];components=ce(()=>this.ds.isDocumentMode()?this.documentComponets:this.defaultComponents);addVariant(t){let e=null;switch(t){case"header-text":e={component:this.renderUtilsService.createInstanceOf("header-text"),variant:"header-text"};break;case"icon":e={component:this.renderUtilsService.createInstanceOf("icon"),variant:"icon"};break;case"image":e={component:this.renderUtilsService.createInstanceOf("image"),variant:"image"};break;case"paragraph":e={component:this.renderUtilsService.createInstanceOf("paragraph"),variant:"paragraph"};break;case"box":e={component:this.renderUtilsService.createInstanceOf("box"),variant:"box"};break;case"column":{let i=this.renderUtilsService.createLayoutComponent("column"),n=this.ds.createNodeProcessor(i);n?.setNodePadding({padding:"16px"}),n?.setNodeLayout({gap:"16px"}),n?.setNodeSize({width:"auto"}),i.children.push(this.renderUtilsService.createInstanceOf("header-text",{title:"ELEMENTO 1"})),i.children.push(this.renderUtilsService.createInstanceOf("header-text",{title:"ELEMENTO 2"})),e={component:i,variant:"column"}}break;case"row":{let i=this.renderUtilsService.createLayoutComponent("row");i.children.push(this.renderUtilsService.createInstanceOf("header-text",{title:"ELEMENTO 1"})),i.children.push(this.renderUtilsService.createInstanceOf("header-text",{title:"ELEMENTO 2"}));let n=this.ds.createNodeProcessor(i);n?.setNodePadding({padding:"16px"}),n?.setNodeLayout({gap:"16px"}),n?.setNodeSize({width:"auto"}),e={component:i,variant:"row"}}break;case"button":e={component:this.renderUtilsService.createInstanceOf("button"),variant:"button"};break}e&&this.ds.standbyComponent.set(e)}addOthersComponents(){this.openComponents.emit()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["action-buttons"]],inputs:{mediatorDesigner:[1,"mediatorDesigner"]},outputs:{openComponents:"openComponents",save:"save"},decls:22,vars:3,consts:[[1,"container"],[1,"action-button",3,"title","ngClass"],["title","zoom",1,"info"],["title","zoom in",1,"action-button",3,"click"],[1,"bi-zoom-in"],["title","zoom out",1,"action-button",3,"click"],[1,"bi-zoom-out"],[1,"bi-bounding-box-circles"],[1,"action-button","active",3,"click"],[1,"bi-play-fill"],[1,"bi-floppy2-fill"],[1,"action-button","active"],[1,"action-button",3,"click","title","ngClass"],[1,"img-icon",3,"src"],[1,"separator"],[1,"action-button",3,"click"],[1,"bi-plus"]],template:function(e,i){if(e&1&&(l(0,"div",0),Y(1,SS,2,7,"div",1,de),D(3,ES,3,0),a(),l(4,"div",0)(5,"div",2)(6,"span"),u(7),a()(),l(8,"div",3),h("click",function(){return i.addZoom(.1)}),_(9,"i",4),a(),l(10,"div",5),h("click",function(){return i.addZoom(-.1)}),_(11,"i",6),a(),l(12,"div",5),h("click",function(){let r;return(r=i.mediatorDesigner())==null?null:r.reestarDesignerView()}),_(13,"i",7),l(14,"span"),u(15,"Centrar"),a()()(),l(16,"div",0)(17,"div",8),h("click",function(){return i.ds.previewMode.set(!0)}),_(18,"i",9),a(),l(19,"div",8),h("click",function(){return i.save.emit()}),_(20,"i",10),a(),D(21,PS,2,0,"div",11),a()),e&2){let n;c(),ee(i.components()),c(2),T(i.ds.isDocumentMode()?-1:3),c(4),Ie("",((((n=i.mediatorDesigner())==null?null:n.scaleApp())??1)*100).toFixed(2),"%"),c(14),T(i.ds.modeOverlay()?21:-1)}},dependencies:[be],styles:["[_nghost-%COMP%]{display:flex;gap:.5rem}.container[_ngcontent-%COMP%]{border-radius:.75rem;background:var(--bg);display:flex;align-items:center;gap:.5rem;padding:.25rem;font-size:11px;box-shadow:0 2px .5rem #0003}.container[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{width:1px;height:1rem;background:#fff}.container[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;padding:.5rem;line-height:normal;border-radius:.5rem;cursor:pointer;min-height:34px;min-width:34px}.container[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:1rem}.container[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.container[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]:hover, .container[_ngcontent-%COMP%]   .action-button.active[_ngcontent-%COMP%]{background-color:var(--primary)}"]})};var MS=["iframe"],IS=["*"],$c=o=>({active:o});function DS(o,t){if(o&1&&_(0,"app-preview",1),o&2){let e=d();f("elements",e.context().nodes)}}function TS(o,t){if(o&1){let e=M();l(0,"div",28),h("click",function(){g(e);let n=d();return n.activeMenu.set("other"),C(n.changeTab("other"))}),_(1,"ng-icon",29),a()}if(o&2){let e=d();f("ngClass",te(2,$c,e.activeMenu()=="other"))("ngbTooltip",e.panelCustomName)}}function FS(o,t){if(o&1){let e=M();l(0,"div",28),h("click",function(){g(e);let n=d();return n.activeMenu.set("explorer"),C(n.changeTab("explorer"))}),_(1,"ng-icon",30),a()}if(o&2){let e=d();f("ngClass",te(2,$c,e.activeMenu()=="explorer"))("ngbTooltip","\xC1rbol de elementos")}}function kS(o,t){if(o&1){let e=M();l(0,"div",28),h("click",function(){g(e);let n=d();return n.activeMenu.set("storage"),C(n.changeTab("storage"))}),_(1,"ng-icon",31),a()}if(o&2){let e=d();f("ngClass",te(2,$c,e.activeMenu()=="storage"))("ngbTooltip","Im\xE1genes")}}function OS(o,t){if(o&1){let e=M();l(0,"div",28),h("click",function(){g(e);let n=d();return n.activeMenu.set("sections"),C(n.changeTab("sections"))}),_(1,"ng-icon",32),a()}if(o&2){let e=d();f("ngClass",te(2,$c,e.activeMenu()=="sections"))("ngbTooltip","Secciones")}}function VS(o,t){if(o&1){let e=M();l(0,"app-ui-storage",33),h("eventChange",function(n){g(e);let r=d();return C(r.onEvent(n))}),a()}if(o&2){let e=d();f("hidden",e.activeMenu()!="storage")}}function NS(o,t){if(o&1&&_(0,"app-components-menu",2),o&2){let e=d();f("hidden",e.activeMenu()!="components")}}function AS(o,t){if(o&1&&_(0,"app-section-list",2),o&2){let e=d();f("hidden",e.activeMenu()!="sections")}}function jS(o,t){o&1&&(l(0,"div",19),_(1,"ng-icon",34),l(2,"b"),u(3,"No hay elementos cargados"),a(),l(4,"p"),u(5,"para habilitarla selecciona una p\xE1gina o componente"),a()())}function RS(o,t){if(o&1){let e=M();l(0,"div",36)(1,"button",38),_(2,"ng-icon",39),a(),l(3,"div",40)(4,"button",41),h("click",function(){g(e);let n=d(2);return C(n.shared("shared"))}),u(5,"Compartir"),a(),l(6,"button",41),h("click",function(){g(e);let n=d(2);return C(n.shared("public"))}),u(7,"Publicar"),a(),l(8,"button",41),h("click",function(){g(e);let n=d(2);return C(n.shared("download"))}),u(9,"Descargar zip"),a()()()}}function LS(o,t){if(o&1){let e=M();l(0,"button",42),h("click",function(){g(e);let n=d(2);return C(n.screenShotHandler(!0))}),u(1," Descargar "),a(),l(2,"button",43),h("click",function(){g(e);let n=d(2);return C(n.screenShotHandler(!1))}),u(3," Reemplazar "),a()}}function US(o,t){if(o&1){let e=M();l(0,"button",44),h("click",function(){g(e);let n=d(2);return C(n.resetForm())}),u(1,"Campos del componente"),a()}}function zS(o,t){if(o&1&&(l(0,"div",22)(1,"b"),u(2,"Acciones"),a(),l(3,"div",35),D(4,RS,10,0,"div",36),D(5,LS,4,0),D(6,US,2,0,"button",37),a()()),o&2){let e=d();c(4),T((e.ds.isPageMode()||e.ds.isCMSMode())&&!e.ds.modeOverlay()?4:-1),c(),T(e.ds.isDocumentMode()?5:-1),c(),T(e.ds.isComponentMode()&&e.ds.formNode()!=null?6:-1)}}function BS(o,t){o&1&&(l(0,"div",24),_(1,"app-device-handler"),a())}function WS(o,t){if(o&1){let e=M();l(0,"app-edit-form",45),h("fieldChange",function(n){g(e);let r=d();return C(r.onFieldChange(n))})("onEventChange",function(n){g(e);let r=d();return C(r.onEventChange(n))})("onOverlayChange",function(n){g(e);let r=d();return C(r.addOverlay(n))})("onEditOverlay",function(n){g(e);let r=d();return C(r.onEditOverlay(n))})("onChangeProp",function(n){g(e);let r=d();return C(r.changeProp(n))}),a()}}function $S(o,t){o&1&&_(0,"app-custom-component-fields-form")}function HS(o,t){o&1&&(l(0,"div",26),_(1,"ng-icon",46),l(2,"b"),u(3,"Editor de propiedades"),a(),l(4,"p"),u(5,"Selecciona un elemento para editar"),a()())}function GS(o,t){if(o&1&&_(0,"app-loading",27),o&2){let e=d();f("text",lt(e.loading()))}}var Po=class o{save(){this.ds.isComponentMode()?this.restoreContext():this.saveDesign.emit()}mediatorDesigner=new Uc;ds=b(Ue);helperPanel=b(Vt);toastr=b(tt);treeExplorerService=b(wo);authService=b(xe);editorFormService=b(jr);contextGeneratorService=b(Rn);componentManagerService=b(Dt);selectedNodesService=b(_n);manager=b(xo);modalService=b(St);ngZone=b(fi);router=b(ln);test=b(qr);confirmService=b(li);cleanup=null;base=this.authService.projectPath;loading=A("");typeForm=A("form");activeMenu=A("other");treeNodes=this.manager.treeNodes;isReadyComponents=ce(()=>this.ds.isPageMode()?this.componentManagerService.isReady():this.componentManagerService.isComponentReady());formNode=this.ds.formNode;isReadyIframeHtml=A(!1);isAllReady=ce(()=>this.isReadyComponents()&&this.isReadyIframeHtml()&&this.ds.sandboxIsReady());lastNavigateLink=A(null);haveNodes=ce(()=>this.context().nodes.length>0);context=this.ds.contextDesign;cutomFormFields=A([]);title="";panelCustomName="Panel";saveDesign=new q;sharedDesign=Oe();imageDesign=new q;metadata=A(null);subscriptions=new Ji;iframe;isLinkBanck=!0;backDesign=new q;goBack(){return P(this,null,function*(){if(this.ds.isComponentMode()){if(this.context().mode=="component-editor"){let e=this.context().metadata.oldNodes;this.changeContext(e,"main-editor",{}),this.ds.setCustomFields([])}}else this.activeMenu()==="explorer"?this.activeMenu.set("other"):this.activeMenu()==="other"?this.ds.isPageMode()||this.ds.isCMSMode()?this.router.navigate([this.base(),"proyectos",this.metadata()?.project_id??""]):(this.ds.isSectionMode()||this.ds.isComponentMode())&&this.router.navigate([this.base()]):this.activeMenu.set("explorer");this.backDesign.emit()})}set elementsData(t){this.resetForm(),this.manager.reset(),this.context.set({nodes:t.nodes,mode:t.mode,metadata:{}}),this.helperPanel.close(),this.ds.showMenu.set(!1),this.ds.isHoverMode.set(!1),this.selectedNodesService.clear(),this.ds.currentOverlayIdOpen.set(null),this.activeMenu.set("other"),t.project_id!=null&&t.item_id!=null&&this.metadata.set({project_id:t.project_id,item_id:t.item_id})}presetCMSPage(){return this.test.htmlStringToNodes(`
                    <div style="width: 100%; background-color: #f0f0f0; padding: 32px;">
                        <h1 style="color: red">Lorem ipsum dolor sit amet</h1>
                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                        <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                    </div>
                `)}set setDeviceSize(t){let e=this.ds.deviceInfo();Object.entries(t).forEach(([i,n])=>{e[+i]&&(e[+i].width=n)}),this.ds.deviceInfo.set([...e]),this.updateDesigner("device size change")}constructor(){this.mediatorDesigner.setDesignerService(this.ds),this.mediatorDesigner.setDesignerComponent(this),this.manager.setComponentManager(this.componentManagerService),this.manager.setProjectHandler(this.ds.dataHandler),this.manager.onNormalizeTree(()=>this.updateDesigner("normalize tree"));let t=this.ds.listenNewSection.subscribe(e=>{this.manager.addSection(e)});this.subscriptions.add(t),this.setupKeyboardListener(),yt(()=>{this.ds.isHoverMode(),Ci(()=>{this.helperPanel.close()})}),yt(()=>{let e=this.ds.dataHandler.currentProjectCms()?.rows??[],i=this.ds.dataHandler.currentProjectCms()?.fields??[];if(e.length==0||i.length==0)return;let[n]=e,r=[];i.forEach(s=>{let m={id:s.id,name:s.name,type:s.type,value:n[s.id]};r.push(m)}),Ci(()=>{this.ds.dataHandler.setCmsVariables(r)})}),yt(()=>{let e=this.selectedNodesService.nodeList(),i=this.ds.cssComponentContext(),n=this.ds.isHoverMode(),r=this.ds.formNode()?.id,s=e.find(m=>m.type==="overlay"||m.type==="dialog");Ci(()=>{s&&this.ds.currentOverlayIdOpen.set({id:s.id,type:s.type});let m=e.map(p=>{let y=n&&p.id===r?uo(p.css.h??{},p.css.main??{}):p.css.main??{},x=i.startsWith("h")?uo(p.css[i]??{},y):y;return{id:p.id,type:p.type,childrenLenght:p.children.length,fields:p.fields,currentCss:x??{},ghost:p.ghost,isCustomComponent:p.isCustom===!0,vars:p.vars}});this.ds.selectNodes(m)})}),yt(()=>{let e=this.selectedNodesService.last();Ci(()=>{e&&(this.activeMenu()!=="storage"&&this.activeMenu.set("explorer"),this.treeExplorerService.remoteExpand(e)),this.updateLastNodeSelected(e)})}),yt(()=>{let e=this.isAllReady();Ci(()=>{e&&this.updateDesigner("main launch")})}),yt(()=>{this.ds.updateActiveDevice(),Ci(()=>{this.helperPanel.close(),this.mediatorDesigner.scrollTop.set(16)})}),yt(()=>this.ds.updateCssContext()),yt(()=>this.ds.updateAddersState()),yt(()=>this.ds.updateCurrentOverlayIdOpen()),yt(()=>this.ds.updateFontFamily()),yt(()=>this.ds.updateVars()),yt(()=>this.ds.updateActiveHover()),yt(()=>{this.isReadyComponents()&&this.context().nodes.length>0&&Ci(()=>{this.componentManagerService.normalizeNodes(this.context().nodes),this.manager.setNodes(this.context().nodes)})}),this.mediatorDesigner.runEffects()}resetForm=()=>this.ds.updateFormNode(null);onWindowMessage(t){t.data=="sandbox-ready"&&(this.ds.sandboxIsReady.set(!0),this.mediatorDesigner.setContext(this.iframe.nativeElement),this.ds.onNodeMouseDown((e,i)=>{if(e!=null&&(this.selectedNodesService.add(e,i),this.setGhostMode({unGhost:!0,id:e})),this.ds.hasStandbyComponent()&&this.ds.isDocumentMode()){let n=this.ds.standbyComponent().component,r=this.ds.createNodeProcessor(n);if(r==null)return;r.setNodePosition({top:i.offsetY+"px",left:i.offsetX+"px",position:"absolute"}),r.setNodeOverflow({"z-index":"1"}),this.manager.addNodeToDocument(n),this.ds.removeStandby();return}}),this.ds.onNodeMouseUp((e,i)=>{this.selectedNodesService.addAfterClick(e,i);let r=Array.from(this.ds.iframeContext()?.document.querySelectorAll('[wt="tab"]')??[]).map(s=>({wmid:s.getAttribute("wmid"),id:s.id})).filter(s=>s.id!=null&&s.id!=="").map(s=>({id:s.id,children:this.manager.find(s.wmid)?.children??[]}));this.ds.nodeTabContainers.set(r)}),this.ds.onIncomingMessage(this.incomingMessage.bind(this)))}addOverlay(t){let e=this.formNode();if(e==null)return;let i=t==="dropdown"?this.componentManagerService.createDropdownComponent():this.componentManagerService.createDialogComponent();this.manager.addChildren(e.id,i),this.updateCurrentFormData()}onEditOverlay(t){this.selectedNodesService.add(t)}changeContext=(t,e,i)=>{this.ds.cssComponentContext.set("main"),this.manager.reset(),this.selectedNodesService.clear(),this.context.set({nodes:t,mode:e,metadata:i}),this.updateDesigner("switch context"),this.manager.setNodes(t),this.mediatorDesigner.reestarDesignerView(),this.resetForm()};restoreContext(){return P(this,null,function*(){let t=this.context().mode;if(t=="component-editor"){this.loading.set("Cargando...");let e=this.context().nodes[0].children,i=this.context().metadata["db-id"],n=this.context().metadata.type,r=this.context().metadata.oldNodes;yield this.componentManagerService.updateProjectComponent(i,e,n,this.ds.customFields()),this.changeContext(r,"main-editor",{}),this.loading.set(""),this.ds.setCustomFields([])}else if(t=="tab-editor"){let e=this.context().metadata.contextId,i=this.context().metadata.oldNodes,n=this.context().nodes[0].children;this.changeContext(i,"main-editor",{});let r=this.manager.find(e);if(r==null)return;r.children=[...n],this.updateDesigner("restore context")}})}saveHistory=t=>{console.log("Saving history... "+t);let e=Date.now();e-this.lastHistorySave>500&&this.manager.saveHistory(),this.lastHistorySave=e};lastCursorPosition=()=>{let t=this.iframe?.nativeElement.contentDocument;if(t==null)return{x:0,y:0};let e=this.selectedNodesService.last();if(e==null)return{x:0,y:0};let i=t.querySelector(`[wmid="${e}"]`);if(i==null)return{x:0,y:0};let n=i.getBoundingClientRect(),r=n.left,s=n.top,m=n.height,p=this.iframe?.nativeElement.getBoundingClientRect().left??0,v=this.iframe?.nativeElement.getBoundingClientRect().top??0;return{x:r+p,y:s+v+m}};setupKeyboardListener(){this.ngZone.runOutsideAngular(()=>{this.cleanup=this.ngZone.runOutsideAngular(()=>{let t=this.keyboardEvents.bind(this),e=i=>{(i.ctrlKey||i.metaKey)&&i.preventDefault()};return window.addEventListener("keydown",t),window.addEventListener("wheel",e,{passive:!1}),()=>{window.removeEventListener("keydown",t),window.removeEventListener("wheel",e)}})})}ngAfterViewInit(){return P(this,null,function*(){let t=this.iframe?.nativeElement.contentDocument,e=yield this.contextGeneratorService.generateSandboxPage();t&&(t?.open(),t?.write(e),t?.close(),this.ds.setContext(this.iframe?.nativeElement??null),this.isReadyIframeHtml.set(!0))})}generatePreview(){this.ds.previewMode.update(t=>t=!t)}closeOverlay=()=>this.ds.currentOverlayIdOpen.set(null);openVariablesForm(){this.modalService.openAsync(gc,{title:"Variables",size:"lg",hiddenMargin:!0,hiddenButtons:!0}).then(t=>{this.manager.normalize(),this.updateDesigner("Variables updated")})}lastHistorySave=0;onFieldChange(t){if(this.ds.formNode()==null)return;let e=this.manager.find(this.ds.formNode().id);if(e!=null){if(this.saveHistory("field change"),t.source==="field"&&(e.fields[t.field]=t.value),t.source==="styles"){let i=this.ds.isHoverMode(),n=this.ds.cssComponentContext()==="main";if(!n&&(this.ds.isPageMode()||this.ds.isSectionMode())){this.toastr.error("No se detecto encuentra dentro de un componente para poder editar estilos");return}if(!n&&i){this.toastr.error("No se puede editar estilos hover de un elemento en modo hover del componente");return}let r=i?"h":this.ds.cssComponentContext();e.css==null&&(e.css={}),e.css[r]==null&&(e.css[r]={}),e.css[r][t.field]=t.value,this.updateCurrentFormData()}this.updateDesignNode(e)}}changeProp(t){if(this.ds.formNode()==null)return;let e=this.manager.find(this.ds.formNode().id);e!=null&&(this.saveHistory("prop change"),e[t.key]=Ee(t.value),this.updateDesignNode(e),this.updateCurrentFormData())}onEventChange(t){if(this.ds.formNode()==null)return;let e=this.manager.find(this.ds.formNode().id);e!=null&&(this.saveHistory("event change"),e.events=Ee(t),this.updateDesignNode(e),this.updateCurrentFormData())}updateDesignNode(t){this.manager.normalize();let e=this.componentManagerService.genarateSimpleDevComponent(t);this.ds.recreateElement(e)}updateDesigner(i){return P(this,arguments,function*(t,e=this.context().nodes){if(t!=null&&console.log("%c[source]: "+t,"background:rgb(88, 75, 207); font-size: 16px; border-radius: 5px; padding: 4px 8px; color: white;"),!this.isAllReady()){console.warn("El dise\xF1ador no est\xE1 listo para actualizar el contenido del iframe");return}console.log("%cUpdating iframe content...","color: #bada55; font-size: 16px; border-radius: 5px; margin: 10px 0;");try{let n=this.componentManagerService.generateDesignerResources(e),r=this.selectedNodesService.list().map(m=>this.manager.find(m)).filter(m=>m!=null).map(m=>({id:m.id,type:m.type,childrenLenght:m.children.length,fields:m.fields,currentCss:m.css[this.ds.cssComponentContext()]??{},ghost:m.ghost,isCustomComponent:m.isCustom===!0,vars:m.vars})),s={styles:n.styles,classScript:n.componentScript,scripts:n.components,styleSheet:n.styleSheet,selectedNodes:r,mode:this.ds.contextDesign().mode};this.ds.insertResources(s)}catch(n){console.error("Error updating iframe content:",n)}})}eventTree(t){this.selectedNodesService.size()!==0&&(t.targetIndex==null||t.targetIndex===-1||t.targetParentId==null||this.manager.moveNodes(this.selectedNodesService.list(),t.targetParentId,t.targetIndex))}keyboardEvents(t){if(this.ds.hasDisabledEvents())return;let e=t.key?.toLocaleLowerCase();if(e==="."){this.ds.showMenu.set(!0);let i=this.lastCursorPosition();this.ds.menuCoordinates.set({x:i.x,y:i.y})}else if(e==="delete")this.removeElements("delete");else if(e==="escape")this.ds.showMenu()?this.ds.showMenu.set(!1):this.ds.hasStandbyComponent()?this.ds.removeStandby():this.selectedNodesService.selectParent()?.type==="overlay"&&this.closeOverlay();else if(t.ctrlKey)switch(e){case"d":t.preventDefault(),this.duplicateElements();break;case"z":this.undoState();break;case"c":this.prepareCopy();break;case"x":this.removeElements("cut");break;case"v":this.pasteElement();break;case"arrowup":case"arrowleft":this.moveLastNode("toPrev");break;case"arrowdown":case"arrowright":this.moveLastNode("toNext");break}else if(["arrowdown","arrowup","arrowleft","arrowright"].includes(e)){let i=e==="arrowleft"?-1:e==="arrowright"?1:0,n=e==="arrowup"?-1:e==="arrowdown"?1:0,r=this.selectedNodesService.list().map(s=>this.manager.find(s)).filter(s=>s!=null);if(r.length===0)return;this.saveHistory("move with keyboard"),r.forEach(s=>{let m=this.ds.createNodeProcessor(s),p=m?.htmlData();m==null||p==null||!p.isFree||(m.setPosition({top:p.top+n,left:p.left+i}),this.updateDesignNode(s))}),this.updateCurrentFormData(),t.preventDefault()}}onActionMenu(t){return P(this,null,function*(){switch(t){case"ghost":this.setGhostMode();break;case"delete":this.removeElements("delete");break;case"cut":this.removeElements("cut");break;case"toPrev":case"toNext":this.moveLastNode(t);break;case"duplicate":this.duplicateElements();break;case"copy":this.prepareCopy();break;case"paste":this.pasteElement();break;case"pasteStyles":this.pasteStyles();break;case"intensivePasteStyles":this.pasteStyles("intensive");break;case"replace":let e=this.selectedNodesService.list();if(e.length===0)return;let i=this.ds.copyCacheElements();if(i.length!=1)return;this.manager.replaceMultipleWith(e,i[0]),this.updateCurrentFormData();break;case"stack-column":case"stack-row":this.handlerWrapperStack(t);break;case"ungroup":this.handlerUnWrapperStack();break;case"edit-component":this.editComponentHandler();break;case"propagatePasteStyles":this.handlerPropagation();break;case"to-component":this.createComponentFromNode();break;case"selectParent":this.selectedNodesService.selectParent();break;case"navigate":this.router.navigate(["maker","design",this.metadata()?.project_id??"",this.lastNavigateLink()?.pageId??""]);break;case"generate-image":this.screenShotHandler(!0);break;case"replace-image":this.screenShotHandler(!1);break;case"save-image":this.saveDesign.emit();break;case"ai-fill":this.ds.setDisabledEvents(!0);let n=yield this.confirmService.prompt({title:"AI Fill",message:"\xBFDeseas rellenar este contenedor con elementos?",type:"confirm",minPromptLength:2});if(!n.isOk)return;this.loading.set("Cargando...");let r=this.selectedNodesService.first(),s=yield this.test.generateComponent(n.prompt??"");s&&r!=null?(this.saveHistory("ai fill"),this.manager.replaceWith(r,s)):console.log("No se puede generar el componente"),this.loading.set(""),this.ds.setDisabledEvents(!1);break}})}incomingMessage(s){return P(this,arguments,function*({type:t,id:e,data:i,action:n,position:r}){switch(t){case"focus":this.editorFormService.focusInput(),this.editComponentHandler();break;case"text-format":n&&this.handlerTextFormat(n);break;case"style-change":let m=i;this.saveHistory("style change"),m.forEach(p=>{this.processStyleChange(p.trigger,p.style,p.id)}),this.updateCurrentFormData();break;case"reset-selection":this.resetForm(),this.selectedNodesService.clear();break;case"css-context":this.ds.cssComponentContext()!=i&&this.ds.isHoverMode.set(!1),this.ds.cssComponentContext.set(i);break}if(e!=null)switch(t){case"target-sibling":let m=this.ds.standbyComponent()?.component;if(m==null)return;this.manager.addSibling(e,m,r??"after"),this.ds.removeStandby();break;case"target-child":let p=this.ds.standbyComponent()?.component;if(p==null)return;this.manager.addChildren(e,p),this.ds.removeStandby();break;case"navigate-data":let v=i?.replace("page_","");this.lastNavigateLink.set({nodeId:e,pageId:v});break;case"editor-tab":let y=this.manager.find(e);if(y==null)return;let x=this.componentManagerService.createInstanceOf("content");x.name="Tab EDITOR",x.children=y.children,this.changeContext([x],"tab-editor",{contextId:e,oldNodes:this.context().nodes});break}})}addZoom(t){let e=this.iframe?.nativeElement.offsetWidth??0,i=this.mediatorDesigner.scaleApp(),n=Math.max(.2,Math.min(i+t,1.5)),r=(e/2-this.mediatorDesigner.scrollLeft())/i,s=e/2-n*r;this.mediatorDesigner.scaleApp.set(n),this.mediatorDesigner.scrollLeft.set(s)}screenShotHandler(t=!1){return P(this,null,function*(){let e=this.selectedNodesService.lastNode();if(e==null)return;let i=e.id;try{this.loading.set("Creando captura...");let n=yield this.ds.takeScreenShot(i);if(this.loading.set(""),n)if(t){let r=new Image;r.src=n;let s=document.createElement("a");s.href=n,s.download=`screenshot-${i}.png`,document.body.appendChild(s),s.click(),document.body.removeChild(s),this.toastr.success("Captura de pantalla generada correctamente")}else{let r=Tp(n,`screenshot-${i}.png`);this.imageDesign.emit({file:r,loading:this.loading})}else this.toastr.error("No se pudo generar la captura de pantalla")}catch(n){console.error("Error al generar la captura:",n),this.toastr.error("Error al generar la captura de pantalla")}})}editComponentHandler(){let t=this.selectedNodesService.lastNode();if(t==null||t.isCustom!==!0)return;let e=t.id,i=t.type,n=this.componentManagerService.mapUserComponentElements()[i],r=this.componentManagerService.createInstanceOf("content");r.name=t.name??"Componente",r.children=n.nodes,this.ds.setCustomFields(n.fields),this.changeContext([r],"component-editor",{componentId:e,"db-id":n.id,type:i,oldNodes:this.context().nodes}),this.mediatorDesigner.reestarDesignerView()}createComponentFromNode(){return P(this,null,function*(){let t=this.metadata()?.project_id;if(t==null)return;let[e]=this.selectedNodesService.list().map(n=>this.manager.find(n)).filter(n=>n!=null);if(e==null)return;this.ds.setDisabledEvents(!0);let i=yield this.confirmService.prompt({message:"Elige un nombre para el componente",title:"Crear componente",minPromptLength:3,promptRegex:/^[a-zA-Z0-9_ ]+$/,promptErrorMessage:"El nombre del componente solo puede contener letras, n\xFAmeros, guiones bajos y espacios"});this.ds.setDisabledEvents(!1),i.isOk&&(yield this.componentManagerService.createUserComponent(e,i.prompt?.trim()??"",+t))})}handlerPropagation(){let t=this.selectedNodesService.first();if(t==null)return;let e=this.manager.propagateStyles(t);e.length!=0&&(e.forEach(i=>{this.updateDesignNode(i)}),this.updateCurrentFormData())}handlerPositionChange(t){let e=this.selectedNodesService.list().map(i=>this.manager.find(i)).filter(i=>i!=null);this.saveHistory("position change"),e.forEach(i=>{let n=this.ds.createNodeProcessor(i),r=n?.htmlData();if(n==null||r==null)return;let s=t==="position-abs"?"absolute":"relative";s=="absolute"?(n.setNodeOverflow({"z-index":"1"}),n.setNodeSize({width:r.width+"px",height:r.height+"px"}),n.setNodePosition({top:r.top+"px",left:r.left+"px",right:"",bottom:"",transform:"initial","ctrl-mv":"","ctrl-mh":"",position:s})):(n.setNodeOverflow({"z-index":""}),n.setNodePosition({top:"",left:"",right:"",bottom:"",transform:"initial","ctrl-mv":"","ctrl-mh":"",position:s})),this.updateDesignNode(i)}),this.updateCurrentFormData()}handlerTextFormat(t){if(this.selectedNodesService.size()===0)return;this.saveHistory("text format"),this.selectedNodesService.list().forEach(i=>{let n=this.manager.find(i);if(n==null)return;let r=new En(n,this.ds.device(),this.ds.cssComponentContext()),s=r.getTextStyle(),m=s?.["font-weight"]==="bold",p=s?.["font-style"]==="italic";t==="tf-bold"&&r.setNodeTextStyle({"font-weight":m?"normal":"bold"}),t==="tf-italic"&&r.setNodeTextStyle({"font-style":p?"normal":"italic"}),["tf-text-center","tf-text-left","tf-text-right","tf-text-justify"].includes(t)&&r.setNodeTextAlign({"text-align":t.replace("tf-text-","")}),pa[t]&&r.setNodeFontSize({"font-size":pa[t]}),this.updateDesignNode(n)}),this.updateCurrentFormData()}setGhostMode(t){if(t==null)this.saveHistory("ghost mode"),this.selectedNodesService.list().map(i=>this.manager.find(i)).filter(i=>i!=null).forEach(i=>{i.ghost=i.ghost!==!0,this.updateDesignNode(i)});else{let e=this.manager.find(t.id);if(e==null||e.ghost!==!0)return;this.saveHistory("ghost mode"),e.ghost=!1,this.updateDesignNode(e)}this.updateCurrentFormData()}processStyleChange(t,e,i){let n=this.manager.find(i);if(n==null)return;let r=new En(n,this.ds.device(),this.ds.cssComponentContext()),m=n.type==="icon",p=!["relative","sticky"].includes(e.position),v=r.getSize(),[y,x]=[po(v.width),po(v.height)],E={bottom:"",right:""};if(t=="resize")if(m)r.setNodeFontSize({"font-size":e.width+"px"});else{let w={width:v.width||"auto",height:v.height||"auto"};e.hasWidthChanged&&(y.unit=="%"?w.width=e.percentWidth+"%":w.width=e.width+"px"),e.hasHeightChanged&&(x.unit=="%"?w.height=e.percentHeight+"%":w.height=e.height+"px"),r.setNodeSize(w)}if(t==="drag"||p&&t==="resize"){let w={};e.isNearTop?w.top=e.top:w.bottom=e.bottom,e.isNearLeft?w.left=e.left:w.right=e.right,r.setPosition(w)}if(t=="radius"){let w=e.radius+"px";r.setNodeBorderRadius({"border-radius":w})}this.updateDesignNode(n)}handlerWrapperStack(t){this.manager.wrapperInStack(this.selectedNodesService.list(),t)}handlerUnWrapperStack(){let t=this.selectedNodesService.lastNode();t!=null&&this.manager.unwrapContainer(t.id)}undoState=()=>{this.manager.undo()&&this.updateCurrentFormData()};takeScreenshot(t=!0){return P(this,null,function*(){let i=yield this.iframe?.nativeElement.contentWindow?.takeScreenShot(t),r=yield(yield fetch(i)).blob();return new File([r],"screenshot.png",{type:"image/png"})})}prepareCopy(){this.ds.copyCacheElements.set(this.manager.createClones(this.selectedNodesService.list()))}updateLastNodeSelected(t){if(t==null){this.resetForm();return}if(this.ds.formNode()?.id===t)return;let e=this.manager.find(t);e&&this.updateFormData(e)}pasteElement(){let t=this.selectedNodesService.last();if(t==null||this.ds.copyCacheElements().length===0)return;let e=this.ds.copyCacheElements().map(i=>Dt.createDuplicate(i));this.manager.addSibling(t,e)}moveLastNode(t){this.manager.moveSiblings(this.selectedNodesService.list(),t)}updateFormData(t){this.ds.updateFormNode(t)}updateCurrentFormData(){if(this.ds.formNode()==null)return;let t=this.manager.find(this.ds.formNode().id);t&&this.updateFormData(t)}duplicateElements(){this.manager.duplicateNodes(this.selectedNodesService.list())}pasteStyles(t="normal"){this.saveHistory();let e=this.manager.pasteStyles(this.ds.copyCacheElements(),this.selectedNodesService.list(),{intensive:t==="intensive"});e.forEach(this.updateDesignNode.bind(this)),e.length>0&&this.updateCurrentFormData()}removeElements(t){return P(this,null,function*(){let e=this.manager.removeElements(this.selectedNodesService.list());e.length!=0&&this.ds.copyCacheElements.set(t==="cut"?e:[])})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup&&this.cleanup(),this.ds.resetDesigner(),this.mediatorDesigner.cleanup(),this.selectedNodesService.clear()}shared(t){this.sharedDesign.emit(t)}loadStorage=A(!1);copy(t){this.selectedNodesService.list().map(n=>this.manager.find(n)).filter(n=>n!=null&&n.type=="image").forEach(n=>{n&&(n.fields.imageUrl=t,this.updateDesignNode(n))}),this.updateCurrentFormData()}onEvent(t){t.data.fileType.includes("image")&&this.copy(t.data.fileUrl)}tabs=A({});changeTab=t=>this.tabs.set(re(k({},this.tabs()),{[t]:!0}));openComponentTab(){this.activeMenu.set("components"),this.changeTab("components")}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-designer"]],viewQuery:function(e,i){if(e&1&&ut(MS,5),e&2){let n;ct(n=dt())&&(i.iframe=n.first)}},hostBindings:function(e,i){e&1&&h("message",function(r){return i.onWindowMessage(r)},No)},inputs:{title:"title",panelCustomName:"panelCustomName",isLinkBanck:"isLinkBanck",elementsData:"elementsData",setDeviceSize:"setDeviceSize"},outputs:{saveDesign:"saveDesign",sharedDesign:"sharedDesign",imageDesign:"imageDesign",backDesign:"backDesign"},features:[we([Te({lucideSave:ro,lucideInbox:fu,lucideRatio:ku,lucidePaintRoller:Ls,lucidePickaxe:Tu,lucideShare2:Ru,lucidePlay:Fu,lucideDatabase:ou,lucideLayoutPanelLeft:_u,lucideLayoutList:Cu,lucideRows2:Bs,lucideVariable:$u,lucideFolderTree:du,lucideImageUp:pu})])],ngContentSelectors:IS,decls:37,vars:23,consts:[["iframe",""],[3,"elements"],[3,"hidden"],[3,"action"],["id","aside-nav-wrapper"],["id","aside-nav-body"],["href","javascript:void(0)",1,"navbar-brand","nav-designer-item",3,"click"],[1,"icon","ion-md-arrow-back"],["placement","end",1,"nav-designer-item",3,"ngClass","ngbTooltip"],["placement","end",1,"nav-designer-item",3,"click","ngbTooltip"],["name","lucideVariable","size","18"],["id","logo","src","/assets/icons/codicoresac.svg","alt",""],["initialPanel1Size","240px","initialPanel3Size","300px"],["pane1","",1,"panel-one"],[3,"move","hidden","treeData"],[2,"padding","0 0.25rem",3,"hidden"],["pane2","",1,"panel-center"],[2,"height","100%","width","100%",3,"hidden"],["tabindex","0"],[1,"w-100","h-100","d-flex",2,"justify-content","center","align-items","center","flex-direction","column"],[3,"openComponents","save","mediatorDesigner"],["pane3","",1,"panel3"],["id","action-area",1,"d-flex","px-2","py-1","align-items-center","justify-content-between"],["id","area-right"],[1,"device-controls"],[1,"panel-form"],[1,"w-100","h-100","d-flex","text-center",2,"justify-content","center","align-items","center","flex-direction","column"],[3,"text"],["placement","end",1,"nav-designer-item",3,"click","ngClass","ngbTooltip"],["name","lucideLayoutList","size","18"],["name","lucideFolderTree","size","18"],["name","lucideImageUp","size","18"],["name","lucideRows2","size","18"],[3,"eventChange","hidden"],["name","lucideInbox","size","80",1,"mb-3"],[1,"d-flex","gap-1","align-items-center"],["ngbDropdown","","placement","bottom-end",1,"d-inline-block"],["app-button","","color","secondary"],["app-button","","color","warning","ngbDropdownToggle",""],["name","lucideShare2"],["ngbDropdownMenu",""],["ngbDropdownItem","",3,"click"],["app-button","","color","warning",3,"click"],["app-button","","color","primary",3,"click"],["app-button","","color","secondary",3,"click"],[3,"fieldChange","onEventChange","onOverlayChange","onEditOverlay","onChangeProp"],["name","lucidePaintRoller","size","80",1,"mb-3"]],template:function(e,i){if(e&1){let n=M();Li(),D(0,DS,1,1,"app-preview",1),l(1,"div",2)(2,"app-menu-designer",3),h("action",function(s){return g(n),C(i.onActionMenu(s))}),a(),l(3,"div",4)(4,"div",5)(5,"a",6),h("click",function(){return g(n),C(i.goBack())}),_(6,"i",7),a(),D(7,TS,2,4,"div",8),D(8,FS,2,4,"div",8),D(9,kS,2,4,"div",8),D(10,OS,2,4,"div",8),l(11,"div",9),h("click",function(){return g(n),C(i.openVariablesForm())}),_(12,"ng-icon",10),a()(),_(13,"img",11),a(),l(14,"app-3split-view",12)(15,"div",13),D(16,VS,1,1,"app-ui-storage",2),D(17,NS,1,1,"app-components-menu",2),D(18,AS,1,1,"app-section-list",2),l(19,"app-tree-explorer",14),h("move",function(s){return g(n),C(i.eventTree(s))}),a(),l(20,"div",15),gi(21),a()(),l(22,"div",16)(23,"div",17),_(24,"iframe",18,0),a(),D(26,jS,6,0,"div",19),l(27,"action-buttons",20),h("openComponents",function(){return g(n),C(i.openComponentTab())})("save",function(){return g(n),C(i.save())}),a()(),l(28,"div",21),D(29,zS,7,3,"div",22),l(30,"div",23),D(31,BS,2,0,"div",24),l(32,"div",25),D(33,WS,1,0,"app-edit-form")(34,$S,1,0,"app-custom-component-fields-form")(35,HS,6,0,"div",26),a()()()()(),D(36,GS,1,2,"app-loading",27)}e&2&&(T(i.ds.previewMode()?0:-1),c(),it(Re("designer-wrapper ",i.ds.contextDesign().mode)),f("hidden",i.ds.previewMode()),c(6),T(i.ds.isPageMode()||i.ds.isSectionMode()||i.ds.isDocumentMode()||i.ds.isCMSMode()?7:-1),c(),T(i.ds.contextDesign().nodes.length>0?8:-1),c(),T(i.ds.isPageMode()||i.ds.isCMSMode()?9:-1),c(),T(i.ds.isPageMode()&&i.ds.contextDesign().nodes.length>0?10:-1),c(),f("ngbTooltip","Variables"),c(5),T(i.tabs().storage?16:-1),c(),T(i.tabs().components?17:-1),c(),T(i.tabs().sections?18:-1),c(),f("hidden",i.activeMenu()!="explorer")("treeData",i.treeNodes()),c(),f("hidden",i.activeMenu()!="other"||!(i.ds.isPageMode()||i.ds.isSectionMode()||i.ds.isDocumentMode()||i.ds.isCMSMode())),c(3),f("hidden",i.context().nodes.length==0),c(3),T(i.context().nodes.length==0?26:-1),c(),f("mediatorDesigner",i.mediatorDesigner),c(2),T(i.context().nodes.length>0?29:-1),c(2),T(i.ds.isDocumentMode()?-1:31),c(2),T(i.formNode()?33:i.formNode()==null&&i.ds.isComponentMode()?34:35),c(3),T(i.loading()!=""?36:-1))},dependencies:[ac,_i,be,lc,Je,cc,Tn,dc,pc,fc,hc,he,Be,Bn,Ye,Lc,pe,Ke,ai,yi,vi,$i,Hi,Bc,Wc,At,rr],styles:["[_nghost-%COMP%]{display:block;height:100%;position:relative}.navbar-main[_ngcontent-%COMP%]   .navbar-brand[_ngcontent-%COMP%]{border:none!important}.navbar[_ngcontent-%COMP%]{border:none!important;background-color:transparent}.responsive-buttons[_ngcontent-%COMP%]{height:50px;background-color:var(--bs-gray-dark);justify-content:center;align-items:center;gap:.5rem}iframe[_ngcontent-%COMP%], .panel[_ngcontent-%COMP%]{width:100%;height:100%;display:block}iframe[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden}app-edit-form[_ngcontent-%COMP%]{height:100%}._title[_ngcontent-%COMP%]{max-width:150px;font-weight:700}.navbar[_ngcontent-%COMP%]{padding-top:.05rem;padding-bottom:.05rem;border-top:1px solid var(--navbar-border-color)}.navbar[_ngcontent-%COMP%]   .navbar-brand[_ngcontent-%COMP%]{padding:0}.designer-wrapper[_ngcontent-%COMP%]{height:100%;display:grid;grid-template-columns:42px auto;grid-template-rows:100%}.panel[_ngcontent-%COMP%]{width:calc(100% - 8px);height:calc(100% - 8px);margin-top:4px;margin-left:4px;border-radius:.5rem;background:var(--fuse-bg-card);position:relative}.panel3[_ngcontent-%COMP%]{--height-cotrol: 52px;width:calc(100% - 8px);height:calc(100% - 8px);margin-top:4px;margin-left:4px;position:relative;display:flex;gap:4px;flex-direction:column}#area-right[_ngcontent-%COMP%]{height:100%;background:var(--fuse-bg-card);overflow-y:auto;border-radius:.5rem;flex:1}#action-area[_ngcontent-%COMP%]{background:var(--fuse-bg-card);border-radius:.5rem}.device-controls[_ngcontent-%COMP%]{height:var(--height-cotrol);background:#0000001a;display:flex;justify-content:center;align-items:center;border-radius:.5rem .5rem 0 0}.panel-center[_ngcontent-%COMP%]{height:100%;background-image:radial-gradient(circle,rgba(255,255,255,.0941176471) 1px,transparent 1px);background-size:24px 24px}.panel-form[_ngcontent-%COMP%]{height:calc(100% - var(--height-cotrol));overflow-y:auto;overflow-x:hidden}.document[_ngcontent-%COMP%]   .panel-form[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden}action-buttons[_ngcontent-%COMP%]{position:absolute;bottom:1rem;left:50%;transform:translate(-50%);z-index:10}#aside-nav-wrapper[_ngcontent-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;justify-content:space-between;align-items:center;border-right:1px solid var(--border-color)}#aside-nav-body[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}.nav-designer-item[_ngcontent-%COMP%]{width:100%;height:48px;display:flex;justify-content:center;align-items:center;cursor:pointer}.nav-designer-item[_ngcontent-%COMP%]:hover, .nav-designer-item.active[_ngcontent-%COMP%]{background:var(--primary)}.nav-designer-item[_ngcontent-%COMP%]:hover > *[_ngcontent-%COMP%], .nav-designer-item.active[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{transform:scale(1.2)}.nav-designer-item[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{transition:transform .2s ease-in-out}#logo[_ngcontent-%COMP%]{width:38px}.panel-one[_ngcontent-%COMP%]{height:100%;border-right:1px solid var(--border-color);overflow-y:auto}"],changeDetection:0})};var Qo=(e=>(e.INACTIVO="0",e.ACTIVO="1",e))(Qo||{});var $n=class o{API=`${Le.web_maker}/project-public`;apiService=b(Lt);loadingService=b(Yt);confirmationService=b(ft);auth=b(xe);toastrService=b(tt);states=[{code:"0",denomination:"Inactivo"},{code:"1",denomination:"Activo"}];stateMap=this.states.reduce((t,e)=>(t[e.code]=e.denomination,t),{});canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.canExport=this.auth.hasPermission("project-public-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("project-public-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("project-public-EXPORT-PDF")}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}patch(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}changeStateMessage(t){let e=this.stateMap[t],i="";switch(t){case"0":i="text-";break;case"1":i="text-";break}return{message:`
            <div class="text-center">
                <div class="mb-3">\xBFEst\xE1 seguro de cambiar el \xBFactivo? del registro?</div>
                <h3 >Nuevo \xBFactivo?: <b class="${i}">${e}</b></h3>
            </div>
        `,denomination:e}}changeStateSave(t){return P(this,null,function*(){return yield this.apiService.putPrivate(`${this.API}/state/change/${t.id}`,t)})}changeState(t){return P(this,null,function*(){let{message:e}=this.changeStateMessage(t.state);if(!(yield this.confirmationService.create("Confirmar",e)))return;this.loadingService.open();let n=yield this.changeStateSave(t);return this.loadingService.hide(),n})}delete(t){return P(this,null,function*(){let e=yield this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}export(t,e,i=!0){return P(this,null,function*(){if(i&&!(yield this.confirmationService.create("Confirmar","\xBFEst\xE1 seguro de exportar los datos?")))return;this.loadingService.open();let n=re(k({},t),{type_export:e,url:Le.storage_view,institution:this.auth.getInstitution()}),r=yield this.apiService.postPrivate(`${this.API}/export`,n);return this.loadingService.hide(),r&&r.state=="success"&&window.open(r.url),r})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var qS=o=>({"modal-body px-0":o}),T0=o=>({"has-danger":o});function JS(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",12),u(2,"DATOS DE PULICACI\xD3N"),a(),l(3,"button",13),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}function XS(o,t){if(o&1){let e=M();l(0,"div",10)(1,"button",14),h("click",function(){g(e);let n=d();return C(n.close())}),u(2,"Cancelar"),a(),l(3,"button",15),h("click",function(){g(e);let n=d();return C(n.save())}),u(4,"Guardar"),a()()}}function ZS(o,t){if(o&1&&_(0,"app-loading",11),o&2){let e=d();f("text",e.loading)}}var Jr=class o{constructor(t){this.modalActive=t}accion="add";projectPublic;isModal=!0;idinstitucion="";uid="";state="0";project_id="";showOption=!0;onSave=new ki(!1);zip=null;eventChange=new q;projectPublicService=b($n);authService=b(xe);projectService=b(Pi);uploadService=b(mr);toastService=b(tt);states=this.projectPublicService.states;subscriptions=[];ngOnInit(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.uid===""&&(this.uid=this.authService.userData.id+"");let t=this.onSave.subscribe(e=>{e&&this.save()});if(this.subscriptions.push(t),this.accion=="update"||this.accion=="duplicate"){if(!this.projectPublic)return;this.form.patchValue({code:this.projectPublic.code,note:this.projectPublic.note,isActive:this.projectPublic.state,projectId:this.projectPublic.project_id+""})}else if(this.accion=="add"){if(console.log(`ZIP: ${this.zip}`),this.zip){let e=this.base64ToFile(this.zip,"archivo.zip");console.log(e),this.currentFiles=[e]}this.form.patchValue({isActive:this.state,projectId:this.project_id})}})}ngAfterViewInit(){setTimeout(()=>{document.getElementById("codePr")?.focus()},150)}form=new ni({code:new Fe("",{validators:[ze.required],nonNullable:!0}),note:new Fe("",{validators:[ze.required],nonNullable:!0}),isActive:new Fe("1",{validators:[ze.required],nonNullable:!0}),projectId:new Fe("0",{validators:[ze.required],nonNullable:!0})});get codeControl(){return this.form.get("code")}get noteControl(){return this.form.get("note")}get isActiveControl(){return this.form.get("isActive")}get projectIdControl(){return this.form.get("projectId")}close(){this.isModal?this.modalActive.dismiss():this.eventChange.emit({event:"close",data:void 0})}submit=!1;loading="";save(){return P(this,null,function*(){if(this.submit=!0,!this.form.valid)return;this.submit=!1;let t=this.form.value;if(yield this.uploadFile()){if(this.accion=="add"||this.accion=="duplicate"){let i={code:t.code,note:t.note,createBy:this.uid,state:t.isActive,idinstitucion:+this.idinstitucion,project_id:+t.projectId,fileUrl:this.file.url,fileName:this.file.name};this.loading="Guardando datos...";let n=yield this.projectPublicService.add(i);this.loading="",n.state=="success"&&(yield this.public(),this.isModal?this.modalActive.close(n.data):this.eventChange.emit({event:"add",data:n.data}))}else if(this.accion=="update"){let i={id:+this.projectPublic?.id,code:t.code,note:t.note,state:t.isActive,idinstitucion:+this.idinstitucion,project_id:+t.projectId,fileUrl:this.file.url,fileName:this.file.name};this.loading="Guardando datos...";let n=yield this.projectPublicService.update(i);this.loading="",n.state=="success"&&(this.isModal?this.modalActive.close(i):this.eventChange.emit({event:"update",data:i}))}}})}currentFiles=null;file={required:!0,type:"file",name:"",url:""};base64ToFile(t,e){let i=atob(t),n=new Array(i.length);for(let m=0;m<i.length;m++)n[m]=i.charCodeAt(m);let r=new Uint8Array(n),s=new Blob([r],{type:"application/zip"});return new File([s],e,{type:"application/zip"})}eventFile(t){return P(this,null,function*(){if(this.file.type="file",this.file.name="",this.file.url="",t.event=="clear"){this.currentFiles=null;return}if(t.event=="files"){this.currentFiles=t.files??null;return}t.event=="link"&&(this.file.url=t.url??"",this.file.name=t.name??"",this.currentFiles=null,this.file.type="link")})}uploadFile(){return P(this,null,function*(){if(this.file.required&&this.accion=="add"&&this.file.type=="file"&&(!this.currentFiles||this.currentFiles?.length==0))return this.toastService.error("Debe seleccionar un archivo"),!1;if(this.file.type=="file"&&this.currentFiles&&this.currentFiles.length>0){let t=this.currentFiles[0];this.loading="Guardando archivo";let e=yield this.uploadService.uploadFile("paginas",t);if(this.loading="",e&&e.state=="success")this.file.url=e.url??"",this.file.name=e.nameFile??"";else return!1}return!0})}public(){return P(this,null,function*(){this.loading="Publicando pagina";let t=yield this.projectService.shared({id:+this.project_id,idinstitucion:this.idinstitucion,content:this.zip??"",public:"1"});this.loading="",t.state=="success"&&window.open(t.data?.domian,"_blank")})}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-project-public-form"]],inputs:{accion:"accion",projectPublic:"projectPublic",isModal:"isModal",idinstitucion:"idinstitucion",uid:"uid",state:"state",project_id:"project_id",showOption:"showOption",onSave:"onSave",zip:"zip"},outputs:{eventChange:"eventChange"},decls:17,vars:17,consts:[[1,"modal-header"],[1,"",3,"ngClass"],[1,"container",3,"submit","formGroup"],[1,"form-group","row",3,"ngClass"],["for","codePr",1,"control-label","col-12"],[1,"col-12"],["type","text","name","codePr","id","codePr","formControlName","code",1,"form-control"],[1,"left",3,"control","show"],["for","notePr",1,"control-label","col-12"],["name","notePr","id","notePr","rows","3","formControlName","note",1,"form-control"],[1,"modal-footer"],[3,"text"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["type","button",1,"btn","btn-outline-secondary","btn-lg-medio","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-lg-medio",3,"click"]],template:function(e,i){e&1&&(D(0,JS,4,0,"div",0),l(1,"div",1)(2,"form",2),h("submit",function(){return i.save()}),l(3,"div",3)(4,"label",4),u(5,"C\xF3digo "),a(),l(6,"div",5),_(7,"input",6)(8,"app-control-messages",7),a()(),l(9,"div",3)(10,"label",8),u(11,"Nota "),a(),l(12,"div",5),_(13,"textarea",9)(14,"app-control-messages",7),a()()()(),D(15,XS,5,0,"div",10),D(16,ZS,1,1,"app-loading",11)),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(11,qS,i.isModal)),c(),f("formGroup",i.form),c(),f("ngClass",te(13,T0,i.codeControl.invalid&&(i.codeControl.touched||i.submit))),c(5),f("control",i.codeControl)("show",i.submit),c(),f("ngClass",te(15,T0,i.noteControl.invalid&&(i.noteControl.touched||i.submit))),c(5),f("control",i.noteControl)("show",i.submit),c(),T(i.showOption?15:-1),c(),T(i.loading!=""?16:-1))},dependencies:[Kt,Zt,Qe,Ne,Xt,Qt,ri,bi,be,Ye],encapsulation:2})};var QS=(o,t,e,i)=>({nodes:o,mode:t,project_id:e,item_id:i});function KS(o,t){if(o&1){let e=M();l(0,"app-designer",2),h("saveDesign",function(){g(e);let n=d();return C(n.savePage())})("sharedDesign",function(n){g(e);let r=d();return C(r.sharedDesign(n))}),l(1,"app-ui-page-list",3),h("onDeletePage",function(n){g(e);let r=d();return C(r.onDeletePage(n))}),a()()}if(o&2){let e=d();f("title",lt(e.webProject==null?null:e.webProject.denomination))("elementsData",xp(6,QS,e.elements(),e.mode(),e.project_id(),e.item_id())),c(),f("cmsList",e.ds.dataHandler.cmsList())("selectedPage_id",e.item_id())("project_id",e.project_id())}}function YS(o,t){if(o&1&&_(0,"app-loading",1),o&2){let e=d();f("text",lt(e.loading()))}}var Hc=class o{sharedDesign(t){t=="shared"?this.shared():t=="public"?this.public():t=="download"&&this.render()}onDeletePage(t){if(t==+this.item_id){this.item_id.set(""),this.elements.set([]);return}}auth=b(xe);activetedRoute=b(Wi);toastr=b(tt);componentManagerService=b(Dt);projectService=b(Pi);contextGeneratorService=b(Rn);pageService=b(vo);ds=b(Ue);modalService=b(Vi);test=b(qr);itemId;layoutId;elements=A([]);project_id=A(null);backPath=ce(()=>this.auth.projectPath()+"/proyectos/"+this.project_id());item_id=A(null);typeContext=A(null);mode=ce(()=>this.typeContext()==null?null:this.typeContext()=="page"?"main-editor":"cms-page");idinstitucion="";uid="";loading=A("");webProject;loadPageData(){return P(this,null,function*(){let t=this.project_id(),e=this.item_id();if(t==null||e==null||this.idinstitucion===""||this.uid==="")return;yield this.ds.initializeProjectData(t),yield this.componentManagerService.loadProjectComponents(+t),this.loading.set("Cargando");let i=yield this.projectService.init({id:+t,idinstitucion:this.idinstitucion,uid:this.uid,item_id:+e}),r=(yield this.pageService.list({project_id:t,state:"1"})).data?.filter(v=>v.type=="content")??[];if(this.ds.updatePageVariables(r.map(v=>({value:`/${v.url}`,name:v.title,id:"page_"+v.id}))),this.loading.set(""),i.state!="success"||!i.data)return;let s=i.data.page,m=i.data.layout;this.itemId=s.id,this.layoutId=m.id;let p=[this.convertWebProjectToElement(m.header,"header_"+this.layoutId,"CABECERA"),this.convertWebProjectToElement(s.nodes,s.id+"","CUERPO"),this.convertWebProjectToElement(m.footer,"footer_"+this.layoutId,"PIE DE PAGINA")];this.elements.set(p)})}loadCmsData(){return P(this,null,function*(){let t=this.project_id(),e=this.item_id();if(t==null||e==null||this.idinstitucion===""||this.uid==="")return;yield this.ds.initializeProjectData(t),this.ds.dataHandler.currentProjectCmsId.set(+e),yield this.componentManagerService.loadProjectComponents(+t),this.loading.set("Cargando");let i=yield this.projectService.initCmsPage({id:+t,idinstitucion:this.idinstitucion,uid:this.uid,item_id:+e}),r=(yield this.pageService.list({project_id:t,state:"1"})).data?.filter(v=>v.type=="content")??[];if(this.ds.updatePageVariables(r.map(v=>({value:`/${v.url}`,name:v.title,id:"page_"+v.id}))),this.loading.set(""),i.state!="success"||!i.data)return;let s=i.data.page,m=i.data.layout;this.itemId=s.id,this.layoutId=m.id;let p=[this.convertWebProjectToElement(m.header,"header_"+this.layoutId,"CABECERA"),this.convertWebProjectToElement(s.nodes.length==0?this.presetCMSPage():s.nodes,s.id+"","CUERPO"),this.convertWebProjectToElement(m.footer,"footer_"+this.layoutId,"PIE DE PAGINA")];this.elements.set(p)})}presetCMSPage(){return this.test.htmlStringToNodes(`
                    <div style="width: 100%; background-color: #f0f0f0; padding: 32px;">
                        <h1 style="color: red">Lorem ipsum dolor sit amet</h1>
                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                        <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                    </div>
                `)}ngOnInit(){this.idinstitucion===""&&(this.idinstitucion=this.auth.institucionData?.idinstitucion+""),this.uid=this.auth.userData.id+"",this.activetedRoute.params.subscribe(t=>P(this,null,function*(){if(this.item_id.set(t.item_id??""),this.project_id.set(t.project_id??null),this.typeContext.set(t.type??null),this.typeContext()!=null&&!["page","cms"].includes(this.typeContext())){window.location.href=this.backPath();return}!this.item_id()||!this.project_id()||(this.typeContext()=="cms"?yield this.loadCmsData():this.typeContext()=="page"&&(yield this.loadPageData()))}))}convertWebProjectToElement(t,e,i){let n=this.componentManagerService.createInstanceOf("content",{});return n.id=e,n.name=i,n.children=Dt.baseToElement(t),n}savePage(){return P(this,null,function*(){if(!this.itemId){this.toastr.error("Error al guardar el proyecto");return}try{this.loading.set("Guardando");let t=this.parseElementToWebProject(this.itemId.toString()),e=this.parseElementToWebProject("header_"+this.layoutId),i=this.parseElementToWebProject("footer_"+this.layoutId),n={id:+this.project_id(),idinstitucion:+this.idinstitucion,uid:this.uid,item:{id:this.itemId,nodes:JSON.stringify(Dt.elementToBase(t))},layout:{id:this.layoutId,header:JSON.stringify(Dt.elementToBase(e)),footer:JSON.stringify(Dt.elementToBase(i))}};this.mode()=="cms-page"?(console.log(n.item),yield this.projectService.pageCmsSave(n)):yield this.projectService.pageSave(n),this.loading.set("")}catch(t){console.error(t),this.toastr.error(t.message||"Error al guardar el proyecto"),this.loading.set("")}})}parseElementToWebProject(t){let e=this.elements().find(i=>i.id===t);if(!e)throw Error(`Error al convertir el elemento ${t}`);return e.children}render(t="blob",e=!0){return P(this,null,function*(){let i=this.project_id();if(i==null)return;e&&this.loading.set("Renderizando");let n=yield this.projectService.makeProject({id:+i,idinstitucion:this.idinstitucion});if(e&&this.loading.set(""),n.state!="success"){this.toastr.error("Error al obtener p\xE1ginas del proyecto");return}if(n.data&&!n.data.pages.find(s=>s.main)){this.toastr.error("No se puede renderizar el proyecto sin una p\xE1gina principal");return}let r=yield this.contextGeneratorService.buildProject(n.data,t,this.ds.formattedVariables());if(t==="blob"){let s=xf(),m=window.URL.createObjectURL(r),p=document.createElement("a");p.href=m,p.download=s+".zip",document.body.appendChild(p),p.click(),document.body.removeChild(p),window.URL.revokeObjectURL(m)}return r})}shared(){return P(this,null,function*(){let t=this.project_id();if(t==null)return;this.loading.set("Renderizando");let e=yield this.render("base64",!1);if(e==null){this.toastr.error("Error al renderizar el proyecto"),this.loading.set("");return}this.loading.set("Subiendo pagina");let i=yield this.projectService.shared({id:+t,idinstitucion:this.idinstitucion,content:e,public:"0"});this.loading.set(""),i.state=="success"&&window.open(i.data?.domianPreview,"_blank")})}public(){return P(this,null,function*(){let t=this.project_id();if(t==null)return;let e=yield this.render("base64");if(e==null){this.toastr.error("Error al renderizar el proyecto");return}try{let i=yield this.modalService.open(Jr,{backdrop:"static",keyboard:!1,size:"md"});i.componentInstance.accion="add",i.componentInstance.idinstitucion=this.idinstitucion,i.componentInstance.zip=e,i.componentInstance.project_id=+t,yield i.result}catch{}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-page-editor"]],inputs:{idinstitucion:"idinstitucion",uid:"uid"},features:[we([Te({lucideSave:ro})])],decls:2,vars:2,consts:[["panelCustomName","P\xE1ginas",3,"title","elementsData"],[3,"text"],["panelCustomName","P\xE1ginas",3,"saveDesign","sharedDesign","title","elementsData"],["cardData","link","type","content","mode","list",3,"onDeletePage","cmsList","selectedPage_id","project_id"]],template:function(e,i){e&1&&(D(0,KS,2,11,"app-designer",0),D(1,YS,1,2,"app-loading",1)),e&2&&(T(i.project_id()!=null&&i.item_id()!=null?0:-1),c(),T(i.loading()!=""?1:-1))},dependencies:[Ye,Tn,Tr,Po],styles:["[_nghost-%COMP%]{display:block;height:100%;position:relative}.action-buttons[_ngcontent-%COMP%]{position:fixed;display:flex;bottom:.5rem;gap:.5rem;left:50%;transform:translate(-50%)}"]})};var e2=["gutter1"],t2=["splitView"],i2=[[["","pane1",""]],[["","pane2",""]]],n2=["[pane1]","[pane2]"],Xr=class o{ngZone=b(fi);set initialPanel1Size(t){let e=this.parseSize(t);e&&this.panel1Size.set(e)}gutter1Ref;splitViewRef;panel1Size=A({value:50,unit:"%"});containerSize=A(0);gutterActive=A(!1);dragCoverVisible=A(!1);pane1Style=ce(()=>this.calculatePaneStyle());resizeObserver=null;ngAfterViewInit(){this.attachGutterListener(),this.setupResizeObserver(),this.updateContainerSize()}ngOnDestroy(){this.resizeObserver?.disconnect(),this.detachGutterListener(),this.detachDocumentListeners()}attachGutterListener(){this.ngZone.runOutsideAngular(()=>{this.gutter1Ref.nativeElement.addEventListener("mousedown",this.onGutterMouseDown)})}detachGutterListener(){this.gutter1Ref.nativeElement.removeEventListener("mousedown",this.onGutterMouseDown)}setupResizeObserver(){this.resizeObserver=new ResizeObserver(()=>this.ngZone.run(()=>this.updateContainerSize())),this.resizeObserver.observe(this.splitViewRef.nativeElement)}onGutterMouseDown=t=>{t.preventDefault(),this.gutterActive.set(!0),this.dragCoverVisible.set(!0),this.ngZone.runOutsideAngular(()=>{document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)})};onMouseMove=t=>{let e=this.splitViewRef.nativeElement.getBoundingClientRect(),i=t.clientX-e.left;requestAnimationFrame(()=>{this.panel1Size.set({value:Math.min(Math.max(i,10),this.containerSize()-20),unit:"px"})})};onMouseUp=()=>{this.ngZone.run(()=>{this.gutterActive.set(!1),this.dragCoverVisible.set(!1)}),this.detachDocumentListeners()};detachDocumentListeners(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)}updateContainerSize(){this.containerSize.set(this.splitViewRef.nativeElement.getBoundingClientRect().width)}calculatePaneStyle(){return{width:`${this.calculatePixelSize(this.panel1Size())}px`}}parseSize(t){let e=t.match(/^(\d+)(px|%)$/);return e?{value:parseInt(e[1],10),unit:e[2]}:null}calculatePixelSize(t){return t.unit==="px"?t.value:t.value/100*this.containerSize()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-split-view"]],viewQuery:function(e,i){if(e&1&&(ut(e2,5),ut(t2,5)),e&2){let n;ct(n=dt())&&(i.gutter1Ref=n.first),ct(n=dt())&&(i.splitViewRef=n.first)}},inputs:{initialPanel1Size:"initialPanel1Size"},ngContentSelectors:n2,decls:11,vars:5,consts:[["splitView",""],["gutter1",""],[1,"split-container"],[1,"drag-cover"],[1,"split-view"],[1,"pane","pane-1",3,"ngStyle"],[1,"gutter-container"],[1,"gutter"],[1,"pane","pane-2"]],template:function(e,i){e&1&&(Li(i2),l(0,"div",2),_(1,"div",3),l(2,"div",4,0)(4,"div",5),gi(5),a(),l(6,"div",6),_(7,"div",7,1),a(),l(9,"div",8),gi(10,1),a()()()),e&2&&(c(),Ct("active",i.dragCoverVisible()),c(3),f("ngStyle",i.pane1Style()),c(3),Ct("active",i.gutterActive()))},dependencies:[_i,ls],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}.split-container[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;overflow:hidden}.split-view[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;height:100%}.pane[_ngcontent-%COMP%]{overflow:auto;transition:flex .3s ease}.pane-2[_ngcontent-%COMP%]{flex:1}.gutter-container[_ngcontent-%COMP%]{position:relative;width:0;flex-shrink:0}.gutter[_ngcontent-%COMP%]{position:absolute;width:4px;height:100%;top:0;left:0;transform:translate(-50%);cursor:col-resize;transition:background-color .2s;z-index:2}.gutter.active[_ngcontent-%COMP%], .gutter[_ngcontent-%COMP%]:hover{background-color:var(--primary)}.drag-cover[_ngcontent-%COMP%]{position:fixed;inset:0;cursor:col-resize;background:transparent;display:none;z-index:1}.drag-cover.active[_ngcontent-%COMP%]{display:block}"],changeDetection:0})};var o2=o=>({current:o,default:void 0});function r2(o,t){if(o&1){let e=M();l(0,"input",4),ne("ngModelChange",function(n){g(e);let r=d().$implicit;return Z(r.enabled,n)||(r.enabled=n),C(n)}),h("ngModelChange",function(){g(e);let n=d(2);return C(n.update())}),a()}if(o&2){let e=d().$implicit;ie("ngModel",e.enabled),f("disabled",!e.optional)}}function a2(o,t){if(o&1){let e=M();l(0,"app-general-styles-control",5),h("valueChange",function(n){g(e);let r=d().$implicit,s=d();return C(s.onChange(n,r.controlName))}),a()}if(o&2){let e=d().$implicit,i=d();f("readonly",i.readonly())("control",e)("css",te(3,o2,e.value))}}function s2(o,t){if(o&1&&(l(0,"b"),u(1),a()),o&2){let e=d().$implicit;c(),W(e.label)}}function l2(o,t){if(o&1&&(l(0,"div",0),D(1,r2,1,2,"input",1),l(2,"div",2),D(3,a2,1,5,"app-general-styles-control",3)(4,s2,2,1,"b"),a()()),o&2){let e=t.$implicit,i=d();c(),T(i.readonly()?-1:1),c(2),T(e.enabled?3:4)}}var Gc=class o{styleControlList=Ee(Sn);optionalControls=new Set(Sn.filter(t=>t.optional).map(t=>t.controlName));readonly=le(!1);formChange=new q;set fields(t){if(!t)return;let e=Ee(t);this.styleControlList=Ee(Sn),this.styleControlList.forEach(i=>{e[i.controlName]&&(i.enabled=!0,i.value=e[i.controlName])})}set specialControls(t){if(t?.length)for(let e of t){let i=this.styleControlList.findIndex(n=>n.controlName===e);i!==-1&&(this.styleControlList[i].enabled=!0)}}onChange(t,e){if(!e||!t)return;let i=this.styleControlList.findIndex(n=>n.controlName===e);i!=-1&&(this.styleControlList[i].value=t,this.update())}updateCheck(t,e){this.styleControlList[t]=k({},e),this.update()}update(){let t=this.cleanEmptyFields(),e=this.getMandatoryControls();this.formChange.emit({fields:t,specialControls:e})}cleanEmptyFields(){let t={};return this.styleControlList.forEach(e=>{e.enabled&&(e.value==null||this.isDevicesEmpty(e.value)||(t[e.controlName]=e.value))}),t}isDevicesEmpty(t){return!oi.some(e=>t[e]!=null)}getMandatoryControls(){return this.styleControlList.filter(t=>t.enabled&&this.optionalControls.has(t.controlName)).map(t=>t.controlName)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-responsive-fields"]],hostVars:2,hostBindings:function(e,i){e&2&&it("input-design")},inputs:{readonly:[1,"readonly"],fields:"fields",specialControls:"specialControls"},outputs:{formChange:"formChange"},decls:2,vars:0,consts:[[1,"field-row"],["type","checkbox",2,"margin-right","8px",3,"ngModel","disabled"],[2,"flex","1"],[3,"readonly","control","css"],["type","checkbox",2,"margin-right","8px",3,"ngModelChange","ngModel","disabled"],[3,"valueChange","readonly","control","css"]],template:function(e,i){e&1&&Y(0,l2,5,2,"div",0,de),e&2&&ee(i.styleControlList)},dependencies:[pe,ps,Ne,at,Ar],styles:[".field-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;padding:8px 1rem;border-bottom:1px solid var(--border-color)}.field-row[_ngcontent-%COMP%]:hover{background-color:#272727}"]})};function c2(o,t){if(o&1&&(l(0,"option",11),u(1),a()),o&2){let e=t.$implicit;f("value",e.value),c(),W(e.label)}}function d2(o,t){if(o&1&&(l(0,"optgroup",20),Y(1,c2,2,2,"option",11,de),a()),o&2){let e=t.$implicit;f("label",lt(e.group)),c(),ee(e.list)}}function m2(o,t){if(o&1&&(l(0,"small",23),u(1),a()),o&2){let e=d(2);c(),W(e.errors.label)}}function p2(o,t){if(o&1&&(l(0,"small",23),u(1),a()),o&2){let e=d(2);c(),W(e.errors.field)}}function u2(o,t){if(o&1){let e=M();l(0,"div",1)(1,"div",17)(2,"label",18),u(3,"Tipo de Campo"),a(),l(4,"select",19),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.type,n)||(r.field.type=n),C(n)}),h("change",function(){g(e);let n=d();return C(n.onTypeChange())}),Y(5,d2,3,2,"optgroup",20,de),a()(),l(7,"div",17)(8,"label",21),u(9,"Etiqueta"),a(),l(10,"input",22),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.label,n)||(r.field.label=n),C(n)}),h("blur",function(){g(e);let n=d();return C(n.validateField("label"))}),a(),D(11,m2,2,1,"small",23),a(),l(12,"div",17)(13,"label",24),u(14,"Nombre de la variable"),a(),l(15,"input",25),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.field,n)||(r.field.field=n),C(n)}),h("blur",function(){g(e);let n=d();return C(n.validateField("field"))}),a(),D(16,p2,2,1,"small",23),a(),l(17,"div",2)(18,"input",26),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.optional,n)||(r.field.optional=n),C(n)}),a(),l(19,"label",27),u(20,"Opcional"),a()()()}if(o&2){let e=d();c(4),ie("ngModel",e.field.type),f("disabled",e.preeventChangeType),c(),ee(e.fieldTypes),c(5),ie("ngModel",e.field.label),f("disabled",e.preeventChangeType),c(),T(e.errors.label?11:-1),c(4),ie("ngModel",e.field.field),f("disabled",e.preeventChangeType),c(),T(e.errors.field?16:-1),c(2),ie("ngModel",e.field.optional),f("disabled",e.preeventChangeType)}}function f2(o,t){o&1&&(l(0,"h5",6),u(1,"Asignar valor"),a())}function h2(o,t){if(o&1){let e=M();l(0,"input",28),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("ngModel",e.field.default)}}function g2(o,t){if(o&1){let e=M();l(0,"input",29),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("ngModel",e.field.default)}}function C2(o,t){if(o&1){let e=M();l(0,"div",10)(1,"input",30),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a(),l(2,"label",31),u(3,"Valor por defecto"),a()()}if(o&2){let e=d();c(),ie("ngModel",e.field.default)}}function _2(o,t){if(o&1){let e=M();l(0,"app-text-editor",32),ne("valueChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("value",e.field.default)}}function v2(o,t){if(o&1&&(l(0,"option",11),u(1),a()),o&2){let e=t.$implicit;f("value",e.value),c(),W(e.label)}}function y2(o,t){if(o&1){let e=M();l(0,"div",34)(1,"input",37),ne("ngModelChange",function(n){let r=g(e).$implicit;return Z(r.value,n)||(r.value=n),C(n)}),a(),l(2,"input",38),ne("ngModelChange",function(n){let r=g(e).$implicit;return Z(r.label,n)||(r.label=n),C(n)}),a(),l(3,"button",39),h("click",function(){let n=g(e).$index,r=d(2);return C(r.removeGroupOption(n))}),_(4,"ng-icon",40),a()()}if(o&2){let e=t.$implicit;c(),ie("ngModel",e.value),c(),ie("ngModel",e.label)}}function b2(o,t){if(o&1){let e=M();l(0,"select",33),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),Y(1,v2,2,2,"option",11,de),a(),l(3,"h6"),u(4,"Opciones del Grupo"),a(),Y(5,y2,5,2,"div",34,bn),l(7,"button",35),h("click",function(){g(e);let n=d();return C(n.addGroupOption())}),_(8,"ng-icon",36),u(9," A\xF1adir Opci\xF3n"),a()}if(o&2){let e=d();ie("ngModel",e.field.default),c(),ee(e.field.options),c(4),ee(e.field.options)}}function x2(o,t){if(o&1){let e=M();l(0,"input",41),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("ngModel",e.field.default)}}function w2(o,t){if(o&1){let e=M();l(0,"app-color-picker",42),ne("colorChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("color",e.field.default)}}function S2(o,t){if(o&1){let e=M();l(0,"app-link-input",32),ne("valueChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("value",e.field.default)}}function E2(o,t){if(o&1){let e=M();l(0,"app-link2-field",32),ne("valueChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("value",e.field.default)}}function P2(o,t){if(o&1){let e=M();l(0,"app-icon-select-field",32),ne("valueChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("value",e.field.default)}}function M2(o,t){if(o&1){let e=M();l(0,"app-unit-selector",32),ne("valueChange",function(n){g(e);let r=d();return Z(r.field.default,n)||(r.field.default=n),C(n)}),a()}if(o&2){let e=d();ie("value",e.field.default)}}var qa=class o{field={type:"text",optional:!1,label:"",field:"",default:"",visible:!0};action;preeventChangeType=!1;modalService=b(St);errors={};fieldTypes=[{group:"basicos",list:[{value:"bool",label:"Condici\xF3n"},{value:"color",label:"Color"},{value:"icon",label:"Icono"},{value:"image",label:"Imagen"},{value:"link",label:"Enlace"},{value:"number",label:"Numero"},{value:"text",label:"Texto"},{value:"units",label:"Unidades"}]},{group:"medios",list:[{value:"group",label:"Lista de opciones"},{value:"array",label:"Lista de elementos"},{value:"paragraph",label:"P\xE1rrafo"}]}];onTypeChange(){switch(delete this.field.formFields,delete this.field.options,this.field.visible=!0,this.field.type){case"text":this.field.default="Texto por defecto";break;case"number":this.field.default=0;break;case"bool":this.field.default=!0;break;case"array":this.field.formFields=[{type:"text",optional:!1,label:"Name",field:"name",default:""}],this.field.default=[{name:"Enlace 1"}];break;case"group":this.field.options=[{value:"option1",label:"Option 1"},{value:"option2",label:"Option 2"}],this.field.default="option1";break;case"icon":this.field.default="house";break;case"link":this.field.default={url:"",target:"_self"};break;case"units":this.field.default="0px";break;default:this.field.default=""}}validateField(t){this.field[t]?delete this.errors[t]:this.errors[t]=`El campo ${t} es requerido`}changeVisible(t){this.field.visible=t.target.checked}isValid(){return this.validateField("label"),this.validateField("field"),Object.keys(this.errors).length===0}removeGroupOption(t){this.field.options?.splice(t,1)}addGroupOption(){this.field.options=this.field.options||[],this.field.options.push({value:"",label:""})}save(){this.isValid()&&this.modalService.ok(this.field)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-form-builder-form"]],inputs:{field:"field",action:"action",preeventChangeType:"preeventChangeType"},features:[we([Te({lucidePlus:kn,lucideTrash:On,lucideFileCode:Ds,lucidePen:Zi})])],decls:26,vars:5,consts:[[1,"form-builder-form"],[1,"field-config"],[1,"form-check"],["type","checkbox","id","visible-item",1,"form-check-input",3,"change","checked"],["for","visible-item",1,"form-check-label"],[1,"field-preview"],[1,"preview-title"],[1,"preview-content"],["placeholder","Valor por defecto",1,"form-control",3,"ngModel"],["type","number","placeholder","Valor por defecto",1,"form-control",3,"ngModel"],[1,"form-check","form-switch"],[3,"value"],["placeholder","URL de imagen por defecto",1,"form-control",3,"ngModel"],[3,"color"],[1,"form-actions"],["app-button","","size","lg","variant","outline","color","secondary",3,"click"],["app-button","","size","lg",3,"click","disabled"],[1,"form-group"],["for","field-type"],["id","field-type",1,"form-select",3,"ngModelChange","change","ngModel","disabled"],[3,"label"],["for","field-label"],["id","field-label","placeholder","Etiqueta del campo",1,"form-control",3,"ngModelChange","blur","ngModel","disabled"],[1,"text-danger"],["for","field-name"],["id","field-name","placeholder","Nombre \xFAnico del campo",1,"form-control",3,"ngModelChange","blur","ngModel","disabled"],["type","checkbox","id","optional-item",1,"form-check-input",3,"ngModelChange","ngModel","disabled"],["for","optional-item",1,"form-check-label"],["placeholder","Valor por defecto",1,"form-control",3,"ngModelChange","ngModel"],["type","number","placeholder","Valor por defecto",1,"form-control",3,"ngModelChange","ngModel"],["type","checkbox",1,"form-check-input",3,"ngModelChange","ngModel"],[1,"form-check-label"],[3,"valueChange","value"],[1,"form-select","mb-3",3,"ngModelChange","ngModel"],[1,"option-item"],["app-button","","variant","outline",1,"mt-2",3,"click"],["name","lucidePlus"],["placeholder","Valor",1,"form-control",3,"ngModelChange","ngModel"],["placeholder","Etiqueta",1,"form-control",3,"ngModelChange","ngModel"],["app-icon-button","","color","danger",3,"click"],["name","lucideTrash"],["placeholder","URL de imagen por defecto",1,"form-control",3,"ngModelChange","ngModel"],[3,"colorChange","color"]],template:function(e,i){if(e&1&&(l(0,"div",0),D(1,u2,21,10,"div",1),l(2,"div",1)(3,"div",2)(4,"input",3),h("change",function(r){return i.changeVisible(r)}),a(),l(5,"label",4),u(6,"Visible"),a()()(),l(7,"div",5),D(8,f2,2,0,"h5",6),l(9,"div",7),D(10,h2,1,1,"input",8)(11,g2,1,1,"input",9)(12,C2,4,1,"div",10)(13,_2,1,1,"app-text-editor",11)(14,b2,10,1)(15,x2,1,1,"input",12)(16,w2,1,1,"app-color-picker",13)(17,S2,1,1,"app-link-input",11)(18,E2,1,1,"app-link2-field",11)(19,P2,1,1,"app-icon-select-field",11)(20,M2,1,1,"app-unit-selector",11),a()(),l(21,"div",14)(22,"button",15),h("click",function(){return i.modalService.close()}),u(23,"Cancelar"),a(),l(24,"button",16),h("click",function(){return i.save()}),u(25,"Guardar"),a()()()),e&2){let n;c(),T(i.preeventChangeType?-1:1),c(3),f("checked",i.field.visible!==!1),c(4),T(i.preeventChangeType?-1:8),c(2),T((n=i.field.type)==="text"?10:n==="number"?11:n==="bool"?12:n==="paragraph"?13:n==="group"?14:n==="image"?15:n==="color"?16:n==="link"?17:n==="link2"?18:n==="icon"?19:n==="units"?20:-1),c(14),f("disabled",!i.isValid())}},dependencies:[Je,he,Be,Ge,An,Vr,ei,yo,pe,Ht,Gt,Qe,Dn,ps,$t,Ne,at,kr,Nr],styles:[".form-builder-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.preview-title[_ngcontent-%COMP%]{margin-bottom:1rem;color:#007bff}.option-item[_ngcontent-%COMP%], .array-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem}.subfield-item[_ngcontent-%COMP%]{flex:1}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:.5rem}"]})};function I2(o,t){o&1&&(l(0,"h6",3),u(1,"Campos internos"),a())}function D2(o,t){o&1&&(l(0,"h5",3),u(1,"Campos"),a())}function T2(o,t){if(o&1){let e=M();l(0,"button",5),h("click",function(){g(e);let n=d();return C(n.addField())}),u(1,"Agregar"),a()}if(o&2){let e=d();f("size",e.isSubForm?"xs":"sm")}}function F2(o,t){o&1&&(l(0,"div",9),_(1,"ng-icon",18),a())}function k2(o,t){if(o&1){let e=M();l(0,"button",19),h("click",function(){g(e);let n=d(),r=n.$implicit,s=n.$index,m=d();return C(m.editField(r,s))}),_(1,"ng-icon",20),a()}}function O2(o,t){if(o&1){let e=M();l(0,"button",21),h("click",function(){g(e);let n=d().$index,r=d();return C(r.removeField(n))}),_(1,"ng-icon",22),a()}}function V2(o,t){o&1&&_(0,"div",23)}function N2(o,t){if(o&1){let e=M();l(0,"div",17)(1,"app-form-builder",24),ne("valueChange",function(n){g(e);let r=d().$implicit;return Z(r.formFields,n)||(r.formFields=n),C(n)}),h("fieldsChange",function(){g(e);let n=d(2);return C(n.change())}),a()()}if(o&2){let e=d().$implicit,i=d();c(),f("readonly",i.readonly)("preventDelete",i.preventDelete),ie("value",e.formFields),f("isSubForm",!0)}}function A2(o,t){if(o&1){let e=M();l(0,"div",6),h("click",function(){let n=g(e).$index,r=d();return C(r.selectField(n))}),l(1,"div",7)(2,"div",8),D(3,F2,2,0,"div",9),_(4,"ng-icon",10),l(5,"div",11)(6,"span",12),u(7),a()()(),l(8,"div",13),D(9,k2,2,0,"button",14),D(10,O2,2,0,"button",15),a()(),Se(11,V2,1,0,"div",16),a(),D(12,N2,2,4,"div",17)}if(o&2){let e=t.$implicit,i=t.$index,n=d();Ct("selected",n.selectedFieldIndex===i),c(3),T(n.readonly?-1:3),c(),f("name",n.iconField[e.type]),c(3),W(e.label||"Nuevo Campo"),c(2),T(n.readonly?-1:9),c(),T(!n.preventDelete&&!n.readonly?10:-1),c(2),T(e.type==="array"?12:-1)}}var qc=class o{isSubForm=!1;preventDelete=!1;readonly=!1;set value(t){this._fields=t||[]}valueChange=new q;modalService=b(St);confirmService=b(li);_fields=[];selectedFieldIndex=null;exportedJSON="";iconField={text:"lucideType",paragraph:"lucideAlignLeft",group:"lucideLayoutGrid",image:"lucideImage",color:"lucidePaintBucket",array:"lucideList",number:"lucideCalculator",bool:"lucideCheck",icon:"lucideStar",link:"lucideLink",link2:"lucideLink","box-properties":"lucideBox",units:"lucideRuler","visible-responsive":"lucideEyeOff"};addField(){this.modalService.open(qa,{title:this.isSubForm?"Nuevo Campo Interno":"Nuevo Campo",hiddenButtons:!0,params:{action:"add"},size:"lg"}).result().then(e=>{e.isOk&&(this._fields.push(e.data),this.emit())})}editField(t,e){let i=JSON.parse(JSON.stringify(t)),n=this.preventDelete?"EDITAR: "+t.label:"Editar Campo";this.modalService.open(qa,{title:n,hiddenButtons:!0,params:{action:"edit",field:i,preeventChangeType:this.preventDelete},size:"lg"}).result().then(s=>{s.isOk&&(this._fields[e]=s.data,this.emit())})}change(){this.emit()}removeField(t){return P(this,null,function*(){(yield this.confirmService.show({title:"Eliminar Campo",message:"\xBFEst\xE1 seguro de que desea eliminar este campo?",type:"delete"}))&&(this._fields.splice(t,1),this.emit())})}selectField(t){this.isSubForm||(this.selectedFieldIndex=t)}addGroupOption(t){t.options=t.options||[],t.options.push({value:"",label:""}),this.emit()}removeGroupOption(t,e){return P(this,null,function*(){(yield this.confirmService.show({title:"Eliminar Opci\xF3n",message:"\xBFEst\xE1 seguro de que desea eliminar esta opci\xF3n?",type:"delete"}))&&(t.options?.splice(e,1),this.emit())})}emit(){this.valueChange.emit(this._fields)}drop(t){t.previousIndex!==t.currentIndex&&(jn(this._fields,t.previousIndex,t.currentIndex),this.emit())}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-form-builder"]],inputs:{isSubForm:"isSubForm",preventDelete:"preventDelete",readonly:"readonly",value:"value"},outputs:{valueChange:"valueChange"},features:[we([Te({lucidePlus:kn,lucideTrash:On,lucideFileCode:Ds,lucidePen:Zi,lucideType:Gs,lucideAlignLeft:ar,lucideLayoutGrid:As,lucideImage:uu,lucidePaintBucket:Pu,lucidePalette:Iu,lucideList:Rs,lucideSigma:Ws,lucideWaypoints:Gu,lucideCheck:Kp,lucideCalculator:Zp,lucideGripVertical:Vs,lucideAlignCenterVertical:hs,lucideStar:Uu,lucideLink:vu,lucideBox:bs,lucideRuler:Vu,lucidePaintRoller:Ls,lucideShapes:ju,lucideSquare:$s,lucideDice1:ru,lucideEyeOff:Is,lucideGrid3x3:Os,lucideContrast:nu,lucideFullscreen:mu,lucideText:Wu})])],decls:8,vars:4,consts:[[1,"form-builder"],["cdkDropList","",1,"field-list",3,"cdkDropListDropped"],[1,"header"],[1,"m-0"],["app-button","","variant","outline",3,"size"],["app-button","","variant","outline",3,"click","size"],["cdkDrag","",1,"field-item",3,"click"],[1,"field-header"],[1,"field-info"],["cdkDragHandle","",1,"drag-handle"],["size","16",3,"name"],[1,"field-details"],[1,"field-title"],[1,"field-actions"],["app-icon-button","","variant","outline","size","xs","color","primary"],["app-icon-button","","variant","outline","size","xs","color","danger"],["class","field-drag-placeholder",4,"cdkDragPlaceholder"],[1,"array-fields"],["name","lucideGripVertical","size","16"],["app-icon-button","","variant","outline","size","xs","color","primary",3,"click"],["name","lucidePen"],["app-icon-button","","variant","outline","size","xs","color","danger",3,"click"],["name","lucideTrash"],[1,"field-drag-placeholder"],[3,"valueChange","fieldsChange","readonly","preventDelete","value","isSubForm"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1),h("cdkDropListDropped",function(r){return i.drop(r)}),l(2,"div",2),D(3,I2,2,0,"h6",3)(4,D2,2,0,"h5",3),D(5,T2,2,1,"button",4),a(),Y(6,A2,13,8,null,null,de),a()()),e&2&&(Ct("compact",i.isSubForm),c(3),T(i.isSubForm?3:4),c(2),T(!i.preventDelete&&!i.readonly?5:-1),c(),ee(i._fields))},dependencies:[o,pe,he,Be,Ge,Je,_o,Co,go,Ml],styles:[".add-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border:1px dashed #ccc;border-radius:8px;padding:.5rem 1rem;cursor:pointer;transition:background-color .2s;background-color:#f8f9fa}.add-item.add-subitem[_ngcontent-%COMP%]{border:1px dashed #e0e0e0;padding:.25rem .5rem;font-size:.8rem}.add-item[_ngcontent-%COMP%]:hover{background-color:#fff}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{color:#666;font-size:.8rem}.form-builder[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;border-radius:8px}.form-builder.compact[_ngcontent-%COMP%]{padding:0rem;gap:1rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.field-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.compact[_ngcontent-%COMP%]   .field-list[_ngcontent-%COMP%]{gap:.5rem}.field-item[_ngcontent-%COMP%]{background-color:var(--fuse-bg-card);color:var(--fuse-text-default);border:1px solid var(--border-color);border-radius:8px;padding:.5rem;cursor:default}.compact[_ngcontent-%COMP%]   .field-item[_ngcontent-%COMP%]{padding:.25rem}.field-item.selected[_ngcontent-%COMP%], .field-item[_ngcontent-%COMP%]:hover{border-color:var(--primary)}.field-item.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.field-item.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.field-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.field-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.field-details[_ngcontent-%COMP%]{display:flex;flex-direction:column}.compact[_ngcontent-%COMP%]   .field-details[_ngcontent-%COMP%]{flex-direction:row;align-items:center;gap:.5rem}.field-title[_ngcontent-%COMP%]{font-weight:700;font-size:.8rem}.field-type[_ngcontent-%COMP%]{font-size:.7rem;line-height:.9;color:#666}.field-optional[_ngcontent-%COMP%]{font-size:.75rem;color:#28a745;background-color:#e6f4ea;padding:.25rem .5rem;border-radius:4px;margin-top:.25rem}.compact[_ngcontent-%COMP%]   .field-optional[_ngcontent-%COMP%]{margin-top:0}.field-actions[_ngcontent-%COMP%]{display:flex;gap:.25rem}.group-options[_ngcontent-%COMP%], .array-fields[_ngcontent-%COMP%]{padding-bottom:1rem;padding-left:2rem}.group-options-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.group-option[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666;font-style:italic}.drag-handle[_ngcontent-%COMP%]{cursor:move;color:var(--primary);opacity:.5;display:flex;align-items:center;justify-content:center}.field-item[_ngcontent-%COMP%]:hover   .drag-handle[_ngcontent-%COMP%]{opacity:1}.field-drag-placeholder[_ngcontent-%COMP%]{background:#ccc;border:dotted 3px #999;min-height:60px}"]})};var j2=["sandbox"],R2=["*"];function L2(o,t){if(o&1){let e=M();l(0,"div",9)(1,"div",13)(2,"button",14),h("click",function(){g(e);let n=d();return C(n.htmlEditor.set("html"))}),u(3,"HTML"),a(),l(4,"button",14),h("click",function(){g(e);let n=d();return C(n.htmlEditor.set("css"))}),u(5,"CSS"),a(),l(6,"button",14),h("click",function(){g(e);let n=d();return C(n.htmlEditor.set("js"))}),u(7,"JS"),a()(),l(8,"div",15)(9,"ngx-monaco-editor",16),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.activeComponent.template,n)||(r.activeComponent.template=n),C(n)}),h("ngModelChange",function(){g(e);let n=d();return C(n.updateIframeContent())}),a(),l(10,"ngx-monaco-editor",17),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.activeComponent.style,n)||(r.activeComponent.style=n),C(n)}),h("ngModelChange",function(){g(e);let n=d();return C(n.updateIframeContent())}),a(),l(11,"ngx-monaco-editor",18),ne("ngModelChange",function(n){g(e);let r=d();return Z(r.activeComponent.script,n)||(r.activeComponent.script=n),C(n)}),h("ngModelChange",function(){g(e);let n=d();return C(n.updateIframeContent())}),a()()()}if(o&2){let e=d();c(2),f("variant",e.htmlEditor()=="html"?"flat":"outline"),c(2),f("variant",e.htmlEditor()=="css"?"flat":"outline"),c(2),f("variant",e.htmlEditor()=="js"?"flat":"outline"),c(3),f("hidden",e.htmlEditor()!=="html")("options",e.htmlEditorOptions),ie("ngModel",e.activeComponent.template),c(),f("hidden",e.htmlEditor()!=="css")("options",e.cssEditorOptions),ie("ngModel",e.activeComponent.style),c(),f("hidden",e.htmlEditor()!=="js")("options",e.jsEditorOptions),ie("ngModel",e.activeComponent.script)}}function U2(o,t){o&1&&(l(0,"div",10),u(1,"Seleccione un componente para empezar a dise\xF1ar"),a())}function z2(o,t){if(o&1){let e=M();l(0,"div",19)(1,"button",20),h("click",function(){g(e);let n=d();return C(n.activeEditor="form")}),_(2,"i",21),u(3," Variables"),a(),l(4,"button",20),h("click",function(){g(e);let n=d();return C(n.activeEditor="style_control")}),_(5,"i",22),u(6," Estilos"),a()(),l(7,"div",23)(8,"div",24)(9,"b"),u(10,"DATOS DINAMICOS"),a(),l(11,"app-form-builder",25),ne("valueChange",function(n){g(e);let r=d();return Z(r.currentForm,n)||(r.currentForm=n),C(n)}),h("valueChange",function(){g(e);let n=d();return C(n.updateIframeContent())}),a(),l(12,"b",26),u(13,"DATOS ESTATICOS"),a(),l(14,"app-form-builder",27),ne("valueChange",function(n){g(e);let r=d();return Z(r.currentMandatoryForm,n)||(r.currentMandatoryForm=n),C(n)}),h("valueChange",function(){g(e);let n=d();return C(n.updateIframeContent())}),a()(),l(15,"div",28)(16,"app-responsive-fields",29),h("formChange",function(n){g(e);let r=d();return C(r.onChangeStyleForm(n))}),a()(),_(17,"div",30),a()}if(o&2){let e=d();c(),Ct("active",e.activeEditor==="form"),c(3),Ct("active",e.activeEditor==="style_control"),c(4),f("hidden",e.activeEditor!=="form"),c(3),f("readonly",e.readonly()),ie("value",e.currentForm),c(3),f("readonly",e.readonly())("preventDelete",!0),ie("value",e.currentMandatoryForm),c(),f("hidden",e.activeEditor!=="style_control"),c(),f("readonly",e.readonly())("fields",e.styleControlFields())("specialControls",e.specialStyleControls)}}function B2(o,t){if(o&1){let e=M();l(0,"div",12)(1,"button",31),h("click",function(){g(e);let n=d();return C(n.saveCompontent())}),_(2,"i",32),u(3," Guardar"),a()()}}var Zr=class o{projectExportService=b(Rn);readonly=le(!1);sandbox;styleControlFields=A({});htmlEditor=A("html");loading=!1;activeComponent=null;activeEditor="form";html="";currentMandatoryForm=[];currentForm=[];specialStyleControls=[];STYLE_CONTROL_LIST=Ee(Sn);iframeloaded=!1;iframeIsReady=!1;set component(t){t?this.setActiveComponent(t):this.resetStates()}onSave=Oe();htmlEditorOptions={theme:"vs-dark",language:"html",automaticLayout:!0,minimap:{enabled:!1}};cssEditorOptions={theme:"vs-dark",language:"css",automaticLayout:!0,minimap:{enabled:!1}};jsEditorOptions={theme:"vs-dark",language:"javascript",automaticLayout:!0,minimap:{enabled:!1}};ngAfterViewInit(){return P(this,null,function*(){let t=document.getElementById("sandbox");this.html=yield this.projectExportService.generateComponentDesigner(),t.contentDocument?.open(),t.contentDocument?.write(this.html),t.contentDocument?.close(),t.contentWindow?.addEventListener("message",()=>{this.iframeIsReady||(this.iframeIsReady=!0,this.updateIframeContent())})})}ngOnDestroy(){document.getElementById("sandbox")?.contentDocument?.removeEventListener("message",()=>{})}onChangeStyleForm(t){this.styleControlFields.set(t.fields),this.specialStyleControls=t.specialControls,this.updateIframeContent()}setActiveComponent(t){this.activeComponent=Ee(t);let e=Ee(bt);this.currentForm=JSON.parse(this.activeComponent?.formFields??"[]");let i=Ot(this.currentForm);e.forEach(r=>{i[r.field]&&(r.default=i[r.field]),this.currentForm=this.currentForm.filter(s=>s.field!==r.field)}),this.currentMandatoryForm=e;let n=JSON.parse(this.activeComponent?.styleControl??"{}");this.styleControlFields.set(n),this.specialStyleControls=JSON.parse(this.activeComponent?.styleList??"[]"),this.updateIframeContent()}updateIframeContent(){return P(this,null,function*(){if(!(!this.activeComponent||!this.iframeIsReady))try{let t=Ot(this.currentForm),e=Ot(this.currentMandatoryForm),i=this.activeComponent.style??"",n=Ut(this.activeComponent.type,this.activeComponent.template,this.activeComponent.script,k(k({},t),e));this.activeComponent.minifyScript=n;let r=document.getElementById("sandbox");if(!r?.contentDocument){console.error("Cannot access iframe document");return}let m=ji.extractStyles(this.styleControlFields()),p=ji.generateStylesSheet([{width:1260,device:oi[0],icon:"https://cdn-icons-png.flaticon.com/512/9428/9428079.png"}],".wmw",m),v={fields:t,scripts:n,styles:p+`
`+i,nameClass:wn(this.activeComponent.type+"")};r.contentWindow?.postMessage({type:"data-element",data:v},"*")}catch(t){console.error("Error updating iframe content:",t)}})}saveCompontent(){return P(this,null,function*(){this.activeComponent!=null&&this.onSave.emit(re(k({},this.activeComponent),{formFields:JSON.stringify([...this.currentForm,...this.currentMandatoryForm]),styleControl:JSON.stringify(this.styleControlFields()),styleList:JSON.stringify(this.specialStyleControls)}))})}resetStates(){this.styleControlFields.set({}),this.loading=!1,this.activeComponent=null,this.activeEditor="form",this.currentMandatoryForm=[],this.currentForm=[],this.specialStyleControls=[]}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-component-design"]],viewQuery:function(e,i){if(e&1&&ut(j2,5),e&2){let n;ct(n=dt())&&(i.sandbox=n.first)}},inputs:{readonly:[1,"readonly"],component:"component"},outputs:{onSave:"onSave"},ngContentSelectors:R2,decls:15,vars:6,consts:[["sandbox",""],[1,"design-container"],[1,"side-panel-left"],[1,"main-panel"],[1,"design-panel"],[3,"initialPanel1Size","hidden"],["pane1","",1,"h-100","overflow-hidden"],["id","sandbox","frameborder","0",1,"w-100",2,"height","100%","border","1px solid gray"],["pane2","",1,"h-100"],[2,"height","100%"],[1,"design-message"],[1,"side-panel-right"],[1,"action-group"],[1,"d-flex","align-items-center","gap-1","px-3",2,"height","32px"],["app-button","","size","xs",3,"click","variant"],[2,"height","calc(100% - 32px)"],["id","templateEditor",2,"height","100%",3,"ngModelChange","hidden","options","ngModel"],["id","stylesEditor",2,"height","100%",3,"ngModelChange","hidden","options","ngModel"],["id","scriptsEditor",2,"height","100%",3,"ngModelChange","hidden","options","ngModel"],[1,"editor-buttons","d-flex","gap-1","align-items-center"],[1,"editor-button",3,"click"],[1,"bi","bi-input-cursor-text"],[1,"bi","bi-palette"],[1,"content-tab"],[1,"p-3",3,"hidden"],[3,"valueChange","readonly","value"],[1,"mt-3","d-block"],[3,"valueChange","readonly","preventDelete","value"],[3,"hidden"],[3,"formChange","readonly","fields","specialControls"],[2,"height","4.5rem"],["app-button","","size","lg","color","success",3,"click"],[1,"bi","bi-save"]],template:function(e,i){e&1&&(Li(),l(0,"div",1)(1,"div",2),gi(2),a(),l(3,"div",3)(4,"div",4)(5,"app-split-view",5)(6,"div",6),_(7,"iframe",7,0),a(),l(9,"div",8),D(10,L2,12,12,"div",9),a()(),D(11,U2,2,0,"div",10),a()(),l(12,"div",11),D(13,z2,18,14),a(),D(14,B2,4,0,"div",12),a()),e&2&&(c(5),f("initialPanel1Size","50%")("hidden",i.activeComponent==null),c(5),T(i.activeComponent?10:-1),c(),T(i.activeComponent==null?11:-1),c(2),T(i.activeComponent?13:-1),c(),T(i.readonly()?-1:14))},dependencies:[Ke,si,pe,Ne,at,At,he,Be,pr,nf,Xr,qc,Tn,Gc],styles:["[_nghost-%COMP%]{display:flex;height:100%}.panelA[_ngcontent-%COMP%]{width:260px;min-width:260px;border-right:1px solid #ccc}.panelB[_ngcontent-%COMP%]{flex:1;padding:1rem}.design-container[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;position:relative}.side-panel-left[_ngcontent-%COMP%]{width:260px;min-width:260px;border-right:1px solid var(--border-color);height:100%;position:relative;display:flex;flex-direction:column}.main-panel[_ngcontent-%COMP%]{flex:1;height:100%;min-width:0;position:relative}.side-panel-right[_ngcontent-%COMP%]{width:360px;min-width:360px;border-left:1px solid var(--border-color);height:100%;display:flex;flex-direction:column}.design-panel[_ngcontent-%COMP%]{height:100%;position:relative}.design-message[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:24px;color:#666;text-align:center}.components-dropdown[_ngcontent-%COMP%]{position:static}.side-panel[_ngcontent-%COMP%]{width:260px;min-width:260px;border-right:1px solid var(--border-color);padding:1rem;display:flex;flex-direction:column;gap:1rem}.editor-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;border-bottom:1px solid var(--border-color);height:42px}.content-tab[_ngcontent-%COMP%]{height:calc(100% - 42px);overflow-y:auto}.editor-button[_ngcontent-%COMP%]{text-align:center;padding:.5rem;height:100%;border:none;background:none;display:flex;align-items:center;gap:.5rem;flex:1;color:var(--fuse-text-default)}.editor-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem;width:20px}.editor-button.active[_ngcontent-%COMP%]{color:var(--primary);font-weight:700}.action-group[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-direction:row;position:fixed;align-items:center;justify-content:flex-end;bottom:1rem;right:1rem;z-index:1000;width:auto}.action-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-width:120px;box-shadow:0 2px 4px #0003}.action-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.5rem}.action-group[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}ngx-monaco-editor[_ngcontent-%COMP%]     .editor-container{height:100%}.main-content[_ngcontent-%COMP%]{flex:1;display:flex;width:calc(100% - 260px)}"]})};var Jc=(i=>(i.ACTIVE="1",i.INACTIVE="2",i.DEVELOPMENT="3",i))(Jc||{});var W2=o=>({active:o});function $2(o,t){o&1&&_(0,"i",6)}var Xc=class o{item={};isActived=!1;card="box";readonly=!1;authService=b(xe);base=Le.isMultipleSystem?`${Le.sistema}/${this.authService.userData.rol}`:`${this.authService.userData.rol}`;router=b(ln);openMenu=new q;design=new q;openMenuEmit(t){this.openMenu.emit(t)}initDesign(t){this.design.emit(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-component-card"]],inputs:{item:"item",isActived:"isActived",card:"card",readonly:"readonly"},outputs:{openMenu:"openMenu",design:"design"},features:[we([Te({lucidePen:Zi})])],decls:10,vars:7,consts:[[1,"items","box-main","p-1",3,"ngClass"],[1,"d-flex","align-items-center","w-100","gap-2"],[2,"width","16px",3,"src","alt"],[1,"flex-grow-1",2,"overflow","hidden"],[1,"text-truncate",2,"text-overflow","ellipsis"],[1,"d-flex","align-items-center"],[1,"bi","bi-lock"],["app-icon-button","","size","xs","variant","text","color","secondary","title","M\xE1s opciones",3,"click"],[1,"bi","bi-three-dots-vertical"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1),_(2,"img",2),l(3,"div",3)(4,"span",4),u(5),a()(),l(6,"div",5),D(7,$2,1,0,"i",6),l(8,"button",7),h("click",function(r){return i.openMenuEmit(r)}),_(9,"i",8),a()()()()),e&2&&(f("ngClass",te(5,W2,i.isActived)),c(2),f("src",i.item.icon,mt)("alt",i.item.name),c(3),W(i.item.name),c(2),T(i.readonly?7:-1))},dependencies:[be,he,Ge],styles:["img[_ngcontent-%COMP%]{filter:var(--filter)}"]})};function H2(o,t){if(o&1){let e=M();l(0,"span",0),u(1),l(2,"button",2),h("click",function(){let n=g(e).$implicit,r=d();return C(r.removeChip(n))}),_(3,"i",3),a()()}if(o&2){let e=t.$implicit;c(),Ie(" ",e," "),c(),f("rounded",!0)}}var Zc=class o{value=le("");valueChange=new q;chips=A([]);placeholder=le("Agregar chip");newChip=A("");constructor(){yt(()=>{let t=this.value()??"";Ci(()=>{let e=t.split(",").map(i=>i.trim()).filter(i=>i.length>0);console.log(e),this.chips.set(e)})})}addChip(){let t=this.newChip().trim();if(t&&!this.chips().includes(t)){let e=[...this.chips(),t];this.chips.set(e),this.emitChanges()}this.newChip.set("")}handleKeydown(t){(t.key===","||t.key==="Enter")&&(t.preventDefault(),this.addChip())}removeChip(t){let e=this.chips().filter(i=>i!==t);this.chips.set(e),this.emitChanges()}emitChanges(){this.valueChange.emit(this.chips().join(", "))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-chip-input"]],inputs:{value:[1,"value"],placeholder:[1,"placeholder"]},outputs:{valueChange:"valueChange"},decls:3,vars:2,consts:[[1,"badge","chip","bg-primary"],["type","text",3,"ngModelChange","keydown","placeholder","ngModel"],["color","light","type","button","app-icon-button","","size","xs","variant","flat","aria-label","Eliminar",3,"click","rounded"],[1,"bi","bi-x"]],template:function(e,i){e&1&&(Y(0,H2,4,2,"span",0,de),l(2,"input",1),ne("ngModelChange",function(r){return Z(i.newChip,r)||(i.newChip=r),r}),h("keydown",function(r){return i.handleKeydown(r)}),a()),e&2&&(ee(i.chips()),c(2),f("placeholder",i.placeholder()),ie("ngModel",i.newChip))},dependencies:[pe,Qe,Ne,at,he,Ge],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;gap:.25rem;border:1px solid var(--form-control-border);border-radius:.375rem;font-size:15px;min-height:40px;padding:2px .75rem;align-items:center;background-color:var(--form-control-bg);-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{border:none;background:none;outline:none;font-size:1rem;color:var(--form-control-color);flex:1;min-width:120px}[_nghost-%COMP%]:focus-within{box-shadow:0 0 0 1px #039be5 inset,0 0 0 1px #e0e0e0 inset;border-color:#039be5!important}.chip[_ngcontent-%COMP%]{padding:0rem .25rem 0rem .5rem;font-size:.8rem;border-radius:20px;display:flex;align-items:center;transition:transform .2s ease;height:30px;gap:.5rem;line-height:normal}"]})};var G2=o=>({"modal-body":o}),qm=o=>({"has-danger":o});function q2(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",14),u(2,"DATOS DEL COMPONENTE"),a(),l(3,"button",15),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}function J2(o,t){o&1&&_(0,"app-loading")}var Qc=class o{constructor(t){this.modalActive=t}accion="add";component;isModal=!0;idinstitucion="";uid="";eventChange=new q;category=A("");componentService=b(fn);authService=b(xe);ngOnInit(){return P(this,null,function*(){if(this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.uid===""&&(this.uid=this.authService.userData.id+""),this.accion=="update"){if(!this.component)return;this.form.patchValue({icon:this.component.icon,name:this.component.name,category:this.component.category}),console.log(this.component.category),this.category.set(this.component.category)}})}ngAfterViewInit(){document.getElementById("id")?.focus()}onCategoryChange(t){this.form.patchValue({category:t})}form=new ni({icon:new Fe("",{validators:[ze.required],nonNullable:!0}),name:new Fe("",{validators:[ze.required],nonNullable:!0}),category:new Fe("",{validators:[ze.required],nonNullable:!0})});get iconControl(){return this.form.get("icon")}get nameControl(){return this.form.get("name")}get categoryControl(){return this.form.get("category")}close(){this.isModal?this.modalActive.dismiss():this.eventChange.emit({event:"close",data:void 0})}submit=!1;loading=!1;save(){return P(this,null,function*(){if(this.submit=!0,!this.form.valid)return;this.submit=!1;let t=this.form.value;if(this.accion=="add"){let e={icon:t.icon,name:t.name,style:"",script:"",template:"<span>Hola mundo</span>",formFields:"[]",category:t.category,state:"1",minifyScript:"",minifyStyle:"",wrapperFields:"{}",styleControl:"{}",styleList:"[]"};this.loading=!0;let i=yield this.componentService.add(e);this.loading=!1,i.state=="success"&&(this.isModal?this.modalActive.close(i.data):this.eventChange.emit({event:"add",data:i.data}))}else if(this.accion=="update"){let e={id:this.component?.id,type:this.component?.type,icon:t.icon,name:t.name,style:this.component?.style,script:this.component?.script,template:this.component?.template,formFields:this.component?.formFields,category:t.category,state:this.component?.state,minifyScript:this.component?.minifyScript,minifyStyle:this.component?.minifyStyle,wrapperFields:this.component?.wrapperFields,styleList:this.component?.styleList,styleControl:this.component?.styleControl};this.loading=!0;let i=yield this.componentService.update(e);this.loading=!1,i.state=="success"&&(this.isModal?this.modalActive.close(e):this.eventChange.emit({event:"update",data:i.data}))}})}onUploadFile(t){t.event=="link"&&this.form.patchValue({icon:t.url})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-component-form"]],inputs:{accion:"accion",component:"component",isModal:"isModal",idinstitucion:"idinstitucion",uid:"uid"},outputs:{eventChange:"eventChange"},decls:22,vars:23,consts:[[1,"modal-header"],[3,"ngClass"],[1,"container",3,"submit","formGroup"],[1,"mb-3",3,"ngClass"],["for","name",1,"form-label"],["type","text","name","name","id","name","formControlName","name","placeholder","Nombre del componente",1,"form-control"],[3,"control","show"],[1,"mb-3",2,"position","relative",3,"ngClass"],["for","icon",1,"form-label"],["name","foto_url","type","image",3,"evento","url"],["placeholder","agregar categoria",3,"valueChange","value"],[1,"modal-footer"],["app-button","","variant","outline","size","lg","color","secondary",3,"click"],["app-button","","size","lg","color","primary",3,"click"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"]],template:function(e,i){e&1&&(D(0,q2,4,0,"div",0),l(1,"div",1)(2,"form",2),h("submit",function(){return i.save()}),l(3,"div",3)(4,"label",4),u(5," Name "),a(),_(6,"input",5)(7,"app-control-messages",6),a(),l(8,"div",7)(9,"label",8),u(10,"Url icono "),a(),l(11,"app-file-upload",9),h("evento",function(r){return i.onUploadFile(r)}),a(),_(12,"app-control-messages",6),a(),l(13,"div",3)(14,"app-chip-input",10),ne("valueChange",function(r){return Z(i.category,r)||(i.category=r),r}),h("valueChange",function(r){return i.onCategoryChange(r)}),a(),_(15,"app-control-messages",6),a()()(),l(16,"div",11)(17,"button",12),h("click",function(){return i.close()}),u(18,"Cancelar"),a(),l(19,"button",13),h("click",function(){return i.save()}),u(20,"Guardar"),a()(),D(21,J2,1,0,"app-loading")),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(15,G2,i.isModal)),c(),f("formGroup",i.form),c(),f("ngClass",te(17,qm,i.nameControl.invalid&&(i.nameControl.touched||i.submit))),c(4),f("control",i.nameControl)("show",i.submit),c(),f("ngClass",te(19,qm,i.iconControl.invalid&&(i.iconControl.touched||i.submit))),c(3),f("url",i.component==null?null:i.component.icon),c(),f("control",i.iconControl)("show",i.submit),c(),f("ngClass",te(21,qm,i.categoryControl.invalid&&(i.categoryControl.touched||i.submit))),c(),ie("value",i.category),c(),f("control",i.categoryControl)("show",i.submit),c(6),T(i.loading?21:-1))},dependencies:[Kt,Zt,Qe,Ne,Xt,Qt,ri,bi,be,Ye,so,he,Be,Zc],encapsulation:2})};var X2=(o,t)=>({item:o,indice:t});function Z2(o,t){if(o&1){let e=M();l(0,"app-ui-header-management",8),ne("searchChange",function(n){g(e);let r=d();return Z(r.filter.texto,n)||(r.filter.texto=n),C(n)}),h("onAdd",function(){g(e);let n=d();return C(n.add())})("onExport",function(n){g(e);let r=d();return C(r.export(n))})("onSearch",function(){g(e);let n=d();return C(n.searchChange())})("reload",function(){g(e);let n=d();return C(n.list())}),a()}if(o&2){let e=d();ie("search",e.filter.texto),f("canExport",e.componentService.canExport)("canExportExcel",e.componentService.canExportExcel)("canExportPdf",e.componentService.canExportPdf)("canNew",e.componentService.canAdd)("showMode",!1)("size","sm")("showExport",!1)}}function Q2(o,t){if(o&1){let e=M();l(0,"app-ui-component-card",9,1),h("elementEvents",function(n){let r=g(e).$implicit,s=d();return C(s.select(r,n))})("openMenu",function(n){let r=g(e).$implicit,s=Xe(1);return d().select(r),C(s.open(n))})("design",function(){let n=g(e).$implicit,r=d();return C(r.select(n,"design"))}),a()}if(o&2){let e=t.$implicit,i=t.$index,n=d(),r=Xe(8);f("item",e)("readonly",n.readonly)("isActived",e.id==(n.selected==null?null:n.selected.id))("contextMenu",r)("contextMenuValue",vt(5,X2,e,i))}}function K2(o,t){o&1&&_(0,"app-ui-message-empty")}function Y2(o,t){o&1&&(l(0,"div",12)(1,"div",13),_(2,"i",14),a(),l(3,"div",15),u(4,"Adicionar"),a(),l(5,"div",16),u(6,"F1"),a()())}function eE(o,t){o&1&&(l(0,"div",12)(1,"div",13),_(2,"i",17),a(),l(3,"div",15),u(4,"Editar"),a(),_(5,"div",16),a())}function tE(o,t){o&1&&(l(0,"div",12)(1,"div",13),_(2,"i",18),a(),l(3,"div",15),u(4,"Eliminar"),a(),_(5,"div",16),a())}function iE(o,t){}function nE(o,t){o&1&&(l(0,"div",12)(1,"div",13),_(2,"i",19),a(),l(3,"div",15),u(4,"Actualizar lista"),a(),_(5,"div",16),a())}function oE(o,t){if(o&1){let e=M();Se(0,Y2,7,0,"ng-template",10),h("execute",function(){g(e);let n=d();return C(n.add())}),Se(1,eE,6,0,"ng-template",10),h("execute",function(n){g(e);let r=d();return C(r.update(n.value.item))}),Se(2,tE,6,0,"ng-template",10),h("execute",function(n){g(e);let r=d();return C(r.remove(n.value.item,n.value.indice))}),Se(3,iE,0,0,"ng-template",11)(4,nE,6,0,"ng-template",7),h("execute",function(){g(e);let n=d();return C(n.list())})}if(o&2){let e=d();f("visible",e.canAdd),c(),f("visible",e.canEdit),c(),f("visible",e.canRemove),c(),f("divider",!0)}}function rE(o,t){o&1&&(l(0,"div",12)(1,"div",13),_(2,"i",19),a(),l(3,"div",15),u(4,"Clonar"),a(),_(5,"div",16),a())}function aE(o,t){o&1&&_(0,"app-loading")}var Ko=class o{toastrService=b(tt);mode="table";size="lg";eventChange=Oe();onClone=Oe();readonly=!1;componentService=b(fn);authService=b(xe);confirmationService=b(ft);modalService=b(Vi);filter={texto:""};components=[];EComponentState=Jc;loading=!1;base=Le.isMultipleSystem?`${Le.sistema}/${this.authService.userData.rol}`:`${this.authService.userData.rol}`;ngOnInit(){return P(this,null,function*(){this.list()})}list(){return P(this,null,function*(){this.loading=!0;let t=yield this.componentService.list(this.filter);this.loading=!1,t&&t.state=="success"&&(this.components=t.data??[])})}add(){this.openForm()}update(t){this.openForm("update",t)}openForm(t="add",e){return P(this,null,function*(){try{let i=this.modalService.open(Qc,{backdrop:"static",keyboard:!1,size:"lg"});i.componentInstance.accion=t,t=="update"&&(i.componentInstance.component=JSON.parse(JSON.stringify(e)));let n=yield i.result;if(t=="add")this.components.unshift(n);else if(t=="update"){if(!e)return;Object.assign(e,n)}}catch{}})}remove(t,e=-1){return P(this,null,function*(){if(!(yield this.confirmationService.create("Eliminar","\xBFEst\xE1 seguro de eliminar el componente?")))return;this.loading=!0;let n=yield this.componentService.delete(t);this.loading=!1,n.state=="success"&&(this.components.splice(e,1),this.selected=void 0)})}saveCompontent(){return P(this,null,function*(){if(this.selected!=null)try{let t={id:this.selected.id,name:this.selected.name,type:this.selected.type,icon:this.selected.icon,style:this.selected.style,script:this.selected.script,template:this.selected.template,formFields:this.selected.formFields,category:this.selected.category,state:this.selected.state,minifyScript:this.selected.minifyScript,minifyStyle:this.selected.minifyStyle,wrapperFields:this.selected.wrapperFields},e=yield this.componentService.update(t);if(e&&e.state=="success"){let i=this.components.findIndex(n=>n.id==this.selected?.id);i>=0&&(this.components[i]=k(k({},this.components[i]),t))}}catch(t){this.toastrService.error("Error "+t)}})}searchChange(){this.list()}stateFilterChange(){this.list()}suiteFilterChange(){this.list()}currentWrapperFormFields="[]";selected;select(t,e="click"){this.selected=JSON.parse(JSON.stringify(t));let i=JSON.parse(JSON.stringify(bt)),n=JSON.parse(this.selected?.wrapperFields??"{}");i.forEach(r=>{n[r.field]&&(r.default=n[r.field])}),this.eventChange.emit(Ee(t))}canAdd=()=>this.componentService.canAdd;canEdit=()=>this.componentService.canEdit;canRemove=()=>this.componentService.canRemove;canChangeState=()=>this.componentService.canChangeState;canExport=()=>this.componentService.canExport;canExportExcel=()=>this.componentService.canExportExcel;canExportPdf=()=>this.componentService.canExportPdf;export(t="pdf"){return P(this,null,function*(){yield this.componentService.export(this.filter,t)})}changeMode(t){this.mode=t}reloadList(){this.list()}clone(t){this.onClone.emit(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-component-list"]],inputs:{mode:"mode",size:"size",readonly:"readonly"},outputs:{eventChange:"eventChange",onClone:"onClone"},features:[we([],[Te({lucideCopy:Fn,lucideClipboard:Es,lucideDownload:Ps})])],decls:12,vars:4,consts:[["menu",""],["ngxContextMenu","ngxContextMenu"],[1,"d-flex","flex-column"],[3,"search","canExport","canExportExcel","canExportPdf","canNew","showMode","size","showExport"],[1,"component-list","flex-grow-1","overflow-auto"],[1,"_list"],[3,"item","readonly","isActived","contextMenu","contextMenuValue"],["contextMenuItem","",3,"execute"],[3,"searchChange","onAdd","onExport","onSearch","reload","search","canExport","canExportExcel","canExportPdf","canNew","showMode","size","showExport"],[3,"elementEvents","openMenu","design","item","readonly","isActived","contextMenu","contextMenuValue"],["contextMenuItem","",3,"execute","visible"],["contextMenuItem","",3,"divider"],[1,"_items"],[1,"icons"],[1,"icons","icon","ion-md-add"],[1,"label","w-100"],[1,"atajo"],[1,"icons","icon","ion-md-create"],[1,"icons","icon","ion-md-trash"],[1,"icons","icon","ion-md-refresh"]],template:function(e,i){if(e&1){let n=M();l(0,"div",2),D(1,Z2,1,8,"app-ui-header-management",3),l(2,"div",4)(3,"div",5),Y(4,Q2,2,8,"app-ui-component-card",6,de,!1,K2,1,0,"app-ui-message-empty"),a()()(),l(7,"context-menu",null,0),D(9,oE,5,4),Se(10,rE,6,0,"ng-template",7),h("execute",function(s){return g(n),C(i.clone(s.value.item))}),a(),D(11,aE,1,0,"app-loading")}e&2&&(c(),T(i.readonly?-1:1),c(3),ee(i.components),c(5),T(i.readonly?-1:9),c(2),T(i.loading?11:-1))},dependencies:[si,Si,wi,xi,pe,Ye,Ke,At,Xc,Ei,dn,Ni,pr,Tn],styles:["textarea.form-control[_ngcontent-%COMP%]{font-family:monospace;font-size:14px}.card-body[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px;filter:var(--filter)}"]})};var Kc=(i=>(i.ACTIVE="1",i.INACTIVE="2",i.DEVELOPMENT="3",i))(Kc||{});var Mo=class o{API=`${Le.web_maker}/project-component`;apiService=b(Lt);loadingService=b(Yt);confirmationService=b(ft);auth=b(xe);toastrService=b(tt);states=[];stateMap=this.states.reduce((t,e)=>(t[e.code]=e.denomination,t),{});canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.canAdd=this.auth.hasSubPermission("component-ADD"),this.canEdit=this.auth.hasSubPermission("component-EDIT"),this.canRemove=this.auth.hasSubPermission("component-REMOVE"),this.canChangeState=this.auth.hasSubPermission("component-CHANGE-STATE"),this.canExport=this.auth.hasPermission("component-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("component-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("component-EXPORT-PDF")}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}delete(t){return P(this,null,function*(){return this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,{id:t.id,idinstitucion:t.idinstitucion})})}export(t,e){return P(this,null,function*(){if(!(yield this.confirmationService.create("Confirmar","\xBFEst\xE1 seguro de exportar los datos?")))return;this.loadingService.open();let n=re(k({},t),{type_export:e,url:Le.storage}),r=yield this.apiService.getPrivate(`${this.API}/export`,n);return this.loadingService.hide(),r&&r.state=="success"&&window.open(r.url),r})}fetchContent(t){return P(this,null,function*(){let e=yield fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.text()})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var Jm=o=>({"has-danger":o});function sE(o,t){o&1&&_(0,"app-loading")}var Yc=class o{accion="add";component;isModal=!0;modalService=b(St);idinstitucion="";project_id="";uid="";eventChange=new q;componentService=b(Mo);authService=b(xe);ngOnInit(){return P(this,null,function*(){if(this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.uid===""&&(this.uid=this.authService.userData.id+""),this.accion=="update"||this.accion=="clone"){if(!this.component)return;this.form.patchValue({icon:this.component.icon,name:this.component.name+(this.accion=="clone"?" (Copia)":""),category:this.component.category})}})}ngAfterViewInit(){document.getElementById("id")?.focus()}form=new ni({icon:new Fe("",{validators:[ze.required],nonNullable:!0}),name:new Fe("",{validators:[ze.required],nonNullable:!0}),category:new Fe("",{validators:[ze.required],nonNullable:!0})});get iconControl(){return this.form.get("icon")}get nameControl(){return this.form.get("name")}get categoryControl(){return this.form.get("category")}close(){this.isModal?this.modalService.close():this.eventChange.emit({event:"close",data:void 0})}submit=!1;loading=!1;save(){return P(this,null,function*(){if(this.submit=!0,!this.form.valid)return;this.submit=!1;let t=this.form.value;if(this.accion=="add"){let e={icon:t.icon,name:t.name,style:"",script:"",template:"<span>Hola mundo</span>",formFields:"[]",category:t.category,idinstitucion:this.idinstitucion,state:"1",minifyScript:"",minifyStyle:"",wrapperFields:"{}",styleControl:"{}",styleList:"[]",project_id:this.project_id};this.loading=!0;let i=yield this.componentService.add(e);this.loading=!1,i.state=="success"&&(this.isModal?this.modalService.ok(i.data):this.eventChange.emit({event:"add",data:i.data}))}else if(this.accion=="update"){let e={id:this.component?.id,type:this.component?.type,icon:t.icon,name:t.name,style:this.component?.style,script:this.component?.script,template:this.component?.template,formFields:this.component?.formFields,category:t.category,idinstitucion:this.component?.idinstitucion,state:this.component?.state,minifyScript:this.component?.minifyScript,minifyStyle:this.component?.minifyStyle,wrapperFields:this.component?.wrapperFields,styleList:this.component?.styleList,styleControl:this.component?.styleControl,project_id:this.component?.project_id};this.loading=!0;let i=yield this.componentService.update(e);this.loading=!1,i.state=="success"&&(this.isModal?this.modalService.ok(e):this.eventChange.emit({event:"update",data:i.data}))}else if(this.accion=="clone"){let e={icon:t.icon,name:t.name,style:this.component?.style,script:this.component?.script,template:this.component?.template,formFields:this.component?.formFields,category:t.category,idinstitucion:this.idinstitucion,state:this.component?.state,minifyScript:this.component?.minifyScript,minifyStyle:this.component?.minifyStyle,wrapperFields:this.component?.wrapperFields,styleList:this.component?.styleList,styleControl:this.component?.styleControl,project_id:this.component?.project_id};this.loading=!0;let i=yield this.componentService.add(e);this.loading=!1,i.state=="success"&&(this.isModal?this.modalService.ok(i.data):this.eventChange.emit({event:"clone",data:i.data}))}})}onUploadFile(t){t.event=="link"&&this.form.patchValue({icon:t.url})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-project-component-form"]],inputs:{accion:"accion",component:"component",isModal:"isModal",idinstitucion:"idinstitucion",project_id:"project_id",uid:"uid"},outputs:{eventChange:"eventChange"},decls:22,vars:18,consts:[[1,"container",3,"submit","formGroup"],[1,"mb-3",3,"ngClass"],["for","name",1,"form-label"],["type","text","name","name","id","name","formControlName","name","placeholder","Nombre del componente",1,"form-control"],[3,"control","show"],[1,"mb-3",2,"position","relative",3,"ngClass"],["for","icon",1,"form-label"],["name","foto_url","type","image",3,"evento","url"],["for","category",1,"form-label"],["type","text","name","category","id","category","formControlName","category","placeholder","Categoria del componente",1,"form-control"],[1,"modal-footer"],["app-button","","variant","outline","size","lg","color","secondary",3,"click"],["app-button","","size","lg","color","primary",3,"click"]],template:function(e,i){e&1&&(l(0,"form",0),h("submit",function(){return i.save()}),l(1,"div",1)(2,"label",2),u(3," Name "),a(),_(4,"input",3)(5,"app-control-messages",4),a(),l(6,"div",5)(7,"label",6),u(8,"Url icono "),a(),l(9,"app-file-upload",7),h("evento",function(r){return i.onUploadFile(r)}),a(),_(10,"app-control-messages",4),a(),l(11,"div",1)(12,"label",8),u(13," Categoria "),a(),_(14,"input",9)(15,"app-control-messages",4),a()(),l(16,"div",10)(17,"button",11),h("click",function(){return i.close()}),u(18,"Cancelar"),a(),l(19,"button",12),h("click",function(){return i.save()}),u(20,"Guardar"),a()(),D(21,sE,1,0,"app-loading")),e&2&&(f("formGroup",i.form),c(),f("ngClass",te(12,Jm,i.nameControl.invalid&&(i.nameControl.touched||i.submit))),c(4),f("control",i.nameControl)("show",i.submit),c(),f("ngClass",te(14,Jm,i.iconControl.invalid&&(i.iconControl.touched||i.submit))),c(3),f("url",i.component==null?null:i.component.icon),c(),f("control",i.iconControl)("show",i.submit),c(),f("ngClass",te(16,Jm,i.categoryControl.invalid&&(i.categoryControl.touched||i.submit))),c(4),f("control",i.categoryControl)("show",i.submit),c(6),T(i.loading?21:-1))},dependencies:[Kt,Zt,Qe,Ne,Xt,Qt,ri,bi,be,Ye,so,he,Be],encapsulation:2})};var lE=o=>({active:o}),ed=class o{item={};isActived=!1;card="box";authService=b(xe);base=Le.isMultipleSystem?`${Le.sistema}/${this.authService.userData.rol}`:`${this.authService.userData.rol}`;router=b(ln);openMenu=new q;design=new q;openMenuEmit(t){this.openMenu.emit(t)}initDesign(t){this.design.emit(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-project-component-card"]],inputs:{item:"item",isActived:"isActived",card:"card"},outputs:{openMenu:"openMenu",design:"design"},features:[we([Te({lucidePen:Zi})])],decls:9,vars:6,consts:[[1,"items","box-main","p-1",3,"ngClass"],[1,"d-flex","align-items-center","w-100","gap-2"],[2,"width","16px",3,"src","alt"],[1,"flex-grow-1",2,"overflow","hidden"],[1,"text-truncate",2,"text-overflow","ellipsis"],[1,"d-flex","align-items-center"],["app-icon-button","","size","xs","variant","text","color","secondary","title","M\xE1s opciones",3,"click"],[1,"bi","bi-three-dots-vertical"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1),_(2,"img",2),l(3,"div",3)(4,"span",4),u(5),a()(),l(6,"div",5)(7,"button",6),h("click",function(r){return i.openMenuEmit(r)}),_(8,"i",7),a()()()()),e&2&&(f("ngClass",te(4,lE,i.isActived)),c(2),f("src",i.item.icon,mt)("alt",i.item.name),c(3),W(i.item.name))},dependencies:[be,he,Ge],styles:["img[_ngcontent-%COMP%]{filter:var(--filter)}"]})};var cE=(o,t)=>({item:o,indice:t});function dE(o,t){if(o&1){let e=M();l(0,"app-ui-project-component-card",10,1),h("elementEvents",function(n){let r=g(e).$implicit,s=d();return C(s.select(r,n))})("openMenu",function(n){let r=g(e).$implicit,s=Xe(1);return d().select(r),C(s.open(n))})("design",function(){let n=g(e).$implicit,r=d();return C(r.select(n,"design"))}),a()}if(o&2){let e=t.$implicit,i=t.$index,n=d(),r=Xe(8);f("item",e)("isActived",e.id==(n.selected==null?null:n.selected.id))("contextMenu",r)("contextMenuValue",vt(4,cE,e,i))}}function mE(o,t){o&1&&_(0,"app-ui-message-empty")}function pE(o,t){o&1&&(l(0,"div",11)(1,"div",12),_(2,"i",13),a(),l(3,"div",14),u(4,"Adicionar"),a(),l(5,"div",15),u(6,"F1"),a()())}function uE(o,t){o&1&&(l(0,"div",11)(1,"div",12),_(2,"i",16),a(),l(3,"div",14),u(4,"Editar"),a(),_(5,"div",15),a())}function fE(o,t){o&1&&(l(0,"div",11)(1,"div",12),_(2,"i",17),a(),l(3,"div",14),u(4,"Eliminar"),a(),_(5,"div",15),a())}function hE(o,t){}function gE(o,t){o&1&&(l(0,"div",11)(1,"div",12),_(2,"i",18),a(),l(3,"div",14),u(4,"Actualizar lista"),a(),_(5,"div",15),a())}function CE(o,t){o&1&&_(0,"app-loading")}var Ja=class o{toastrService=b(tt);idinstitucion="";mode="table";size="lg";eventChange=new q;componentService=b(Mo);authService=b(xe);confirmationService=b(ft);modalService=b(St);project_id=le(null);filter={texto:"",project_id:""};components=[];EComponentState=Kc;loading=!1;base=Le.isMultipleSystem?`${Le.sistema}/${this.authService.userData.rol}`:`${this.authService.userData.rol}`;ngOnInit(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.filter.idinstitucion=this.idinstitucion,this.filter.project_id=this.project_id()??"",this.list()})}list(){return P(this,null,function*(){this.loading=!0;let t=yield this.componentService.list(this.filter);this.loading=!1,t&&t.state=="success"&&(this.components=t.data??[])})}add(){this.openForm()}update(t){this.openForm("update",t)}openForm(t="add",e){return P(this,null,function*(){try{let n=yield this.modalService.open(Yc,{title:t=="add"?"Agregar componente":t=="update"?"Editar componente":"Clonar componente",hiddenButtons:!0,params:{accion:t,idinstitucion:this.filter.idinstitucion,project_id:this.project_id()??"",component:t=="update"||t=="clone"?JSON.parse(JSON.stringify(e)):void 0}}).result();if(n.isOk){if(console.log("state",n.data),t=="add"||t=="clone")this.components.unshift(n.data),console.log("state",n.data);else if(t=="update"){if(!e)return;Object.assign(e,n.data)}}}catch{}})}remove(t,e=-1){return P(this,null,function*(){if(!(yield this.confirmationService.create("Eliminar","\xBFEst\xE1 seguro de eliminar el componente?")))return;this.loading=!0;let n=yield this.componentService.delete(t);this.loading=!1,n.state=="success"&&(this.components.splice(e,1),this.selected=void 0)})}saveCompontent(){return P(this,null,function*(){if(this.selected!=null)try{let t={id:this.selected.id,idinstitucion:this.selected.idinstitucion,name:this.selected.name,type:this.selected.type,icon:this.selected.icon,style:this.selected.style,script:this.selected.script,template:this.selected.template,formFields:this.selected.formFields,category:this.selected.category,state:this.selected.state,minifyScript:this.selected.minifyScript,minifyStyle:this.selected.minifyStyle,wrapperFields:this.selected.wrapperFields,project_id:this.project_id()},e=yield this.componentService.update(t);if(e&&e.state=="success"){let i=this.components.findIndex(n=>n.id==this.selected?.id);i>=0&&(this.components[i]=k(k({},this.components[i]),t))}}catch(t){this.toastrService.error("Error "+t)}})}searchChange(){this.list()}stateFilterChange(){this.list()}suiteFilterChange(){this.list()}currentWrapperFormFields="[]";selected;select(t,e="click"){this.selected=JSON.parse(JSON.stringify(t));let i=JSON.parse(JSON.stringify(bt)),n=JSON.parse(this.selected?.wrapperFields??"{}");i.forEach(r=>{n[r.field]&&(r.default=n[r.field])}),this.eventChange.emit(Ee(t))}canAdd=()=>this.componentService.canAdd;canEdit=()=>this.componentService.canEdit;canRemove=()=>this.componentService.canRemove;canChangeState=()=>this.componentService.canChangeState;canExport=()=>this.componentService.canExport;canExportExcel=()=>this.componentService.canExportExcel;canExportPdf=()=>this.componentService.canExportPdf;export(t="pdf"){return P(this,null,function*(){yield this.componentService.export(this.filter,t)})}changeMode(t){this.mode=t}reloadList(){this.list()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-project-component-list"]],inputs:{idinstitucion:"idinstitucion",mode:"mode",size:"size",project_id:[1,"project_id"]},outputs:{eventChange:"eventChange"},features:[we([],[Te({lucideCopy:Fn,lucideClipboard:Es,lucideDownload:Ps})])],decls:15,vars:14,consts:[["menu",""],["ngxContextMenu","ngxContextMenu"],[1,"d-flex","flex-column"],[3,"searchChange","onAdd","onExport","onSearch","reload","search","canExport","canExportExcel","canExportPdf","canNew","showMode","size","showExport"],[1,"component-list","flex-grow-1","overflow-auto"],[1,"_list"],[3,"item","isActived","contextMenu","contextMenuValue"],["contextMenuItem","",3,"execute","visible"],["contextMenuItem","",3,"divider"],["contextMenuItem","",3,"execute"],[3,"elementEvents","openMenu","design","item","isActived","contextMenu","contextMenuValue"],[1,"_items"],[1,"icons"],[1,"icons","icon","ion-md-add"],[1,"label","w-100"],[1,"atajo"],[1,"icons","icon","ion-md-create"],[1,"icons","icon","ion-md-trash"],[1,"icons","icon","ion-md-refresh"]],template:function(e,i){if(e&1){let n=M();l(0,"div",2)(1,"app-ui-header-management",3),ne("searchChange",function(s){return g(n),Z(i.filter.texto,s)||(i.filter.texto=s),C(s)}),h("onAdd",function(){return g(n),C(i.add())})("onExport",function(s){return g(n),C(i.export(s))})("onSearch",function(){return g(n),C(i.searchChange())})("reload",function(){return g(n),C(i.list())}),a(),l(2,"div",4)(3,"div",5),Y(4,dE,2,7,"app-ui-project-component-card",6,de,!1,mE,1,0,"app-ui-message-empty"),a()()(),l(7,"context-menu",null,0),Se(9,pE,7,0,"ng-template",7),h("execute",function(){return g(n),C(i.add())}),Se(10,uE,6,0,"ng-template",7),h("execute",function(s){return g(n),C(i.update(s.value.item))}),Se(11,fE,6,0,"ng-template",7),h("execute",function(s){return g(n),C(i.remove(s.value.item,s.value.indice))}),Se(12,hE,0,0,"ng-template",8)(13,gE,6,0,"ng-template",9),h("execute",function(){return g(n),C(i.list())}),a(),D(14,CE,1,0,"app-loading")}e&2&&(c(),ie("search",i.filter.texto),f("canExport",i.componentService.canExport)("canExportExcel",i.componentService.canExportExcel)("canExportPdf",i.componentService.canExportPdf)("canNew",i.componentService.canAdd)("showMode",!1)("size","sm")("showExport",!1),c(3),ee(i.components),c(5),f("visible",i.canAdd),c(),f("visible",i.canEdit),c(),f("visible",i.canRemove),c(),f("divider",!0),c(2),T(i.loading?14:-1))},dependencies:[si,Si,wi,xi,pe,Ye,Ke,At,Ei,dn,Ni,pr,Tn,ed],styles:["textarea.form-control[_ngcontent-%COMP%]{font-family:monospace;font-size:14px}.card-body[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:22px;filter:var(--filter)}"]})};var td=class o{projetComponentService=b(Mo);activatedRoute=b(Wi);isProjectComponent=A(!1);project_id=A(null);projectComponentList;activeEdit=A(null);currentCoreComponent=A(null);selected(t,e=!1){let{formFields:i,styleControl:n,styleList:r,type:s,template:m,style:p,script:v,minifyScript:y}=t;this.currentCoreComponent.set({formFields:i,styleControl:n,styleList:r,type:s,template:m,style:p,script:v,minifyScript:y}),this.activeEdit.set(t),this.isProjectComponent.set(e)}onSave(t){return P(this,null,function*(){if(this.activeEdit()!=null)try{if(this.isProjectComponent()){let e=k(k({},this.activeEdit()),t),i=yield this.projetComponentService.update(e);i&&i.state=="success"&&this.projectComponentList.reloadList()}}catch{}})}constructor(){this.activatedRoute.params.subscribe(t=>P(this,null,function*(){t.project_id&&this.project_id.set(t.project_id)}))}onClone(t){this.projectComponentList.openForm("clone",{category:t.category,formFields:t.formFields,icon:t.icon,minifyScript:t.minifyScript,minifyStyle:t.minifyStyle,name:t.name,script:t.script,project_id:this.project_id(),state:t.state,style:t.style,styleControl:t.styleControl,styleList:t.styleList,template:t.template,wrapperFields:t.wrapperFields}),this.activeEdit.set(null),this.currentCoreComponent.set(null)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["ui-project-component-designer"]],viewQuery:function(e,i){if(e&1&&ut(Ja,5),e&2){let n;ct(n=dt())&&(i.projectComponentList=n.first)}},decls:5,vars:4,consts:[[3,"onSave","readonly","component"],[3,"eventChange","project_id"],[1,"pt-2","ps-2"],[3,"eventChange","onClone","readonly"]],template:function(e,i){e&1&&(l(0,"app-ui-component-design",0),h("onSave",function(r){return i.onSave(r)}),l(1,"app-ui-project-component-list",1),h("eventChange",function(r){return i.selected(r,!0)}),a(),l(2,"div",2),u(3,"Ejemplos"),a(),l(4,"app-ui-component-list",3),h("eventChange",function(r){return i.selected(r)})("onClone",function(r){return i.onClone(r)}),a()()),e&2&&(f("readonly",!i.isProjectComponent())("component",i.currentCoreComponent()),c(),f("project_id",i.project_id()),c(3),f("readonly",!0))},dependencies:[Zr,Ko,Ja],encapsulation:2})};var id=class o{componentService=b(fn);componentList;activeEdit=A(null);currentComponent=A(null);selected(t){let{formFields:e,styleControl:i,styleList:n,type:r,template:s,style:m,script:p,minifyScript:v}=t;this.currentComponent.set({formFields:e,styleControl:i,styleList:n,type:r,template:s,style:m,script:p,minifyScript:v}),this.activeEdit.set(t)}onSave(t){return P(this,null,function*(){if(this.activeEdit()!=null)try{let e=k(k({},this.activeEdit()),t),i=yield this.componentService.update(e);i&&i.state=="success"&&this.componentList.reloadList()}catch{}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["ui-core-component-designer"]],viewQuery:function(e,i){if(e&1&&ut(Ko,5),e&2){let n;ct(n=dt())&&(i.componentList=n.first)}},decls:2,vars:1,consts:[[3,"onSave","component"],[3,"eventChange"]],template:function(e,i){e&1&&(l(0,"app-ui-component-design",0),h("onSave",function(r){return i.onSave(r)}),l(1,"app-ui-component-list",1),h("eventChange",function(r){return i.selected(r)}),a()()),e&2&&f("component",i.currentComponent())},dependencies:[Zr,Ko],encapsulation:2})};var _E=o=>({"background-image":o}),nd=class o{imageUrl="";static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-image-display"]],inputs:{imageUrl:"imageUrl"},decls:3,vars:4,consts:[[1,"background-image",3,"ngStyle"],[1,"overlay"],["alt","Displayed image",1,"foreground-image",3,"src"]],template:function(e,i){e&1&&(l(0,"div",0),_(1,"div",1),a(),_(2,"img",2)),e&2&&(f("ngStyle",te(2,_E,"url("+i.imageUrl+")")),c(2),f("src",i.imageUrl,mt))},dependencies:[ls],styles:["[_nghost-%COMP%]{position:relative;width:100%;height:100%;min-height:60px;overflow:hidden;display:flex;justify-content:center;align-items:center}.background-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-size:cover;background-position:center;filter:blur(5px);transform:scale(1.1)}.overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(#00000080,#00000080)}.foreground-image[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;object-fit:contain}"]})};var vE=o=>({active:o}),od=class o{item={};isActived=!1;card="box";openMenu=new q;openMenuEmit(t){this.openMenu.emit(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-preset-card"]],inputs:{item:"item",isActived:"isActived",card:"card"},outputs:{openMenu:"openMenu"},decls:5,vars:4,consts:[[1,"items","box-main","p-1",3,"ngClass"],[1,"d-flex","gap-2","align-items-center","w-100"],[3,"imageUrl"],["app-icon-button","","size","sm","variant","text","color","dark",2,"position","absolute","top","0.5rem","right","0.5rem",3,"click"],[1,"bi","bi-three-dots-vertical"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1),_(2,"app-image-display",2),l(3,"button",3),h("click",function(r){return i.openMenuEmit(r)}),_(4,"i",4),a()()()),e&2&&(f("ngClass",te(2,vE,i.isActived)),c(2),f("imageUrl",i.item.imgUrl))},dependencies:[be,_i,nd,he,Ge],styles:["img[_ngcontent-%COMP%]{height:80px;width:100%}.items[_ngcontent-%COMP%]{background-image:var(--url);background-position:center;background-size:cover}.icon-column[_ngcontent-%COMP%]{background-image:var(--url);background-position:center;background-size:contain;height:80px;width:100%;background-repeat:no-repeat}"]})};var yE=o=>({"modal-body":o});function bE(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",6),u(2,"DATOS"),a(),l(3,"button",7),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}var rd=class o{constructor(t){this.activeModal=t}isModal=!0;item={};eventChange=new q;close(){this.isModal?this.activeModal.close():this.eventChange.emit({event:"close",data:this.item})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-preset-detail"]],inputs:{isModal:"isModal",item:"item"},outputs:{eventChange:"eventChange"},decls:39,vars:12,consts:[[1,"modal-header"],[1,"",3,"ngClass"],[1,"table","table-datos","box-main"],[2,"width","100px"],["nowrap",""],[3,"state"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"]],template:function(e,i){e&1&&(D(0,bE,4,0,"div",0),l(1,"div",1)(2,"table",2)(3,"thead")(4,"tr"),_(5,"th",3)(6,"th"),a()(),l(7,"tbody")(8,"tr")(9,"td",4)(10,"b"),u(11,"Category"),a()(),l(12,"td"),u(13),a()(),l(14,"tr")(15,"td",4)(16,"b"),u(17,"Name"),a()(),l(18,"td"),u(19),a()(),l(20,"tr")(21,"td",4)(22,"b"),u(23,"Estado"),a()(),l(24,"td"),_(25,"app-text-state",5),a()(),l(26,"tr")(27,"td",4)(28,"b"),u(29,"Fecha de registro"),a()(),l(30,"td"),u(31),Ii(32,"date"),a()(),l(33,"tr")(34,"td",4)(35,"b"),u(36,"Type"),a()(),l(37,"td"),u(38),a()()()()()),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(10,yE,i.isModal)),c(12),W(i.item.category),c(6),W(i.item.name),c(6),f("state",i.item.state),c(6),W(Di(32,7,i.item.createAt,"dd/MM/yyyy HH:mm:ss")),c(7),W(i.item.type))},dependencies:[be,Gi,Oi],encapsulation:2})};var xE=(o,t)=>({"modal-body":o,container:t}),wE=(o,t)=>t.code;function SE(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",12),u(2),a(),l(3,"button",13),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}if(o&2){let e=d();c(2),W(e.type=="section"?"Secci\xF3n":"Documento")}}function EE(o,t){if(o&1&&(l(0,"option",17),u(1),a()),o&2){let e=t.$implicit;f("value",e.value),c(),W(e.label)}}function PE(o,t){if(o&1&&(l(0,"option",17),u(1),a()),o&2){let e=t.$implicit;f("value",e.code),c(),W(e.denomination)}}function ME(o,t){if(o&1&&(l(0,"div",4)(1,"div",5)(2,"label",14),u(3,"Categor\xEDa"),a(),l(4,"select",15)(5,"option",16),u(6,"Seleccione una categor\xEDa"),a(),Y(7,EE,2,2,"option",17,de),a(),_(9,"app-control-messages",8),a()(),l(10,"div",4)(11,"div",5)(12,"label",18),u(13,"Estado"),a(),l(14,"select",19)(15,"option",16),u(16,"Seleccione un estado"),a(),Y(17,PE,2,2,"option",17,wE),a(),_(19,"app-control-messages",8),a()()),o&2){let e=d();c(7),ee(e.categories),c(2),f("control",e.categoryControl)("show",e.submit),c(8),ee(e.states),c(2),f("control",e.stateControl)("show",e.submit)}}function IE(o,t){o&1&&_(0,"app-loading")}var ad=class o{constructor(t){this.modalActive=t}accion="add";preset;isModal=!0;idinstitucion="";uid="";type="section";eventChange=new q;presetService=b(So);authService=b(xe);states=this.presetService.states;ngOnInit(){return P(this,null,function*(){if(this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.uid===""&&(this.uid=this.authService.userData.id+""),this.type=="document"&&this.accion=="add"&&this.form.patchValue({category:"document",state:"1"}),this.accion=="update"){if(!this.preset)return;this.form.patchValue({category:this.preset.category,name:this.preset.name,state:this.preset.state})}})}ngAfterViewInit(){document.getElementById("name")?.focus()}categories=[{value:"head",label:"Cabecera"},{value:"hero",label:"Hero"},{value:"body",label:"Cuerpo"},{value:"footer",label:"Pie de p\xE1gina"},{value:"error",label:"Pagina de error"}];form=new ni({category:new Fe("",{validators:[ze.required],nonNullable:!0}),name:new Fe("",{validators:[ze.required],nonNullable:!0}),state:new Fe("1",{validators:[ze.required],nonNullable:!0})});get categoryControl(){return this.form.get("category")}get nameControl(){return this.form.get("name")}get stateControl(){return this.form.get("state")}close(){this.isModal?this.modalActive.dismiss():this.eventChange.emit({event:"close",data:void 0})}submit=!1;loading=!1;save(){return P(this,null,function*(){if(this.submit=!0,!this.form.valid)return;this.submit=!1;let t=this.form.value;if(this.accion=="add"){let e={category:t.category,name:t.name,state:t.state,element:"[]",type:this.type,imgUrl:"https://placehold.co/300x200?text=Secci\xF3n"};this.loading=!0;let i=yield this.presetService.add(e);this.loading=!1,i.state=="success"&&(this.isModal?this.modalActive.close(i.data):this.eventChange.emit({event:"add",data:i.data}))}else if(this.accion=="update"){let e={id:this.preset.id,category:t.category,name:t.name,state:t.state,element:this.preset.element,type:this.preset.type,imgUrl:this.preset.imgUrl};this.loading=!0;let i=yield this.presetService.update(e);this.loading=!1,i.state=="success"&&(this.isModal?this.modalActive.close(e):this.eventChange.emit({event:"update",data:i.data}))}})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-preset-form"]],inputs:{accion:"accion",preset:"preset",isModal:"isModal",idinstitucion:"idinstitucion",uid:"uid",type:"type"},outputs:{eventChange:"eventChange"},decls:17,vars:10,consts:[[1,"modal-header"],[3,"ngClass"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-md-6"],[1,"form-group"],["for","name",1,"form-label"],["type","text","id","name","formControlName","name","placeholder","Ingrese el nombre",1,"form-control"],[3,"control","show"],[1,"modal-footer"],["app-button","","size","lg","type","button","variant","outline","color","secondary",3,"click"],["app-button","","size","lg","type","button",1,"btn-primary",3,"click"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["for","category",1,"form-label"],["id","category","formControlName","category",1,"form-select"],["value","","disabled","","selected",""],[3,"value"],["for","state",1,"form-label"],["id","state","formControlName","state",1,"form-select"]],template:function(e,i){e&1&&(D(0,SE,4,1,"div",0),l(1,"div",1)(2,"form",2),h("ngSubmit",function(){return i.save()}),l(3,"div",3)(4,"div",4)(5,"div",5)(6,"label",6),u(7,"Nombre"),a(),_(8,"input",7)(9,"app-control-messages",8),a()(),D(10,ME,20,4),a()()(),l(11,"div",9)(12,"button",10),h("click",function(){return i.close()}),u(13,"Cancelar"),a(),l(14,"button",11),h("click",function(){return i.save()}),u(15,"Guardar"),a()(),D(16,IE,1,0,"app-loading")),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",vt(7,xE,i.isModal,!i.isModal)),c(),f("formGroup",i.form),c(7),f("control",i.nameControl)("show",i.submit),c(),T(i.type!="document"?10:-1),c(6),T(i.loading?16:-1))},dependencies:[Kt,Zt,Ht,Gt,Qe,$t,Ne,Xt,Qt,ri,bi,be,Ye,he,Be],encapsulation:2})};var DE=(o,t)=>({item:o,indice:t});function TE(o,t){if(o&1){let e=M();l(0,"app-ui-preset-card",7,1),h("elementEvents",function(n){let r=g(e).$implicit,s=d();return C(s.select(r,n))})("openMenu",function(n){let r=g(e).$implicit,s=Xe(1);return d().select(r),C(s.open(n))}),a()}if(o&2){let e=t.$implicit,i=t.$index,n=d(),r=Xe(6);f("card",lt(n.mode))("item",e)("isActived",e.id==(n.selected==null?null:n.selected.id))("contextMenu",r)("contextMenuValue",vt(6,DE,e,i))}}function FE(o,t){o&1&&_(0,"app-ui-message-empty")}function kE(o,t){o&1&&(l(0,"div",8)(1,"div",9),_(2,"i",10),a(),l(3,"div",11),u(4,"Adicionar"),a(),l(5,"div",12),u(6,"F1"),a()())}function OE(o,t){o&1&&(l(0,"div",8)(1,"div",9),_(2,"i",13),a(),l(3,"div",11),u(4,"Editar"),a(),_(5,"div",12),a())}function VE(o,t){o&1&&(l(0,"div",8)(1,"div",9),_(2,"i",14),a(),l(3,"div",11),u(4,"Eliminar"),a(),_(5,"div",12),a())}function NE(o,t){}function AE(o,t){o&1&&(l(0,"div",8)(1,"div",15),_(2,"i",16),a(),l(3,"div",11),u(4,"Activar"),a(),_(5,"div",12),a())}function jE(o,t){o&1&&(l(0,"div",8)(1,"div",17),_(2,"i",18),a(),l(3,"div",11),u(4,"Bloquear"),a(),_(5,"div",12),a())}function RE(o,t){o&1&&(l(0,"div",8)(1,"div",9),_(2,"i",19),a(),l(3,"div",11),u(4,"Actualizar lista"),a(),_(5,"div",12),a())}function LE(o,t){o&1&&_(0,"app-loading")}var Qr=class o{state="1";mode="list";size="sm";eventChange=new q;contentNodes=nt([]);uploadService=b(yr);elementsManager;type=le("section");minimizedExplorer=A(!0);presetService=b(So);confirmationService=b(ft);componentManager=b(Dt);modalService=b(Vi);toastr=b(tt);filter={texto:"",type:this.type()};presets=[];EPresetState=xa;loading=nt(!1);ngOnInit(){return P(this,null,function*(){this.filter.state=this.state,this.filter.type=this.type(),this.list()})}save(){return P(this,null,function*(){try{if(this.loading.set(!0),this.selected==null)return;let t=this.contentNodes().find(r=>r.type==="content")?.children;if(t==null)return;this.selected.element=JSON.stringify(Dt.elementToBase(t));let e=yield this.elementsManager?.takeScreenshot(!1);if(e==null)return;let i=yield this.uploadService.uploadImage(e),n={id:this.selected.id,category:this.selected.category,element:this.selected.element,name:this.selected.name,state:this.selected.state,type:this.selected.type,imgUrl:i.secure_url};yield this.presetService.update(n),this.selected.imgUrl=i.secure_url}catch(t){console.log(t),this.toastr.error("Error al guardar el preset, "+t)}finally{this.loading.set(!1)}})}list(){return P(this,null,function*(){this.loading.set(!0);let t=yield this.presetService.list(this.filter);this.loading.set(!1),t&&t.state=="success"&&(this.presets=t.data??[])})}add(){this.openForm()}update(t){this.openForm("update",t)}openForm(t="add",e){return P(this,null,function*(){try{let i=this.modalService.open(ad,{backdrop:"static",keyboard:!1,size:"lg"});i.componentInstance.accion=t,i.componentInstance.state=this.filter.state,i.componentInstance.type=this.type(),t=="update"&&(i.componentInstance.preset=JSON.parse(JSON.stringify(e)));let n=yield i.result;if(t=="add")this.presets.unshift(n);else if(t=="update"){if(!e)return;Object.assign(e,n)}}catch{}})}remove(t,e=-1){return P(this,null,function*(){if(!(yield this.confirmationService.create("Eliminar","\xBFEst\xE1 seguro de eliminar el registro?")))return;this.loading.set(!0);let n=yield this.presetService.delete({id:t.id});this.loading.set(!1),n.state=="success"&&(this.presets.splice(e,1),this.selected=void 0)})}openDetail(t){return P(this,null,function*(){try{let e=this.modalService.open(rd,{backdrop:"static",keyboard:!1,size:"lg"});e.componentInstance.item=t,e.componentInstance.id=t.id;let i=yield e.result}catch{}})}changeState(t,e){return P(this,null,function*(){let i={id:t.id,state:e},n=yield this.presetService.changeState(i);n&&n.state=="success"&&(t.state=e)})}searchChange(){this.list()}stateFilterChange(){this.list()}suiteFilterChange(){this.list()}selected;select(t,e="click"){if(!(t.id==this.selected?.id&&e!="dblclick")){this.selected=t;try{let i=this.componentManager.createInstanceOf("content"),n=Dt.baseToElement(JSON.parse(t.element));if(n.length>0)i.children=n,this.contentNodes.set([i]);else{let r=this.componentManager.createInstanceOf("layout");i.children.push(r),this.contentNodes.set([i])}}catch(i){console.log(i)}e=="dblclick"&&this.openDetail(t),this.eventChange.emit({event:e,data:JSON.parse(JSON.stringify(t))})}}canAdd=()=>this.presetService.canAdd;canEdit=()=>this.presetService.canEdit;canRemove=()=>this.presetService.canRemove;canChangeState=()=>this.presetService.canChangeState;canChangeStateActive=t=>this.presetService.canChangeState&&t.item.state!="1";canChangeStateInactive=t=>this.presetService.canChangeState&&t.item.state!="0";takeScreenshot(){this.elementsManager?.takeScreenshot()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-preset-list"]],inputs:{state:"state",mode:"mode",size:"size",contentNodes:[1,"contentNodes"],elementsManager:"elementsManager",type:[1,"type"],loading:[1,"loading"]},outputs:{eventChange:"eventChange",contentNodes:"contentNodesChange",loading:"loadingChange"},features:[we([Te({lucideSave:ro,lucideCamera:Qp})])],decls:15,vars:20,consts:[["menu",""],["ngxContextMenu","ngxContextMenu"],[3,"stateChange","searchChange","onAdd","onSearch","reload","modeChange","state","search","states","showMode","showExport","canNew","mode","size","showState"],[3,"item","isActived","card","contextMenu","contextMenuValue"],["contextMenuItem","",3,"execute","visible"],["contextMenuItem","",3,"divider"],["contextMenuItem","",3,"execute"],[3,"elementEvents","openMenu","item","isActived","card","contextMenu","contextMenuValue"],[1,"_items"],[1,"icons"],[1,"icons","icon","ion-md-add"],[1,"label","w-100"],[1,"atajo"],[1,"icons","icon","ion-md-create"],[1,"icons","icon","ion-md-trash"],[1,"icons","text-success"],[1,"icon","ion-md-eye"],[1,"icons","text-danger"],[1,"icon","ion-md-eye-off"],[1,"icons","icon","ion-md-refresh"]],template:function(e,i){if(e&1){let n=M();l(0,"app-ui-header-management",2),ne("stateChange",function(s){return g(n),Z(i.filter.state,s)||(i.filter.state=s),C(s)})("searchChange",function(s){return g(n),Z(i.filter.texto,s)||(i.filter.texto=s),C(s)}),h("onAdd",function(){return g(n),C(i.add())})("onSearch",function(){return g(n),C(i.searchChange())})("reload",function(){return g(n),C(i.list())}),ne("modeChange",function(s){return g(n),Z(i.mode,s)||(i.mode=s),C(s)}),a(),l(1,"div"),Y(2,TE,2,9,"app-ui-preset-card",3,de,!1,FE,1,0,"app-ui-message-empty"),a(),l(5,"context-menu",null,0),Se(7,kE,7,0,"ng-template",4),h("execute",function(){return g(n),C(i.add())}),Se(8,OE,6,0,"ng-template",4),h("execute",function(s){return g(n),C(i.update(s.value.item))}),Se(9,VE,6,0,"ng-template",4),h("execute",function(s){return g(n),C(i.remove(s.value.item,s.value.indice))}),Se(10,NE,0,0,"ng-template",5)(11,AE,6,0,"ng-template",4),h("execute",function(s){return g(n),C(i.changeState(s.value.item,i.EPresetState.ACTIVE))}),Se(12,jE,6,0,"ng-template",4),h("execute",function(s){return g(n),C(i.changeState(s.value.item,i.EPresetState.INACTIVE))}),Se(13,RE,6,0,"ng-template",6),h("execute",function(){return g(n),C(i.list())}),a(),D(14,LE,1,0,"app-loading")}e&2&&(ie("state",i.filter.state)("search",i.filter.texto),f("states",i.presetService.states)("showMode",!1)("showExport",!1)("canNew",i.presetService.canAdd),ie("mode",i.mode),f("size",i.size)("showState",!1),c(),it(Re("_",i.mode)),c(),ee(i.presets),c(5),f("visible",i.canAdd),c(),f("visible",i.canEdit),c(),f("visible",i.canRemove),c(),f("divider",!0),c(),f("visible",i.canChangeStateActive),c(),f("visible",i.canChangeStateInactive),c(2),T(i.loading()?14:-1))},dependencies:[si,Si,wi,xi,pe,Ye,Ke,At,od,Ei,dn,Ni],encapsulation:2})};var UE=["preset"],zE=o=>({nodes:o,mode:"section"}),sd=class o{contentNodes=A([]);preset;save(){return P(this,null,function*(){this.preset?.save()})}onChangeSelection(t){this.contentNodes.set(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["ng-component"]],viewQuery:function(e,i){if(e&1&&ut(UE,5),e&2){let n;ct(n=dt())&&(i.preset=n.first)}},decls:4,vars:4,consts:[["elementsManager",""],["preset",""],["panelCustomName","Presets",3,"saveDesign","elementsData"],[3,"contentNodesChange","elementsManager"]],template:function(e,i){if(e&1){let n=M();l(0,"app-designer",2,0),h("saveDesign",function(){return g(n),C(i.save())}),l(2,"app-ui-preset-list",3,1),h("contentNodesChange",function(s){return g(n),C(i.onChangeSelection(s))}),a()()}if(e&2){let n=Xe(1);f("elementsData",te(2,zE,i.contentNodes())),c(2),f("elementsManager",n)}},dependencies:[Po,Qr],encapsulation:2})};var BE=["preset"],WE=()=>({0:1400}),$E=o=>({nodes:o,mode:"document"}),ld=class o{contentNodes=A([]);preset;save(){return P(this,null,function*(){this.preset?.save()})}onChangeSelection(t){this.contentNodes.set(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["ng-component"]],viewQuery:function(e,i){if(e&1&&ut(BE,5),e&2){let n;ct(n=dt())&&(i.preset=n.first)}},decls:4,vars:6,consts:[["elementsManager",""],["preset",""],["panelCustomName","Documentos",3,"saveDesign","setDeviceSize","elementsData"],["type","document",3,"contentNodesChange","elementsManager"]],template:function(e,i){if(e&1){let n=M();l(0,"app-designer",2,0),h("saveDesign",function(){return g(n),C(i.save())}),l(2,"app-ui-preset-list",3,1),h("contentNodesChange",function(s){return g(n),C(i.onChangeSelection(s))}),a()()}if(e&2){let n=Xe(1);f("setDeviceSize",Xi(3,WE))("elementsData",te(4,$E,i.contentNodes())),c(2),f("elementsManager",n)}},dependencies:[Po,Qr],encapsulation:2})};var HE=o=>({active:o});function GE(o,t){if(o&1&&(l(0,"table",0)(1,"thead")(2,"tr"),_(3,"th",2)(4,"th"),a()(),l(5,"tbody")(6,"tr")(7,"td",3)(8,"b"),u(9," Fecha de registro "),a()(),l(10,"td"),u(11),Ii(12,"date"),a()()()()),o&2){let e=d();c(11),W(Di(12,1,e.item.createAt,"dd/MM/yyyy HH:mm:ss"))}}function qE(o,t){if(o&1){let e=M();l(0,"div")(1,"button",5),h("click",function(n){g(e);let r=d(2);return C(r.openMenuEmit(n))}),_(2,"i",6),a()()}}function JE(o,t){if(o&1&&(l(0,"div",1)(1,"div")(2,"div",4),u(3),a()(),D(4,qE,3,0,"div"),a()),o&2){let e=d();f("ngClass",te(3,HE,e.isActived)),c(3),W(e.item.cms==null?null:e.item.cms.denomination),c(),T(e.showOption?4:-1)}}var Kr=class o{item={};isActived=!1;card="box";showOption=!1;openMenu=new q;modeData="";projectCmsService=b(mn);openMenuEmit(t){this.openMenu.emit(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-project-cms-card"]],inputs:{item:"item",isActived:"isActived",card:"card",showOption:"showOption",modeData:"modeData"},outputs:{openMenu:"openMenu"},decls:2,vars:1,consts:[[1,"table","table-datos","box-main"],[1,"items","box-main",3,"ngClass"],[2,"width","100px"],["nowrap",""],[1,"text-truncate"],["type","button",1,"btn","btn-more",3,"click"],[1,"icon","ion-md-more"]],template:function(e,i){e&1&&D(0,GE,13,4,"table",0)(1,JE,5,5,"div",1),e&2&&T(i.card=="table"?0:1)},dependencies:[be,Oi],encapsulation:2})};var XE=o=>({"modal-body":o});function ZE(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",3),u(2,"DATOS DE"),a(),l(3,"button",4),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}var cd=class o{constructor(t){this.activeModal=t}isModal=!0;item={};eventChange=new q;projectCmsService=b(mn);close(){this.isModal?this.activeModal.close():this.eventChange.emit({event:"close",data:this.item})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-project-cms-detail"]],inputs:{isModal:"isModal",item:"item"},outputs:{eventChange:"eventChange"},decls:3,vars:5,consts:[[1,"modal-header"],[1,"",3,"ngClass"],["card","table",3,"item"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"]],template:function(e,i){e&1&&(D(0,ZE,4,0,"div",0),l(1,"div",1),_(2,"app-ui-project-cms-card",2),a()),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(3,XE,i.isModal)),c(),f("item",i.item))},dependencies:[be,Kr],encapsulation:2})};var Io=class o{API=`${Le.web_maker}/cms`;apiService=b(Lt);loadingService=b(Yt);confirmationService=b(ft);auth=b(xe);toastrService=b(tt);states=[{code:"1",denomination:"Activo"},{code:"0",denomination:"Inactivo"}];stateMap=this.states.reduce((t,e)=>(t[e.code]=e.denomination,t),{});canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.abled(!0)}abled(t){t?(this.canAdd=this.auth.hasSubPermission("cms-ADD"),this.canEdit=this.auth.hasSubPermission("cms-EDIT"),this.canRemove=this.auth.hasSubPermission("cms-REMOVE"),this.canChangeState=this.auth.hasSubPermission("cms-CHANGE-STATE"),this.canExport=this.auth.hasPermission("cms-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("cms-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("cms-EXPORT-PDF")):(this.canAdd=!1,this.canEdit=!1,this.canRemove=!1,this.canChangeState=!1,this.canExport=!1,this.canExportExcel=!1,this.canExportPdf=!1)}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}addAll(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create/all`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}patch(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}changeStateMessage(t){let e=this.stateMap[t],i="";switch(t){case"1":i="text-success";break;case"0":i="text-danger";break}return{message:`
            <div class="text-center">
                <div class="mb-3">\xBFEst\xE1 seguro de cambiar el estado del registro?</div>
                <h3 >Nuevo estado: <b class="${i}">${e}</b></h3>
            </div>
        `,denomination:e}}changeStateSave(t){return P(this,null,function*(){return yield this.apiService.putPrivate(`${this.API}/state/change/${t.id}`,t)})}changeState(t){return P(this,null,function*(){let{message:e}=this.changeStateMessage(t.state);if(!(yield this.confirmationService.create("Confirmar",e)))return;this.loadingService.open();let n=yield this.changeStateSave(t);return this.loadingService.hide(),n})}delete(t){return P(this,null,function*(){let e=yield this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}export(t,e,i=!0){return P(this,null,function*(){if(i&&!(yield this.confirmationService.create("Confirmar","\xBFEst\xE1 seguro de exportar los datos?")))return;this.loadingService.open();let n=re(k({},t),{type_export:e,url:Le.storage_view,institution:this.auth.getInstitution()}),r=yield this.apiService.postPrivate(`${this.API}/export`,n);return this.loadingService.hide(),r&&r.state=="success"&&window.open(r.url),r})}syncDataApi(t,e=!0){return P(this,null,function*(){if(e&&!(yield this.confirmationService.create("Confirmar","\xBFEst\xE1 seguro de continuar con el proceso?")))return;this.loadingService.open();let i=yield this.apiService.postPrivate(`${this.API}/sync/data/api`,t);return this.loadingService.hide(),i})}saveOrder(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/order/list`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var Do=(e=>(e.ACTIVE="1",e.INACTIVE="0",e))(Do||{});var Yi=class o{API=`${Le.web_maker}/cms-field`;apiService=b(Lt);loadingService=b(Yt);confirmationService=b(ft);auth=b(xe);toastrService=b(tt);types=[{code:"text",denomination:"Texto",icon:"https://cdn-icons-png.flaticon.com/512/7837/7837456.png"},{code:"slug",denomination:"URL (Slug)",icon:"https://cdn-icons-png.flaticon.com/512/7837/7837456.png"},{code:"paragraph",denomination:"Parrafo",icon:"https://cdn-icons-png.flaticon.com/512/7837/7837456.png"},{code:"image",denomination:"Imagen",icon:"https://cdn-icons-png.flaticon.com/512/7837/7837456.png"},{code:"link2",denomination:"Enlace",icon:"https://cdn-icons-png.flaticon.com/512/7837/7837456.png"},{code:"file",denomination:"Archivo",icon:"https://cdn-icons-png.flaticon.com/512/7837/7837456.png"}];typeMap=this.types.reduce((t,e)=>(t[e.code]=e,t),{});states=[{code:"1",denomination:"Activo"},{code:"0",denomination:"Inactivo"}];stateMap=this.states.reduce((t,e)=>(t[e.code]=e.denomination,t),{});canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.abled()}abled(t=!0){t?(this.canAdd=this.auth.hasSubPermission("cms-field-ADD"),this.canEdit=this.auth.hasSubPermission("cms-field-EDIT"),this.canRemove=this.auth.hasSubPermission("cms-field-REMOVE"),this.canChangeState=this.auth.hasSubPermission("cms-field-CHANGE-STATE"),this.canExport=this.auth.hasPermission("cms-field-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("cms-field-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("cms-field-EXPORT-PDF")):(this.canAdd=!1,this.canEdit=!1,this.canRemove=!1,this.canChangeState=!1,this.canExport=!1,this.canExportExcel=!1,this.canExportPdf=!1)}list(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/list`,t)})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}patch(t,e=!0){return P(this,null,function*(){let i=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return i.state=="success"&&e&&this.toastrService.success(i.message),i})}changeStateMessage(t){let e=this.stateMap[t],i="";switch(t){case"1":i="text-success";break;case"0":i="text-danger";break}return{message:`
            <div class="text-center">
                <div class="mb-3">\xBFEst\xE1 seguro de cambiar el estado del registro?</div>
                <h3 >Nuevo estado: <b class="${i}">${e}</b></h3>
            </div>
        `,denomination:e}}changeStateSave(t){return P(this,null,function*(){return yield this.apiService.putPrivate(`${this.API}/state/change/${t.id}`,t)})}changeState(t){return P(this,null,function*(){let{message:e}=this.changeStateMessage(t.state);if(!(yield this.confirmationService.create("Confirmar",e)))return;this.loadingService.open();let n=yield this.changeStateSave(t);return this.loadingService.hide(),n})}delete(t){return P(this,null,function*(){let e=yield this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}export(t,e,i=!0){return P(this,null,function*(){if(i&&!(yield this.confirmationService.create("Confirmar","\xBFEst\xE1 seguro de exportar los datos?")))return;this.loadingService.open();let n=re(k({},t),{type_export:e,url:Le.storage_view,institution:this.auth.getInstitution()}),r=yield this.apiService.postPrivate(`${this.API}/export`,n);return this.loadingService.hide(),r&&r.state=="success"&&window.open(r.url),r})}saveOrder(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/order/list`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}getField(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9\s]/g,"").trim().replace(/\s+/g,"_").toLowerCase()}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var KE=o=>({active:o});function YE(o,t){if(o&1&&(l(0,"table",0)(1,"thead")(2,"tr"),_(3,"th",2)(4,"th"),a()(),l(5,"tbody")(6,"tr")(7,"td",3)(8,"b"),u(9," Tipo "),a()(),l(10,"td"),u(11),a()(),l(12,"tr")(13,"td",3)(14,"b"),u(15," Denominaci\xF3n "),a()(),l(16,"td"),u(17),a()(),l(18,"tr")(19,"td",3)(20,"b"),u(21," Fecha de registro "),a()(),l(22,"td"),u(23),Ii(24,"date"),a()(),l(25,"tr")(26,"td",3)(27,"b"),u(28," Estado "),a()(),l(29,"td"),_(30,"app-text-state",4),a()()()()),o&2){let e=d();c(11),W(e.item.type),c(6),W(e.item.denomination),c(6),W(Di(24,4,e.item.createAt,"dd/MM/yyyy HH:mm:ss")),c(7),f("state",e.item.state)}}function eP(o,t){if(o&1){let e=M();l(0,"div")(1,"button",9),h("click",function(n){g(e);let r=d(2);return C(r.openMenuEmit(n))}),_(2,"i",10),a()()}}function tP(o,t){if(o&1&&(l(0,"div",1)(1,"div",5),_(2,"img",6),a(),l(3,"div",7)(4,"div",8),u(5),a()(),D(6,eP,3,0,"div"),a()),o&2){let e=d();f("ngClass",te(5,KE,e.isActived)),c(2),f("src",lt(e.typeMap[e.item.type].icon),mt),c(3),W(e.item.denomination),c(),T(e.showOption?6:-1)}}var dd=class o{item={};isActived=!1;card="box";showOption=!1;openMenu=new q;modeData="";cmsFieldService=b(Yi);typeMap=this.cmsFieldService.typeMap;openMenuEmit(t){this.openMenu.emit(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-cms-field-card"]],inputs:{item:"item",isActived:"isActived",card:"card",showOption:"showOption",modeData:"modeData"},outputs:{openMenu:"openMenu"},decls:2,vars:1,consts:[[1,"table","table-datos","box-main"],[1,"items","box-main",3,"ngClass"],[2,"width","100px"],["nowrap",""],[3,"state"],[1,"_img"],["alt","",3,"src"],[1,"flex-grow-1"],[1,"text-truncate"],["type","button",1,"btn","btn-more",3,"click"],[1,"icon","ion-md-more"]],template:function(e,i){e&1&&D(0,YE,31,7,"table",0)(1,tP,7,7,"div",1),e&2&&T(i.card=="table"?0:1)},dependencies:[be,Gi,Oi],styles:[".items.box-main[_ngcontent-%COMP%]{box-shadow:none!important}._img[_ngcontent-%COMP%]{margin-right:1rem}._img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:20px;max-height:20px;display:block}.items[_ngcontent-%COMP%]   .btn-more[_ngcontent-%COMP%]{font-size:1rem;margin-right:-8px;position:relative}"]})};var iP=o=>({"modal-body":o});function nP(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",3),u(2,"DATOS DE COLUMNA"),a(),l(3,"button",4),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}var md=class o{constructor(t){this.activeModal=t}isModal=!0;item={};eventChange=new q;cmsFieldService=b(Yi);ECmsFieldState=Do;close(){this.isModal?this.activeModal.close():this.eventChange.emit({event:"close",data:this.item})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-cms-field-detail"]],inputs:{isModal:"isModal",item:"item"},outputs:{eventChange:"eventChange"},decls:3,vars:5,consts:[[1,"modal-header"],[1,"",3,"ngClass"],["card","table",3,"item"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"]],template:function(e,i){e&1&&(D(0,nP,4,0,"div",0),l(1,"div",1),_(2,"app-ui-cms-field-card",2),a()),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(3,iP,i.isModal)),c(),f("item",i.item))},dependencies:[be,dd],encapsulation:2})};var oP=o=>({"modal-body":o}),To=o=>({"has-danger":o});function rP(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",10),u(2,"DATOS DE COLUMNA"),a(),l(3,"button",11),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}function aP(o,t){if(o&1&&(l(0,"div",7),u(1),a()),o&2){let e=d();c(),Ie(" ",e.extraControl.value," ")}}function sP(o,t){if(o&1&&(l(0,"option",13),u(1),a()),o&2){let e=t.$implicit;f("value",e.code),c(),W(e.denomination)}}function lP(o,t){if(o&1){let e=M();l(0,"div",3)(1,"label",4),u(2,"Tipo "),a(),l(3,"div",5)(4,"select",12),h("change",function(){g(e);let n=d();return C(n.changeField("type"))}),Y(5,sP,2,2,"option",13,de),a(),_(7,"app-control-messages",8),a()()}if(o&2){let e=d();f("ngClass",te(9,To,e.typeControl.invalid&&(e.typeControl.touched||e.submit))),c(),f("for",Re("typeCm",e.idForm)),c(3),f("name",Re("typeCm",e.idForm))("id",Re("typeCm",e.idForm)),c(),ee(e.types),c(2),f("control",e.typeControl)("show",e.submit)}}function cP(o,t){if(o&1){let e=M();l(0,"div",3)(1,"label",4),u(2,"\xBFEs requerido? "),a(),l(3,"div",5)(4,"app-bool-field",15),ne("valueChange",function(n){g(e);let r=d(2);return Z(r.isRequiredControl.value,n)||(r.isRequiredControl.value=n),C(n)}),h("valueChange",function(){g(e);let n=d(2);return C(n.changeField("isRequired"))}),a(),_(5,"app-control-messages",8),a()()}if(o&2){let e=d(2);f("ngClass",te(6,To,e.isRequiredControl.invalid&&(e.isRequiredControl.touched||e.submit))),c(),f("for",Re("isRequiredCm",e.idForm)),c(3),ie("value",e.isRequiredControl.value),c(),f("control",e.isRequiredControl)("show",e.submit)}}function dP(o,t){if(o&1){let e=M();l(0,"div",3)(1,"label",4),u(2," Longitud m\xE1xima"),a(),l(3,"div",5)(4,"input",16),h("change",function(){g(e);let n=d(2);return C(n.changeField("maxLength"))}),a(),_(5,"app-control-messages",8),a()()}if(o&2){let e=d(2);f("ngClass",te(9,To,e.maxLengthControl.invalid&&(e.maxLengthControl.touched||e.submit))),c(),f("for",Re("maxLengthCm",e.idForm)),c(3),f("name",Re("maxLengthCm",e.idForm))("id",Re("maxLengthCm",e.idForm)),c(),f("control",e.maxLengthControl)("show",e.submit)}}function mP(o,t){if(o&1){let e=M();l(0,"div",3)(1,"label",4),u(2,"Por defecto "),a(),l(3,"div",5)(4,"input",17),h("change",function(){g(e);let n=d(2);return C(n.changeField("defaultValue"))}),a(),_(5,"app-control-messages",8),a()()}if(o&2){let e=d(2);f("ngClass",te(9,To,e.defaultValueControl.invalid&&(e.defaultValueControl.touched||e.submit))),c(),f("for",Re("defaultValueCm",e.idForm)),c(3),f("name",Re("defaultValueCm",e.idForm))("id",Re("defaultValueCm",e.idForm)),c(),f("control",e.defaultValueControl)("show",e.submit)}}function pP(o,t){if(o&1){let e=M();l(0,"div",3)(1,"label",4),u(2,"Extensiones "),a(),l(3,"div",5)(4,"input",18),h("change",function(){g(e);let n=d(2);return C(n.changeField("extra"))}),a(),_(5,"app-control-messages",8),a()()}if(o&2){let e=d(2);f("ngClass",te(9,To,e.extraControl.invalid&&(e.extraControl.touched||e.submit))),c(),f("for",Re("extraCm",e.idForm)),c(3),f("name",Re("extraCm",e.idForm))("id",Re("extraCm",e.idForm)),c(),f("control",e.extraControl)("show",e.submit)}}function uP(o,t){if(o&1&&(l(0,"option",13),u(1),a()),o&2){let e=t.$implicit;f("value",e.id),c(),W(e.denomination)}}function fP(o,t){if(o&1){let e=M();l(0,"div",3)(1,"label",4),u(2,"En base a "),a(),l(3,"div",5)(4,"select",19),h("change",function(){g(e);let n=d(2);return C(n.changeField("extra"))}),l(5,"option",20),u(6,"Seleccione"),a(),Y(7,uP,2,2,"option",13,de),a(),_(9,"app-control-messages",8),a()()}if(o&2){let e=d(2);f("ngClass",te(9,To,e.extraControl.invalid&&(e.extraControl.touched||e.submit))),c(),f("for",Re("extraCm",e.idForm)),c(3),f("name",Re("extraCm",e.idForm))("id",Re("extraCm",e.idForm)),c(3),ee(e.cmsFields),c(2),f("control",e.extraControl)("show",e.submit)}}function hP(o,t){if(o&1){let e=M();l(0,"div",3)(1,"label",4),u(2,"Descripci\xF3n "),a(),l(3,"div",5)(4,"textarea",14),h("change",function(){g(e);let n=d();return C(n.changeField("description"))}),a(),_(5,"app-control-messages",8),a()(),D(6,cP,6,8,"div",3),D(7,dP,6,11,"div",3),D(8,mP,6,11,"div",3),D(9,pP,6,11,"div",3),D(10,fP,10,11,"div",3)}if(o&2){let e=d();f("ngClass",te(14,To,e.descriptionControl.invalid&&(e.descriptionControl.touched||e.submit))),c(),f("for",Re("descriptionCm",e.idForm)),c(3),f("name",Re("descriptionCm",e.idForm))("id",Re("descriptionCm",e.idForm)),c(),f("control",e.descriptionControl)("show",e.submit),c(),T(e.typeControl.value==="text"||e.typeControl.value==="file"||e.typeControl.value==="link2"||e.typeControl.value==="paragraph"?6:-1),c(),T(e.typeControl.value==="text"||e.typeControl.value==="paragraph"?7:-1),c(),T(e.typeControl.value==="text"?8:-1),c(),T(e.typeControl.value==="file"?9:-1),c(),T(e.typeControl.value==="slug"?10:-1)}}function gP(o,t){if(o&1){let e=M();l(0,"div",9)(1,"button",21),h("click",function(){g(e);let n=d();return C(n.close())}),u(2,"Cancelar"),a(),l(3,"button",22),h("click",function(){g(e);let n=d();return C(n.save())}),u(4,"Guardar"),a()()}}function CP(o,t){o&1&&_(0,"app-loading")}var Yr=class o{constructor(t){this.modalActive=t}accion="add";cmsField;isModal=!0;idinstitucion="";uid="";state="1";cms_id="";source="";showOption=!0;onSave=new ki(!1);orderList="0";modeSave="complete";idForm=Math.random().toString(36).substring(2,9);cmsFields=[];eventChange=new q;cmsFieldService=b(Yi);authService=b(xe);states=this.cmsFieldService.states;types=this.cmsFieldService.types;subscriptions=[];ngOnInit(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.uid===""&&(this.uid=this.authService.userData.id+"");let t=this.onSave.subscribe(e=>{e&&this.save()});if(this.subscriptions.push(t),this.accion=="update"||this.accion=="duplicate"){if(!this.cmsField)return;this.form.patchValue({orderList:this.cmsField.orderList+"",state:this.cmsField.state,denomination:this.cmsField.denomination,type:this.cmsField.type,cmsId:this.cmsField.cms_id+"",description:this.cmsField.description,isRequired:this.cmsField.isRequired==="1",defaultValue:this.cmsField.defaultValue,maxLength:this.cmsField.maxLength,minLength:this.cmsField.minLength,extra:this.cmsField.extra})}else this.accion=="add"&&this.form.patchValue({state:this.state,cmsId:this.cms_id,denomination:this.cmsField?.denomination??"",extra:this.cmsField?.extra??"",orderList:(this.cmsField?.orderList??this.orderList)+""})})}ngAfterViewInit(){setTimeout(()=>{document.getElementById(`denominationCm${this.idForm}`)?.focus()},150)}form=new ni({orderList:new Fe("0",{validators:[ze.required],nonNullable:!0}),state:new Fe("1",{validators:[ze.required],nonNullable:!0}),denomination:new Fe("",{validators:[ze.required],nonNullable:!0}),type:new Fe("text",{validators:[ze.required],nonNullable:!0}),cmsId:new Fe("0",{validators:[ze.required],nonNullable:!0}),description:new Fe("",{validators:[],nonNullable:!0}),isRequired:new Fe(!0,{validators:[],nonNullable:!0}),defaultValue:new Fe("",{validators:[],nonNullable:!0}),maxLength:new Fe("",{validators:[],nonNullable:!0}),minLength:new Fe("",{validators:[],nonNullable:!0}),extra:new Fe("",{validators:[],nonNullable:!0})});get orderListControl(){return this.form.get("orderList")}get stateControl(){return this.form.get("state")}get denominationControl(){return this.form.get("denomination")}get typeControl(){return this.form.get("type")}get cmsIdControl(){return this.form.get("cmsId")}get descriptionControl(){return this.form.get("description")}get defaultValueControl(){return this.form.get("defaultValue")}get maxLengthControl(){return this.form.get("maxLength")}get minLengthControl(){return this.form.get("minLength")}get extraControl(){return this.form.get("extra")}get isRequiredControl(){return this.form.get("isRequired")}close(){this.isModal?this.modalActive.dismiss():this.eventChange.emit({event:"close",data:void 0})}submit=!1;loading=!1;save(){return P(this,null,function*(){if(this.modeSave==="action"||(this.submit=!0,!this.form.valid))return;this.submit=!1;let t=this.form.value;if(this.accion=="add"||this.accion=="duplicate"){let e={createBy:this.uid,idinstitucion:+this.idinstitucion,orderList:+t.orderList,state:t.state,denomination:t.denomination,type:t.type,cms_id:+t.cmsId,description:t.description,defaultValue:t.defaultValue,maxLength:t.maxLength,minLength:t.minLength,extra:t.extra,isRequired:t.isRequired?"1":"0",readonly:"0"};this.loading=!0;let i=yield this.cmsFieldService.add(e);this.loading=!1,i.state=="success"&&(this.isModal?this.modalActive.close(i.data):this.eventChange.emit({event:"add",data:i.data}))}else if(this.accion=="update"){let e={id:+this.cmsField?.id,idinstitucion:+this.idinstitucion,orderList:+t.orderList,state:t.state,denomination:t.denomination,type:t.type,cms_id:+t.cmsId,description:t.description,defaultValue:t.defaultValue,maxLength:t.maxLength,minLength:t.minLength,extra:t.extra,isRequired:t.isRequired?"1":"0"};this.loading=!0;let i=yield this.cmsFieldService.update(e);this.loading=!1,i.state=="success"&&(this.isModal?this.modalActive.close(e):this.eventChange.emit({event:"update",data:e}))}})}changeField(t){return P(this,null,function*(){if(this.modeSave==="complete"||!this.cmsField)return;let e={id:this.cmsField.id,idinstitucion:this.cmsField.idinstitucion};switch(t){case"denomination":e[t]=this.denominationControl.value;break;case"description":e[t]=this.descriptionControl.value;break;case"maxLength":e[t]=this.maxLengthControl.value;break;case"defaultValue":e[t]=this.defaultValueControl.value;break;case"extra":e[t]=this.extraControl.value;break;case"type":e[t]=this.typeControl.value;break;case"isRequired":e[t]=this.isRequiredControl.value?"1":"0";break;default:return}console.log(`this.cms_id: ${this.cms_id}`),+this.cms_id>0&&(yield this.cmsFieldService.patch(e,!1)),this.eventChange.emit({event:"update",data:e})})}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-cms-field-form"]],inputs:{accion:"accion",cmsField:"cmsField",isModal:"isModal",idinstitucion:"idinstitucion",uid:"uid",state:"state",cms_id:"cms_id",source:"source",showOption:"showOption",onSave:"onSave",orderList:"orderList",modeSave:"modeSave",idForm:"idForm",cmsFields:"cmsFields"},outputs:{eventChange:"eventChange"},decls:14,vars:21,consts:[[1,"modal-header"],[1,"",3,"ngClass"],[1,"container",3,"submit","formGroup"],[1,"form-group","row",3,"ngClass"],[1,"control-label","col-12","col-md-4",3,"for"],[1,"col-12","col-md-8"],["type","text","formControlName","denomination",1,"form-control",3,"change","name","id"],[1,"text-primary"],[1,"left",3,"control","show"],[1,"modal-footer"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["formControlName","type",1,"form-select",3,"change","name","id"],[3,"value"],["formControlName","description","rows","3",1,"form-control",3,"change","name","id"],[3,"valueChange","value"],["type","text","formControlName","maxLength",1,"form-control",3,"change","name","id"],["type","text","formControlName","defaultValue",1,"form-control",3,"change","name","id"],["type","text","formControlName","extra",1,"form-control",3,"change","name","id"],["formControlName","extra",1,"form-select-sm",3,"change","name","id"],["value",""],["type","button",1,"btn","btn-outline-secondary","btn-lg-medio","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-lg-medio",3,"click"]],template:function(e,i){e&1&&(D(0,rP,4,0,"div",0),l(1,"div",1)(2,"form",2),h("submit",function(){return i.save()}),l(3,"div",3)(4,"label",4),u(5,"Denominaci\xF3n "),a(),l(6,"div",5)(7,"input",6),h("change",function(){return i.changeField("denomination")}),a(),D(8,aP,2,1,"div",7),_(9,"app-control-messages",8),a()(),D(10,lP,8,11,"div",3),D(11,hP,11,16),a()(),D(12,gP,5,0,"div",9),D(13,CP,1,0,"app-loading")),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(17,oP,i.isModal)),c(),f("formGroup",i.form),c(),f("ngClass",te(19,To,i.denominationControl.invalid&&(i.denominationControl.touched||i.submit))),c(),f("for",Re("denominationCm",i.idForm)),c(3),f("name",Re("denominationCm",i.idForm))("id",Re("denominationCm",i.idForm)),c(),T(i.source=="API"?8:-1),c(),f("control",i.denominationControl)("show",i.submit),c(),T(i.accion!="update"||i.source==="API"?10:-1),c(),T(i.source!="API"?11:-1),c(),T(i.showOption?12:-1),c(),T(i.loading?13:-1))},dependencies:[Kt,Zt,Ht,Gt,Qe,$t,Ne,Xt,Qt,ri,bi,be,Ye,Fr],encapsulation:2})};var vP=o=>({"modal-body p-0":o}),F0=o=>({active:o}),k0=(o,t)=>({item:o,indice:t}),yP=(o,t)=>t.id;function bP(o,t){if(o&1){let e=M();l(0,"div",2)(1,"h4",10),u(2,"LISTA DE COLUMNAS"),a(),l(3,"button",11),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}function xP(o,t){if(o&1){let e=M();l(0,"button",12),h("click",function(){g(e);let n=d();return C(n.saveOrder())}),u(1,"Guardar orden"),a()}}function wP(o,t){if(o&1){let e=M();l(0,"button",19),h("click",function(){let n=g(e).$implicit,r=d(2);return C(r.addSave(n))}),l(1,"div",20)(2,"div",21),_(3,"img",22),a(),l(4,"div",23),u(5),a(),_(6,"div",24),a()()}if(o&2){let e=t.$implicit;c(3),f("src",lt(e.icon),mt),c(2),W(e.denomination)}}function SP(o,t){if(o&1){let e=M();l(0,"div",4)(1,"div",13)(2,"button",14),u(3,"Adicionar"),a(),l(4,"div",15),Y(5,wP,7,3,"button",16,de),a()(),l(7,"div")(8,"button",17),h("click",function(){g(e);let n=d();return C(n.resetPage())}),_(9,"i",18),a()()()}if(o&2){let e=d();c(2),f("rounded",!0),c(3),ee(e.types),c(3),f("rounded",!0)}}function EP(o,t){if(o&1){let e=M();l(0,"tr",29,1),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))}),l(2,"td",30),u(3),a(),l(4,"td",31),u(5),a(),l(6,"td",30),u(7),a(),l(8,"td",30)(9,"button",32),h("click",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),C(s.open(n))}),_(10,"i",33),a()()()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(7);f("ngClass",te(8,F0,e.id==n.selected.id))("contextMenu",r)("contextMenuValue",vt(10,k0,e,i)),c(3),Ie(" ",(i+1).zfill(2)," "),c(2),_p("",e.denomination," (",e.orderList," / ",e.order_new,")"),c(2),W(e.type)}}function PP(o,t){if(o&1){let e=M();l(0,"div")(1,"table",25)(2,"thead")(3,"tr")(4,"th",26),u(5,"#"),a(),l(6,"th"),u(7,"Denominaci\xF3n"),a(),l(8,"th"),u(9,"Tipo"),a(),_(10,"th",26),a()(),l(11,"tbody",27),h("onUpdate",function(n){g(e);let r=d();return C(r.changeList(n))}),Y(12,EP,11,13,"tr",28,yP),a()()()}if(o&2){let e=d();c(11),f("items",e.cmsFields),c(),ee(e.cmsFields)}}function MP(o,t){if(o&1){let e=M();l(0,"div",36,1),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))}),l(2,"div",37),_(3,"i",38),a(),l(4,"div",39),_(5,"img",22),a(),l(6,"div",40),u(7),a(),l(8,"div")(9,"button",41),h("click",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),C(s.open(n))}),_(10,"i",33),a()()()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(7);f("ngClass",te(6,F0,e.id==n.selected.id))("contextMenu",r)("contextMenuValue",vt(8,k0,e,i)),c(5),f("src",lt(n.typeMap[e.type].icon),mt),c(2),Ie(" ",e.denomination," ")}}function IP(o,t){o&1&&_(0,"app-ui-message-empty")}function DP(o,t){if(o&1){let e=M();l(0,"div",34),h("cdkDropListDropped",function(n){g(e);let r=d();return C(r.drop(n))}),Y(1,MP,11,11,"div",35,de,!1,IP,1,0,"app-ui-message-empty"),a()}if(o&2){let e=d();it(Re("_",e.mode)),c(),ee(e.cmsFields)}}function TP(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",42),a(),l(3,"div",43),u(4,"Ver detalles"),a(),_(5,"div",24),a())}function FP(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",44),a(),l(3,"div",43),u(4,"Eliminar"),a(),_(5,"div",24),a())}function kP(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",45),a(),l(3,"div",43),u(4,"Duplicar"),a(),_(5,"div",24),a())}function OP(o,t){}function VP(o,t){o&1&&(l(0,"div",20)(1,"div",46),_(2,"i",47),a(),l(3,"div",43),u(4,"Activar"),a(),_(5,"div",24),a())}function NP(o,t){o&1&&(l(0,"div",20)(1,"div",48),_(2,"i",49),a(),l(3,"div",43),u(4,"Bloquear"),a(),_(5,"div",24),a())}function AP(o,t){}function jP(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",50),a(),l(3,"div",43),u(4,"Actualizar lista"),a(),_(5,"div",24),a())}function RP(o,t){o&1&&_(0,"app-loading")}var pd=class o{constructor(t){this.modalActive=t}idinstitucion="";state="1";cms_id="";showPagination=!1;mode="table";size="lg";eventChange=new q;cmsFields=[];load=!0;isModal=!1;abled=!0;cmsFieldService=b(Yi);authService=b(xe);confirmationService=b(ft);modalService=b(Vi);types=this.cmsFieldService.types;typeMap=this.cmsFieldService.typeMap;filter={texto:""};ECmsFieldState=Do;loading=!1;ngOnInit(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.filter.idinstitucion=this.idinstitucion,this.filter.state=this.state,this.filter.cms_id=this.cms_id,this.cmsFieldService.abled(this.abled),this.load&&this.resetPage()})}page=1;resetPage(){return P(this,null,function*(){this.page=1,this.list()})}onPage(){this.list()}list(){return P(this,null,function*(){this.loading=!0,this.showPagination&&(this.filter.page=this.page);let t=yield this.cmsFieldService.list(this.filter);this.loading=!1,t&&t.state=="success"&&(this.cmsFields=t.data??[])})}add(){this.openForm()}duplicate(t){return P(this,null,function*(){this.openForm("duplicate",t)})}update(t){this.openForm("update",t)}openForm(t="add",e){return P(this,null,function*(){try{let i=yield this.modalService.open(Yr,{backdrop:"static",keyboard:!1,size:"lg"});i.componentInstance.accion=t,i.componentInstance.idinstitucion=this.filter.idinstitucion,i.componentInstance.cms_id=this.filter.cms_id,this.cmsFields.length?i.componentInstance.orderList=this.cmsFields[this.cmsFields.length-1].orderList+1:i.componentInstance.orderList=1,t!="add"&&(i.componentInstance.cmsField=JSON.parse(JSON.stringify(e)));let n=yield i.result;if(t=="add"||t=="duplicate")this.cmsFields.push(n);else if(t=="update"){if(!e)return;Object.assign(e,n)}}catch{}})}remove(t,e=-1){return P(this,null,function*(){if(!(yield this.confirmationService.create("Eliminar","\xBFEst\xE1 seguro de eliminar el registro?")))return;this.loading=!0;let n=yield this.cmsFieldService.delete({id:t.id,idinstitucion:t.idinstitucion});this.loading=!1,n.state=="success"&&(this.cmsFields.splice(e,1),this.selected={})})}openDetail(t){return P(this,null,function*(){try{let e=yield this.modalService.open(md,{backdrop:"static",keyboard:!1,size:"lg"});e.componentInstance.item=t,e.componentInstance.id=t.id,e.componentInstance.idinstitucion=t.idinstitucion;let i=yield e.result}catch{}})}changeState(t,e){return P(this,null,function*(){let i={id:t.id,idinstitucion:t.idinstitucion,state:e},n=yield this.cmsFieldService.changeState(i);n&&n.state=="success"&&(t.state=e)})}searchChange(){this.resetPage()}stateFilterChange(){this.resetPage()}selected={};select(t,e="click"){t.id==this.selected.id&&e!="dblclick"||(this.selected=t,e=="dblclick"&&this.openDetail(t),this.eventChange.emit({event:e,data:JSON.parse(JSON.stringify(t))}))}addSave(t){return P(this,null,function*(){console.log(t);let e=1;this.cmsFields.length&&(e=this.cmsFields[this.cmsFields.length-1].orderList+1);let i={createBy:this.authService.userData.id+"",idinstitucion:+this.idinstitucion,orderList:e,state:"1",denomination:t.denomination,type:t.code,cms_id:+this.cms_id,description:"",defaultValue:"",maxLength:"",minLength:"",extra:"",isRequired:"1",readonly:"0"};this.loading=!0;let n=yield this.cmsFieldService.add(i);this.loading=!1,n.state=="success"&&n.data&&(this.cmsFields.push(n.data),this.select(this.cmsFields[this.cmsFields.length-1]))})}canAdd=()=>this.cmsFieldService.canAdd;canEdit=t=>this.cmsFieldService.canEdit&&t.item.readonly!=="1";canDuplicate=t=>this.cmsFieldService.canAdd&&t.item.readonly!=="1";canRemove=t=>this.cmsFieldService.canRemove&&t.item.readonly!=="1";canChangeState=()=>this.cmsFieldService.canChangeState;canExport=()=>this.cmsFieldService.canExport;canExportExcel=()=>this.cmsFieldService.canExportExcel;canExportPdf=()=>this.cmsFieldService.canExportPdf;canChangeStateACTIVE=t=>this.cmsFieldService.canChangeState&&t.item.state!="1"&&t.item.readonly!=="1";canChangeStateINACTIVE=t=>this.cmsFieldService.canChangeState&&t.item.state!="0"&&t.item.readonly!=="1";export(t="pdf"){return P(this,null,function*(){yield this.cmsFieldService.export(this.filter,t)})}changeMode(t){this.mode=t}changes=[];changeList(t){if(this.cmsFields.forEach((e,i)=>{e.order_new=i+1}),this.detectSaveOrder(),this.mode!="table"){let e=this.mode;this.mode="table",setTimeout(()=>{this.mode=e})}}detectSaveOrder(){this.changes=[],this.cmsFields.forEach((t,e)=>{typeof t.order_new<"u"&&t.order_new!=t.orderList&&this.changes.push({id:t.id,idinstitucion:t.idinstitucion,orderList:t.order_new})})}saveOrder(){return P(this,arguments,function*(t=!0,e=this.changes){if(t&&!(yield this.confirmationService.create("Guardar Orden","\xBFEst\xE1 seguro de guardar el orden?")))return;this.loading=!0,(yield this.cmsFieldService.saveOrder(e)).state=="success"&&(this.cmsFields.forEach((n,r)=>{n.orderList=n.order_new??n.orderList}),this.changes=[]),this.loading=!1})}drop(t){return P(this,null,function*(){if(jn(this.cmsFields,t.previousIndex,t.currentIndex),!(+this.cms_id>0)){this.cmsFields.forEach((i,n)=>{i.orderList=n+1});return}this.cmsFields.forEach((i,n)=>{i.order_new=n+1});let e=[];this.cmsFields.forEach((i,n)=>{typeof i.order_new<"u"&&i.order_new!=i.orderList&&e.push({id:i.id,orderList:i.order_new,idinstitucion:i.idinstitucion})}),e.length!=0&&this.saveOrder(!1,e)})}close(){this.isModal&&this.modalActive.close(this.cmsFields)}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-cms-field-list"]],inputs:{idinstitucion:"idinstitucion",state:"state",cms_id:"cms_id",showPagination:"showPagination",mode:"mode",size:"size",cmsFields:"cmsFields",load:"load",isModal:"isModal",abled:"abled"},outputs:{eventChange:"eventChange"},decls:18,vars:14,consts:[["menu",""],["ngxContextMenu","ngxContextMenu"],[1,"modal-header"],["type","button",1,"btn","btn-warning","btn-md-custom","btn-order"],[1,"p-1","d-flex","gap-1","justify-content-end"],[1,"",3,"ngClass"],["cdkDropList","",3,"class"],["contextMenuItem","",3,"execute"],["contextMenuItem","",3,"execute","visible"],["contextMenuItem","",3,"divider"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["type","button",1,"btn","btn-warning","btn-md-custom","btn-order",3,"click"],["ngbDropdown","",1,"primary"],["type","button","app-button","","ngbDropdownToggle","",3,"rounded"],["ngbDropdownMenu",""],["ngbDropdownItem",""],["app-icon-button","",3,"click","rounded"],[1,"icon","ion-md-refresh"],["ngbDropdownItem","",3,"click"],[1,"_items"],[1,"icons"],["alt","",3,"src"],[1,"label"],[1,"atajo"],[1,"table","table-sm","table-box","table-fixed"],[2,"width","40px"],["sortablejs","",3,"onUpdate","items"],[3,"ngClass","contextMenu","contextMenuValue"],[3,"elementEvents","ngClass","contextMenu","contextMenuValue"],[1,"text-center"],[1,""],[1,"btn","btn-more",3,"click"],[1,"ion-md-more"],["cdkDropList","",3,"cdkDropListDropped"],["cdkDrag","",1,"box-main","p-1","d-flex","align-items-center","gap-1",2,"border-radius","0.25rem",3,"ngClass","contextMenu","contextMenuValue"],["cdkDrag","",1,"box-main","p-1","d-flex","align-items-center","gap-1",2,"border-radius","0.25rem",3,"elementEvents","ngClass","contextMenu","contextMenuValue"],["cdkDragHandle","",1,"drag-handle","d-flex","align-items-center","justify-content-center"],[1,"ion-md-menu"],[1,"_img"],[1,"flex-grow-1"],[1,"btn","btn-more","btn-more-sm",3,"click"],[1,"icons","icon","ion-md-list-box"],[1,"label","w-100"],[1,"icons","icon","ion-md-trash"],[1,"icons","icon","ion-md-copy"],[1,"icons","text-success"],[1,"icon","ion-md-eye"],[1,"icons","text-danger"],[1,"icon","ion-md-eye-off"],[1,"icons","icon","ion-md-refresh"]],template:function(e,i){if(e&1){let n=M();D(0,bP,4,0,"div",2),D(1,xP,2,0,"button",3),D(2,SP,10,2,"div",4),l(3,"div",5),D(4,PP,14,1,"div")(5,DP,4,4,"div",6),a(),l(6,"context-menu",null,0),Se(8,TP,6,0,"ng-template",7),h("execute",function(s){return g(n),C(i.openDetail(s.value.item))}),Se(9,FP,6,0,"ng-template",8),h("execute",function(s){return g(n),C(i.remove(s.value.item,s.value.indice))}),Se(10,kP,6,0,"ng-template",8),h("execute",function(s){return g(n),C(i.duplicate(s.value.item))}),Se(11,OP,0,0,"ng-template",9)(12,VP,6,0,"ng-template",8),h("execute",function(s){return g(n),C(i.changeState(s.value.item,i.ECmsFieldState.ACTIVE))}),u(13,", "),Se(14,NP,6,0,"ng-template",8),h("execute",function(s){return g(n),C(i.changeState(s.value.item,i.ECmsFieldState.INACTIVE))}),Se(15,AP,0,0,"ng-template",9)(16,jP,6,0,"ng-template",7),h("execute",function(){return g(n),C(i.resetPage())}),a(),D(17,RP,1,0,"app-loading")}e&2&&(T(i.isModal?0:-1),c(),T(i.changes.length?1:-1),c(),T(i.abled?2:-1),c(),f("ngClass",te(12,vP,i.isModal)),c(),T(i.mode=="table"?4:5),c(5),f("visible",i.canRemove),c(),f("visible",i.canDuplicate),c(),f("divider",!0),c(),f("visible",i.canChangeStateACTIVE),c(2),f("visible",i.canChangeStateINACTIVE),c(),f("divider",!0),c(2),T(i.loading?17:-1))},dependencies:[si,Si,wi,xi,be,pe,Ye,Ke,ai,yi,vi,$i,Hi,At,Ei,Ni,lo,he,Be,Ge,Dr,_o,Co,go],styles:[".modal-body[_ngcontent-%COMP%]{min-height:calc(100vh - 150px)}.drag-handle[_ngcontent-%COMP%]{color:var(--primary);padding:5px}._img[_ngcontent-%COMP%]{margin-right:.5rem}._img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:20px;max-height:20px;display:block}"]})};var LP=o=>({$implicit:o,path:""}),UP=(o,t)=>({$implicit:o,path:t});function zP(o,t){o&1&&la(0)}function BP(o,t){if(o&1&&(l(0,"div",1)(1,"ul",2),Se(2,zP,1,0,"ng-container",3),a()()),o&2){let e=d(),i=Xe(2);c(2),f("ngTemplateOutlet",i)("ngTemplateOutletContext",te(2,LP,e.data))}}function WP(o,t){if(o&1){let e=M();l(0,"button",17),h("click",function(n){g(e);let r=d(2).$implicit,s=d().path,m=d();return C(m.removeNode(s+r,n))}),u(1,"-"),a()}}function $P(o,t){if(o&1){let e=M();l(0,"button",18),h("click",function(n){g(e);let r=d(2).$implicit,s=d().path,m=d();return C(m.addNode(s+r,n))}),u(1,"+"),a()}}function HP(o,t){if(o&1&&D(0,WP,2,0,"button",15)(1,$P,2,0,"button",16),o&2){let e=d().$implicit,i=d().path,n=d();T(n.isSelected(i+e)?0:1)}}function GP(o,t){if(o&1){let e=M();l(0,"input",19),h("change",function(){g(e);let n=d().$implicit,r=d().path,s=d();return C(s.toggle(r+n))}),a()}if(o&2){let e=d().$implicit,i=d().path,n=d();f("id",Re("node-",i+e))("checked",n.isSelected(i+e))}}function qP(o,t){if(o&1){let e=M();l(0,"span",20),h("click",function(n){g(e);let r=d().$implicit,s=d().path,m=d();return C(m.toggleNode(s+r,n))}),u(1),a()}if(o&2){let e=d().$implicit,i=d().path,n=d();c(),Ie(" ",n.isExpanded(i+e)?"\u25BC":"\u25BA"," ")}}function JP(o,t){o&1&&_(0,"span",8)}function XP(o,t){if(o&1&&(l(0,"span",11),u(1),a()),o&2){let e=d().$implicit,i=d().$implicit;c(),Ie(": ",i[e])}}function ZP(o,t){o&1&&(l(0,"span",12),u(1,": [Array]"),a())}function QP(o,t){o&1&&(l(0,"span",13),u(1,": Object"),a())}function KP(o,t){o&1&&la(0)}function YP(o,t){if(o&1&&(l(0,"ul",14),Se(1,KP,1,0,"ng-container",3),a()),o&2){let e=d().$implicit,i=d(),n=i.$implicit,r=i.path;d();let s=Xe(2);c(),f("ngTemplateOutlet",s)("ngTemplateOutletContext",vt(2,UP,n[e],r+e+"."))}}function eM(o,t){if(o&1&&(l(0,"li",4)(1,"div",5),D(2,HP,2,1)(3,GP,1,3,"input",6),D(4,qP,2,1,"span",7)(5,JP,1,0,"span",8),l(6,"label",9)(7,"span",10),u(8),a(),D(9,XP,2,1,"span",11)(10,ZP,2,0,"span",12)(11,QP,2,0,"span",13),a()(),D(12,YP,2,5,"ul",14),a()),o&2){let e=t.$implicit,i=d(),n=i.$implicit,r=i.path,s=d();c(2),T(s.showActionButtons?2:3),c(2),T(s.isObject(n[e])?4:5),c(2),f("for",Re("node-",r+e)),c(2),W(e),c(),T(!s.isObject(n[e])&&!s.isArray(n[e])?9:s.isArray(n[e])?10:11),c(3),T(s.isObject(n[e])&&s.isExpanded(r+e)?12:-1)}}function tM(o,t){if(o&1&&Y(0,eM,13,7,"li",4,de),o&2){let e=t.$implicit,i=d();ee(i.objectKeys(e))}}var ud=class o{_data=A({});selected=A(new Map);set data(t){this._data.set(t)}get data(){return this._data()}modeSelect="single";showActionButtons=!1;selectedFields=new q;nodeToggled=new q;expanded=A(new Set);toggleNode(t,e){e.stopPropagation();let i=new Set(this.expanded());i.has(t)?i.delete(t):i.add(t),this.expanded.set(i)}isExpanded(t){return this.expanded().has(t)}isObject(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}isArray(t){return Array.isArray(t)}addNode(t,e){e.stopPropagation(),this.toggle(t)}removeNode(t,e){e.stopPropagation(),this.toggle(t)}getValueByPath(t,e){return e.split(".").reduce((i,n)=>i?.[n],t)}objectKeys(t){return Object.keys(t??{})}toggle(t){let e=new Map(this.selected()),i=t.split("."),n=e.has(t);this.modeSelect==="single"&&e.clear();let r=!n;if(r?e.set(t,!0):e.delete(t),e.has(t))for(let p=1;p<i.length;p++){let v=i.slice(0,p).join(".");e.set(v,!0)}this.selected.set(e);let s=this.getValueByPath(this.data,t);this.nodeToggled.emit({path:t,value:s,state:r});let m=[...e.keys()].map(p=>({path:p,value:this.getValueByPath(this.data,p)}));if(this.modeSelect==="single"){let p=m.find(v=>v.path===t);this.selectedFields.emit(p?[p]:[])}else this.selectedFields.emit(m)}isSelected(t){return this.selected().has(t)}set defaultSelected(t){if(t&&t.length){let e=new Map;t.forEach(i=>{e.set(i,!0);let n=i.split(".");for(let r=1;r<n.length;r++){let s=n.slice(0,r).join(".");e.set(s,!0)}}),this.selected.set(e)}}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-json-tree"]],inputs:{data:"data",modeSelect:"modeSelect",showActionButtons:"showActionButtons",defaultSelected:"defaultSelected"},outputs:{selectedFields:"selectedFields",nodeToggled:"nodeToggled"},decls:3,vars:1,consts:[["renderNode",""],[1,"json-tree"],[1,"tree-root"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"tree-node"],[1,"node-content"],["type","checkbox",1,"node-checkbox",3,"id","checked"],[1,"toggle-icon"],[1,"toggle-placeholder"],[1,"node-label",3,"for"],[1,"key"],[1,"value","text-truncate"],[1,"value","array"],[1,"value","object"],[1,"child-nodes"],[1,"btn","btn-danger","btn-sm-custom"],[1,"btn","btn-outline-primary","btn-sm-custom"],[1,"btn","btn-danger","btn-sm-custom",3,"click"],[1,"btn","btn-outline-primary","btn-sm-custom",3,"click"],["type","checkbox",1,"node-checkbox",3,"change","id","checked"],[1,"toggle-icon",3,"click"]],template:function(e,i){e&1&&(D(0,BP,3,4,"div",1),Se(1,tM,2,0,"ng-template",null,0,Sp)),e&2&&T(i.data?0:-1)},dependencies:[_i,Mp],styles:['.json-tree[_ngcontent-%COMP%]{font-family:monospace;font-size:14px}.json-tree[_ngcontent-%COMP%]   .tree-root[_ngcontent-%COMP%]{list-style-type:none;padding:0;margin:0}.json-tree[_ngcontent-%COMP%]   .tree-node[_ngcontent-%COMP%]{list-style-type:none;margin:2px 0;padding-left:20px;position:relative}.json-tree[_ngcontent-%COMP%]   .tree-node[_ngcontent-%COMP%]:before{content:"";position:absolute;left:8px;top:0;border-left:1px dashed #ccc;height:100%}.json-tree[_ngcontent-%COMP%]   .tree-node[_ngcontent-%COMP%]:last-child:before{height:10px}.json-tree[_ngcontent-%COMP%]   .node-content[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:2px}.json-tree[_ngcontent-%COMP%]   .node-checkbox[_ngcontent-%COMP%]{margin-right:5px}.json-tree[_ngcontent-%COMP%]   .node-label[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center}.json-tree[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{font-weight:700;color:#2c3e50}.json-tree[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#7f8c8d;max-width:100px}.json-tree[_ngcontent-%COMP%]   .value.object[_ngcontent-%COMP%]{color:#3498db}.json-tree[_ngcontent-%COMP%]   .value.array[_ngcontent-%COMP%]{color:#2ecc71}.json-tree[_ngcontent-%COMP%]   .child-nodes[_ngcontent-%COMP%]{padding-left:0;margin-top:2px}.json-tree[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{display:inline-block;width:16px;height:16px;line-height:16px;text-align:center;cursor:pointer;font-size:10px;margin-right:5px;-webkit-user-select:none;user-select:none}.json-tree[_ngcontent-%COMP%]   .toggle-placeholder[_ngcontent-%COMP%]{display:inline-block;width:16px;margin-right:5px}']})};function iM(o,t){o&1&&_(0,"app-loading")}function nM(o,t){if(o&1){let e=M();l(0,"div",3)(1,"b"),u(2,"DATOS DE LISTA:"),a()(),l(3,"app-json-tree",4),h("selectedFields",function(n){g(e);let r=d();return C(r.selectedFieldsItem(n))})("nodeToggled",function(n){g(e);let r=d();return C(r.nodeToggledItem(n))}),a()}if(o&2){let e=d();c(3),f("data",e.arrayJson)("showActionButtons",!0)("defaultSelected",e.fieldsPathItemDefault)("modeSelect","multiple")}}var fd=class o{_data=A({});mode="data";apiUrl="";httpMethod="GET";requestBody=null;headers={};fieldsPathDefault=[];fieldsPathItemDefault=[];nodeToggled=new q;listPath=new q;isLoading=A(!1);error=A(null);set data(t){this._data.set(t)}get data(){return this._data()}selectedFields(t){if(this.arrayJson={},t.length===0)return;let e=t[0];Array.isArray(e.value)?e.value.length>0&&(this.arrayJson=e.value[0],this.listPath.emit(e)):this.listPath.emit({path:"",value:[]})}selectedFieldsItem(t){console.log("Selected fields from JSON tree:",t)}nodeToggledItem(t){console.log("Selected fields from JSON tree:",t),this.nodeToggled.emit(t)}ngOnInit(){this.mode==="api"&&this.apiUrl!==""&&this.fetchData()}fetchData(){return P(this,null,function*(){if(this.apiUrl){this.isLoading.set(!0),this.error.set(null);try{let t={method:this.httpMethod,headers:k({"Content-Type":"application/json"},this.headers)};this.httpMethod==="POST"&&this.requestBody&&(t.body=typeof this.requestBody=="string"?this.requestBody:JSON.stringify(this.requestBody));let e=yield fetch(this.apiUrl,t);if(!e.ok)throw new Error(`API error: ${e.status}`);let i=yield e.json();if(this.fieldsPathDefault.length>0){let n=this.fieldsPathDefault[0];i[n]&&Array.isArray(i[n])&&i[n].length>0&&(this.arrayJson=i[n][0])}this._data.set(i)}catch(t){console.error("Failed to fetch API data:",t),this.error.set(t instanceof Error?t.message:"Failed to fetch data")}finally{this.isLoading.set(!1)}}})}arrayJson={};static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-json-tree-data"]],inputs:{mode:"mode",apiUrl:"apiUrl",httpMethod:"httpMethod",requestBody:"requestBody",headers:"headers",fieldsPathDefault:"fieldsPathDefault",fieldsPathItemDefault:"fieldsPathItemDefault",data:"data"},outputs:{nodeToggled:"nodeToggled",listPath:"listPath"},decls:8,vars:4,consts:[[1,""],[1,"mb-3"],[3,"selectedFields","data","defaultSelected"],[1,"my-3"],[3,"selectedFields","nodeToggled","data","showActionButtons","defaultSelected","modeSelect"]],template:function(e,i){e&1&&(D(0,iM,1,0,"app-loading"),l(1,"div",0)(2,"div",1)(3,"b"),u(4,"JSON"),a()(),l(5,"app-json-tree",2),h("selectedFields",function(r){return i.selectedFields(r)}),a()(),l(6,"div",0),D(7,nM,4,4),a()),e&2&&(T(i.isLoading()?0:-1),c(5),f("data",i.data)("defaultSelected",i.fieldsPathDefault),c(2),T(i.arrayJson?7:-1))},dependencies:[ud,Ye],encapsulation:2})};var oM=o=>({"modal-body p-0":o});function rM(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",3),u(2),a(),l(3,"button",4),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}if(o&2){let e=d();c(2),Ie("GESTI\xD3N DE COLUMNAS [",e.cms_id,"]")}}function aM(o,t){if(o&1){let e=M();l(0,"app-ui-cms-field-form",12),h("eventChange",function(n){g(e);let r=d(3);return C(r.cmsEvent(n))}),a()}if(o&2){let e=d(3);f("accion",+e.cms_id>0?"update":"add")("cmsFields",e.cmsFields)("cmsField",e.cmsField)("showOption",!1)("isModal",!1)("cms_id",e.cms_id)("source",e.cms.source)}}function sM(o,t){if(o&1){let e=M();l(0,"div",6)(1,"app-json-tree-data",7),h("listPath",function(n){g(e);let r=d(2);return C(r.listPath(n))})("nodeToggled",function(n){g(e);let r=d(2);return C(r.nodeToggledItem(n))}),a()(),l(2,"div",8)(3,"app-ui-cms-field-list",9),h("eventChange",function(n){g(e);let r=d(2);return C(r.onSelect(n))}),a()(),l(4,"div",10),D(5,aM,1,7,"app-ui-cms-field-form",11),a()}if(o&2){let e=d(2);c(),f("apiUrl",lt(e.cms.sourceUrl))("fieldsPathDefault",e.fieldsPath)("fieldsPathItemDefault",e.fieldsPathItem)("httpMethod",e.cms.sourceMethod),c(2),f("abled",e.cms.source!=="API")("cmsFields",e.cmsFields)("load",e.load)("state",e.state)("cms_id",e.cms_id)("showPagination",e.showPagination),c(2),T(e.cmsField?5:-1)}}function lM(o,t){if(o&1){let e=M();l(0,"app-ui-cms-field-form",16),h("eventChange",function(n){g(e);let r=d(3);return C(r.cmsEvent(n))}),a()}if(o&2){let e=d(3);f("cmsFields",e.cmsFields)("cmsField",e.cmsField)("showOption",!1)("isModal",!1)("cms_id",e.cms_id)}}function cM(o,t){if(o&1){let e=M();l(0,"div",6)(1,"app-ui-cms-field-list",13),h("eventChange",function(n){g(e);let r=d(2);return C(r.onSelect(n))}),a()(),l(2,"div",14),D(3,lM,1,5,"app-ui-cms-field-form",15),a()}if(o&2){let e=d(2);c(),f("cmsFields",e.cmsFields)("load",e.load)("state",e.state)("cms_id",e.cms_id)("showPagination",e.showPagination),c(2),T(e.cmsField?3:-1)}}function dM(o,t){if(o&1&&(l(0,"div",2)(1,"div",5),D(2,sM,6,12)(3,cM,4,6),a()()),o&2){let e=d();c(2),T(e.cms.source==="API"?2:3)}}function mM(o,t){o&1&&_(0,"app-loading")}var ea=class o{constructor(t){this.activeModal=t}state="1";cms_id="";showPagination=!1;cmsFields=[];load=!0;cms;isModal=!0;eventChange=new q;pathSelected=new q;idinstitucion="";cmsFieldService=b(Yi);authService=b(xe);fieldsPath=[];fieldsPathItem=[];ngOnInit(){this.idinstitucion=this.authService.userData.idinstitucion+"",+this.cms_id>0&&this.cms&&this.fieldsPath.push(this.cms.fields),this.cmsFields.length>0&&this.cmsFields.forEach(t=>{this.fieldsPathItem.push(t.extra)})}close(){this.isModal&&this.activeModal.close(this.cmsFields)}listPath(t){console.log("listPath",t),this.pathSelected.emit(t)}cmsField;onSelect(t){this.cmsField=void 0,setTimeout(()=>{this.cmsField=t.data},50)}cmsEvent(t){if(t.event==="update"){let e=this.cmsFields.find(i=>i.id===t.data?.id);e&&Object.assign(e,t.data)}}auto=0;loading=!1;nodeToggledItem(t){return P(this,null,function*(){if(t.state){this.auto++;let e={cms_id:+this.cms_id,createBy:"",defaultValue:"",denomination:t.path,idinstitucion:+this.idinstitucion,description:"",extra:t.path,isRequired:"0",maxLength:"",minLength:"",orderList:this.cmsFields.length+1,readonly:"0",state:"1",type:"text"};if(+this.cms_id>0){this.loading=!0;let i=yield this.cmsFieldService.add(e);this.loading=!1,i.state==="success"&&i.data&&this.cmsFields.push(i.data)}else this.cmsFields.push(re(k({},e),{id:this.auto,createAt:""}))}else if(+this.cms_id>0){let e=this.cmsFields.find(n=>n.extra==t.path);if(!e)return;this.loading=!0;let i=yield this.cmsFieldService.delete({id:e.id,idinstitucion:+this.idinstitucion});this.loading=!1,i.state==="success"&&(this.cmsFields=this.cmsFields.filter(n=>n.id!=e.id))}else this.cmsFields=this.cmsFields.filter(e=>e.denomination!=t.path)})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-cms-field-crud"]],inputs:{state:"state",cms_id:"cms_id",showPagination:"showPagination",cmsFields:"cmsFields",load:"load",cms:"cms",isModal:"isModal",idinstitucion:"idinstitucion"},outputs:{eventChange:"eventChange",pathSelected:"pathSelected"},decls:4,vars:6,consts:[[1,"modal-header"],[1,"",3,"ngClass"],[1,"container-fluid"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],[1,"row"],[1,"col-12","col-md-5","p-0","b-r"],["mode","api",3,"listPath","nodeToggled","fieldsPathDefault","fieldsPathItemDefault","apiUrl","httpMethod"],[1,"col-12","col-md-3","p-0","b-r"],["mode","list",3,"eventChange","abled","cmsFields","load","state","cms_id","showPagination"],[1,"col-12","col-md-4","px-0","py-2"],["modeSave","action",3,"accion","cmsFields","cmsField","showOption","isModal","cms_id","source"],["modeSave","action",3,"eventChange","accion","cmsFields","cmsField","showOption","isModal","cms_id","source"],["mode","list",3,"eventChange","cmsFields","load","state","cms_id","showPagination"],[1,"col-12","col-md-7","px-0","py-2"],["accion","update","modeSave","action",3,"cmsFields","cmsField","showOption","isModal","cms_id"],["accion","update","modeSave","action",3,"eventChange","cmsFields","cmsField","showOption","isModal","cms_id"]],template:function(e,i){e&1&&(D(0,rM,4,1,"div",0),l(1,"div",1),D(2,dM,4,1,"div",2),a(),D(3,mM,1,0,"app-loading")),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(4,oM,i.isModal)),c(),T(i.cms?2:-1),c(),T(i.loading?3:-1))},dependencies:[be,pd,Yr,fd,Ye],styles:[".row[_ngcontent-%COMP%]{min-height:400px}"]})};var Fo=(e=>(e.ACTIVE="1",e.INACTIVE="0",e))(Fo||{});var Xm=(i=>(i.VOID="",i.ACTIVE="1",i.INACTIVE="0",i))(Xm||{});var pM=o=>({"modal-body":o}),Zm=o=>({"has-danger":o});function uM(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",6),u(2,"DATOS DE CMS"),a(),l(3,"button",7),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}function fM(o,t){if(o&1&&(l(0,"option",21),u(1),a()),o&2){let e=t.$implicit;f("value",e.value),c(),W(e.label)}}function hM(o,t){if(o&1){let e=M();l(0,"form",8),h("submit",function(){g(e);let n=d();return C(n.save())}),l(1,"div",9)(2,"label",10),u(3,"Fuente "),a(),l(4,"div",11)(5,"app-group-selector",12),h("valueChange",function(n){g(e);let r=d();return C(r.changeType(n))}),a(),_(6,"app-control-messages",13),a()(),l(7,"div",14)(8,"label",15),u(9,"Denominaci\xF3n "),a(),l(10,"div",11),_(11,"input",16)(12,"app-control-messages",13),a()(),l(13,"div",17)(14,"label",18),u(15,"API URL "),a(),l(16,"div",11)(17,"div",19)(18,"select",20),Y(19,fM,2,2,"option",21,de),a(),_(21,"input",22),a(),_(22,"app-control-messages",13),a()()()}if(o&2){let e=d();f("formGroup",e.form),c(),f("ngClass",te(13,Zm,e.sourceControl.invalid&&(e.sourceControl.touched||e.submit))),c(4),f("list",e.types)("value",e.sourceControl.value),c(),f("control",e.sourceControl)("show",e.submit),c(),f("ngClass",te(15,Zm,e.denominationControl.invalid&&(e.denominationControl.touched||e.submit))),c(5),f("control",e.denominationControl)("show",e.submit),c(),f("hidden",e.sourceControl.value!="API")("ngClass",te(17,Zm,e.sourceUrlControl.invalid&&(e.sourceUrlControl.touched||e.submit))),c(6),ee(e.methos),c(3),f("control",e.sourceUrlControl)("show",e.submit)}}function gM(o,t){if(o&1){let e=M();l(0,"div",23)(1,"b"),u(2,"URL: "),a(),l(3,"a",24),u(4),a(),l(5,"button",25),h("click",function(){g(e);let n=d();return C(n.otro())}),u(6,"Otro"),a()(),l(7,"app-ui-cms-field-crud",26),h("pathSelected",function(n){g(e);let r=d();return C(r.pathSelected(n))}),a()}if(o&2){let e=d();c(4),Ie(" ",e.cms==null?null:e.cms.sourceUrl),c(3),f("isModal",!1)("cms",e.cms)("load",!1)("cmsFields",e.cmsFields)}}function CM(o,t){if(o&1){let e=M();l(0,"button",29),h("click",function(){g(e);let n=d(3);return C(n.next())}),u(1,"Continuar"),a()}}function _M(o,t){if(o&1){let e=M();l(0,"button",29),h("click",function(){g(e);let n=d(3);return C(n.save())}),u(1,"Guardar"),a()}}function vM(o,t){if(o&1&&D(0,CM,2,0,"button",28)(1,_M,2,0,"button",28),o&2){let e=d(2);T(e.panel===1?0:1)}}function yM(o,t){if(o&1){let e=M();l(0,"button",29),h("click",function(){g(e);let n=d(2);return C(n.save())}),u(1,"Guardar"),a()}}function bM(o,t){if(o&1){let e=M();l(0,"div",5)(1,"button",27),h("click",function(){g(e);let n=d();return C(n.close())}),u(2,"Cancelar"),a(),D(3,vM,2,1)(4,yM,2,0,"button",28),a()}if(o&2){let e=d();c(3),T(e.sourceControl.value==="API"?3:4)}}function xM(o,t){o&1&&_(0,"app-loading")}var hd=class o{constructor(t){this.modalActive=t}accion="add";cms;isModal=!0;idinstitucion="";uid="";state="1";showOption=!0;onSave=new ki(!1);eventChange=new q;onAdd=new q;onUpdate=new q;cmsService=b(Io);authService=b(xe);methos=[{label:"GET",value:"GET"},{label:"POST",value:"POST"}];types=[{label:"LOCAL",value:"LOCAL"},{label:"API",value:"API"}];states=this.cmsService.states;subscriptions=[];ngOnInit(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.uid===""&&(this.uid=this.authService.userData.id+"");let t=this.onSave.subscribe(e=>{e&&this.save()});if(this.subscriptions.push(t),this.accion=="update"||this.accion=="duplicate"){if(!this.cms)return;this.form.patchValue({denomination:this.cms.denomination,state:this.cms.state,orderList:this.cms.orderList+"",note:this.cms.note,fields:this.cms.fields,source:this.cms.source,sourceUrl:this.cms.sourceUrl,sourceMethod:this.cms.sourceMethod})}else this.accion=="add"&&this.form.patchValue({state:this.state})})}ngAfterViewInit(){setTimeout(()=>{document.getElementById("denominationCm")?.focus()},150)}form=new ni({denomination:new Fe("",{validators:[ze.required],nonNullable:!0}),state:new Fe("1",{validators:[ze.required],nonNullable:!0}),orderList:new Fe("0",{validators:[ze.required],nonNullable:!0}),note:new Fe("",{validators:[],nonNullable:!0}),fields:new Fe("",{validators:[],nonNullable:!0}),data:new Fe("[]",{validators:[],nonNullable:!0}),source:new Fe("LOCAL",{validators:[ze.required],nonNullable:!0}),sourceUrl:new Fe("",{validators:[],nonNullable:!0}),sourceMethod:new Fe("",{validators:[],nonNullable:!0})});get denominationControl(){return this.form.get("denomination")}get stateControl(){return this.form.get("state")}get orderListControl(){return this.form.get("orderList")}get noteControl(){return this.form.get("note")}get fieldsControl(){return this.form.get("fields")}get dataControl(){return this.form.get("data")}get sourceControl(){return this.form.get("source")}get sourceUrlControl(){return this.form.get("sourceUrl")}get sourceMethodControl(){return this.form.get("sourceMethod")}close(){this.isModal?this.modalActive.dismiss():this.eventChange.emit({event:"close",data:void 0})}submit=!1;loading=!1;loadApi=!1;changeType(t){this.sourceControl.setValue(t),this.sourceControl.value=="LOCAL"?(this.sourceUrlControl.clearValidators(),this.sourceMethodControl.clearValidators(),this.fieldsControl.clearValidators()):(this.form.patchValue({sourceMethod:"GET"}),this.sourceUrlControl.setValidators([ze.required]),this.sourceMethodControl.setValidators([ze.required]),this.fieldsControl.clearValidators()),this.sourceUrlControl.updateValueAndValidity(),this.sourceMethodControl.updateValueAndValidity(),this.fieldsControl.updateValueAndValidity(),setTimeout(()=>{document.getElementById("denominationCm")?.focus()},50)}panel=1;next(){this.form.valid&&(this.panel=2,this.cms||(this.cms={}),this.cms.sourceUrl=this.sourceUrlControl.value,this.cms.sourceMethod=this.sourceMethodControl.value,this.cms.source=this.sourceControl.value,this.fieldsControl.setValidators([ze.required]),this.fieldsControl.updateValueAndValidity(),this.changeClass(!0))}changeClass(t=!0){let e=document.querySelector(".formCms");t?e?.classList.add("modal_1250"):e?.classList.remove("modal_1250")}otro(){this.changeClass(!1),this.fieldsControl.setValidators([]),this.fieldsControl.updateValueAndValidity()}values=[];pathSelected(t){console.log("listPath",t),this.fieldsControl.setValue(t.path),this.values=t.value}cmsFields=[];save(t=!0){return P(this,null,function*(){if(this.submit=!0,!this.form.valid)return;if(this.sourceControl.value==="API"&&this.panel===1){this.next();return}this.submit=!1;let e=this.form.value;if(this.accion=="add"||this.accion=="duplicate"){let n={cms:{denomination:e.denomination,state:e.state,orderList:+e.orderList,createBy:this.uid,idinstitucion:+this.idinstitucion,note:e.note,fields:e.fields,source:e.source,sourceUrl:e.sourceUrl,sourceMethod:e.sourceMethod},fields:this.cmsFields.map(r=>({cms_id:0,idinstitucion:+this.idinstitucion,orderList:r.orderList,state:r.state,denomination:r.denomination,type:r.type,description:r.description,defaultValue:r.defaultValue,maxLength:r.maxLength,minLength:r.minLength,extra:r.extra,isRequired:r.isRequired,createBy:this.uid,readonly:r.readonly})),data:this.values.slice(0,10).map((r,s)=>{let m={};return this.cmsFields.forEach(p=>{m[p.extra]=r[p.extra]}),{cms_id:0,idinstitucion:+this.idinstitucion,orderList:s+1,state:"1",createBy:this.uid,data:JSON.stringify(m)}})};if(t){this.loading=!0;let r=yield this.cmsService.addAll(n);this.loading=!1,r.state=="success"&&(this.isModal?this.modalActive.close(r.data):this.eventChange.emit({event:"add",data:r.data}))}else this.isModal?this.modalActive.close(n):this.onAdd.emit(n)}else if(this.accion=="update"){let i={id:+this.cms?.id,denomination:e.denomination,state:e.state,orderList:+e.orderList,idinstitucion:+this.idinstitucion,note:e.note,fields:e.fields,source:e.source,sourceUrl:e.sourceUrl,sourceMethod:e.sourceMethod};this.loading=!0;let n=yield this.cmsService.update(i);this.loading=!1,n.state=="success"?this.isModal?this.modalActive.close(i):this.eventChange.emit({event:"update",data:i}):this.isModal?this.modalActive.close(i):this.onUpdate.emit(i)}})}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-cms-form"]],inputs:{accion:"accion",cms:"cms",isModal:"isModal",idinstitucion:"idinstitucion",uid:"uid",state:"state",showOption:"showOption",onSave:"onSave"},outputs:{eventChange:"eventChange",onAdd:"onAdd",onUpdate:"onUpdate"},decls:8,vars:7,consts:[[1,"modal-header"],[1,"",3,"ngClass"],[1,""],[1,"form"],[1,"container",3,"formGroup"],[1,"modal-footer"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],[1,"container",3,"submit","formGroup"],[1,"form-group","row","justify-content-center",3,"ngClass"],["for","sourceCm",1,"control-label","col-12","col-md-3"],[1,"col-12","col-md-9"],[3,"valueChange","list","value"],[1,"left",3,"control","show"],[1,"form-group","row",3,"ngClass"],["for","denominationCm",1,"control-label","col-12","col-md-3"],["type","text","name","denominationCm","id","denominationCm","formControlName","denomination",1,"form-control"],[1,"form-group","row",3,"hidden","ngClass"],["for","sourceUrlCm",1,"control-label","col-12","col-md-3"],[1,"input-group"],["name","sourceMethodCm","id","sourceMethodCm","formControlName","sourceMethod",1,"form-select",2,"max-width","80px"],[3,"value"],["type","text","name","sourceUrlCm","id","sourceUrlCm","formControlName","sourceUrl",1,"form-control","flex-grow-1"],[1,"box-main","mb-2","px-3","py-1","mx-1"],["href","javascript:void(0)"],["type","button",1,"btn","btn-primary","btn-sm-custom","ms-1",3,"click"],[3,"pathSelected","isModal","cms","load","cmsFields"],["type","button",1,"btn","btn-outline-secondary","btn-lg-medio","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-lg-medio"],["type","button",1,"btn","btn-primary","btn-lg-medio",3,"click"]],template:function(e,i){e&1&&(D(0,uM,4,0,"div",0),l(1,"div",1)(2,"div",2)(3,"div",3),D(4,hM,23,19,"form",4)(5,gM,8,5),a()()(),D(6,bM,5,1,"div",5),D(7,xM,1,0,"app-loading")),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(5,pM,i.isModal)),c(3),T(i.panel===1?4:5),c(2),T(i.showOption?6:-1),c(),T(i.loading?7:-1))},dependencies:[Kt,Zt,Ht,Gt,Qe,$t,Ne,Xt,Qt,ri,bi,be,Ye,Ln,ea],styles:[".grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 3fr;gap:10px}"]})};var wM=o=>({"modal-body px-0":o});function SM(o,t){if(o&1){let e=M();l(0,"div",1)(1,"h4",6),u(2,"DATOS DEL CMS"),a(),l(3,"button",7),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}function EM(o,t){if(o&1){let e=M();l(0,"div",5)(1,"button",8),h("click",function(){g(e);let n=d();return C(n.close())}),u(2,"Cancelar"),a(),l(3,"button",9),h("click",function(){g(e),d();let n=Xe(3);return C(n.save(!1))}),u(4,"Guardar"),a()()}}function PM(o,t){o&1&&_(0,"app-loading")}var gd=class o{constructor(t){this.modalActive=t}accion="add";projectCms;isModal=!0;idinstitucion="";uid="";cms_id="";project_id="";showOption=!0;onSave=new ki(!1);eventChange=new q;projectCmsService=b(mn);authService=b(xe);subscriptions=[];ngOnInit(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.uid===""&&(this.uid=this.authService.userData.id+"");let t=this.onSave.subscribe(e=>{e&&this.save()});if(this.subscriptions.push(t),this.accion=="update"||this.accion=="duplicate"){if(!this.projectCms)return;this.form.patchValue({cmsId:this.projectCms.cms_id+"",orderList:this.projectCms.orderList+"",projectId:this.projectCms.project_id+""})}else this.accion=="add"&&this.form.patchValue({cmsId:this.cms_id,projectId:this.project_id})})}ngAfterViewInit(){setTimeout(()=>{document.getElementById("cmsIdPr")?.focus()},150)}form=new ni({cmsId:new Fe("0",{validators:[ze.required],nonNullable:!0}),orderList:new Fe("0",{validators:[ze.required],nonNullable:!0}),projectId:new Fe("0",{validators:[ze.required],nonNullable:!0})});get cmsIdControl(){return this.form.get("cmsId")}get orderListControl(){return this.form.get("orderList")}get projectIdControl(){return this.form.get("projectId")}close(){this.isModal?this.modalActive.dismiss():this.eventChange.emit({event:"close",data:void 0})}submit=!1;loading=!1;onUpdateCMS(t){console.log("value",t),t.event=="update"&&this.save("update",t.data?.denomination)}save(){return P(this,arguments,function*(t=this.accion,e){if(this.submit=!0,!this.form.valid)return;this.submit=!1;let i=this.form.value;if(t=="add"||t=="duplicate"){let n={createBy:this.uid,idinstitucion:+this.idinstitucion,cms_id:+i.cmsId,orderList:+i.orderList,project_id:+i.projectId,url:ds.transformToSlug(e||this.projectCms?.cms?.denomination||"")};this.loading=!0;let r=yield this.projectCmsService.add(n);this.loading=!1,r.state=="success"&&(this.isModal?this.modalActive.close(r.data):this.eventChange.emit({event:"add",data:r.data}))}else if(t=="update"){let n={id:+this.projectCms?.id,idinstitucion:+this.idinstitucion,cms_id:+i.cmsId,orderList:+i.orderList,project_id:+i.projectId,url:ds.transformToSlug(e||this.projectCms?.cms?.denomination||"")};this.loading=!0;let r=yield this.projectCmsService.update(n);this.loading=!1,r.state=="success"&&(this.isModal?this.modalActive.close(n):this.eventChange.emit({event:"update",data:n}))}})}onAddCMS(t){return P(this,null,function*(){if(this.accion=="add"||this.accion=="duplicate"){this.loading=!0;let e=this.form.value,i={createBy:this.uid,idinstitucion:+this.idinstitucion,cms_id:+e.cmsId,orderList:+e.orderList,project_id:+e.projectId,url:ds.transformToSlug(t.cms.denomination)},n=yield this.projectCmsService.addAll({cms:t,projectCms:i});this.loading=!1,n.state=="success"&&(this.isModal?this.modalActive.close(n.data):this.eventChange.emit({event:"add",data:n.data}))}})}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-project-cms-form"]],inputs:{accion:"accion",projectCms:"projectCms",isModal:"isModal",idinstitucion:"idinstitucion",uid:"uid",cms_id:"cms_id",project_id:"project_id",showOption:"showOption",onSave:"onSave"},outputs:{eventChange:"eventChange"},decls:7,vars:11,consts:[["cmsForm",""],[1,"modal-header"],[1,"",3,"ngClass"],[3,"onAdd","eventChange","isModal","showOption","cms","accion"],[1,"container",3,"submit","formGroup"],[1,"modal-footer"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["type","button",1,"btn","btn-outline-secondary","btn-lg-medio","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-lg-medio",3,"click"]],template:function(e,i){if(e&1){let n=M();D(0,SM,4,0,"div",1),l(1,"div",2)(2,"app-ui-cms-form",3,0),h("onAdd",function(s){return g(n),C(i.onAddCMS(s))})("eventChange",function(s){return g(n),C(i.onUpdateCMS(s))}),a(),l(4,"form",4),h("submit",function(){return g(n),C(i.save())}),a()(),D(5,EM,5,0,"div",5),D(6,PM,1,0,"app-loading")}e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(9,wM,i.isModal)),c(),f("isModal",!1)("showOption",!1)("cms",i.projectCms==null?null:i.projectCms.cms)("accion",(i.projectCms==null?null:i.projectCms.cms)==null?"add":"update"),c(2),f("formGroup",i.form),c(),T(i.showOption?5:-1),c(),T(i.loading?6:-1))},dependencies:[Kt,Zt,Xt,Qt,be,Ye,hd],encapsulation:2})};var O0=o=>({active:o}),Qm=(o,t)=>({item:o,indice:t}),MM=(o,t)=>t.id;function IM(o,t){if(o&1){let e=M();l(0,"button",17),h("click",function(){g(e);let n=d();return C(n.saveOrder())}),u(1,"Guardar orden"),a()}}function DM(o,t){if(o&1){let e=M();l(0,"tr",22,2),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))}),l(2,"td",23),u(3),a(),l(4,"td",23),u(5),a(),l(6,"td",23)(7,"button",24),h("click",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),C(s.open(n))}),_(8,"i",25),a()()()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(18);f("ngClass",te(5,O0,e.id==n.selected.id))("contextMenu",r)("contextMenuValue",vt(7,Qm,e,i)),c(3),Ie(" ",(i+1).zfill(2)," "),c(2),W(e.orderList)}}function TM(o,t){if(o&1){let e=M();l(0,"div")(1,"table",18)(2,"thead")(3,"tr")(4,"th",19),u(5,"#"),a(),l(6,"th"),u(7,"Orden"),a(),_(8,"th",19),a()(),l(9,"tbody",20),h("onUpdate",function(n){g(e);let r=d();return C(r.changeList(n))}),Y(10,DM,9,10,"tr",21,MM),a()()()}if(o&2){let e=d();c(9),f("items",e.projectCmss),c(),ee(e.projectCmss)}}function FM(o,t){o&1&&_(0,"img",29)}function kM(o,t){o&1&&_(0,"img",30)}function OM(o,t){if(o&1){let e=M();l(0,"a",27,2),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))}),l(2,"div",28),D(3,FM,1,0,"img",29)(4,kM,1,0,"img",30),a(),l(5,"div",31),u(6),a(),l(7,"div",32)(8,"button",33),h("click",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),s.open(n),C(n.stopPropagation())}),_(9,"i",34),a()()()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(18);f("routerLink",tr("/",n.base,"/proyectos/",e.project_id,"/cms/",e.cms_id,"/data"))("ngClass",te(9,O0,e.id==n.selected.id))("contextMenu",r)("contextMenuValue",vt(11,Qm,e,i)),c(3),T((e.cms==null?null:e.cms.source)==="API"?3:4),c(3),Ie(" ",e.cms==null?null:e.cms.denomination," ")}}function VM(o,t){if(o&1&&(l(0,"div",11),Y(1,OM,10,14,"a",26,de),a()),o&2){let e=d();c(),ee(e.projectCmss)}}function NM(o,t){if(o&1){let e=M();l(0,"app-ui-project-cms-card",36,2),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))})("openMenu",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),C(s.open(n))}),a()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(18);f("card",lt(n.mode))("item",e)("isActived",e.id==n.selected.id)("contextMenu",r)("showOption",!0)("contextMenuValue",vt(7,Qm,e,i))}}function AM(o,t){o&1&&_(0,"app-ui-message-empty")}function jM(o,t){if(o&1&&(l(0,"div"),Y(1,NM,2,10,"app-ui-project-cms-card",35,de,!1,AM,1,0,"app-ui-message-empty"),a()),o&2){let e=d();it(Re("_",e.mode)),c(),ee(e.projectCmss)}}function RM(o,t){o&1&&(l(0,"div",37)(1,"div",38),_(2,"i",39),a(),l(3,"div",40),u(4,"Ver detalles"),a(),_(5,"div",41),a())}function LM(o,t){o&1&&(l(0,"div",37)(1,"div",38),_(2,"i",42),a(),l(3,"div",40),u(4,"Adicionar"),a(),l(5,"div",41),u(6,"F1"),a()())}function UM(o,t){o&1&&(l(0,"div",37)(1,"div",38),_(2,"i",43),a(),l(3,"div",40),u(4,"Editar"),a(),_(5,"div",41),a())}function zM(o,t){o&1&&(l(0,"div",37)(1,"div",38),_(2,"i",44),a(),l(3,"div",40),u(4,"Eliminar"),a(),_(5,"div",41),a())}function BM(o,t){o&1&&(l(0,"div",37)(1,"div",38),_(2,"i",45),a(),l(3,"div",40),u(4,"Duplicar"),a(),_(5,"div",41),a())}function WM(o,t){}function $M(o,t){o&1&&(l(0,"div",37)(1,"div",38),_(2,"img",46),a(),l(3,"div",40),u(4,"Exportar"),a(),_(5,"div",41),a())}function HM(o,t){}function GM(o,t){o&1&&(l(0,"div",37)(1,"div",38),_(2,"i",47),a(),l(3,"div",40),u(4,"Actualizar lista"),a(),_(5,"div",41),a())}function qM(o,t){o&1&&(l(0,"div",37)(1,"div",38),_(2,"img",48),a(),l(3,"div",40),u(4,"En formato PDF"),a(),_(5,"div",41),a())}function JM(o,t){o&1&&(l(0,"div",37)(1,"div",38),_(2,"img",49),a(),l(3,"div",40),u(4,"En formato Excel"),a(),_(5,"div",41),a())}function XM(o,t){o&1&&_(0,"app-loading")}var Cd=class o{idinstitucion="";cms_id="";project_id="";showPagination=!1;mode="link";size="lg";eventChange=new q;projectCmss=[];load=!0;projectCmsService=b(mn);authService=b(xe);confirmationService=b(ft);modalService=b(Vi);filter={texto:""};loading=!1;base=this.authService.projectPath();ngOnInit(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.filter.idinstitucion=this.idinstitucion,this.filter.cms_id=this.cms_id,this.filter.project_id=this.project_id,this.load&&this.resetPage()})}page=1;resetPage(){return P(this,null,function*(){this.page=1,this.list()})}onPage(){this.list()}list(){return P(this,null,function*(){this.loading=!0,this.showPagination&&(this.filter.page=this.page);let t=yield this.projectCmsService.list(this.filter);this.loading=!1,t&&t.state=="success"&&(this.projectCmss=t.data??[])})}add(){this.openForm()}duplicate(t){return P(this,null,function*(){this.openForm("duplicate",t)})}update(t){this.openForm("update",t)}openForm(t="add",e){return P(this,null,function*(){try{let i=yield this.modalService.open(gd,{backdrop:"static",keyboard:!1,windowClass:"formCms"});i.componentInstance.accion=t,i.componentInstance.idinstitucion=this.filter.idinstitucion,i.componentInstance.cms_id=this.filter.cms_id,i.componentInstance.project_id=this.filter.project_id,t!="add"&&(i.componentInstance.projectCms=JSON.parse(JSON.stringify(e)));let n=yield i.result;if(t=="add"||t=="duplicate")this.projectCmss.unshift(n);else if(t=="update"){if(!e)return;Object.assign(e,n)}}catch{}})}remove(t,e=-1){return P(this,null,function*(){if(!(yield this.confirmationService.create("Eliminar","\xBFEst\xE1 seguro de eliminar el registro?")))return;this.loading=!0;let n=yield this.projectCmsService.delete({id:t.id,idinstitucion:t.idinstitucion});this.loading=!1,n.state=="success"&&(this.projectCmss.splice(e,1),this.selected={})})}openDetail(t){return P(this,null,function*(){try{let e=yield this.modalService.open(cd,{backdrop:"static",keyboard:!1,size:"lg"});e.componentInstance.item=t,e.componentInstance.id=t.id,e.componentInstance.idinstitucion=t.idinstitucion;let i=yield e.result}catch{}})}searchChange(){this.resetPage()}stateFilterChange(){this.resetPage()}selected={};select(t,e="click"){t.id==this.selected.id&&e!="dblclick"||(this.selected=t,e=="dblclick"&&this.openDetail(t),this.eventChange.emit({event:e,data:JSON.parse(JSON.stringify(t))}))}canAdd=()=>this.projectCmsService.canAdd;canEdit=()=>this.projectCmsService.canEdit;canRemove=()=>this.projectCmsService.canRemove;canChangeState=()=>this.projectCmsService.canChangeState;canExport=()=>this.projectCmsService.canExport;canExportExcel=()=>this.projectCmsService.canExportExcel;canExportPdf=()=>this.projectCmsService.canExportPdf;export(t="pdf"){return P(this,null,function*(){yield this.projectCmsService.export(this.filter,t)})}changeMode(t){this.mode=t}changes=[];changeList(t){if(this.projectCmss.forEach((e,i)=>{e.order_new=i+1}),this.detectSaveOrder(),this.mode!="table"){let e=this.mode;this.mode="table",setTimeout(()=>{this.mode=e})}}detectSaveOrder(){this.changes=[],this.projectCmss.forEach((t,e)=>{typeof t.order_new<"u"&&t.order_new!=t.orderList&&this.changes.push({id:t.id,idinstitucion:t.idinstitucion,orderList:t.order_new})})}saveOrder(){return P(this,null,function*(){if(!(yield this.confirmationService.create("Guardar Orden","\xBFEst\xE1 seguro de guardar el orden?")))return;this.loading=!0,(yield this.projectCmsService.saveOrder(this.changes)).state=="success"&&(this.projectCmss.forEach((i,n)=>{i.orderList=i.order_new??i.orderList}),this.changes=[]),this.loading=!1})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-project-cms-list"]],inputs:{idinstitucion:"idinstitucion",cms_id:"cms_id",project_id:"project_id",showPagination:"showPagination",mode:"mode",size:"size",projectCmss:"projectCmss",load:"load"},outputs:{eventChange:"eventChange"},decls:33,vars:15,consts:[["menu",""],["SubMenu",""],["ngxContextMenu","ngxContextMenu"],["type","button",1,"btn","btn-warning","btn-md-custom","btn-order"],[1,"d-flex","align-items-center","gap-1","p-1"],[1,"flex-grow-1"],[1,"d-flex","gap-1"],["app-button","",3,"click","rounded"],[1,"icon","ion-md-add"],["app-icon-button","",3,"click","rounded"],[1,"icon","ion-md-refresh"],[1,"p-1"],[3,"class"],["contextMenuItem","",3,"execute"],["contextMenuItem","",3,"execute","visible"],["contextMenuItem","",3,"divider"],["contextMenuItem","",3,"visible","subMenu"],["type","button",1,"btn","btn-warning","btn-md-custom","btn-order",3,"click"],[1,"table","table-sm","table-box","table-fixed"],[2,"width","40px"],["sortablejs","",3,"onUpdate","items"],[3,"ngClass","contextMenu","contextMenuValue"],[3,"elementEvents","ngClass","contextMenu","contextMenuValue"],[1,"text-center"],[1,"btn","btn-more",3,"click"],[1,"ion-md-more"],["routerLinkActive","active","cdkDrag","",1,"items",3,"routerLink","ngClass","contextMenu","contextMenuValue"],["routerLinkActive","active","cdkDrag","",1,"items",3,"elementEvents","routerLink","ngClass","contextMenu","contextMenuValue"],[1,"_img"],["src","https://cdn-icons-png.flaticon.com/512/967/967558.png","alt",""],["src","https://cdn-icons-png.flaticon.com/128/5134/5134601.png","alt",""],[1,"flex-grow-1","px-2"],[1,"action-buttons"],["app-icon-button","","variant","text","size","xs",3,"click"],[1,"icon","ion-md-more"],[3,"item","isActived","card","contextMenu","showOption","contextMenuValue"],[3,"elementEvents","openMenu","item","isActived","card","contextMenu","showOption","contextMenuValue"],[1,"_items"],[1,"icons"],[1,"icons","icon","ion-md-list-box"],[1,"label","w-100"],[1,"atajo"],[1,"icons","icon","ion-md-add"],[1,"icons","icon","ion-md-create"],[1,"icons","icon","ion-md-trash"],[1,"icons","icon","ion-md-copy"],["src","https://cdn-icons-png.flaticon.com/512/5414/5414637.png","alt",""],[1,"icons","icon","ion-md-refresh"],["src","assets/img/icons/pdf.png","alt",""],["src","assets/img/icons/excel.png","alt",""]],template:function(e,i){if(e&1){let n=M();D(0,IM,2,0,"button",3),l(1,"div",4)(2,"div",5)(3,"b"),u(4,"CMS"),a()(),l(5,"div",6)(6,"div")(7,"button",7),h("click",function(){return g(n),C(i.add())}),_(8,"i",8),l(9,"span"),u(10,"Adicionar"),a()()(),l(11,"div")(12,"button",9),h("click",function(){return g(n),C(i.resetPage())}),_(13,"i",10),a()()()(),D(14,TM,12,1,"div")(15,VM,3,0,"div",11)(16,jM,4,4,"div",12),l(17,"context-menu",null,0),Se(19,RM,6,0,"ng-template",13),h("execute",function(s){return g(n),C(i.openDetail(s.value.item))}),Se(20,LM,7,0,"ng-template",14),h("execute",function(){return g(n),C(i.add())}),Se(21,UM,6,0,"ng-template",14),h("execute",function(s){return g(n),C(i.update(s.value.item))}),Se(22,zM,6,0,"ng-template",14),h("execute",function(s){return g(n),C(i.remove(s.value.item,s.value.indice))}),Se(23,BM,6,0,"ng-template",14),h("execute",function(s){return g(n),C(i.duplicate(s.value.item))}),Se(24,WM,0,0,"ng-template",15)(25,$M,6,0,"ng-template",16)(26,HM,0,0,"ng-template",15)(27,GM,6,0,"ng-template",13),h("execute",function(){return g(n),C(i.resetPage())}),a(),l(28,"context-menu",null,1),Se(30,qM,6,0,"ng-template",14),h("execute",function(){return g(n),C(i.export())}),Se(31,JM,6,0,"ng-template",14),h("execute",function(){return g(n),C(i.export("excel"))}),a(),D(32,XM,1,0,"app-loading")}if(e&2){let n=Xe(29);T(i.changes.length?0:-1),c(7),f("rounded",!0),c(5),f("rounded",!0),c(2),T(i.mode=="table"?14:i.mode=="link"?15:16),c(6),f("visible",i.canAdd),c(),f("visible",i.canEdit),c(),f("visible",i.canRemove),c(),f("visible",i.canAdd),c(),f("divider",!0),c(),f("visible",i.canExport)("subMenu",n),c(),f("divider",!0),c(4),f("visible",i.canExportPdf),c(),f("visible",i.canExportExcel),c(),T(i.loading?32:-1)}},dependencies:[si,Si,wi,xi,be,pe,Ye,Ke,At,Kr,Ei,Ni,lo,cs,cn,ir,he,Be,Ge],styles:[".items[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem;margin-bottom:.25rem;color:inherit}.items.box-main[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:.5rem}.items[_ngcontent-%COMP%]:not(.box-main){background:var(--fuse-bg-card);border-radius:.5rem;padding:.25rem .05rem}.items[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;width:100%;color:var(--navbar-color)}.items[_ngcontent-%COMP%]:hover, .items[_ngcontent-%COMP%]:hover   a[_ngcontent-%COMP%]{color:var(--primary-hover)}.items[_ngcontent-%COMP%]   ._img[_ngcontent-%COMP%]{width:20px;height:20px;display:flex;justify-content:center;align-items:center;border-radius:.2rem;margin-left:.5rem}.items[_ngcontent-%COMP%]   ._img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.items.active[_ngcontent-%COMP%]{font-weight:700;color:var(--primary);background-color:var(--primary-pastel)}.items.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--slide-active-color)!important}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.25rem;align-items:center}"]})};var _d=class o{routerActive=b(Wi);router=b(ln);authService=b(xe);project_id="";ngOnInit(){this.routerActive.params?.subscribe(t=>{console.log("estamos recibiendo paramrtros",t),t.project_id&&(this.project_id=t.project_id)})}selectCMS(t){return P(this,null,function*(){console.log(t),this.router.navigate([`/${this.authService.projectPath()}/proyectos/${this.project_id}/cms2/`,t.data.cms_id,"data"])})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-project-cms-panel"]],decls:6,vars:2,consts:[["initialPanel1Size","350px"],["pane1","",1,"b-r",2,"height","100%"],[2,"height","100%","overflow-y","auto","overflow-x","hidden"],["size","sm","mode","link",3,"project_id"],["pane2","",1,"",2,"height","100%"]],template:function(e,i){e&1&&(l(0,"app-split-view",0)(1,"div",1)(2,"div",2),_(3,"app-ui-project-cms-list",3),a()(),l(4,"div",4),_(5,"router-outlet"),a()()),e&2&&(c(3),f("project_id",lt(i.project_id)))},dependencies:[Xr,Cd,oo],encapsulation:2})};var vd=class o{constructor(t){this.fb=t;this.form=this.fb.group({label:[this.label,ze.required]})}form;modalService=b(St);color="#000000ff";label="";ngOnInit(){this.form.patchValue({label:this.label})}onSubmit(){this.form.valid&&this.modalService.ok(re(k({},this.form.value),{color:this.color}))}onCancel(){this.modalService.close()}static \u0275fac=function(e){return new(e||o)(gt(kp))};static \u0275cmp=N({type:o,selectors:[["app-color-form"]],inputs:{color:"color",label:"label"},decls:20,vars:3,consts:[[3,"ngSubmit","formGroup"],[2,"width","100px"],[3,"colorChange","color"],["type","text","formControlName","label","placeholder","Etiqueta del color",1,"form-control"],[1,"modal-footer"],["app-button","","size","lg","variant","outline","color","secondary","type","button",3,"click"],["app-button","","size","lg","type","submit",3,"disabled"]],template:function(e,i){e&1&&(l(0,"form",0),h("ngSubmit",function(){return i.onSubmit()}),l(1,"table")(2,"tbody")(3,"tr")(4,"td",1)(5,"label"),u(6,"Color:"),a()(),l(7,"td")(8,"app-color-picker",2),ne("colorChange",function(r){return Z(i.color,r)||(i.color=r),r}),a()()(),l(9,"tr")(10,"td")(11,"label"),u(12,"Etiqueta:"),a()(),l(13,"td"),_(14,"input",3),a()()()(),l(15,"div",4)(16,"button",5),h("click",function(){return i.onCancel()}),u(17,"Cancelar"),a(),l(18,"button",6),u(19,"Guardar"),a()()()),e&2&&(f("formGroup",i.form),c(8),ie("color",i.color),c(10),f("disabled",i.form.invalid))},dependencies:[Kt,Zt,Qe,Ne,Xt,Qt,ri,he,Be,An],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.actions[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:flex-end}"]})};function ZM(o,t){if(o&1){let e=M();l(0,"button",14),h("click",function(){g(e);let n=d();return C(n.choiseFavicon())}),l(1,"span"),u(2,"Elegir favicon"),a()()}}function QM(o,t){if(o&1){let e=M();l(0,"img",15),h("click",function(){g(e);let n=d();return C(n.choiseFavicon())}),a()}if(o&2){let e=d();f("src",e.project.faviconUrl,mt)}}function KM(o,t){o&1&&_(0,"div",27)}function YM(o,t){if(o&1){let e=M();l(0,"div",8)(1,"div",16)(2,"button",17),h("click",function(n){return g(e),C(n.stopPropagation())}),_(3,"i",18),a(),_(4,"app-color-box",19),l(5,"div",20),u(6),a(),l(7,"div",21)(8,"button",22),h("click",function(){let n=g(e).$implicit,r=d();return C(r.deleteColor(n))}),_(9,"ng-icon",23),a(),l(10,"button",24),h("click",function(){let n=g(e).$implicit,r=d();return C(r.editColor(n))}),_(11,"ng-icon",25),a()()(),Se(12,KM,1,0,"div",26),a()}if(o&2){let e=t.$implicit;c(4),f("color",e.color),c(2),W(e.label)}}function eI(o,t){if(o&1&&(l(0,"option",10),u(1),a()),o&2){let e=t.$implicit;f("value",e.value),c(),W(e.label)}}function tI(o,t){o&1&&u(0," A\xFAn no se gener\xF3 el enlace de dominio ")}function iI(o,t){if(o&1&&(l(0,"a",13),u(1),a()),o&2){let e=d();f("href",lt(e.project.domian),mt),c(),Ie(" ",e.project.domian," ")}}function nI(o,t){o&1&&u(0," A\xFAn no se gener\xF3 el enlace de previsualizaci\xF3n ")}function oI(o,t){if(o&1&&(l(0,"a",13),u(1),a()),o&2){let e=d();f("href",lt(e.project.domianPreview),mt),c(),Ie(" ",e.project.domianPreview," ")}}var yd=class o{project_id;project;institution;projectService=b(Pi);modalService=b(St);projectDataService=b(gr);modeDeleteColor=A(!1);colorPalette=[];fontFamily="";fontOptions=[{value:" ",label:"Fuente Global",url:""},{value:"'Tangerine', cursive",label:"Tangerine",url:"https://fonts.googleapis.com/css2?family=Tangerine:wght@400;700&display=swap"},{value:"'Playwrite CU', cursive",label:"Playwrite CU",url:"https://fonts.googleapis.com/css2?family=Playwrite+CU:wght@100..400&display=swap"},{value:"'Raleway', sans-serif",label:"Raleway",url:"https://fonts.googleapis.com/css2?family=Raleway&display=swap"},{value:"'Pacifico', cursive",label:"Pacifico",url:"https://fonts.googleapis.com/css2?family=Pacifico&display=swap"},{value:"'Poppins', sans-serif",label:"Poppins",url:"https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,300;0,400;0,600;1,300;1,400;1,600&display=swap"},{value:"'Lato', sans-serif",label:"Lato",url:"https://fonts.googleapis.com/css2?family=Lato&display=swap"},{value:"'Roboto', sans-serif",label:"Roboto",url:"https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,700;1,300;1,400;1,700&display=swap"},{value:"'Merriweather', serif",label:"Merriweather",url:"https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap"},{value:"'Playfair Display', serif",label:"Playfair Display",url:"https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap"},{value:"'Montserrat', system-ui",label:"Montserrat",url:"https://fonts.googleapis.com/css2?family=Montserrat&display=swap"},{value:"'Orbitron', sans-serif",label:"Orbitron",url:"https://fonts.googleapis.com/css2?family=Orbitron&display=swap"},{value:"'Chakra Petch', sans-serif",label:"Chakra Petch",url:"https://fonts.googleapis.com/css2?family=Chakra+Petch:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap"}];ngOnInit(){this.loadColorPalette(),this.loadProject()}loadColorPalette(){return P(this,null,function*(){let e=(yield this.projectDataService.list({project_id:this.project_id,idinstitucion:this.institution?.idinstitucion+""})).data??[];if(e.length>0){let[i]=e;this.colorPalette=JSON.parse(i.paletteColors??"[]")}})}loadProject(){return P(this,null,function*(){let t=yield this.projectService.data({id:+this.project_id,idinstitucion:this.institution?.idinstitucion+""});return t.state=="success"&&(this.project=t.data??this.project,this.fontFamily=this.project.fontFamily??""),t})}choiseFavicon(){return P(this,null,function*(){let e=yield this.modalService.open(Bn,{title:"Subir favicon",hiddenButtons:!0,hiddenMargin:!0,params:{modeSelection:!0}}).result();e!=null&&e.isOk&&this.projectService.updateFavicon({id:+this.project_id,faviconUrl:e.data?.fileUrl??"",faviconName:e.data?.fileName??"",idinstitucion:this.institution?.idinstitucion+""}).then(i=>{i.state=="success"&&(this.project.faviconUrl=e.data?.fileUrl??"",this.project.faviconName="")})})}drop(t){jn(this.colorPalette,t.previousIndex,t.currentIndex),this.saveColorPalette()}saveColorPalette(){this.projectDataService.registerPaletteColor(+this.project_id,JSON.stringify(this.colorPalette))}onFontChange(t){let i=t.target.value;this.fontFamily=i,this.projectService.patch({id:+this.project_id,fontFamily:this.fontFamily,idinstitucion:this.institution?.idinstitucion+""});let n=this.fontOptions.find(r=>r.value===i);n&&n.url&&this.loadFontLink(n.url)}loadFontLink(t){let e=document.getElementById("dynamic-font");e&&e.remove();let i=document.createElement("link");i.id="dynamic-font",i.rel="stylesheet",i.href=t,document.head.appendChild(i)}editColor(t){this.addColor(t)}deleteColor(t){this.colorPalette=this.colorPalette.filter(e=>e.id!=t.id),this.saveColorPalette()}addColor(t){return P(this,null,function*(){let i=yield this.modalService.open(vd,{title:t?"Editar color":"Agregar color",hiddenButtons:!0,params:{color:t?.color??"#000000",label:t?.label??""}}).result();if(i?.data){if(t){let n=this.colorPalette.findIndex(r=>r.id==t.id);n!=-1&&(this.colorPalette[n]=re(k({},i.data),{id:t.id}))}else this.colorPalette.push(re(k({},i.data),{id:ga()}));this.projectDataService.registerPaletteColor(+this.project_id,JSON.stringify(this.colorPalette))}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-project-settings"]],inputs:{project_id:"project_id",project:"project",institution:"institution"},features:[we([],[Te({lucidePencil:Du,lucideTrash2:ao})])],decls:48,vars:7,consts:[[1,"settings-container"],[1,"settings-section","box-main"],[1,"favicon-container"],[1,"favicon-button"],["alt","Favicon",1,"favicon-preview",3,"src"],[1,"d-flex","justify-content-between","align-items-center"],["app-button","",3,"click"],["cdkDropList","",1,"color-palette",3,"cdkDropListDropped"],["cdkDrag","",1,"color-item"],[1,"form-select-sm",2,"max-width","300px",3,"change","value"],[3,"value"],[1,"font-preview"],[1,"text-secondary"],["target","_blank",3,"href"],[1,"favicon-button",3,"click"],["alt","Favicon",1,"favicon-preview",3,"click","src"],[1,"d-flex","align-items-center","w-100"],["cdkDragHandle","",1,"drag-handle",3,"click"],[1,"bi","bi-grip-vertical"],["size","28px",2,"border-radius","50%",3,"color"],[1,"color-label"],[1,"color-actions"],["app-icon-button","","variant","text","color","danger","size","xs",3,"click"],["name","lucideTrash2"],["app-icon-button","","size","xs",3,"click"],["name","lucidePencil"],["class","cdkDragPlaceholder",4,"cdkDragPlaceholder"],[1,"cdkDragPlaceholder"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div",1)(2,"h5")(3,"b"),u(4,"Favicon del sitio"),a()(),l(5,"p"),u(6,"El favicon aparecer\xE1 en la pesta\xF1a del navegador, para subir un favicon, seleccione una imagenen el menu multimedia."),a(),l(7,"div",2),D(8,ZM,3,0,"button",3)(9,QM,1,1,"img",4),a()(),l(10,"div",1)(11,"div",5)(12,"h5")(13,"b"),u(14,"Paleta de colores"),a()(),l(15,"button",6),h("click",function(){return i.addColor()}),u(16,"Nuevo"),a()(),l(17,"p"),u(18,"Agrega colores a la paleta"),a(),l(19,"div",7),h("cdkDropListDropped",function(r){return i.drop(r)}),Y(20,YM,13,2,"div",8,de),a()(),l(22,"div",1)(23,"h5")(24,"b"),u(25,"Fuente principal"),a()(),l(26,"p"),u(27,"Selecciona la fuente principal para el sitio"),a(),l(28,"select",9),h("change",function(r){return i.onFontChange(r)}),Y(29,eI,2,2,"option",10,de),a(),l(31,"div",11)(32,"span"),u(33,"Vista previa: El r\xE1pido zorro marr\xF3n salta sobre el perro perezoso."),a()()(),l(34,"div",1)(35,"h5")(36,"b"),u(37,"Dominios"),a()(),l(38,"p",12),u(39,"Dominio de producci\xF3n:"),a(),l(40,"div",2),D(41,tI,1,0)(42,iI,2,3,"a",13),a(),l(43,"p",12),u(44,"Dominio de previsualizaci\xF3n:"),a(),l(45,"div",2),D(46,nI,1,0)(47,oI,2,3,"a",13),a()()()),e&2&&(c(8),T(i.project.faviconUrl==""?8:9),c(12),ee(i.colorPalette),c(8),f("value",i.fontFamily),c(),ee(i.fontOptions),c(3),pi(Re("font-size: 1.2em; font-family: ",i.fontFamily,";")),c(9),T(i.project.domian==""?41:42),c(5),T(i.project.domianPreview==""?46:47))},dependencies:[Ki,he,Be,Ge,Dr,_o,Co,go,Ml,Je],styles:['@charset "UTF-8";.settings-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.settings-section[_ngcontent-%COMP%]{padding:1.5rem;border-radius:8px}.favicon-button[_ngcontent-%COMP%]{display:block;width:64px;height:64px;border:2px dashed #ccc;border-radius:8px;cursor:pointer;transition:all .2s ease;padding:0}.favicon-button[_ngcontent-%COMP%]:hover{border-color:#1976d2}.favicon-preview[_ngcontent-%COMP%]{display:block;width:64px;height:64px;object-fit:contain;border-radius:8px;border:1px solid #dee2e6;cursor:pointer}.color-palette[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;padding:10px 0}.color-item[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:default;gap:1rem;padding:2px 8px;border-radius:6px;border:1px solid transparent}.color-label[_ngcontent-%COMP%]{font-size:.8rem;margin-left:12px;text-align:left;flex-grow:1}.color-actions[_ngcontent-%COMP%]{display:flex;gap:6px}.action-btn[_ngcontent-%COMP%]{background:transparent;border:none;padding:4px 6px;border-radius:4px;cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center}.edit-btn[_ngcontent-%COMP%]:hover{color:#0d6efd;background-color:#0d6efd1a}.delete-btn[_ngcontent-%COMP%]:hover{color:#dc3545;background-color:#dc35451a}.drag-handle[_ngcontent-%COMP%]{cursor:move;border:none;background:transparent;color:#aaa;margin-right:8px;padding:0}.drag-handle[_ngcontent-%COMP%]:hover{color:#666}.cdk-drag-placeholder[_ngcontent-%COMP%]{border:2px dashed #aaa!important;box-shadow:0 1px 8px #0000001a;height:40px}.color-palette.cdk-drop-list-dragging[_ngcontent-%COMP%]   .color-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){border:1px solid #ddd}.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 5px 10px #0003;border:1px solid #ccc;background-color:#fff;border-radius:6px}.font-preview[_ngcontent-%COMP%]{padding:1rem;background-color:var(--bg-card-100);border-radius:8px;border:1px solid var(--border-color);margin-top:1rem}']})};function rI(o,t){if(o&1&&_(0,"app-project-settings",2),o&2){let e=d();f("project_id",e.project_id())("project",e.project())("institution",e.institution)}}function aI(o,t){o&1&&(l(0,"div",3),u(1,"Cargando informaci\xF3n del proyecto..."),a())}var bd=class o{projectDetailService=b(co);project=ce(()=>this.projectDetailService.project());project_id=ce(()=>this.projectDetailService.project_id());institution=this.projectDetailService.institution;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-page-menu"]],decls:6,vars:2,consts:[[1,"main-menu"],["type","content","mode","list",3,"project_id"],[3,"project_id","project","institution"],[1,"loading-message"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"div"),_(2,"app-ui-page-list",1),a(),l(3,"div"),D(4,rI,1,3,"app-project-settings",2)(5,aI,2,0,"div",3),a()()),e&2&&(c(2),f("project_id",i.project_id()),c(2),T(i.project()!=null?4:5))},dependencies:[Tr,yd],styles:[".main-menu[_ngcontent-%COMP%]{display:flex;width:100%;height:100%}.main-menu[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1;padding:15px;overflow-y:auto}.loading-message[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100px;font-style:italic;color:#666}"]})};var sI=o=>({active:o});function lI(o,t){if(o&1&&(l(0,"table",0)(1,"thead")(2,"tr"),_(3,"th",2)(4,"th"),a()(),l(5,"tbody")(6,"tr")(7,"td",3)(8,"b"),u(9," C\xF3digo "),a()(),l(10,"td"),u(11),a()(),l(12,"tr")(13,"td",3)(14,"b"),u(15," Descripci\xF3n "),a()(),l(16,"td"),u(17),a()(),l(18,"tr")(19,"td",3)(20,"b"),u(21," Fecha de registro "),a()(),l(22,"td"),u(23),Ii(24,"date"),a()(),l(25,"tr")(26,"td",3)(27,"b"),u(28," \xBFActivo? "),a()(),l(29,"td"),_(30,"app-text-state",4),a()()()()),o&2){let e=d();c(11),W(e.item.code),c(6),W(e.item.note),c(6),W(Di(24,4,e.item.createAt,"dd/MM/yyyy HH:mm:ss")),c(7),f("state",e.item.state)}}function cI(o,t){if(o&1){let e=M();l(0,"div")(1,"button",6),h("click",function(n){g(e);let r=d(2);return C(r.openMenuEmit(n))}),_(2,"i",7),a()()}}function dI(o,t){if(o&1&&(l(0,"div",1)(1,"div")(2,"div",5),u(3),a(),l(4,"div",5),u(5),a(),l(6,"div",5),u(7),a(),l(8,"div"),u(9),Ii(10,"date"),a(),l(11,"div",5),u(12),a(),l(13,"div"),_(14,"app-text-state",4),a(),l(15,"div",5),u(16),a(),l(17,"div",5),u(18),a(),l(19,"div",5),u(20),a(),l(21,"div",5),u(22),a()(),D(23,cI,3,0,"div"),a()),o&2){let e=d();f("ngClass",te(15,sI,e.isActived)),c(3),W(e.item.id),c(2),W(e.item.code),c(2),W(e.item.note),c(2),W(Di(10,12,e.item.createAt,"dd/MM/yyyy HH:mm:ss")),c(3),W(e.item.createBy),c(2),f("state",e.item.state),c(2),W(e.item.idinstitucion),c(2),W(e.item.project_id),c(2),W(e.item.fileUrl),c(2),W(e.item.fileName),c(),T(e.showOption?23:-1)}}var ta=class o{item={};isActived=!1;card="box";showOption=!1;openMenu=new q;modeData="";projectPublicService=b($n);openMenuEmit(t){this.openMenu.emit(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-project-public-card"]],inputs:{item:"item",isActived:"isActived",card:"card",showOption:"showOption",modeData:"modeData"},outputs:{openMenu:"openMenu"},decls:2,vars:1,consts:[[1,"table","table-datos","box-main"],[1,"items","box-main",3,"ngClass"],[2,"width","100px"],["nowrap",""],[3,"state"],[1,"text-truncate"],["type","button",1,"btn","btn-more",3,"click"],[1,"icon","ion-md-more"]],template:function(e,i){e&1&&D(0,lI,31,7,"table",0)(1,dI,24,17,"div",1),e&2&&T(i.card=="table"?0:1)},dependencies:[be,Gi,Oi],encapsulation:2})};var mI=o=>({"modal-body":o});function pI(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",3),u(2,"DATOS DE PULICACI\xD3N"),a(),l(3,"button",4),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}var xd=class o{constructor(t){this.activeModal=t}isModal=!0;item={};eventChange=new q;projectPublicService=b($n);EProjectPublicState=Qo;close(){this.isModal?this.activeModal.close():this.eventChange.emit({event:"close",data:this.item})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-project-public-detail"]],inputs:{isModal:"isModal",item:"item"},outputs:{eventChange:"eventChange"},decls:3,vars:5,consts:[[1,"modal-header"],[1,"",3,"ngClass"],["card","table",3,"item"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"]],template:function(e,i){e&1&&(D(0,pI,4,0,"div",0),l(1,"div",1),_(2,"app-ui-project-public-card",2),a()),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(3,mI,i.isModal)),c(),f("item",i.item))},dependencies:[be,ta],encapsulation:2})};var uI=o=>({active:o}),V0=(o,t)=>({item:o,indice:t}),fI=(o,t)=>t.id;function hI(o,t){if(o&1){let e=M();l(0,"tr",12,2),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))}),l(2,"td",13),u(3),a(),l(4,"td",14),u(5),Ii(6,"date"),a(),l(7,"td",14),u(8),a(),l(9,"td"),u(10),a(),l(11,"td",14),_(12,"app-text-state",15),a(),l(13,"td",13)(14,"button",16),h("click",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),C(s.open(n))}),_(15,"i",17),a()()()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(4);f("ngClass",te(11,uI,e.id==n.selected.id))("contextMenu",r)("contextMenuValue",vt(13,V0,e,i)),c(3),Ie(" ",(i+1).zfill(2)," "),c(2),W(Di(6,8,e.createAt,"dd/MM/yyyy HH:mm")),c(3),W(e.code),c(2),W(e.note),c(2),f("state",e.state)}}function gI(o,t){if(o&1&&(l(0,"div")(1,"table",9)(2,"thead")(3,"tr")(4,"th",10),u(5,"#"),a(),l(6,"th",10),u(7,"A las"),a(),l(8,"th",10),u(9,"C\xF3digo"),a(),l(10,"th"),u(11,"Descripci\xF3n"),a(),l(12,"th",10),u(13,"\xBFActivo?"),a(),_(14,"th",10),a()(),l(15,"tbody"),Y(16,hI,16,16,"tr",11,fI),a()()()),o&2){let e=d();c(16),ee(e.projectPublics)}}function CI(o,t){if(o&1){let e=M();l(0,"app-ui-project-public-card",19,2),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))})("openMenu",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),C(s.open(n))}),a()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(4);f("card",lt(n.mode))("item",e)("isActived",e.id==n.selected.id)("contextMenu",r)("showOption",!0)("contextMenuValue",vt(7,V0,e,i))}}function _I(o,t){o&1&&_(0,"app-ui-message-empty")}function vI(o,t){if(o&1&&(l(0,"div"),Y(1,CI,2,10,"app-ui-project-public-card",18,de,!1,_I,1,0,"app-ui-message-empty"),a()),o&2){let e=d();it(Re("_",e.mode)),c(),ee(e.projectPublics)}}function yI(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",22),a(),l(3,"div",23),u(4,"Ver detalles"),a(),_(5,"div",24),a())}function bI(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",25),a(),l(3,"div",23),u(4,"Adicionar"),a(),l(5,"div",24),u(6,"F1"),a()())}function xI(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",26),a(),l(3,"div",23),u(4,"Editar"),a(),_(5,"div",24),a())}function wI(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",27),a(),l(3,"div",23),u(4,"Eliminar"),a(),_(5,"div",24),a())}function SI(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",28),a(),l(3,"div",23),u(4,"Duplicar"),a(),_(5,"div",24),a())}function EI(o,t){}function PI(o,t){o&1&&(l(0,"div",20)(1,"div",29),_(2,"i",30),a(),l(3,"div",23),u(4,"INACTIVO"),a(),_(5,"div",24),a())}function MI(o,t){o&1&&(l(0,"div",20)(1,"div",29),_(2,"i",30),a(),l(3,"div",23),u(4,"ACTIVO"),a(),_(5,"div",24),a())}function II(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"img",31),a(),l(3,"div",23),u(4,"Exportar"),a(),_(5,"div",24),a())}function DI(o,t){}function TI(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"i",32),a(),l(3,"div",23),u(4,"Actualizar lista"),a(),_(5,"div",24),a())}function FI(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"img",33),a(),l(3,"div",23),u(4,"En formato PDF"),a(),_(5,"div",24),a())}function kI(o,t){o&1&&(l(0,"div",20)(1,"div",21),_(2,"img",34),a(),l(3,"div",23),u(4,"En formato Excel"),a(),_(5,"div",24),a())}function OI(o,t){o&1&&_(0,"app-loading")}var wd=class o{idinstitucion="";state="";project_id=nt("");showPagination=!1;mode="table";size="lg";eventChange=new q;projectPublics=[];load=!0;projectPublicService=b($n);authService=b(xe);confirmationService=b(ft);modalService=b(Vi);filter={texto:""};EProjectPublicState=Qo;loading=A(!1);projectDetailService=b(co);constructor(){yt(()=>{let t=this.projectDetailService.project_id();Ci(()=>{this.project_id.set(t)})})}ngOnInit(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.filter.idinstitucion=this.idinstitucion,this.filter.state=this.state,this.filter.project_id=this.project_id(),this.load&&this.resetPage()})}page=1;resetPage(){return P(this,null,function*(){this.page=1,this.list()})}onPage(){this.list()}list(){return P(this,null,function*(){this.loading.set(!0),this.showPagination&&(this.filter.page=this.page);let t=yield this.projectPublicService.list(this.filter);this.loading.set(!1),t&&t.state=="success"&&(this.projectPublics=t.data??[])})}add(){this.openForm()}duplicate(t){return P(this,null,function*(){this.openForm("duplicate",t)})}update(t){this.openForm("update",t)}openForm(t="add",e){return P(this,null,function*(){try{let i=yield this.modalService.open(Jr,{backdrop:"static",keyboard:!1,size:"lg"});i.componentInstance.accion=t,i.componentInstance.idinstitucion=this.filter.idinstitucion,i.componentInstance.project_id=this.filter.project_id,t!="add"&&(i.componentInstance.projectPublic=JSON.parse(JSON.stringify(e)));let n=yield i.result;if(t=="add"||t=="duplicate")this.projectPublics.unshift(n);else if(t=="update"){if(!e)return;Object.assign(e,n)}}catch{}})}remove(t,e=-1){return P(this,null,function*(){if(!(yield this.confirmationService.create("Eliminar","\xBFEst\xE1 seguro de eliminar el registro?")))return;this.loading.set(!0);let n=yield this.projectPublicService.delete({id:t.id,idinstitucion:t.idinstitucion});this.loading.set(!1),n.state=="success"&&(this.projectPublics.splice(e,1),this.selected={})})}openDetail(t){return P(this,null,function*(){try{let e=yield this.modalService.open(xd,{backdrop:"static",keyboard:!1,size:"lg"});e.componentInstance.item=t,e.componentInstance.id=t.id,e.componentInstance.idinstitucion=t.idinstitucion;let i=yield e.result}catch{}})}changeState(t,e){return P(this,null,function*(){let i={id:t.id,idinstitucion:t.idinstitucion,state:e},n=yield this.projectPublicService.changeState(i);n&&n.state=="success"&&(t.state=e)})}searchChange(){this.resetPage()}stateFilterChange(){this.resetPage()}selected={};select(t,e="click"){t.id==this.selected.id&&e!="dblclick"||(this.selected=t,e=="dblclick"&&this.openDetail(t),this.eventChange.emit({event:e,data:JSON.parse(JSON.stringify(t))}))}canAdd=()=>this.projectPublicService.canAdd;canEdit=()=>this.projectPublicService.canEdit;canRemove=()=>this.projectPublicService.canRemove;canChangeState=()=>this.projectPublicService.canChangeState;canExport=()=>this.projectPublicService.canExport;canExportExcel=()=>this.projectPublicService.canExportExcel;canExportPdf=()=>this.projectPublicService.canExportPdf;canChangeStateINACTIVO=t=>this.projectPublicService.canChangeState&&t.item.state!="0";canChangeStateACTIVO=t=>this.projectPublicService.canChangeState&&t.item.state!="1";export(t="pdf"){return P(this,null,function*(){yield this.projectPublicService.export(this.filter,t)})}changeMode(t){this.mode=t}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-project-public-list"]],inputs:{idinstitucion:"idinstitucion",state:"state",project_id:[1,"project_id"],showPagination:"showPagination",mode:"mode",size:"size",projectPublics:"projectPublics",load:"load"},outputs:{project_id:"project_idChange",eventChange:"eventChange"},decls:22,vars:25,consts:[["menu",""],["SubMenu",""],["ngxContextMenu","ngxContextMenu"],[3,"stateChange","searchChange","onAdd","onExport","onSearch","reload","pageChange","modeChange","state","states","search","canExport","canExportExcel","canExportPdf","page","showPagination","canNew","mode","size"],[3,"class"],["contextMenuItem","",3,"execute"],["contextMenuItem","",3,"execute","visible"],["contextMenuItem","",3,"divider"],["contextMenuItem","",3,"visible","subMenu"],[1,"table","table-sm","table-box","table-fixed"],[2,"width","40px"],[3,"ngClass","contextMenu","contextMenuValue"],[3,"elementEvents","ngClass","contextMenu","contextMenuValue"],[1,"text-center"],["nowrap","",1,"text-center"],[3,"state"],[1,"btn","btn-more",3,"click"],[1,"ion-md-more"],[3,"item","isActived","card","contextMenu","showOption","contextMenuValue"],[3,"elementEvents","openMenu","item","isActived","card","contextMenu","showOption","contextMenuValue"],[1,"_items"],[1,"icons"],[1,"icons","icon","ion-md-list-box"],[1,"label","w-100"],[1,"atajo"],[1,"icons","icon","ion-md-add"],[1,"icons","icon","ion-md-create"],[1,"icons","icon","ion-md-trash"],[1,"icons","icon","ion-md-copy"],[1,"icons","text-"],[1,"icon","ion-md-"],["src","https://cdn-icons-png.flaticon.com/512/5414/5414637.png","alt",""],[1,"icons","icon","ion-md-refresh"],["src","assets/img/icons/pdf.png","alt",""],["src","assets/img/icons/excel.png","alt",""]],template:function(e,i){if(e&1){let n=M();l(0,"app-ui-header-management",3),ne("stateChange",function(s){return g(n),Z(i.filter.state,s)||(i.filter.state=s),C(s)})("searchChange",function(s){return g(n),Z(i.filter.texto,s)||(i.filter.texto=s),C(s)}),h("onAdd",function(){return g(n),C(i.add())})("onExport",function(s){return g(n),C(i.export(s))})("onSearch",function(){return g(n),C(i.searchChange())})("reload",function(){return g(n),C(i.resetPage())}),ne("pageChange",function(s){return g(n),Z(i.page,s)||(i.page=s),C(s)}),h("pageChange",function(){return g(n),C(i.onPage())}),ne("modeChange",function(s){return g(n),Z(i.mode,s)||(i.mode=s),C(s)}),a(),D(1,gI,18,0,"div")(2,vI,4,4,"div",4),l(3,"context-menu",null,0),Se(5,yI,6,0,"ng-template",5),h("execute",function(s){return g(n),C(i.openDetail(s.value.item))}),Se(6,bI,7,0,"ng-template",6),h("execute",function(){return g(n),C(i.add())}),Se(7,xI,6,0,"ng-template",6),h("execute",function(s){return g(n),C(i.update(s.value.item))}),Se(8,wI,6,0,"ng-template",6),h("execute",function(s){return g(n),C(i.remove(s.value.item,s.value.indice))}),Se(9,SI,6,0,"ng-template",6),h("execute",function(s){return g(n),C(i.duplicate(s.value.item))}),Se(10,EI,0,0,"ng-template",7)(11,PI,6,0,"ng-template",6),h("execute",function(s){return g(n),C(i.changeState(s.value.item,i.EProjectPublicState.INACTIVO))}),u(12,", "),Se(13,MI,6,0,"ng-template",6),h("execute",function(s){return g(n),C(i.changeState(s.value.item,i.EProjectPublicState.ACTIVO))}),Se(14,II,6,0,"ng-template",8)(15,DI,0,0,"ng-template",7)(16,TI,6,0,"ng-template",5),h("execute",function(){return g(n),C(i.resetPage())}),a(),l(17,"context-menu",null,1),Se(19,FI,6,0,"ng-template",6),h("execute",function(){return g(n),C(i.export())}),Se(20,kI,6,0,"ng-template",6),h("execute",function(){return g(n),C(i.export("excel"))}),a(),D(21,OI,1,0,"app-loading")}if(e&2){let n=Xe(18);ie("state",i.filter.state),f("states",i.projectPublicService.states),ie("search",i.filter.texto),f("canExport",i.projectPublicService.canExport)("canExportExcel",i.projectPublicService.canExportExcel)("canExportPdf",i.projectPublicService.canExportPdf),ie("page",i.page),f("showPagination",i.showPagination)("canNew",i.projectPublicService.canAdd),ie("mode",i.mode),f("size",i.size),c(),T(i.mode=="table"?1:2),c(5),f("visible",i.canAdd),c(),f("visible",i.canEdit),c(),f("visible",i.canRemove),c(),f("visible",i.canAdd),c(),f("divider",!0),c(),f("visible",i.canChangeStateINACTIVO),c(2),f("visible",i.canChangeStateACTIVO),c(),f("visible",i.canExport)("subMenu",n),c(),f("divider",!0),c(4),f("visible",i.canExportPdf),c(),f("visible",i.canExportExcel),c(),T(i.loading()?21:-1)}},dependencies:[si,Si,wi,xi,be,pe,Gi,Ye,Ke,At,ta,Ei,dn,Ni,Oi],encapsulation:2})};var Hn=class o{API=`${Le.web_maker}/cms-data`;apiService=b(Lt);loadingService=b(Yt);confirmationService=b(ft);auth=b(xe);toastrService=b(tt);states=[{code:"1",denomination:"Publico"},{code:"0",denomination:"Oculto"}];stateMap=this.states.reduce((t,e)=>(t[e.code]=e.denomination,t),{});canAdd=!1;canEdit=!1;canRemove=!1;canChangeState=!1;canExport=!1;canExportExcel=!1;canExportPdf=!1;constructor(){this.abled(!0)}abled(t){t?(this.canAdd=this.auth.hasSubPermission("cms-data-ADD"),this.canEdit=this.auth.hasSubPermission("cms-data-EDIT"),this.canRemove=this.auth.hasSubPermission("cms-data-REMOVE"),this.canChangeState=this.auth.hasSubPermission("cms-data-CHANGE-STATE"),this.canExport=this.auth.hasPermission("cms-data-EXPORT"),this.canExportExcel=this.auth.hasSubPermission("cms-data-EXPORT-EXCEL"),this.canExportPdf=this.auth.hasSubPermission("cms-data-EXPORT-PDF")):(this.canAdd=!1,this.canEdit=!1,this.canRemove=!1,this.canChangeState=!1,this.canExport=!1,this.canExportExcel=!1,this.canExportPdf=!1)}list(t){return P(this,null,function*(){let e=yield this.apiService.getPrivate(`${this.API}/list`,t);return e.state=="success"&&e.data&&e.data.forEach(i=>{i.data!=""&&(i.dataJSON=JSON.parse(i.data))}),e})}add(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/create`,t);return e.state=="success"&&e.data&&this.toastrService.success(e.message),e})}data(t){return P(this,null,function*(){return yield this.apiService.getPrivate(`${this.API}/data/${t.id}`,t)})}update(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}patch(t){return P(this,null,function*(){let e=yield this.apiService.putPrivate(`${this.API}/update/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}changeStateMessage(t){let e=this.stateMap[t],i="";switch(t){case"1":i="text-success";break;case"0":i="text-danger";break}return{message:`
            <div class="text-center">
                <div class="mb-3">\xBFEst\xE1 seguro de cambiar el estado del registro?</div>
                <h3 >Nuevo estado: <b class="${i}">${e}</b></h3>
            </div>
        `,denomination:e}}changeStateSave(t){return P(this,null,function*(){return yield this.apiService.putPrivate(`${this.API}/state/change/${t.id}`,t)})}changeState(t){return P(this,null,function*(){let{message:e}=this.changeStateMessage(t.state);if(!(yield this.confirmationService.create("Confirmar",e)))return;this.loadingService.open();let n=yield this.changeStateSave(t);return this.loadingService.hide(),n})}delete(t){return P(this,null,function*(){let e=yield this.apiService.deletePrivate(`${this.API}/delete/${t.id}`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}export(t,e,i=!0){return P(this,null,function*(){if(i&&!(yield this.confirmationService.create("Confirmar","\xBFEst\xE1 seguro de exportar los datos?")))return;this.loadingService.open();let n=re(k({},t),{type_export:e,url:Le.storage_view,institution:this.auth.getInstitution()}),r=yield this.apiService.postPrivate(`${this.API}/export`,n);return this.loadingService.hide(),r&&r.state=="success"&&window.open(r.url),r})}saveOrder(t){return P(this,null,function*(){let e=yield this.apiService.postPrivate(`${this.API}/order/list`,t);return e.state=="success"&&this.toastrService.success(e.message),e})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=He({token:o,factory:o.\u0275fac,providedIn:"root"})};var VI=o=>({active:o});function NI(o,t){if(o&1&&(l(0,"table",0)(1,"thead")(2,"tr"),_(3,"th",2)(4,"th"),a()(),l(5,"tbody")(6,"tr")(7,"td",3)(8,"b"),u(9," Fecha de registro "),a()(),l(10,"td"),u(11),Ii(12,"date"),a()(),l(13,"tr")(14,"td",3)(15,"b"),u(16," Estado "),a()(),l(17,"td"),_(18,"app-text-state",4),a()()()()),o&2){let e=d();c(11),W(Di(12,2,e.item.createAt,"dd/MM/yyyy HH:mm:ss")),c(7),f("state",e.item.state)}}function AI(o,t){if(o&1){let e=M();l(0,"div")(1,"button",6),h("click",function(n){g(e);let r=d(2);return C(r.openMenuEmit(n))}),_(2,"i",7),a()()}}function jI(o,t){if(o&1&&(l(0,"div",1)(1,"div")(2,"div",5),u(3),a()(),D(4,AI,3,0,"div"),a()),o&2){let e=d();f("ngClass",te(3,VI,e.isActived)),c(3),W(e.item.data),c(),T(e.showOption?4:-1)}}var ia=class o{item={};isActived=!1;card="box";showOption=!1;openMenu=new q;modeData="";cmsDataService=b(Hn);openMenuEmit(t){this.openMenu.emit(t)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-cms-data-card"]],inputs:{item:"item",isActived:"isActived",card:"card",showOption:"showOption",modeData:"modeData"},outputs:{openMenu:"openMenu"},decls:2,vars:1,consts:[[1,"table","table-datos","box-main"],[1,"items","box-main",3,"ngClass"],[2,"width","100px"],["nowrap",""],[3,"state"],[1,"text-truncate"],["type","button",1,"btn","btn-more",3,"click"],[1,"icon","ion-md-more"]],template:function(e,i){e&1&&D(0,NI,19,5,"table",0)(1,jI,5,5,"div",1),e&2&&T(i.card=="table"?0:1)},dependencies:[be,Gi,Oi],encapsulation:2})};var RI=o=>({"modal-body":o});function LI(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",3),u(2,"DATOS"),a(),l(3,"button",4),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}var Sd=class o{constructor(t){this.activeModal=t}isModal=!0;item={};eventChange=new q;cmsDataService=b(Hn);ECmsDataState=Fo;close(){this.isModal?this.activeModal.close():this.eventChange.emit({event:"close",data:this.item})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-cms-data-detail"]],inputs:{isModal:"isModal",item:"item"},outputs:{eventChange:"eventChange"},decls:3,vars:5,consts:[[1,"modal-header"],[1,"",3,"ngClass"],["card","table",3,"item"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"]],template:function(e,i){e&1&&(D(0,LI,4,0,"div",0),l(1,"div",1),_(2,"app-ui-cms-data-card",2),a()),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(3,RI,i.isModal)),c(),f("item",i.item))},dependencies:[be,ia],encapsulation:2})};var Ed=class o{value="";_disabled=!1;set disabled(t){this._disabled=t}get disabled(){return this._disabled}onChange=t=>{};onTouched=()=>{};writeValue(t){t!==void 0&&(this.value=t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._disabled=t}validate(t){return null}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-text-editor-reactive"]],inputs:{disabled:"disabled"},features:[we([{provide:ms,useExisting:Yo(()=>o),multi:!0},{provide:us,useExisting:Yo(()=>o),multi:!0}])],decls:1,vars:1,consts:[[3,"valueChange","value"]],template:function(e,i){e&1&&(l(0,"app-text-editor",0),h("valueChange",function(r){return i.onChange(r)}),a()),e&2&&f("value",i.value)},dependencies:[yo],encapsulation:2})};var UI=o=>({"modal-body ":o}),zI=o=>({"has-danger":o});function BI(o,t){if(o&1){let e=M();l(0,"div",0)(1,"h4",6),u(2,"DATOS"),a(),l(3,"button",7),h("click",function(){g(e);let n=d();return C(n.close())}),a()()}}function WI(o,t){if(o&1&&_(0,"i",9),o&2){let e=d().$implicit;f("ngbTooltip",e.description)}}function $I(o,t){o&1&&(l(0,"span",10),u(1,"*"),a())}function HI(o,t){if(o&1){let e=M();l(0,"input",19),h("ngModelChange",function(){g(e);let n=d().$implicit,r=d();return C(r.change(n))}),a()}if(o&2){let e=d().$implicit;f("id",e.field)("formControlName",e.field)}}function GI(o,t){if(o&1){let e=M();l(0,"div",13)(1,"div",20),_(2,"input",21),a(),l(3,"button",22),h("click",function(){g(e);let n=d().$implicit,r=d();return C(r.storage(n))}),u(4,"Catalogo"),a()()}if(o&2){let e=d().$implicit;c(2),f("id",e.field)("formControlName",e.field)}}function qI(o,t){if(o&1&&_(0,"input",14),o&2){let e=d().$implicit;f("id",e.field)("formControlName",e.field)}}function JI(o,t){if(o&1&&_(0,"app-text-editor-reactive",15),o&2){let e=d().$implicit;f("formControlName",e.field)}}function XI(o,t){if(o&1&&_(0,"input",16),o&2){let e=d().$implicit;f("id",e.field)("formControlName",e.field)}}function ZI(o,t){if(o&1&&_(0,"input",17),o&2){let e=d().$implicit;f("id",e.field)("formControlName",e.field)}}function QI(o,t){if(o&1&&(l(0,"div",3)(1,"label",8),u(2),D(3,WI,1,1,"i",9),D(4,$I,2,0,"span",10),a(),l(5,"div",11),D(6,HI,1,2,"input",12)(7,GI,5,2,"div",13)(8,qI,1,2,"input",14)(9,JI,1,1,"app-text-editor-reactive",15)(10,XI,1,2,"input",16)(11,ZI,1,2,"input",17),_(12,"app-control-messages",18),a()()),o&2){let e,i,n=t.$implicit,r=d();f("ngClass",te(8,zI,((e=r.formDetail.get(n.field))==null?null:e.invalid)&&(((e=r.formDetail.get(n.field))==null?null:e.touched)||r.submit))),c(),f("for",n.field),c(),Ie("",n.denomination," "),c(),T(n.description!==""?3:-1),c(),T(n.isRequired==="1"?4:-1),c(2),T((i=n.type)==="text"?6:i==="image"?7:i==="link2"?8:i==="paragraph"?9:i==="file"?10:i==="slug"?11:-1),c(6),f("control",r.formDetail.get(n.field))("show",r.submit)}}function KI(o,t){if(o&1){let e=M();l(0,"div",5)(1,"button",23),h("click",function(){g(e);let n=d();return C(n.close())}),u(2,"Cancelar"),a(),l(3,"button",24),h("click",function(){g(e);let n=d();return C(n.save())}),u(4,"Guardar"),a()()}}function YI(o,t){o&1&&_(0,"app-loading")}var Pd=class o{constructor(t){this.modalActive=t}accion="add";cmsData;isModal=!0;idinstitucion="";uid="";state="1";cms_id="";showOption=!0;onSave=new ki(!1);isSave=!0;cmsFields=[];eventChange=new q;cmsFieldService=b(Yi);cmsDataService=b(Hn);authService=b(xe);states=this.cmsDataService.states;subscriptions=[];formDetail=new ni({});showDetail=!1;ngOnInit(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.uid===""&&(this.uid=this.authService.userData.id+"");let t=this.onSave.subscribe(e=>{e&&this.save()});if(this.subscriptions.push(t),this.accion=="update"||this.accion=="duplicate"){if(!this.cmsData)return;this.form.patchValue({orderList:this.cmsData.orderList+"",state:this.cmsData.state,data:this.cmsData.data,cmsId:this.cmsData.cms_id+""})}else this.accion=="add"&&this.form.patchValue({state:this.state,cmsId:this.cms_id});if(this.cmsFields.forEach(e=>{let i=[];e.isRequired=="1"&&i.push(ze.required),e.maxLength&&e.maxLength!=""&&i.push(ze.maxLength(+e.maxLength)),this.formDetail.addControl(e.field,new Fe(e.defaultValue,i))}),this.showDetail=!0,this.cmsFields.length&&this.focusInput(this.cmsFields[0].field),this.accion=="update"||this.accion=="duplicate"){let e=this.cmsFields.map(n=>n.field),i={};e.forEach(n=>{i[`${n}`]=this.cmsData?.dataJSON?.[`${n}`]}),this.formDetail.patchValue(i)}})}ngAfterViewInit(){setTimeout(()=>{document.getElementById("orderListCm")?.focus()},150)}focusInput(t){setTimeout(()=>{document.getElementById(t)?.focus()},150)}form=new ni({orderList:new Fe("0",{validators:[ze.required],nonNullable:!0}),state:new Fe("1",{validators:[ze.required],nonNullable:!0}),data:new Fe("",{validators:[ze.required],nonNullable:!0}),cmsId:new Fe("0",{validators:[ze.required],nonNullable:!0})});get orderListControl(){return this.form.get("orderList")}get stateControl(){return this.form.get("state")}get dataControl(){return this.form.get("data")}get cmsIdControl(){return this.form.get("cmsId")}close(){this.isModal?this.modalActive.dismiss():this.eventChange.emit({event:"close",data:void 0})}submit=!1;loading=!1;save(){return P(this,null,function*(){if(this.submit=!0,!this.formDetail.valid)return;let t=this.formDetail.value;if(this.form.patchValue({data:JSON.stringify(t)}),!this.form.valid)return;this.submit=!1;let e=this.form.value;if(!this.isSave){if(this.accion==="add"||this.accion==="duplicate"){let i={id:Date.now(),createBy:this.uid,idinstitucion:+this.idinstitucion,orderList:+e.orderList,state:e.state,data:e.data,cms_id:+e.cmsId,createAt:""};this.isModal?this.modalActive.close(i):this.eventChange.emit({event:"add",data:i})}else if(this.accion==="update"){let i={id:+this.cmsData?.id,idinstitucion:+this.idinstitucion,cms_id:+e.cmsId,createAt:this.cmsData?.createAt,createBy:this.cmsData?.createBy,data:e.data,orderList:this.cmsData?.orderList,state:e.state};this.isModal?this.modalActive.close(i):this.eventChange.emit({event:"update",data:i})}return}if(this.accion=="add"||this.accion=="duplicate"){let i={createBy:this.uid,idinstitucion:+this.idinstitucion,orderList:+e.orderList,state:e.state,data:e.data,cms_id:+e.cmsId};this.loading=!0;let n=yield this.cmsDataService.add(i);this.loading=!1,n.state=="success"&&(n.data&&(n.data.dataJSON=JSON.parse(n.data.data)),this.isModal?this.modalActive.close(n.data):this.eventChange.emit({event:"add",data:n.data}))}else if(this.accion=="update"){let i={id:+this.cmsData?.id,idinstitucion:+this.idinstitucion,orderList:+e.orderList,state:e.state,data:e.data,cms_id:+e.cmsId};this.loading=!0;let n=yield this.cmsDataService.update(i);this.loading=!1,n.state=="success"&&(i.dataJSON=JSON.parse(i.data),this.isModal?this.modalActive.close(i):this.eventChange.emit({event:"update",data:i}))}})}change(t){let e=this.formDetail.get(t.field)?.value;console.log(`VALUE: ${e}`);let i=this.cmsFields.filter(n=>n.type==="slug"&&n.extra===t.id+"");if(i.length){let n=i[0];e=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-").replace(/-+/g,"-"),this.formDetail.get(n.field)?.setValue(e)}}modalService=b(St);storage(t){return P(this,null,function*(){let i=yield this.modalService.open(Bn,{title:"Subir favicon",hiddenButtons:!0,hiddenMargin:!0,params:{modeSelection:!0}}).result();i!=null&&i.isOk&&this.formDetail.get(t.field)?.setValue(i.data?.fileUrl)})}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}static \u0275fac=function(e){return new(e||o)(gt(Mt,8))};static \u0275cmp=N({type:o,selectors:[["app-ui-cms-data-form"]],inputs:{accion:"accion",cmsData:"cmsData",isModal:"isModal",idinstitucion:"idinstitucion",uid:"uid",state:"state",cms_id:"cms_id",showOption:"showOption",onSave:"onSave",isSave:"isSave",cmsFields:"cmsFields"},outputs:{eventChange:"eventChange"},decls:8,vars:8,consts:[[1,"modal-header"],[1,"",3,"ngClass"],[1,"",3,"submit","formGroup"],[1,"form-group",3,"ngClass"],[1,"container",3,"submit","formGroup"],[1,"modal-footer"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],[1,"control-label","gap-2",3,"for"],["placement","top",1,"ion-md-information-circle-outline",3,"ngbTooltip"],[1,"text-danger"],[1,""],["type","text",1,"form-control",3,"id","formControlName"],[1,"d-flex","gap-1"],["type","url","placeholder","Ingrese enlace",1,"form-control",3,"id","formControlName"],[3,"formControlName"],["type","url","placeholder","Ingrese URL de archivo",1,"form-control",3,"id","formControlName"],["type","url","placeholder","URL del contenido",1,"form-control",3,"id","formControlName"],[3,"control","show"],["type","text",1,"form-control",3,"ngModelChange","id","formControlName"],[1,"flex-grow-1"],["type","url","placeholder","Ingrese URL de imagen",1,"form-control",3,"id","formControlName"],["type","button",1,"btn","btn-primary","btn-md-custom",3,"click"],["type","button",1,"btn","btn-outline-secondary","btn-lg-medio","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-lg-medio",3,"click"]],template:function(e,i){e&1&&(D(0,BI,4,0,"div",0),l(1,"div",1)(2,"form",2),h("submit",function(){return i.save()}),Y(3,QI,13,10,"div",3,de),a(),l(5,"form",4),h("submit",function(){return i.save()}),a()(),D(6,KI,5,0,"div",5),D(7,YI,1,0,"app-loading")),e&2&&(T(i.isModal?0:-1),c(),f("ngClass",te(6,UI,i.isModal)),c(),f("formGroup",i.formDetail),c(),ee(i.cmsFields),c(2),f("formGroup",i.form),c(),T(i.showOption?6:-1),c(),T(i.loading?7:-1))},dependencies:[Kt,Zt,Qe,Ne,Xt,Qt,ri,bi,be,Ye,At,rr,Ed],styles:["span.text-danger[_ngcontent-%COMP%]{margin-left:5px}i[_ngcontent-%COMP%]{font-size:1rem;color:var(--primary);vertical-align:middle}"]})};var eD=o=>({active:o}),N0=(o,t)=>({item:o,indice:t}),tD=(o,t)=>t.id;function iD(o,t){if(o&1){let e=M();l(0,"button",18),h("click",function(){g(e);let n=d();return C(n.saveOrder())}),u(1,"Guardar orden"),a()}}function nD(o,t){if(o&1&&(l(0,"option",8),u(1),a()),o&2){let e=t.$implicit;f("value",lt(e.code)),c(),W(e.denomination)}}function oD(o,t){if(o&1){let e=M();l(0,"div")(1,"button",19),h("click",function(){g(e);let n=d(2);return C(n.syncDataApi())}),_(2,"i",11),u(3," Sincronizar datos "),a()()}o&2&&(c(),f("rounded",!0))}function rD(o,t){if(o&1){let e=M();l(0,"div")(1,"button",19),h("click",function(){g(e);let n=d(2);return C(n.add())}),_(2,"i",20),l(3,"span"),u(4,"Adicionar"),a()()()}o&2&&(c(),f("rounded",!0))}function aD(o,t){if(o&1&&D(0,oD,4,1,"div")(1,rD,5,1,"div"),o&2){let e=d();T(e.cms.source==="API"?0:1)}}function sD(o,t){if(o&1&&(l(0,"th"),u(1),a()),o&2){let e=t.$implicit;c(),Ie(" ",e.denomination," ")}}function lD(o,t){if(o&1&&(l(0,"div",30),_(1,"img",31),a()),o&2){let e=d().$implicit,i=d().$implicit;c(),f("src",lt(i.dataJSON[e.field]),mt)}}function cD(o,t){o&1&&(l(0,"div"),u(1,"[Cotenido...]"),a())}function dD(o,t){if(o&1&&u(0),o&2){let e=d().$implicit,i=d().$implicit;Ie(" ",i.dataJSON[e.field]," ")}}function mD(o,t){if(o&1&&(l(0,"td"),D(1,lD,2,2,"div",30)(2,cD,2,0,"div")(3,dD,1,1),a()),o&2){let e,i=t.$implicit;c(),T((e=i.type)==="image"?1:e==="paragraph"?2:3)}}function pD(o,t){if(o&1){let e=M();l(0,"tr",25,2),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))}),l(2,"td",26),u(3),a(),l(4,"td",27),u(5),Ii(6,"date"),a(),Y(7,mD,4,1,"td",null,de),l(9,"td",26)(10,"button",28),h("click",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),C(s.open(n))}),_(11,"i",29),a()()()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(21);f("ngClass",te(8,eD,e.id==n.selected.id))("contextMenu",r)("contextMenuValue",vt(10,N0,e,i)),c(3),Ie(" ",(i+1).zfill(2)," "),c(2),W(Di(6,5,e.createAt,"dd/MM/yyyy HH:mm:ss")),c(2),ee(n.cmsFields)}}function uD(o,t){if(o&1){let e=M();l(0,"div")(1,"table",21)(2,"thead")(3,"tr")(4,"th",22),u(5,"#"),a(),l(6,"th"),u(7,"Creado"),a(),Y(8,sD,2,1,"th",null,de),_(10,"th",22),a()(),l(11,"tbody",23),h("onUpdate",function(n){g(e);let r=d();return C(r.changeList(n))}),Y(12,pD,12,13,"tr",24,tD),a()()()}if(o&2){let e=d();c(8),ee(e.cmsFields),c(3),f("items",e.data),c(),ee(e.data)}}function fD(o,t){if(o&1){let e=M();l(0,"app-ui-cms-data-card",33,2),h("elementEvents",function(n){let r=g(e).$implicit,s=d(2);return C(s.select(r,n))})("openMenu",function(n){let r=g(e).$implicit,s=Xe(1);return d(2).select(r),C(s.open(n))}),a()}if(o&2){let e=t.$implicit,i=t.$index,n=d(2),r=Xe(21);f("card",lt(n.mode))("item",e)("isActived",e.id==n.selected.id)("contextMenu",r)("showOption",!0)("contextMenuValue",vt(7,N0,e,i))}}function hD(o,t){o&1&&_(0,"app-ui-message-empty")}function gD(o,t){if(o&1&&(l(0,"div"),Y(1,fD,2,10,"app-ui-cms-data-card",32,de,!1,hD,1,0,"app-ui-message-empty"),a()),o&2){let e=d();it(Re("_",e.mode)),c(),ee(e.data)}}function CD(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"i",36),a(),l(3,"div",37),u(4,"Ver detalles"),a(),_(5,"div",38),a())}function _D(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"i",39),a(),l(3,"div",37),u(4,"Adicionar"),a(),l(5,"div",38),u(6,"F1"),a()())}function vD(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"i",40),a(),l(3,"div",37),u(4,"Editar"),a(),_(5,"div",38),a())}function yD(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"i",41),a(),l(3,"div",37),u(4,"Eliminar"),a(),_(5,"div",38),a())}function bD(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"i",42),a(),l(3,"div",37),u(4,"Duplicar"),a(),_(5,"div",38),a())}function xD(o,t){}function wD(o,t){o&1&&(l(0,"div",34)(1,"div",43),_(2,"i",44),a(),l(3,"div",37),u(4,"Mostrar"),a(),_(5,"div",38),a())}function SD(o,t){o&1&&(l(0,"div",34)(1,"div",45),_(2,"i",46),a(),l(3,"div",37),u(4,"Ocultar"),a(),_(5,"div",38),a())}function ED(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"img",47),a(),l(3,"div",37),u(4,"Exportar"),a(),_(5,"div",38),a())}function PD(o,t){}function MD(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"i",48),a(),l(3,"div",37),u(4,"Actualizar lista"),a(),_(5,"div",38),a())}function ID(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"img",49),a(),l(3,"div",37),u(4,"En formato PDF"),a(),_(5,"div",38),a())}function DD(o,t){o&1&&(l(0,"div",34)(1,"div",35),_(2,"img",50),a(),l(3,"div",37),u(4,"En formato Excel"),a(),_(5,"div",38),a())}function TD(o,t){o&1&&_(0,"app-loading")}var Md=class o{routerActive=b(Wi);cmsService=b(Io);idinstitucion="";state="1";cms_id=nt("");showPagination=!1;mode="table";size="lg";eventChange=new q;data=[];cmsFields=[];cms;abled=!0;isLoad=!0;cmsDataService=b(Hn);authService=b(xe);confirmationService=b(ft);modalService=b(Vi);filter={texto:""};ECmsDataState=Fo;loading=A(!1);constructor(){yt(()=>{this.cms_id()&&Ci(()=>P(this,null,function*(){yield this.load()}))})}ngOnInit(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.filter.cms_id=this.cms_id(),this.filter.state=this.state}load(){return P(this,null,function*(){this.idinstitucion===""&&(this.idinstitucion=this.authService.institucionData?.idinstitucion+""),this.filter.idinstitucion=this.idinstitucion,this.filter.state=this.state,this.filter.cms_id=this.cms_id(),this.cmsDataService.abled(this.abled),this.cms?.source==="API"&&(this.abled=!1,this.cmsDataService.abled(!1)),this.isLoad&&(yield this.resetPage())})}page=1;resetPage(){return P(this,null,function*(){this.page=1,this.list()})}onPage(){this.list()}list(){return P(this,null,function*(){this.loading.set(!0),this.showPagination&&(this.filter.page=this.page);let t=yield this.cmsDataService.list(this.filter);this.loading.set(!1),t&&t.state=="success"&&(this.data=t.data??[])})}add(){this.openForm()}duplicate(t){return P(this,null,function*(){this.openForm("duplicate",t)})}update(t){this.openForm("update",t)}openForm(t="add",e){return P(this,null,function*(){try{let i=this.modalService.open(Pd,{backdrop:"static",keyboard:!1,size:"md"});i.componentInstance.accion=t,i.componentInstance.idinstitucion=this.filter.idinstitucion,i.componentInstance.cms_id=this.filter.cms_id,i.componentInstance.cmsFields=this.cmsFields,t!="add"&&(i.componentInstance.cmsData=JSON.parse(JSON.stringify(e)));let n=yield i.result;if(t=="add"||t=="duplicate")this.data.unshift(n);else if(t=="update"){if(!e)return;Object.assign(e,n)}}catch{}})}remove(t,e=-1){return P(this,null,function*(){if(!(yield this.confirmationService.create("Eliminar","\xBFEst\xE1 seguro de eliminar el registro?")))return;this.loading.set(!0);let n=yield this.cmsDataService.delete({id:t.id,idinstitucion:t.idinstitucion});this.loading.set(!1),n.state=="success"&&(this.data.splice(e,1),this.selected={})})}openDetail(t){return P(this,null,function*(){try{let e=yield this.modalService.open(Sd,{backdrop:"static",keyboard:!1,size:"lg"});e.componentInstance.item=t,e.componentInstance.id=t.id,e.componentInstance.idinstitucion=t.idinstitucion;let i=yield e.result}catch{}})}changeState(t,e){return P(this,null,function*(){let i={id:t.id,idinstitucion:t.idinstitucion,state:e},n=yield this.cmsDataService.changeState(i);n&&n.state=="success"&&(t.state=e)})}searchChange(){this.resetPage()}ECmsDataStateFilter=Xm;setState(t){this.filter.state=t,this.resetPage()}stateFilterChange(){this.resetPage()}selected={};select(t,e="click"){t.id==this.selected.id&&e!="dblclick"||(this.selected=t,e=="dblclick"&&this.openDetail(t),this.eventChange.emit({event:e,data:JSON.parse(JSON.stringify(t))}))}canAdd=()=>this.cmsDataService.canAdd;canEdit=()=>this.cmsDataService.canEdit;canRemove=()=>this.cmsDataService.canRemove;canChangeState=()=>this.cmsDataService.canChangeState;canExport=()=>this.cmsDataService.canExport;canExportExcel=()=>this.cmsDataService.canExportExcel;canExportPdf=()=>this.cmsDataService.canExportPdf;canChangeStateACTIVE=t=>this.cmsDataService.canChangeState&&t.item.state!="1";canChangeStateINACTIVE=t=>this.cmsDataService.canChangeState&&t.item.state!="0";export(t="pdf"){return P(this,null,function*(){yield this.cmsDataService.export(this.filter,t)})}changeMode(t){this.mode=t}changes=[];changeList(t){if(this.data.forEach((e,i)=>{e.order_new=i+1}),this.detectSaveOrder(),this.mode!="table"){let e=this.mode;this.mode="table",setTimeout(()=>{this.mode=e})}}detectSaveOrder(){this.changes=[],this.data.forEach((t,e)=>{typeof t.order_new<"u"&&t.order_new!=t.orderList&&this.changes.push({id:t.id,idinstitucion:t.idinstitucion,orderList:t.order_new})})}saveOrder(){return P(this,null,function*(){if(!(yield this.confirmationService.create("Guardar Orden","\xBFEst\xE1 seguro de guardar el orden?")))return;this.loading.set(!0),(yield this.cmsDataService.saveOrder(this.changes)).state=="success"&&(this.data.forEach((i,n)=>{i.orderList=i.order_new??i.orderList}),this.changes=[]),this.loading.set(!1)})}admColumn(){return P(this,null,function*(){try{let t=yield this.modalService.open(ea,{backdrop:"static",keyboard:!1,size:"lg",windowClass:this.cms?.source==="API"?"modal_1250":""});t.componentInstance.cms_id=this.cms_id(),t.componentInstance.load=!1,t.componentInstance.isModal=!0,t.componentInstance.cmsFields=this.cmsFields,t.componentInstance.cms=this.cms;let e=yield t.result;JSON.stringify(this.cmsFields)!==JSON.stringify(e)&&(this.cmsFields=e)}catch{}})}syncDataApi(){return P(this,null,function*(){let t=yield this.cmsService.syncDataApi({id:+this.cms_id(),idinstitucion:+this.idinstitucion});t&&t.state=="success"&&this.resetPage()})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-ui-cms-data-list"]],inputs:{idinstitucion:"idinstitucion",state:"state",cms_id:[1,"cms_id"],showPagination:"showPagination",mode:"mode",size:"size",data:"data",cmsFields:"cmsFields",cms:"cms",abled:"abled",isLoad:"isLoad"},outputs:{cms_id:"cms_idChange",eventChange:"eventChange"},decls:39,vars:19,consts:[["menu",""],["SubMenu",""],["ngxContextMenu","ngxContextMenu"],["type","button",1,"btn","btn-warning","btn-md-custom","btn-order"],[1,"justify-content-between","gap-1","d-flex","p-1"],["addClass","transparente","title","Estado"],["name","estado","id","estado",1,"form-select","form-select-sm",3,"change","ngModelChange","ngModel"],["value",""],[3,"value"],[1,"gap-1","d-flex"],["app-button","","variant","outline",3,"click","rounded"],[1,"icon","ion-md-refresh"],["app-icon-button","",3,"click","rounded"],[3,"class"],["contextMenuItem","",3,"execute"],["contextMenuItem","",3,"execute","visible"],["contextMenuItem","",3,"divider"],["contextMenuItem","",3,"visible","subMenu"],["type","button",1,"btn","btn-warning","btn-md-custom","btn-order",3,"click"],["app-button","",3,"click","rounded"],[1,"icon","ion-md-add"],[1,"table","table-sm","table-box","table-fixed"],[2,"width","40px"],["sortablejs","",3,"onUpdate","items"],[3,"ngClass","contextMenu","contextMenuValue"],[3,"elementEvents","ngClass","contextMenu","contextMenuValue"],[1,"text-center"],["nowrap","",1,"text-center"],[1,"btn","btn-more","btn-more-sm",3,"click"],[1,"ion-md-more"],[1,"_img"],["alt","",3,"src"],[3,"item","isActived","card","contextMenu","showOption","contextMenuValue"],[3,"elementEvents","openMenu","item","isActived","card","contextMenu","showOption","contextMenuValue"],[1,"_items"],[1,"icons"],[1,"icons","icon","ion-md-list-box"],[1,"label","w-100"],[1,"atajo"],[1,"icons","icon","ion-md-add"],[1,"icons","icon","ion-md-create"],[1,"icons","icon","ion-md-trash"],[1,"icons","icon","ion-md-copy"],[1,"icons","text-success"],[1,"icon","ion-md-eye"],[1,"icons","text-danger"],[1,"icon","ion-md-eye-off"],["src","https://cdn-icons-png.flaticon.com/512/5414/5414637.png","alt",""],[1,"icons","icon","ion-md-refresh"],["src","assets/img/icons/pdf.png","alt",""],["src","assets/img/icons/excel.png","alt",""]],template:function(e,i){if(e&1){let n=M();D(0,iD,2,0,"button",3),l(1,"div",4)(2,"div")(3,"app-box-filter",5)(4,"select",6),h("change",function(){return g(n),C(i.resetPage())}),ne("ngModelChange",function(s){return g(n),Z(i.filter.state,s)||(i.filter.state=s),C(s)}),l(5,"option",7),u(6,"Todos"),a(),Y(7,nD,2,3,"option",8,de),a()()(),l(9,"div",9),D(10,aD,2,1),l(11,"div")(12,"button",10),h("click",function(){return g(n),C(i.admColumn())}),_(13,"i",11),u(14," Columnas "),a()(),l(15,"div")(16,"button",12),h("click",function(){return g(n),C(i.resetPage())}),_(17,"i",11),a()()()(),D(18,uD,14,1,"div")(19,gD,4,4,"div",13),l(20,"context-menu",null,0),Se(22,CD,6,0,"ng-template",14),h("execute",function(s){return g(n),C(i.openDetail(s.value.item))}),Se(23,_D,7,0,"ng-template",15),h("execute",function(){return g(n),C(i.add())}),Se(24,vD,6,0,"ng-template",15),h("execute",function(s){return g(n),C(i.update(s.value.item))}),Se(25,yD,6,0,"ng-template",15),h("execute",function(s){return g(n),C(i.remove(s.value.item,s.value.indice))}),Se(26,bD,6,0,"ng-template",15),h("execute",function(s){return g(n),C(i.duplicate(s.value.item))}),Se(27,xD,0,0,"ng-template",16)(28,wD,6,0,"ng-template",15),h("execute",function(s){return g(n),C(i.changeState(s.value.item,i.ECmsDataState.ACTIVE))}),u(29,", "),Se(30,SD,6,0,"ng-template",15),h("execute",function(s){return g(n),C(i.changeState(s.value.item,i.ECmsDataState.INACTIVE))}),Se(31,ED,6,0,"ng-template",17)(32,PD,0,0,"ng-template",16)(33,MD,6,0,"ng-template",14),h("execute",function(){return g(n),C(i.resetPage())}),a(),l(34,"context-menu",null,1),Se(36,ID,6,0,"ng-template",15),h("execute",function(){return g(n),C(i.export())}),Se(37,DD,6,0,"ng-template",15),h("execute",function(){return g(n),C(i.export("excel"))}),a(),D(38,TD,1,0,"app-loading")}if(e&2){let n=Xe(35);T(i.changes.length?0:-1),c(4),ie("ngModel",i.filter.state),c(3),ee(i.cmsDataService.states),c(3),T(i.cms?10:-1),c(2),f("rounded",!0),c(4),f("rounded",!0),c(2),T(i.mode=="table"?18:19),c(5),f("visible",i.canAdd),c(),f("visible",i.canEdit),c(),f("visible",i.canRemove),c(),f("visible",i.canAdd),c(),f("divider",!0),c(),f("visible",i.canChangeStateACTIVE),c(2),f("visible",i.canChangeStateINACTIVE),c(),f("visible",i.canExport)("subMenu",n),c(),f("divider",!0),c(4),f("visible",i.canExportPdf),c(),f("visible",i.canExportExcel),c(),T(i.loading()?38:-1)}},dependencies:[si,Si,wi,xi,be,pe,Ht,Gt,$t,Ne,at,Ye,Ke,At,ia,Ei,Ni,lo,he,Be,Ge,of,Oi],styles:["._img[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;margin:auto}._img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:40px;max-height:40px}"]})};function FD(o,t){if(o&1&&_(0,"app-ui-cms-data-list",0),o&2){let e=d();f("cms_id",lt(e.cms.id))("data",e.cmsData)("cms",e.cms)("cmsFields",e.cmsFields)("isLoad",!1)}}function kD(o,t){o&1&&_(0,"app-loading")}var Id=class o{cms;cmsData=[];cmsFields=[];cmsService=b(Io);loading=!1;routerActive=b(Wi);cms_id="";authService=b(xe);ngOnInit(){this.routerActive.params.subscribe(t=>{console.log("params",t),t.cms_id&&(this.cms_id=t.cms_id,this.getData())})}getData(){return P(this,null,function*(){if(!this.authService.institucionData)return;this.loading=!0;let t=yield this.cmsService.data({id:+this.cms_id,idinstitucion:this.authService.institucionData.idinstitucion,origin:"ALL"});t&&t.state=="success"&&(this.cms=t.data,this.cmsFields=this.cms?.fieldsData??[],this.cmsData=this.cms?.data??[]),this.loading=!1})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=N({type:o,selectors:[["app-cms-data-page"]],decls:2,vars:2,consts:[[3,"data","cms","cmsFields","isLoad","cms_id"]],template:function(e,i){e&1&&(D(0,FD,1,6,"app-ui-cms-data-list",0),D(1,kD,1,0,"app-loading")),e&2&&(T(i.cms?0:-1),c(),T(i.loading?1:-1))},dependencies:[Md,Ye],encapsulation:2})};var Uge=[{path:"",component:Zs,children:[{path:"bienvenido",redirectTo:"proyectos"},{path:"proyectos",component:ol},{path:"componentes",component:id},{path:"play",component:bl},{path:"proyectos/:project_id",component:al,children:[{path:"",redirectTo:"general",pathMatch:"full"},{path:"general",component:bd},{path:"historial",component:wd},{path:"storage",component:Bn},{path:"componentes",component:td},{path:"cms",component:_d,children:[{path:":cms_id/data",component:Id}]}]},{path:"design",component:Qs,children:[{path:":project_id/:type/:item_id",component:Hc},{path:"presets",component:sd},{path:"docs",component:ld}]},{path:"",redirectTo:"proyectos",pathMatch:"full"}]},{path:"",redirectTo:"bienvenido",pathMatch:"full"}];export{Uge as MakerRoutes};
